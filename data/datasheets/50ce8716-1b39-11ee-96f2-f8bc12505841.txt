[{'role': 'system', 'content': 'You are a technical specialist with expertise in electronics. Your task is to analyze datasheets for electronic components and provide a concise summary of the product’s key characteristics and specifications. In addition, you need to gather textual information about the component, including its description and typical applications.Instructions:    Identify the correct component in the datasheet using the provided product code.    Summarize key parameters, including:        Voltage ratings        Current ratings        Power consumption        Operating temperature range        Package type        Special features or notes (if applicable)        Moisture Sensetive Level JEDEC J-STD-020E    Provide a short description of the component, including what it is (e.g., transistor, microcontroller, sensor) and its primary function.    Explain typical applications for the component (e.g., power management, signal processing, data storage, etc.).    Be thorough and accurate: Ensure the information corresponds specifically to the product code, as some datasheets cover multiple variants.Your goal is to create a clear and accurate technical summary that includes both key specifications and a description of what the component is used for.'}, {'role': 'user', 'content': "Give me information about the component of ADE7878ACPZ-RL production of ANALOG DEVICES from the text: Polyphase Multifunction Energy Metering IC \nwith Harmonic and Fundamental Information  \nData Sheet ADE7854 /ADE7858 /ADE7868 /ADE7878  \n \nFEATURES  \nHighly accurate; supports EN 50470 -1, EN 50470- 3, \nIEC 62053- 21, IEC 62053- 22, and IEC 62053- 23 standards  \nCompatible with 3 -phase, 3 - or 4 -wire (delta or wye), and \nother 3 -phase services  \nSupplies total (fundamental and harmonic) active , reactive  \n(ADE7878 , ADE7 868, and ADE7858 only), and apparent \nenergy , and fundamental active/reactive energy  (ADE7878  \nonly)  on each phase and on the overall system   \nLess than 0.1% error in active and reactive energy over a \ndynamic range of 1000 to 1 at TA = 25°C \nLess than 0.2% error in ac tive and reactive energy over a \ndynamic range of 3000 to 1 at TA = 25°C  \nSupports current transformer and di/dt current sensors  \nDedicated ADC channel for neutral current input  (ADE7868  and \nADE7878  only)  \nLess than 0.1% error in voltage and current rms over a \ndynamic r ange of 1000 to 1 at TA = 25°C  \nSupplies sampled waveform data on all three  phases and on \nneutral current  \nSelectable no load threshold level s for total and \nfundamental active  and reactive powers, as well as for  \napparent powers \nLow power battery mode monito rs phase currents for \nantitampering detection  (ADE7868 and ADE7878 only)   \nBattery supply input f or missin g neutral operation  \nPhase angle measurements in both current and voltage \nchannels with a typical  0.3° error  \nWide -supply voltage operation : 2.4 V to 3.7  V \nReferen ce: 1.2 V (drift +5 ppm/°C typ ical ) with external \noverdrive  capability  \nSingle 3.3 V supply  \n40-lead lead frame chip scal e package (LFCSP), Pb -free  \nOperating temperature: −40°C to +85°C  \nFlexible I2C, SPI , and HSDC serial interfaces  \nAPPLICATIONS  \nEnergy metering systems  \nGENERAL DESCRIPTION  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 are high accuracy,  \n3-phase electrical energy measurement ICs with serial interface s \nand three flexible pulse outputs. The ADE78xx  devices incorporate  \nsecond -order sigma -delta (Σ -∆) analog -to-digital converters \n(ADCs), a digital integrator, reference circuitry, and all of the \nsignal processing required to perform total (fundamental  and harmonic) active, reactive  (ADE7878, ADE7868, and \nADE7858) , and apparent energy measurement and rms calcu -\nlations , as well  as fundamental -only active and reactive energy \nmeasurement  (ADE7878)  and rms calculations. A fixed function \ndigital signal processor (DSP) executes this signal processing. \nThe DSP program is stored in  the internal ROM memory.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 are suitabl e for \nmeasuring active, reactive, and apparent energy in various 3 -phase  \nconfigurations, such as wye or delta services, with both three and four wires. The ADE78xx  devices provide system calibration  \nfeatures for each phase, that is, rms offset correction, phase calibration, and gain calibration. The CF1, CF2, and CF3 logic outputs provide a wide choice o f power information: total active, \nreactive, and apparent powers, or the sum of the current rms \nvalues, and fundamental active and reactive powers.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 contain wave -\nform sample registers that allow access to all ADC outputs. The \ndevices also in corporate power quality measurements, such as \nshort duration low or high voltage detections, short duration \nhigh current variations, line voltage period measurement, and \nangles be tween phase voltages and currents. Two serial interfaces, \nSPI and I\n2C, can be  used to communicate with the ADE78xx . A \ndedicated high speed interface, the high speed data capture \n(HSDC) port, can be used in conjunction with I2C to provide \naccess to the ADC  outputs and real -time power information. \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 also have two \ninterrupt request pins, IRQ0  and IRQ1 , to indicate that an enabled \ninterrupt event has occurred. For the ADE7868/ ADE7878,  three \nspecially designed low power modes ensure the continuity of energy accumulation when the ADE7868/ ADE7878 is in a tam -\npering situation.  See Table 1 for a quick reference chart listing \neach part and its functions. The  ADE78xx  are available in the  \n40-lead LFCSP , Pb -free package.  \nTable 1. Part Comparison  \nPart No.  WATT  VAR  IRM S, \nVRMS,  \nand  \nVA di/dt  Fundamental \nWATT and VAR  Tamper \nDetect and \nLow Power Modes  \nADE7878  Yes Yes Yes Yes Yes Yes \nADE7868  Yes Yes Yes Yes No Yes \nADE7858  Yes Yes Yes Yes No No \nADE7854  Yes No Yes Yes No No \n \n Rev.  H Document Feedback  \nInformati on furnished by Analog Devices is believed to be accurate and reliable. However, no \nresponsibility is assumed by Analog Devices for its use, nor for any infringements of patents or other \nrights of third parties that may result from its use. Specifications subject to change without notice. No \nlicense is granted by implication or otherwise under any patent or patent rights of Analog Devices. \nTrademarks and registered trademarks are the property of their respective owners.    \n \nOne Technology Way, P.O. Box 9106,  Norwood, MA 02062- 9106, U.S.A.  \nTel: 781.329.4700  ©2010– 2014 Analog Devices, Inc. All rights reserved.  \nTechnical Support  www.analog.com   \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTABLE OF CONTENTS  \nFeatu res .............................................................................................. 1 \nApplications  ....................................................................................... 1 \nGeneral Description  ......................................................................... 1 \nRevision History  ............................................................................... 3 \nFunctional Block Diagrams  ............................................................. 5 \nSpecifications  ..................................................................................... 9 \nTiming Characteristic s .............................................................. 12 \nAbsolute Maximum Ratings  .......................................................... 15 \nThermal Resistance  .................................................................... 15 \nESD Cauti on ................................................................................ 15 \nPin Configuration and Function Descriptions  ........................... 16 \nTypical Performance Characteristics  ........................................... 18 \nTest Circuit  ...................................................................................... 21 \nTerminology  .................................................................................... 22 \nPower Management  ........................................................................ 23 \nPSM0 —Normal Power Mode (All Parts)  ................................ 23 \nPSM1 —Reduced Power Mode (ADE7868, ADE7878 Only)  23 \nPSM2 —Low Power Mode (ADE 7868, ADE7878 Only)  ....... 23 \nPSM3 —Sleep Mode (All Parts)  ................................................ 24 \nPower -Up Procedure  .................................................................. 26 \nHardware Reset  ........................................................................... 27 \nSoftware Reset Functionality  .................................................... 27 \nTheory of Operation  ...................................................................... 28 \nAnalog Inputs  .............................................................................. 28 \nAnalog -to-Digital Conversion  .................................................. 28 \nCurrent Channel ADC ............................................................... 29 \ndi/dt Current Sensor and Digital Integrator  .............................. 31 \nVoltage Channel ADC  ............................................................... 32 \nChanging Phase Voltage Datapa th ........................................... 33 Power Quality Measurements  ................................................... 34 \nPhase Compensation  ................................................................. 39 \nReference Circuit  ........................................................................ 41 \nDigital Signal Processor  ............................................................. 42 \nRoot Mean Square Measurement  ............................................. 43 \nActive Power Calculation  .......................................................... 47 \nReactive Power Calculation —ADE7858, ADE7868, ADE7878 \nOnly  .............................................................................................. 52 \nApparent Power Calculation  ..................................................... 57 \nWaveform Sampling Mode  ....................................................... 60 \nEnergy -to-Frequency Conversion ............................................ 60 \nNo Load Condition  .................................................................... 64 \nChecksum Register ..................................................................... 65 \nInterrupts  ..................................................................................... 66 \nSerial Int erfaces  .......................................................................... 68 \nQuick Setup as Energy Meter  ................................................... 75 \nLayout Guidelines ....................................................................... 75 \nCrystal Circuit  ............................................................................ 76 \nADE7878 Evaluation Board  ...................................................... 76 \nDie Version  .................................................................................. 76 \nSilicon Anomaly  ............................................................................. 77 \nADE7854/ADE7858/ADE7868/ADE7878 Functionality \nIssues  ............................................................................................ 77 \nFunctionality Issues  .................................................................... 77 \nSection 1. ADE7854/ADE7858/ADE7868/ADE7878 Functionality Issues  .................................................................... 79\n \nRegisters List  ................................................................................... 80 \nOutline Dim ensions  ....................................................................... 98 \nOrdering Guide  .......................................................................... 98 \n \n \nRev. H | Page  2 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nREVISION HISTORY  \n4/14— Rev. G to Rev. H  \nChanges to Power -Up Procedure Section  .................................... 26 \nChanges to Crystal Circuit Section  ............................................... 76 \n10/13— Rev. F to Rev. G  \nChanges to Product Title  and Features Section  ............................ 1 \nChanges to  Table 2  ............................................................................ 9 \nDeleted Junction Temperature; Table 6  ........................................ 15 \nChanges to NC and CLKIN Pin Descriptions  ............................. 16 \nReplaced Typical Performance Characteristics  Section  ............. 18 \nAdded Text  to Test Circuit Secti on ............................................... 21 \nChanges to  Terminology Section  .................................................. 22 \nChanges to PSM2 —Low Power Mode (ADE7868, ADE7878 \nOnly) Section  and Added Figure 25 ............................................. 24 \nChanges to Changing Phase Voltage Datapath Section and \nFigure 42 ........................................................................................... 33 \nChanges to  Reference Circuit Section ; Added Figure 56, \nFigure  57, and Figure 58; Renumbered Sequentially  .................. 41 \nChanges to Current RMS Compensation Section  ......................... 44 \nChanges to Current Mean Absolute Value Calculation —\nADE7868 and ADE7878 Only and Figure 60 .............................. 45 \nChanges to Voltage RMS Offset Compensation Section  ............... 47 \nChanges to  Line Cycl e Active Energy Accumulation Mode  \nSection  ............................................................................................... 51 \nChanges to Quick Setup as Energy Meter Section  and  \nFigure 95 ........................................................................................... 75 \nChanges to Figure 96 and Figure 97; Added Crystal Circuit \nSection  .............................................................................................. 76 \nChanges to Address 0xE520 Description; Table 33 .................... 84 \nChanges to Bit 11, Bit 12, Bit 13 Description s; Table 43 ............ 91 \nUpdated Outl ine Dimensions  ........................................................ 99 \n10/12— Rev. E to Rev. F  \nChanges to Figure 1  ........................................................................... 4 \nChanges to Figure 2  ........................................................................... 5 \nChanges to Figure 3  ........................................................................... 6 \nChanges to Figure 4  ........................................................................... 7 \nChanges to Table 2  ............................................................................ 8 \nChanges to Figure 5  ......................................................................... 11 \nAdded Text under Table 6  .............................................................. 14 \nChanges to Figure 9 and to Table 8  ............................................... 15 \nChanges to Power -Up Procedure Section  .................................... 24 \nChanges to Figure 31 and Figure 32  ............................................. 28 \nChanges to Figure 39  ...................................................................... 30 \nChanges to Voltage Waveform Gain Register Section  ................ 31 \nChanges to Figure 41  ...................................................................... 32 \nChanges to Phase Compensation Section  .................................... 37 \nChanges to Digital Signal Processor Section  ............................... 39 \nChang es to Equation 12  .................................................................. 40 \nChanges to Current RMS Offset Compensation Section  .......... 42 \nChanges to Voltage Channel RMS Calculation Section  ............. 43 \nChanges to Voltage RMS Offset Compensation Section and  \nto Figure 59  ...................................................................................... 44 Changes to Equation 20 and to Equation 21  ............................... 45 \nChanges to  Active Energy Calculation Section  ........................... 46 \nChanges to Figure 62 and to following text and to Equation 25  .... 47 \nChanges to Equation 32, Equation 34, and to Reactive  \nPower Gain Calibration Section  .................................................... 50 \nChanges to Reactive Energy Calculation Section  ....................... 51 \nChanges to Figu re 66  ...................................................................... 52 \nChanges to Energy Accumulation Modes Sections and to \nCaption for Figure 67  ...................................................................... 53 \nChanges to Equation 40  ................................................................. 54 \nChanges to Apparent Power Calculation Using VNOM Section ... 55 \nChanges to CF Outputs for Various Accumultation Modes  \nSection  .............................................................................................. 60 \nChanges to Sign of  Sum -of-Phase Powers in the CFx  \nDatapath Section and to Equation 47  ........................................... 61 \nChanges to Equation 48  ................................................................. 62 \nChanges to Checksum Register Section and to Table 23  ........... 63 \nChanges to Figure 81  ...................................................................... 66 \nChanges to Figure 82  ...................................................................... 67 \nChanges to SPI -Compatible Interface Section  ............................ 68 \nChanges  to HSDC Interface Section  ............................................ 70 \nChanges to Figure 88  ...................................................................... 71 \nChanges to Figure 89, added Quick Setup as Energy Meter Section, added Layout Guidelines, and added Figure 90; Renumbered Sequentially  .............................................................. 72 \nAdded Figure 91 and Figure 92  ..................................................... 73 \nChanges to Table 30  ........................................................................ 78 \nChanges to Table 33  ........................................................................ 79 \nChanges to Table 46  ........................................................................ 90 \n4/11— Rev. D to Rev. E  \nChanges to Input Clock FrequencyParameter, Table 2  .............. 10 \nChanges to Current RMS Offset Compensation Section  .......... 42 \nChanges to Voltage RMS Offset Compensation Section  ........... 44 \nChanges to Note 2, Table 30 ........................................................... 77 \nChanges to Address 0xE707, Table 33 .......................................... 80 \nChanges to Table 45  ........................................................................ 87 \nChanges to Table 46  ........................................................................ 88 \nChanges to Bit Location 7:3, Default Value, Table 54  ................ 92 \n2/11— Rev. C to Rev. D  \nChanges to Figure 1  .......................................................................... 4 \nChanges to Figure 2  .......................................................................... 5 \nChanges to Figure 3  .......................................................................... 6 \nChanges to Figure 4  .......................................................................... 7 \nChange s to Table 2  ............................................................................ 8 \nChanged SCLK Edge to HSCLK Edge, Table 5  ........................... 13 \nChange to Current Channel HPF Section  ................................... 28 \nChange to di /dt Current Sensor and Digital Integrator Section  .... 30 \nChanges to Digital Signal Processor Section  ............................... 39 \nChanges to Figure 59  ...................................................................... 44 \nChanges to Figure 62  ...................................................................... 47 \nChanges to Figure 65  ...................................................................... 49 \nChanges to Figure 66  ...................................................................... 52 \nRev. H | Page 3 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nChanges to Line Cycle Reactive Energy Accumulation Mode \nSection and to Figure 67  ................................................................ 53 \nNo Load Detection Based On Total Active, Reactive Powers Section  .............................................................................................. 61 \nChange to Equation 50  ................................................................... 63 \nChanges to the HSDC Interfa ce Section  ..................................... 70 \nChanges to Figure 87 and Figure 88  ............................................. 71  \nChanges to Figure 89  ...................................................................... 72 \nChanges to Table 30  ........................................................................ 77 \nChanges to Table 46  ........................................................................ 88 \n11/10— Rev. B to Rev. C  \nChange to Signal -to-Noise -and-Distortion Ratio, SINAD  \nParameter, Table 1  ............................................................................. 9 \nChanges to Figure 18  ...................................................................... 18 \nChanges to  Figure 22  ...................................................................... 19 \nChanges to Silicon Anomaly Section  ........................................... 72 \nAdded Table 28 to Silicon Anomaly Section  ............................... 73 \n8/10— Rev. A to Rev. B  \nChanges to Figure 1  .......................................................................... 4 \nChanges to Figure 2  .......................................................................... 5 \nChanges to Figure 3  .......................................................................... 6 \nChanges to Figure 4  .......................................................................... 7 \nChange to Table 8  ........................................................................... 16 \nChanges to Power -Up Procedure Section  ................................... 23 \nChanges to Equation 6 and Equation 7  ....................................... 33 \nChanges to Equation 17  ................................................................. 43 \nChanges to Active Power Offset Calibration Section  ................ 45 \nChanges to Figure 63  ...................................................................... 46 \nChanges to Reactive Power Offset Calibration Section  ............. 49 \nChanges to Figure 82  ...................................................................... 65 \nAdded Silicon Anomaly Section, Renumbered Tables \nSequentially  ..................................................................................... 71 3/10— Rev. 0 to Rev. A  \nAdded ADE7854, ADE7858, and ADE7878  ................... Universal  \nReorganized Layout  ............................................................ Universal  \nAdded Table 1, Renumbered Sequentially  ..................................... 1 \nAdded Figure 1, Renumbered Sequentially  ................................... 3 \nAdded Figure 2  ................................................................................... 4 \nAdded Figu re 3 ................................................................................... 5 \nChanges to Specifications Section  ................................................... 7 \nChanges to Figure 9 and changes  to Table 8  .............................. 14 \nChanges to Typical Performance Characteristics Section  ........ 16 \nChanges to Figure 22  ...................................................................... 18 \nChanges to the Power Management Section  .............................. 20 \nChanges to the Theory of Operation Sectio n ............................. 25 \nChanges to Figure 31 and Figure 32 ............................................. 27 \nChange to Equation 28  .................................................................. 47 \nChanges to Figure 83  ...................................................................... 66 \nChanges to Figure 86  ...................................................................... 68 \nChanges to the Registers List Section  .......................................... 72 \nChanges to Ordering Guide  .......................................................... 91 \n2/10— Revision 0: Initial Version  \n \nRev. H | Page  4 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nFUNCTIONAL BLOCK DIA GRAM S \nPGA1PGA1PGA1\nPGA3PGA3PGA31.2V\nREF\nDIGITAL SIGNAL\nPROCESSORAPHCA LHPFDIS\n[23:0]\nHPFHPFDIS\n[23:0]DIGITAL\nINTEGRATOR\nHPFPOR LDO LDOX2 AIRMS\nLPFAIRMSOS\nX2 AVRMS\nLPF\nLPFAVRMSOSAVAGAIN\nAWGAINDFCCF1DEN\n:\nDFCCF2DEN\n:\nDFCCF3DEN\n:5 24 26 25 17 4\n7\n8\n9\n2212\n13\n14\n19\n18\n3937383632293534333227\n28\n236\nSPI\nOR\nI2C/HSDCRESET REF IN/OUT VDD AGND AVDD DVDD DGND\nCLKIN\nCLKOUT\nIAP\nIAN\nVAP\nIBP\nIBN\nVBP\nICP\nICN\nVCP\nVNPM0\nPM1\nCF1\nCF2\nCF3/HSCLK\nIRQ0\nIRQ1\nSCLK/SC L\nMOSI/SD A\nMISO/HSD\nSS/HSAADE7854\nADC\nADC\nADC\nADC\nADC\nADC\n08510-204TOTAL ACTIVE/APPARENT\nENERGIES AND VOLTAGE/\nCURRENT RMS CALCULATION FOR\nPHASE C\n(SEE PHASE A FOR DETAILED\nDATA PATH)TOTAL ACTIVE/APPARENT\nENERGIES AND VOLTAGE/\nCURRENT RMS CALCULATION FOR\nPHASE B\n(SEE PHASE A FOR DETAILED\nDATA PATH)PHASE A,\nPHASE B,\nAND\nPHASE C\nDATAAWATTOS\nAVGAINAIGAIN\n \nFigure 1. ADE7854  Functional Block Diagram  \nRev. H | Page 5 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nPGA1PGA1PGA1\nPGA3PGA3PGA31.2V\nREF\nDIGITAL SIGNA L\nPROCESSORCOMPUTATIONAL\nBLOCK FOR\nTOTAL\nREACTIVE POWERAPHCA LPOR LDO LDOX2 AIRMS\nLPFAIRMSOS\nX2 AVRMS\nLPF\nLPFAVRMSOSAVAGAIN\nAVARGAIN AVAROSDFCCF1DEN\n:\nDFCCF2DEN\n:\nDFCCF3DEN\n:5 24 26 25 17 4\n7\n8\n9\n2212\n13\n14\n19\n18\n3937383632293534333227\n28\n236RESET REFIN/OUT VDD AGND AVDD DVDD DGND\nCLKIN\nCLKOUT\nIAP\nIAN\nVAP\nIBP\nIBN\nVBP\nICP\nICN\nVCP\nVNPM0\nPM1\nCF1\nCF2\nCF3/HSCLK\nIRQ0\nIRQ1\nSCLK/SC L\nMOSI/SD A\nMISO/HSD\nSS/HS AADE7858\nADC\nADC\nADC\nADC\nADC\nADC\n08510-203TOTAL ACTIVE/REACTIVE/\nAPPARENT ENERGIES AND\nVOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE B\n(SEE PHASE A FOR DETAILED\nDATA PATH)\nTOTAL ACTIVE/REACTIVE/\nAPPARENT ENERGIES AND\nVOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE C\n(SEE PHASE A FOR DETAILED\nDATA PATH)PHASE A,\nPHASE B,\nAND\nPHASE C\nDATAAWGAIN AWATTOS\nHPFHPFDIS\n[23:0]\nHPFDIS\n[23:0]DIGITAL\nINTEGRATOR\nHPF\nSPI\nOR\nI2C/HSDCAVGAINAIGAIN\n \nFigure 2. ADE7858  Functional Block Diagram  \n \nRev. H | Page  6 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nPGA1PGA1PGA1\nPGA3PGA3PGA31.2V\nREF\nTOTAL ACTIVE/REACTIVE/\nAPPARENT ENERGIES AND\nVOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE B\n(SEE PHASE A FOR DETAILED\nDATA PATH)\nTOTAL ACTIVE/REACTIVE/\nAPPARENT ENERGIES AND\nVOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE C\n(SEE PHASE A FOR DETAILED\nDATA PATH)\nDIGITAL SIGNAL\nPROCESSORCOMPUTATIONAL\nBLOCK FOR\nTOTAL\nREACTIVE POWERAPHCA LHPFDIS\n[23:0]\nHPF\nHPFDIS\n[23:0]\nHPFHPFDIS\n[23:0]DIGITAL\nINTEGRATOR\nHPF\nDIGITAL\nINTEGRATORPOR LDO LDOX2 AIRMS\nLPFAIRMSOS\nX2\nX2AVRMS\nLPF\nLPFAVRMSOSAVAGAIN\nLPFAWGAIN\nNIRMSNIRMSOSAWATTOS\nAVARGAIN AVAROSDFCCF1DEN\n:\nDFCCF2DEN\n:\nDFCCF3DEN\n:5 24 26 25 17 4\n7\n8\n9\n2212\n13\n14\n19\n18\n3937383632293534333227\n28\n236RESET REF IN/OUT VDD AGND AVDD DVDD DGND\nCLKIN\nCLKOUT\nIAP\nIAN\nVAP\nIBP\nIBN\nVBP\nICP\nICN\nVCP\nVNPM0\nPM1\nCF1\nCF2\nCF3/HSCLK\nIRQ0\nIRQ1\nSCLK/SCL\nMOSI/SDA\nMISO/HSD\nSS/HSAADE7868\nADC\nADC\nADC\nADC\nADC\nADC\nPGA215\n16INP\nINNADC\n08510-202PHASE A,\nPHASE B,\nAND\nPHASE C\nDATA\nSPI\nOR\nI2C/HSDC\nNIGAINAIGAIN\nAVGAIN\n \nFigure 3. ADE7868  Functional Block Diagram  \nRev. H | Page 7 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nPGA1PGA1PGA1\nPGA3PGA3PGA31.2V\nREF\nTOTAL/FUNDAMENTAL ACTIVE/\nREACTIVE ENERGIES, APPARENT\nENERGY AND VOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE B\n(SEE PHASE A FOR DETAILED\nDATA PATH)\nTOTAL/FUNDAMENTAL ACTIVE/\nREACTIVE ENERGIES, APPARENT\nENERGY AND VOLTAGE/CURRENT\nRMS CALCULATION FOR PHASE C\n(SEE PHASE A FOR DETAILED\nDATA PATH)\nDIGITAL SIGNA L\nPROCESSORCOMPUTATIONAL\nBLOCK FOR\nTOTAL\nREACTIVE POWERAPHCA LHPFDIS\n[23:0]\nHPF\nHPFDIS\n[23:0]\nHPFHPFDIS\n[23:0]DIGITAL\nINTEGR ATOR\nHPF\nDIGITAL\nINTEGR ATORPOR LDO LDOX2 AIRMS\nLPFAIRMSOS\nX2\nX2AVRMS\nLPF\nLPFAVRMSOSAVAGAIN\nLPFCOMPUTATIONAL\nBLOCK FOR\nFUNDAMENTAL\nACTIVE AND\nREACTIVE POWERAWGAIN\nNIRMSNIRMSOSAWATTOS\nAVARGAIN AVAROS\nAFWGAIN AFWATTOS\nAFVARGAIN AFVAROSPHASE A,\nPHASE B,\nAND\nPHASE C\nDATADFCCF1DEN\n:\nDFCCF2DEN\n:\nDFCCF3DEN\n:5 24 26 25 17 4\n7\n8\n9\n2212\n13\n14\n19\n18\n3937383632293534333227\n28\n236RESET REFIN/OUT VDD AGND AVDD DVDD DGND\nCLKIN\nCLKOUT\nIAP\nIAN\nVAP\nIBP\nIBN\nVBP\nICP\nICN\nVCP\nVNPM0\nPM1\nCF1\nCF2\nCF3/HSCLK\nIRQ0\nIRQ1\nSCLK/SC L\nMOSI/SD A\nMISO/HSD\nSS/HSAADE7878\nADC\nADC\nADC\nADC\nADC\nADC\nPGA215\n16INP\nINNADC\n08510-201SPI\nOR\nI2C/HSDCAVGAIN\nNIGAINAIGAIN\n \nFigure 4. ADE7878  Functional Block Diagram  \n \nRev. H | Page  8 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nSPECIFICATIONS \nVDD = 3.3 V ± 10%, AGND = DGND = 0 V , on -chip reference, CLKIN = 16.384 MHz, T MIN to T MAX = −40°C to +85°C , T TYP= 25°C .  \nTable 2.  \nParameter1, 2 Min  Typ  Max  Unit  Test Conditions/Comments  \nACCURACY       \nActive  Energy  Measurement       \nActive  Energy  Measurement Error \n(per Phase)       \nTotal  Active Energy   0.1  % Over  a dynamic range of 1000 to 1, PGA = 1, 2, 4; \nintegrator off  \n  0.2  %  Over a dynamic range of 3000 to 1, PGA = 1, 2, 4; \nintegrator off  \n  0.1  % Over a dynamic range of 500 to 1, PGA = 8, 16; \nintegrator on  \nFundamental  Active Energy  \n(ADE7878 Only)   0.1  % Over a dynamic range of 1000 to 1, PGA = 1, 2, 4; integrator off  \n  0.2  % Over a dynamic range of 3000 to 1, PGA = 1, 2, 4; \nintegr ator off  \n  0.1  % Over a dynamic range of 500 to 1, PGA = 8, 16; \nintegrator on  \nAC Power Supply Rejection      VDD = 3.3 V + 120 mV rms/120 Hz/100 Hz, IPx = VPx = ±100 mV rms \nOutput Frequency Variation   0.01   %  \nDC Power Supply Rejection      VDD = 3.3 V ± 330 mV dc ; IPx = VPx =  \n±100 mV rms  \nOutput Frequency Variation   0.01  %   \nTotal Active Energy Measurement \nBandwidth  2  kHz   \nREACTIVE ENER GY MEASUREMENT  \n(ADE7858, ADE7868, AND ADE7878 )      \nReactive Energy Measurement Error \n(per Phase)       \nTotal  Reactive Energy   0.1  % Over a dynamic range of 1000 to 1, PGA = 1, 2, 4; \nintegrator off  \n  0.2  % Over a dynamic range of 3000 to 1, PGA = 1, 2, 4; \nintegrator off  \n  0.1  % Over a dynami c range of 500 to 1, PGA = 8, 16; \nintegrator on  \nFundamental  Reactive Energy  \n(ADE7878 Only)   0.1  % Over a dynamic range of 1000 to 1 , PGA = 1, 2, 4; \nintegrator off  \n  0.2  % Over a dynamic range of 3000 to 1, PGA = 1, 2, 4; \nintegrator off  \n  0.1  % Over a dynamic range of 500 to 1, PGA = 8, 16; integrator on  \nAC Power Supply Rejection      VDD = 3.3 V + 120 mV rms/120 Hz/100 Hz, IPx = \nVPx = ±100 mV rms Output Frequency Variation   0.01  % \nDC Power Supply Rejection      VDD = 3.3 V ± 330 mV dc ; IPx = VPx =  \n±100 mV rms  \nOutput Frequency Variation   0.01  %   \nTotal Reactive Energy Measurement \nBandwidth  2  kHz   \nRMS MEASUREMENTS       \nI rms and V rms Measurement \nBandwidth  2  kHz  \nI rms and V rms Measurement Error \n(PSM0 Mode)   0.1  %  Over a dynamic range of 1000 to 1, PGA = 1  \nRev. H | Page 9 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nParameter1, 2 Min  Typ  Max  Unit  Test Conditions/Comments  \nMEAN ABSOLUTE VALUE (MAV) \nMEASUREMENT ( ADE7868 AND \nADE7878)       \nI mav Measurement Bandwidth (PSM1 \nMode)   260  Hz  \nI mav Measurement Error (PSM1 Mode)   0.5  % Over a dynamic range of 100 to 1, PGA = 1, 2, 4, 8  \nANALOG INPUTS       \nMaximum Signal Levels    ±500  mV peak  PGA  = 1, differential inputs between the \nfollowing pins: IAP and IAN, IBP and IBN, ICP \nand ICN; single -ended inputs between the \nfollowing pins: VAP and VN, VBP and VN, VCP , \nand VN  \nInput Impedance (DC)       \nIAP , IAN, IBP , IBN, ICP , ICN, VAP , VBP , \nand VCP Pins  400   kΩ  \nVN Pin  130   kΩ  \nADC Offset   −24  mV  PGA = 1, uncalibrated error, see the Terminology  \nsection  \nGain Error   ±4  %  External 1.2 V reference  \nWAVEFORM SAMPLING      Sampling CLKIN/2048, 16.384 MHz/2048 = 8 kSPS  \nCurrent and Voltage Channels      See the Wave form Sampling Mode  section  \nSignal -to-Noise Ratio, SNR   74  dB  PGA = 1 , fundamental frequency: 45 Hz to \n65 Hz, s ee the Terminology  section  \nSignal -to-Noise -and -Distortion Ratio, \nSINAD   74  dB PGA = 1 ; fundamental  frequency: 45 Hz to \n65 Hz, s ee the Terminology  section   \nBandwidth (−3 dB)   2  kHz  \nTIME INTERVAL BETWEEN PHASES       \nMeasurement Error   0.3  Degrees  Line frequency = 45 Hz to 65 Hz, HPF on  \nCF1, CF2, CF3 PULSE OUTPUTS       \nMaximum Output Frequency  8  kHz WTHR = VARTHR = VATHR = PMAX = 33,516,139  \nDuty Cycle   50  % If CF1, CF2, or CF3 frequency > 6.25 Hz and \nCFDEN is even and > 1  \n  (1 + 1/CFDEN) \n× 50%    If CF1, CF2, or CF3 frequency > 6.25 Hz and \nCFDEN is odd  and > 1  \nActive Low Pulse Width   80  ms If CF1, CF2, or CF3 frequency < 6.25 Hz  \nJitter   0.04  % For CF1, CF2, or CF3 frequency = 1 Hz and \nnominal phase currents are larger than 10% of \nfull scale  \nREFERENCE INPUT       \nREF IN/OUT  Input Voltage Range  1.1  1.3 V Minimum = 1.2 V −  8%; maximum = 1.2 V +  8%  \nInput Capacitance    10 pF   \nON-CHIP REFERENCE      Nominal 1.2  V at the REF IN/OUT  pin at T A = 25°C  \nPSM0 and PSM1 Modes       \nTemperature Coefficient  −50 ±5 +50  ppm/°C  Drift across the entire temperature range of − 40°C \nto +85 °C is calculated with reference to 25 °C; \nsee the Reference Circuit  section for more details  \nCLKIN      All specifications CLKIN of 16.384 MHz . See the \nCrystal Circuit  section for more details.  \nInput Clock Frequency  16.22 16.384 16.55 MHz   \nLOGIC INPUTS —MOSI/SDA, SCLK/SCL, SS, \nRESET , PM0, AND PM1       \nInput High Voltage, V INH 2.0    V  VDD = 3.3 V ± 10%  \nInput Lo w Voltage, V INL   0.8 V  VDD = 3.3 V ± 10%  \nInput Current, I IN   −8.7 µA  Input = 0 V, VDD = 3.3 V  \n   3 μA  Input = VDD = 3.3 V  \nInput Capacitance, C IN  10  pF   \nRev. H | Page  10 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nParameter1, 2 Min  Typ  Max  Unit  Test Conditions/Comments  \nLOGIC OUTPUTS— IRQ0 , IRQ1 , MISO/HSD      VDD = 3.3 V ± 10%  \nOutput High Voltage, V OH  2.4   V  VDD = 3.3 V ± 10%  \nISOURCE    800 µA  \nOutput Low Voltage, V OL    0.4 V  VDD = 3.3 V ± 10%  \nISINK   2 mA  \nCF1, CF2, CF3/HSCLK       \nOutput High Voltage, V OH  2.4    V  VDD = 3.3 V ± 10%  \nISOURCE    500 µA  \nOutput Low Voltage, V OL    0.4 V  VDD = 3.3 V ± 10%  \nISINK   2 mA  \nPOWER S UPPLY      For specified performance  \nPSM0 Mode       \nVDD Pin  2.97   3.63  V  Minimum = 3.3 V −  10%; maximum = 3.3 V + 10%  \nIDD   24.4 27.2 mA   \nPSM1 and PSM2 Modes (ADE7868  and \nADE7878)       \nVDD Pin  2.4  3.7 V  \nIDD      \nPSM1 Mode   6.0  mA  \nPSM2 Mode   0.2  mA  \nPSM3 Mode       \nVDD Pin  2.4  3.7 V  \nIDD in PSM3 Mode   1.7  μA   \n1 See the Typical Performance Characteristics  section.  \n2 See the Terminology  section  for a definition of the parameters . \n \n \nRev. H | Page 11 of 100  \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTIMING CHARACTERISTI CS \nVDD = 3.3 V ± 10%, AGND = DGND = 0 V , on -chip reference, CLKIN = 16.384 MHz , T MIN to T MAX = −40°C to +85°C. Note that dual \nfunction pin names are referenced by the relevant function only within the timing tables and diagrams; see the Pin Configuration and \nFunction Descriptions  section for full pin mnemonics and descriptions.  \nTable 3. I2C-Compatible Interface Timing Parameter  \n  Standard M ode  Fast Mode   \nParameter  Symbol  Min  Max  Min  Max  Unit  \nSCL Clock Fre quency  fSCL 0 100 0 400 kHz \nHold Time (Repea ted) Start  Condition tHD;STA  4.0  0.6  μs \nLow P eriod of SCL Clock  tLOW 4.7  1.3  µs \nHigh Period of SCL Clock  tHIGH 4.0  0.6  µs \nSet-Up Ti me for Rep eated S tart Condition  tSU;STA  4.7  0.6  µs \nData Hold Ti me tHD;DAT  0 3.45 0 0.9 µs \nData Setup Time  tSU;DAT  250  100  ns \nRise Time of Both SDA and SCL S ignals  tR  1000 20 300 ns \nFall Time of B oth SDA and SCL S ignals  tF  300 20 300 ns \nSetup Time for S top Condition  tSU;STO  4.0  0.6  µs \nBus Free Time Between a Stop  and S tart Condition  tBUF 4.7  1.3  µs \nPulse Width of Suppressed Sp ikes  tSP N/A1   50 ns \n1 N/A means not applicable.  \n \ntF\ntR\ntHD;DATtHD;STA\ntHIGHtSU;STAtSU;DAT\ntFtHD;STA tSP\ntSU;STOtRtBUF\ntLOWSDA\nSCLK\nSTART\nCONDITIONREPE ATED ST ART\nCONDITIONSTOP\nCONDITIONSTART\nCONDITION\n08510-002 \nFigure 5. I2C-Compatible Interface Timing  \nRev. H | Page  12 of 100  \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 4. SPI Interface Timing  Parameter s \nParameter  Symbol  Min  Max  Unit  \nSS to SCLK E dge  tSS  50  ns \nSCLK Period   0.4 40001 μs \nSCLK Low Pulse Widt h tSL 175  ns \nSCLK High Pulse Width  tSH 175  ns \nData Output Valid Afte r SCLK E dge  tDAV  100 ns \nData Input Setup Time Befo re SCLK E dge  tDSU 100  ns \nData  Input Hold Time After  SCLK Edge  tDHD 5  ns \nData Output Fall Tim e tDF  20 ns \nData Output Rise Time tDR  20 ns \nSCLK Rise Time  tSR  20 ns \nSCLK  Fall Time  tSF  20 ns \nMISO Disable After  SS Rising Edge  tDIS  200 ns \nSS High Aft er SCLK E dge  tSFS 0  ns \n1 Guaranteed by design. \n \nMSB LSB\nLSB ININTERMEDI ATE BITS\nINTERMEDI ATE BITStSFS\ntDIStSS\ntSL\ntDFtSH\ntDHDtDAV\ntDSUtSR tSF\ntDR\nMSB IN MOSIMISOSCLKSS\n08510-003 \nFigure 6. SPI Inte rface Timing  \nRev. H | Page 13 of 100  \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTable 5. HSDC I nterface  Timing  Parameter  \nParameter  Symbol  Min  Max  Unit  \nHSA to H SCLK Edge  tSS  0  ns \nHSCLK Period   125  ns \nHSCLK Low Pulse W idth  tSL 50  ns \nHSCLK High Pulse Widt h tSH 50  ns \nData Output Valid Aft er HSCLK Edge  tDAV  40 ns \nData Output Fall Tim e tDF  20 ns \nData  Output Rise Ti me tDR  20 ns \nHSCLK Rise Tim e tSR  10 ns \nHSCLK Fall Tim e tSF  10 ns \nHSD Disable Af ter H SA Rising Edg e tDIS 5  ns \nHSA High Afte r HSCLK Edge  tSFS 0  ns \nMSB LSB INTERMEDI ATE BITStSFS\ntDIStSS\ntSL\ntDFtSHtDAVtSR tSF\ntDRHSDHSCLKHSA\n08510-004 \nFigure 7. HSDC Interface Timing  \n2mA IOL\n800µ A IOH1.6VTO OUTPUT\nPINCL\n50pF\n08510-005 \nFigure 8. Load Circuit for Timing Specifications  \n \n \nRev. H | Page  14 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nABSOLUTE MAXIMUM RAT INGS  \nTA = 25°C, unless otherwise noted.  \nTable 6.  \nParameter  Rating  \nVDD to AGND  −0.3 V to +3.7 V  \nVDD to DGND  −0.3 V to +3.7 V  \nAnalog Input Voltage to AGND,  I A P,  \nIAN, IBP , IBN, ICP , ICN, VAP , VBP , VCP , \nVN −2 V to +2 V  \nAnalog Input Voltage to INP and INN  −2 V to +2 V  \nReference Input Voltage to AGND  −0.3 V to VDD + 0.3 V  \nDigital Input Voltage to DGND  −0.3 V to VDD + 0.3 V  \nDigital Output Voltage to DGND  −0.3 V to VDD + 0.3 V  \nOperating Temperature   \nIndustrial Range  −40°C to +85°C  \nStorage Temperature Range  −65°C to +150°C \nLead Temperature (Soldering, 10 sec)  300°C  \nNote that, r egarding the temperature profile used in soldering \nRoHS compliant parts,  Analog Devices advises that reflow \nprofiles should conform to J -STD 20 from JEDEC. Refer to \nwww.jedec.org for the latest revision.  \nStresses above those listed under Absolute Maximum Ratings \nmay cause permanent damage to the device. This is a stress \nrating only; functional operation of the device at these or any \nother conditions above those listed in the operational sections \nof this specification is not implied. Exposure to absolute \nmaximum rating conditions for extended periods may affect \ndevice reliability.  THERMAL RESISTANCE  \nθJA is specified equal to 29.3°C/W ; θJC is specified equal to \n1.8°C/W .  \nTable 7. Thermal Resistance  \nPackage Type  θJA θJC Unit  \n40-Lead L FCSP  29.3 1.8 °C/W  \n \nESD CAUTION  \n \n \n \n \n \nRev. H | Page 15 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nPIN CONFIGURATION AN D FUNCTION DESCRIPTI ONS \nNOTES\n1. NC = NO CONNECT.\n2. CREATE A SIMILAR PAD ON THE PCB UNDER THE\n    EXPOSED PAD. SOLDER THE EXPOSED PAD TO\n    THE PAD ON THE PCB TO CONFER MECHANICAL\n    STRENGTH TO THE PACKAGE. CONNECT THE\n    PADS TO AGND AND DGND.\n11NC\n12IBN\n13IC\nP\n15IN\nP\n17REF\nIN/OUT\n16INN\n18VN\n19VCP\n20NC\n14ICNNC\nPM0\nPM1\nRESET\nDVDD\nDGND\nIAP\nIAN\nIBP\nNCVAPAVDDAGNDVDDCLKINCLKOUTIRQ0NC\nVBP\nNC\n33\nCF134\nCF235\nCF3/HSCLK36\nSCLK/SC\nL37\nMISO/HSD38\nMOSI/SD\nA39\nSS/HS\nA40\nNC32\nIRQ131\nNC\n08510-1061\n2\n3\n4\n5\n6\n7\n8\n9\n102324252627282930\n22\n21ADE78xx\nTOP VIEW\n(Not to Scale)\n \nFigure 9. Pin Configuration  \nTable 8. Pin Function Descriptions \nPin No.  Mnemonic  Description  \n1, 10, 11, 20, \n21, 30, 31, 40 NC No Connect. These pins are not connected internally.  It is recommended to ground these pins .  \n2 PM0  Power Mode P in 0. This pin, combined with PM1, defines the power mode of the \nADE7854/ ADE7858 /ADE7868/ ADE7878, as described in Table 9. \n3 PM1  Power Mode P in 1. This pin defines the power mode of the  ADE7854 /ADE7858/ ADE7868/ ADE7878  \nwhen combined with PM0, as described in Table 9. \n4 RESET  Reset Input,  Active Lo w. In PSM0  mode , this pin should stay low for at least 10  µs to trigger a \nhardware reset .  \n5 DVDD  2.5 V output of the digital low dropout regulator ( LDO ). Decouple t his pin with a 4.7 µF capacitor in \nparallel with a ceramic 220 nF capacitor.  Do not connect external active circuitry to this pin.  \n6 DGND  Ground Reference. This pin provides the ground reference for the digital circuitry .  \n7, 8 IAP , IAN  Analog Inputs for Current Channel  A. This channel is used with the current transducers and is \nreferenced in this document as Current Channel A . These inputs are fully differential voltage inputs \nwith a  maximum differential level of ±0.5 V. This channel also has an internal PGA  equal to the ones \non Channel B and Channel C.   \n9, 12 IBP , IBN  Analog Input s for Current Channel B. This channel is used with the current transducers and is \nreferenced in this document as Current Channel B. These inputs are fully differential voltage inputs \nwith a  maximum differential level of ±0.5 V. This channel also has  an int ernal PGA  equal to the one s \non Channel C and Channel A.  \n13, 14 ICP , ICN  Analog Inputs for Current Channel C. This channel is used with the current transducers and is \nreferenced in this document as Current Channel C. These inputs are fully differential vol tage inputs \nwith a  maximum differential level of ±0.5 V. This channel also has  an internal PGA  equal to the ones \non Channel A and Channel B.  \n15, 16 INP , INN  Analog Inputs for Neutral Current Channel N. This channel is used with the current transducers and  \nis referenced in this document as Current Channel N. These inputs are fully differential voltage \ninputs with a maximum differential level of ±0.5 V. This channel also has an internal PGA, different \nfrom the ones found on the A, B, and C channels.  The neut ral current channel is available in the \nADE7878 and ADE7868. In the ADE7858 and ADE7854, connect these pins  to AGND.  \n17 REF IN/OUT   This pin provides access to the on- chip voltage reference. The on -chip reference has a nominal \nvalue of 1.2  V. An external reference source  with  1.2 V ± 8%  can also be connected at this pin. In \neither case, decouple this pin to AGND with a 4.7  µF capacitor in parallel with a ceramic 100  nF \ncapacitor. After reset, the on -chip reference is  enabled.  \nRev. H | Page  16 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nPin No.  Mnemonic  Description  \n18, 19,  22, 23  VN, VCP , VBP , VAP   Analog Inputs for the Voltage Channel. This channel is used with the voltage transducer and is \nreferenced as the voltage channel in this document. These inputs are single -ended voltage inputs \nwith a maximum signal level of ±0.5 V with respect to VN for specified operation . This ch annel also \nhas an internal PGA.   \n24 AVDD  2.5 V output of the analog  low dropout regulator ( LDO ). Decouple t his pin with a 4.7  µF capacitor in \nparallel with a ceramic 220 nF capacitor.  Do not connect external active circuitry to this pin.  \n25 AGN D  Ground Reference. This pin provides the ground reference for the analog circuitry . Tie t his pin to the \nanalog ground plane or to the quietest ground reference in the system. Use t his quiet ground \nreference for all analog circuitry, for example, antialia sing filters, cur rent, and voltage transducers.   \n26 VDD  Supply  Voltage. This pin prov ides the supply voltage. In PSM0 (normal power mode) , maintain  the \nsupply voltage at 3.3 V ± 10% for specified operation. In PSM1 (reduced power mode), PSM2 (low \npower m ode) , and PSM3 (sleep mode), when the ADE7868/ ADE7878 is supplied from a battery, \nmaintain the supply voltage between 2.4  V and 3.7  V. Decouple t his pin to A GND with a 10 µF \ncapacitor in parallel with a ceramic 100  nF capacitor. The only modes available on the ADE7858 and \nADE78 54 are the PSM0 and PSM3 power modes.  \n27 CLKIN  Master Clock. An external clock can be provided at this logic input. Alternatively, a crystal can be \nconnected across CLKIN and CLKOUT to provide a clock source for the ADE7854 /ADE7858/  \nADE7868/ ADE7878 . The clock frequency for  specified operation is 16.384 MHz. See the Crystal \nCircuit  section for details on choosing a suitable crystal.  \n28 CLKOUT  A crystal can be connected across this pin and CLKIN ( as previously described  with Pin 27 i n this \ntable)  to provide a clock source for the  ADE7854 /ADE7858/ ADE7868/ ADE7878.  \n29, 32 IRQ0 , IRQ1   Interrupt Request Outputs. These are active low logic outputs. See the  Interrupts  section for a \ndetailed presentation of the events that can trigger interrupts.  \n33, 34, 35 CF1, CF2, \nCF3/HSCLK  Calibration Frequency (CF) Logic Outputs. These outputs p rovide power information based on the \nCF1SEL [2:0] , CF2SEL [2:0] , and CF3SEL [2:0]  bits in the CFMODE reg ister. These out puts are used for \noperational and calibration purposes. The full -scale output frequency can be scaled by writing to the \nCF1DEN, CF2DEN, and CF3DEN registers , respectively  (see the Energy -to-Frequency  Conversion \nsection).  CF3 is multiplexed with the serial clock output of the HSDC port.  \n36 SCLK/SCL  Serial Clock Input for SPI Port/ Serial Clock Input for I2C Port. All serial data transfers are synchronized \nto this clock (see the Serial Interfaces  section). This pin has a Schmidt  trigger input for use with a \nclock source that has a slow edge transition time, for example, opto -isolator outputs.  \n37 MISO/HSD  Data  Out for SPI Port/ Data Out for HSDC  Port. \n38 MOSI/SD A Data In for SPI Port/ Data Out for I2C Port. \n39 SS/HSA  Slave Select for SPI Port /HSDC Port Activ e. \nEP Exposed Pad  Create a similar pad on the PCB under the exposed pad. Solder the exposed pad to the pad on the PCB to confer mechanical strength to the package. C onnect the pads to AGND  and DGND . \n \nRev. H | Page 17 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTYPICAL PERFORMANCE CHARACTERISTICS  \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)–40°C+25°C+85°C VDD = 3.3V\n08510-601 \nFigure 10. Total Active Energy Error As Percentage of Reading (Gain = +1, \nPower Factor = 1) over Temperature with Internal Refer ence and Integrator Off  \n0.15\n–0.15–0.10–0.0500.050.10\n65 60 55 50 45ERROR (%)\nLINE FREQUENCY (Hz)PF = +1.0PF = –0.5PF = +0.5\n08510-602 \nFigure 11. Total Active Energy Error As Percentage of Reading (Gain = +1) \nover Frequency with Internal Reference and Integrator Off  \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)2.97V3.30V3.63V\n08510-603TA = 25°C\n \nFigure 12. Total Active Energy Error As Percentage of Reading (Gain = +1,  \nPower Factor = 1) over Power Supply with Internal Reference and Integrator Off  1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-604–40°C+25°C+85°C VDD = 3.3V\n \nFigure 13. Total Active Energy Error As Percentage of Reading (Gain = +16, \nPower Factor = 1) over  Temperature with Internal Reference and Integrator On  \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-605–40°C+25°C+85°C VDD = 3.3V\n \nFigure 14. Total Reactive Energy Error As Percentage of Reading (Gain = +1, \nPower Factor = 0) over Temperature with Internal Reference and Integrator Off  \n0.15\n–0.15–0.10–0.0500.050.10\n65 60 55 50 45ERROR (%)\nLINE FREQUENCY (Hz)PF = 0PF = –0.866PF = +0.866\n08510-606 \nFigure 15. Total Reactive Energy Error As Percentage of Reading (Gain = +1) \nover Frequency with Internal Reference and Integrator Off  \nRev. H | Page  18 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)2.97V3.30V3.63V\n08510-607TA = 25°C\n \nFigure 16. Total Reactive Energy Error As Percentage of Reading (Gain = +1, \nPower Factor = 0)  over P ower Supply with Internal Reference and Integrator Off  \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-608–40°C+25°C+85°C VDD = 3.3V\n \nFigure 17. Total Reactive Energy Error As Percentage of Reading (Gain = +16, \nPower Factor = 0) over Temperature with Internal Reference and Integrator On  \n0.15\n–0.15–0.10–0.0500.050.10\n65 60 55 50 45ERROR (%)\nLINE FREQUENCY (Hz)PF = +1.0PF = –0.5PF = +0.5\n08510-609 \nFigure 18. Fundamental Active Energy Error As Percentage of Reading  \n(Gain = +1) over Frequency with Internal Reference and Integrator Off  1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-610–40°C+25°C+85°C VDD = 3.3V\n \nFigure 19. Fundamental Active Energy Error As Percentage of Reading  \n(Gain = +16) over Temperature with Internal Reference and Integrator On  \n0.15\n–0.15–0.10–0.0500.050.10\n65 60 55 50 45ERROR (%)\nLINE FREQUENCY (Hz)PF = 0PF = –0.866PF = +0.866\n08510-6 11\n \nFigure 20. Fundamental Reactive Energy Error As Percentage of Reading \n(Gain = +1) over Frequency with Internal Reference and Integrator Off  \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-612–40°C+25°C+85°C VDD = 3.3V\n \nFigure 21. Fundamental Reactive Energy Error As Percentage of Reading \n(Gain = +16) over Temperature with Internal Reference and Integrator On  \nRev. H | Page 19 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \n1.5\n–1.5–1.2–0.9–0.6–0.300.30.60.91.2\n0.01 100 10 1 0.1ERROR (%)\nPERCENTAGE OF FULL-SCALE CURRENT (%)\n08510-613–40°C+25°C+85°C VDD = 3.3V\n \nFigure 22. IRMS Error a s Percentage of Reading (Gain = +1, Power Factor = 1) \nover Temperature with Internal Reference and Integrator Off   \n \n \nRev. H | Page  20 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTEST CIRCUIT  \nNote that in Figure 23, the PM1 and PM0 pins are pulled up internally to 3.3  V . Select the mode of operation by using a microcontroller  to \nprogrammatically change the pin values.  \n \n08510-099SAME AS\nCF2PM00.22µF 4.7µF\nMOSI/SDA\nMISO/HSD\nSCLK/SCL\nCF3/HSCLK\nCF2\nCF1\nREF IN/OUTPM1\nRESET\nIAP\nIAN\nIBP\nIBN\nICP\nICN\nVN\nVCP\nVBP\nVAP2\n233\n4\n7\n8\n9\n12\n13\n14\n18\n19\n2239\n38\n37\n36\n35\n34\n33\n32\n29\n17\nCLKOUT 28\nCLKIN 27ADE78xx24 26 5AVDD\nVDD\nDVDD\n6 25DGND\nAGND0.22µF 4.7µF\n0.1µF 4.7µF++ +\n3.3V\nSAME AS\nVCP\nSAME AS\nVCPSAME AS\nIAP, IANSAME AS\nIAP, IAN\n22nF 1kΩ1kΩ1kΩ10kΩ\n10kΩ\n1.5kΩ\n1kΩ 22nF3.3V\n1µF\n22nF22nFSS/HSA\nIRQ1\nIRQ00.1µF 10µF+3.3V\nCL2\nCL116.384 MHz 5MΩ\n \nFigure 23. Test Circuit  \n \n \nRev. H | Page 21 of 100 \n \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTERMINOLOGY  \nMeasurement Error  \nThe error associated with the energy measurement made by the \nADE7854/ ADE7858/ ADE7868 /ADE7878 is defined by  \nMeasurement Error  = \n%10078×−\nEnergy TrueEnergy True xx ADEby Registered Energy (1) \nPower Supply Rejection (PSR)  \nThis quantifies the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nmeasurement error as a percentage of reading when the power \nsupplies are varied. For the ac PSR measurement, a reading  at \nnominal supplies (3.3 V) is taken. A second reading is obtained with the same input signal leve ls when an ac signal ( 120 mV rms \nat twice the fundamental frequency ) is introduced onto the \nsupplies. Any error introduced by this ac signal is expressed as a \npercentage of reading —see the Measurement Error definition.  \nFor the dc PSR measurement, a reading at nominal supplies (3.3 V) is taken. A second reading is obtained with the same \ninput signal levels when the power supplies are varied ±10%. Any error introduced is expressed as a percentage of the reading.  \nADC Offset Error  \nThis refers to the dc offset associated with the analog inputs to the ADCs. It means that with the analog inputs connected to \nAGND, the ADCs still see a dc analog input signal. The magni -\ntude of the offset depends on the gain and input range selection \nHowever, the HPF removes the offset from the current and voltage \nchannels  and the power calculation remains unaffected by this \noffset.  Gain Error  \nThe gain error in the ADCs of the ADE7854/ ADE7858/ \nADE7868/ ADE7878 is defined as the difference between the \nmeasured ADC output code (minus the offset) and the ideal \noutput code (see the Current Channel  ADC  section and the \nVoltage Channe l ADC  section). The difference is expressed as a \npercentage of the ideal code.  \nCF Jitter  \nThe period of pulses at one of the CF1, CF2 , or CF3 pins is \ncontinuously measured. The maximum, minimum, and average \nvalues of four consecutive pulses are computed  as follows: \nMaximum  = max (Period\n0, Period 1, Period 2, Period 3) \nMinimum  = min(Period 0, Period 1, Period 2, Period 3) \nAverage  = 43 2 1 0 Period Period Period Period +++ \nThe CF jitter is then computed as  \n%100×−=AverageMinimum MaximumCFJITTER  (2) \nSignal-to-Noise Ratio (SNR)  \nSNR is the ratio of t he rms value of the actual input signal to  \nthe rms sum of all other spectral components below 2 kHz, \nexcluding harmonics and dc. The input signal contains only  \nthe fundamental component. The spectral components are \ncalculated over a 2 sec window. The val ue for SNR is expressed \nin decibels.  \nSignal-to-(Noise and Distortion) Ratio (SINAD) \nSINAD is the ratio of the rms value of the actual input signal  to the rms sum of all other spectral components below 2 kHz,  \nincluding harmonics but excluding dc. The input  signal  \ncontains only the fundamental component. The spectral  \ncomponents are calculated over a 2 sec window. The value  \nfor SINAD is expressed in decibels.  \n \n \n \nRev. H | Page  22 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \nPOWER MANAGEMENT  \nThe ADE7868/ ADE7878 ha ve four modes of operation, deter -\nmined by the state of the PM0 an d PM1 pins (see Table 9). The \nADE7854/ ADE7858 have two modes of operation. These pins \nprovide complete control of the ADE7854/ ADE7858/ ADE7868 / \nADE7878 operation and c an easily be connected to an external \nmicroprocessor  I/O. The PM 0 and PM1  pins have internal pull -\nup resistor s. See Table 11 and Table 12 for a list of actions that are \nrecommended  before and after setting a new power mode .  \nTable 9. Power Supply Modes  \nPower Supply Modes  PM1  PM0  \nPSM0, Normal Power Mode  0 1 \nPSM1, Reduced Power Mode1 0 0 \nPSM2, Low Power Mode1 1 0 \nPSM3, Sleep Mode 1 1 \n1 Available in the ADE7868 and ADE7878. \nPSM0 —NORMAL POWER MODE  (ALL PARTS) \nIn PSM0 mode, the ADE7854/ADE7858/ ADE7868/ ADE7878 \nare fully functional. T he PM0 pin is set to high and the PM1 pin \nis set to low for the ADE78xx  to enter this mode. If the ADE78xx  \nis in one of PSM1, PSM2, or PSM3 modes and is  switched into \nPSM0 mode, then all control registers take the default values with \nthe exception of the threshold register , LPOILVL, which is used \nin PSM2 mode , and the CONFIG2 register, both of which \nmaintain their value s.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 signal  the end of \nthe transition  period by triggering  the IRQ1  interrupt pin low and \nsetting Bit 15 (RSTDONE) in the STATUS1 register  to 1. This bit is \n0 during the transition period and becomes 1 when the transition is \nfinished . The status bit is cleared and  the IRQ1  pin is set back to \nhigh by writing to the STATUS1 register with the corresponding \nbit set to 1. Bit 15 (RSTDONE) in the interrupt mask register \ndoes not have any functionality attached even if the IRQ1  pin goes \nlow when B it 15 (RSTDONE) in the STATUS1 register is set to 1. \nThis makes the RSTDONE interrupt unmaskable.  \nPSM1 —REDUCED POWER MODE ( ADE7868, \nADE7878 ONLY)  \nThe reduced power mode, PSM1, is available on the ADE7868 \nand ADE7878 only. In this mode, the ADE7868 /ADE7878 \nmeasure  the mean absolute values ( mav) of the 3 -phase currents \nand store  the results in the AIMAV , BIMAV , and CIMAV 20- bit \nregisters. This mode is useful in missing neutral cases in which \nthe voltage supply of the ADE7868 or ADE7878 is provided by an \nexternal battery. The serial ports, I2C or SPI, are enabled in this \nmode ; the active port can be used to read the AIMAV , BIMAV , \nand CIM AV r egisters. It is not recommended to read any of the \nother registers because their values are not guaranteed in this \nmode.  Similarly, a write operation is not taken into account by \nthe ADE7868/ ADE7878 in this mode.  In summary, in this m ode, i t is not r ecommended to access an y \nregister o ther t han AI MAV , B IMAV , a nd CIMAV . T he circuit \nthat measures t hese estimates of rms values is also a ctive d uring \nPSM0; t herefore, i ts calibration can b e completed in e ither P SM0 \nmode o r in PSM1 mo de. Note t hat t he ADE7868 a nd ADE7878 \ndo n ot provide any re gister t o store or process t he corrections \nresulting from t he calibration process. T he external m icroprocessor \nstore s the g ain values i n connection with t hese measurements \nand uses them during PSM1 (see the Curre nt Mean Absolute \nValue Calculation—ADE7868 and ADE7878 Only sec tion for \nmore d etails on the xIMAV r egisters ). \nThe 2 0-bit mean a bsolute value m easurements done in P SM1, \nalthoug h available a lso in P SM0, a re different f rom t he rms \nmeasurements of p hase currents a nd v oltages executed o nly i n \nPSM0 and stored in the xIRMS and xVRMS 24-b it registers. \nSee the  Current Mean Absolute Value Calculation—ADE7868 \nand A DE7878 Only section for de tails. \nIf\n the ADE7868 /ADE7878 is set in  PSM1 mode while still in the \nPSM0  mode , the ADE7868/ ADE7878 immediately begin  the \nmean absolute value calculations without any delay. The xIMAV \nregisters are accessible  at any time; however, if the ADE7878 or \nADE7868 is set in PSM1 mode while still in PSM2 or PSM3 \nmodes, the  ADE7868/ ADE 7878 signal the start of the mean \nabsolute value computations by triggering  the IRQ1  pin low. \nThe xIMAV registers can be accessed only after this moment.  \nPSM2 —LOW POWER MODE  (ADE7868, ADE7878 \nONLY)  \nThe low power mode, PSM2, is available o n the ADE7868 and \nADE7878 only. In this mode, the ADE7868/ ADE7878 compare \nall phase currents against a threshold for a per iod of 0.02 × \n(LPLINE [4:0]  + 1) seconds, independent of the line frequency. \nLPLINE [4:0]  are Bits[7:3] of the LPOILVL register ( see Table 10 ).  \nTable 10. LPOILVL Register \nBit  Mnemonic  Defau lt  Description  \n[2:0] LPOIL[2:0] 111 Threshold is put at a value \ncorresponding to full scale \nmultiplied by LPOIL/8 . \n[7:3] LPLINE [4:0] 00000 The measurement period is (LPLINE[4:0] + 1)/50 sec . \nRev. H | Page 23 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nThe threshold is derived from B its[2:0] (LPOIL[2:0] ) of the \nLPOILVL register as LPOIL[2:0] /8 of full scale. Every  time  \none phase current becomes greater than the thresh old, a \ncounter i s incremented. If every phase counter remains belo w \nLPLINE [4:0]  + 1 at the end of the measurement period, then \nthe IRQ0  pin is triggered low. If a single phase counter becomes \ngreater or equal to LPLINE [4:0]  + 1 at the end of the measure -\nment period, the IRQ1  pin is triggered low. Figure 24 illustrates \nhow the  ADE7868/ ADE7878 behave in PSM2 mode when \nLPLINE [4:0]  = 2 and LPOIL [2:0]  = 3. The test period is three \n50 Hz cycles (60  ms), and the Phase A current rises  above  the \nLPOIL [2:0]  threshold three times. At the end of the test period,  \nthe IRQ1  pin is triggered low.  \nPHASE\nCOUNTER = 1PHASE\nCOUNTER = 2PHASE\nCOUNTER = 3LPLINE[4:0] = 2\nIRQ1IA CURRENTLPOIL[2:0]\nTHRESHOLD\n08510-008 \nFigure 24. PSM2 Mode Triggering IRQ1  Pin for LPLINE [4:0]  = 2 \n(50 Hz Systems)  \nVREFIxP\nIxN\nTAMPER\nINDICATION+V p-p\n–V p-p\n–V p-p/2–V p-p/2+V p-p/2\n+V p-p/2\nPEAK DETECT CIRCUITIxP – IxN\nIxP(a)\n(b)\n08510-503 \nFigure 25. PSM2 Low Power Mode Peak Detection  The PSM2 level threshold comparison works based on a peak \ndetection methodology. The peak detect circuit makes the \ncomparison based on the positive terminal current channel \ninput, I AP, IBP, and I CP (see Figure 25). In case of differential \ninputs being appl ied to the current channels, Figure 25 shows \nthe differential antiphase signals at each of the current input \nterminals, I xP and I xN, and the net differential current, I xP – IxN. \nThe I2C or SPI port is  not functiona l during this mode. The PSM2  \nmode reduces the power consumption required to monitor the \ncurrents when there is no voltage input and the voltage supply of the ADE7868 /ADE7878 is provided by an external battery. If \nthe \nIRQ0  pin is triggered low at th e end of a measurement period,  \nthis signifies all phase currents stayed below threshold and , \ntherefore , there is no current flowing through the system.  \nAt this point, t he external microprocessor sets the ADE7868/  \nADE7878 into Sleep Mode PSM3. If the IRQ1  pin is triggered \nlow at the end of the measurement period, this signifies that at \nleast one current input is above the defined threshold and current is flowing through the system, although no voltage is present at the ADE7868/ ADE7878 pins. This situation is often \ncalled missing neutral and is considered a tampering situation , \nat which point t he external microprocessor sets  the ADE7868/ \nADE7878in to PSM1 mode, measure s the mean absolute values \nof phase currents, and integrates  the energy  based on their values \nand the nominal voltage.  \nIt is recommended to use the ADE7868/ ADE7878 in PSM2 \nmode when Bits[2:0] (PGA1 [2:0] ) of the gain register are equal \nto 1 or 2. These bits represent the gain in the current channel datapath . It is not recommended to use the ADE7868/ ADE7878 \nin PSM2 mode when the PGA1 [2:0] bits are equal to 4, 8, or 16.  \nPSM3 —SL EEP MODE  (ALL PARTS) \nThe sleep mode is available on all parts ( ADE7854, ADE7858, \nADE7868, and ADE7878). In this mode, the ADE78xx  has most \nof its internal circuits  turned off and t he current consumption is \nat its lowest  level. The I2C, HSDC, and SPI ports are not func -\ntiona l during this mode , and the RESET , SCLK/SCL, MOSI/SDA , \nand SS/HSA pins shoul d be set high.  \n \nRev. H | Page  24 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \nTable 11. Power Modes and Related Characteristics  \nPower Mode  All Registers1 LPOILVL, \nCONFIG2  I2C/SPI  Functionality  \nPSM0  \nState After Hardware Reset  Set to default  Set to default  I2C enabled  All circuits are active and DSP \nis in idle mode.  \nState After Software Reset  Set to default  Unchanged  Active serial port is unchanged if lock -in \nprocedure has been previously executed  All circuits are active and DSP is in idle mode.  \nPSM1 —ADE7878, ADE7868  Only Not available  Values set during PSM0 \nunchanged  Enabled  Current mean absolute values \nare computed and the results \nare st ored in the AIMAV, \nBIMAV, and CIMAV registers. The I\n2C or SPI serial port is \nenabled  with limited \nfunctionality.  \nPSM2 —ADE7878, ADE7868  Only  Not available  Values set during PSM0 \nunchanged  Disabled  Compares phase currents \nagainst the threshold set in \nLPOILVL. Triggers \nIRQ0 or IRQ1  \npins accordingly. The serial \nports are not a vailable.  \nPSM3  Not available  Values set during PSM0 unchanged  Disabled  Internal circuits shut down and the serial ports are not available.  \n1 Setting for all registers except the  LPOILVL and CONFIG2 registers.  \nTable 12. Recommended  Actions When Changing Power Modes  \nInitial Power \nMode  Recommended Actions Before Setting Next  \nPower Mode  Next Power Mode \nPSM0  PSM1  PSM2  PSM3  \nPSM0  Stop DSP by setting the r un \nregister = 0x0000.  C urrent mean absolute \nvalues (mav) computed \nimmediately . Wait until the IRQ0  or \nIRQ1  pin is triggered \naccordingly. No action necessary.  \nDisable HSDC by clearing Bit  6 \n(HSDEN) to 0 in the CONFIG register.  xIMAV registers can be \naccessed immediately. \nMask interrupts by setting \nMASK0 = 0x0 and  \nMASK1 = 0x0.  \nErase interrupt status flags in the STATUS0 and STATUS1 \nregister s. \nPSM1 —\nADE7878 , \nADE7868  Only  No action necessary. Wait until the IRQ1  pin is \ntriggered low.  W ait until the IRQ0  or \nIRQ1  pin is triggered \naccordingly. No action \nnecessary.  \nPoll the STATUS1 register \nuntil Bit 15 (RSTDONE) is \nset to 1.  \nPSM2 —\nADE7878 , \nADE7868  OnlyNo action necessary. W ait unti l the IRQ1  pin is \ntriggered low.  Wait until the IRQ1  pin \ntriggered low.  N o action \nnecessary.  \nPoll the STATUS1 register until Bit 15 (RSTDONE) is \nset to 1.  Current mean absolute \nvalues compute at  this \nmoment.  \nxI MAV registers may be \naccessed from this \nmoment.  \nPSM3  No action necessary. Wait until the IRQ1  pin is \ntriggered low.  Wait until the IRQ1  pin is \ntriggered low.  Wait until the IRQ0  or \nIRQ1  pin is triggered \naccordingly. Poll the STATUS1 register  \nuntil Bit 15 (RSTDONE) is \nset to 1.  Current mav  circuit begins \ncomputations at this time.  \nx IMAV  registers can be \naccessed from this \nmoment.  \nRev. H | Page 25 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet  \n \nPOWER -UP PROCEDURE  \nPOR TIMER\nTURNED ONMICROPROCESSOR\nSETS PM1 PIN TO 0;\nAPPLY VDD TO CHI PADE78xx\nFULLY\nPOWERED U PMICROPROCESSOR\nMAKES THE\nCHOICE BETWEEN\nI2CAND SPIRSTDONE\nINTERRUPT\nTRIGGERED~40ms ~26ms0V\nVDD3.3V – 10%\n2.0V ± 10%ADE78xx\nPSM0 READ Y\n08510-009 \nFigure 26. Power -Up Procedure   \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 contain an on -\nchip power supply monitor that supervises the power supply \n(VDD). At power -up, the device i s inactive until VDD reaches \n2 V ± 10%. When VDD crosses this threshold, the power supply \nmoni tor keeps the device in the inactive state for an additional \n26 ms to allow VDD to rise to 3.3 V − 10%, the minimum \nrecommended supply voltage.  \nThe PM0 and PM1 pins have internal pull -up resistors, but it is \nnecessary to set the PM1 pin to Logic 0 either through a microcontroller or by grounding the PM1 pin externally, before powering up the chip. Th e PM0 pin can remain open as it is \nheld high, due to the internal pull -up resistor. This ensures that \nADE7854/ ADE7858/ ADE7868 /ADE7878 always power up in \nPSM0 (normal) mode. The time taken from the chip being powered up completely to the state where all functionality is enabled, is about 40  ms (see Figure 26). It is necessary to ensure \nthat the \nRESET  pin is held high during the entire power -up \nprocedur e.  \nIf PSM0 mode is the only desired power mode, the PM1 pin can be tied to ground externally. When th e ADE7854/ ADE7858/  \nADE7868/ ADE7878 enter PSM0  mode, the I\n2C port is the active \nserial port. To use the SPI  port, toggle the SS/HSA pin three times \nfrom  high to low.  \nTo lock I2C as the active serial port, set Bit 1 (I2C_LOCK) of the \nCONFIG2 register to 1. From this moment, the device ignores \nspurious toggling of the SS/HSA pi n, and a switch to the SPI \nport is no longer possible.  \nIf SPI is the active serial port, any write to the CONFIG2 register  \nlocks the port, and a switch to the I2C port is no longer possible. \nTo use the I2C port, the ADE7854 /ADE7858/ ADE7868/ ADE7878 \nmust be powered down or the device must be reset by setting \nthe RESET  pin low. After the serial port is locked, the serial port \nselection is maintained when the device changes from one \nPSMx power mo de to another.  \n Immediately after entering PSM0 mode, all registers in the \nADE7854/ ADE7858/ ADE7868 /ADE7878 are set to their default \nvalues, including the CONFIG2 and LPOILVL registers.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 signal the end of \nthe transition period by pulling the IRQ1  interrupt pin low  and \nsetting Bit 15 (RSTDONE) in the STATUS1 register to 1. This bit is cleared to 0 during the transition period and is set to 1 when the transition ends. Writing the STATUS1 register with \nthe RSTDONE bit set to 1 clears the status bit and returns the \nIRQ1  pin high. Because RSTDONE is an unmaskable interrupt, \nBit 15 (RSTDONE) in the ST ATUS1 register must be cancelled \nfor the IRQ1  pin to return high. Wait until the IRQ1  pin goes low  \nbefore accessing the STATUS1 register to test the state of the \nRSTDONE bit. At this point, as a good programming practice , \ncancel all other status flags in the STATUS1 and STATUS0 registers  \nby writing the corresponding bits with 1.  \nInitially, the DSP is in idle mode and, therefore, does not \nexecute any instructions. This is the moment to initialize all registers in the ADE7854, ADE7858, ADE7868, or ADE7878. \nSee the Digital Signal Processor  section for the proper procedure  \nto initialize all registers and start the metering.  \nIf the supply vo ltage, VDD, fa lls lower than 2  V ± 10%, the \nADE7854/ ADE7858/ ADE7868 /ADE7878 enter an inactive \nstate, which means that no m easurements or computations \nare executed.  \n \nRev. H | Page 26 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nHARDWARE RESET  \nThe ADE7854/ ADE7858 /ADE7868/ ADE7878  each has  a RESET  \npin. If the ADE7854, ADE7858, ADE7868, or ADE7878 is in \nPSM0 mode and the RESET  pin is set low, then the ADE78xx  \nenter s the hardware reset state. The ADE78xx  must  be in PSM0 \nmode for a hardware reset to be considered. Setting  the RESET  \npin low while the ADE78xx  is in PSM1, PSM2 , and PSM3 \nmodes does not have any effect.  \nIf the ADE7854 , ADE7858, ADE7868, or ADE7878 is in PSM0 \nmode and the RESET  pin is toggled from high to low and then \nback to high after at least 10  µs, all the registers are set to their  \ndefault values, including the CONFIG2  and LPOILVL  registers . \nThe ADE78xx  signal s the end of the transition period by triggering  \nthe IRQ1  interrupt pin  low and setting B it 15 (RSTDONE) in the \nSTATUS1 register to 1. This bit is 0 during the transition period \nand bec omes 1 when the transition ends. The status bit is cleared \nand the IRQ1  pin is returned  high by writing to the STATUS1 \nregister with the corresponding bit set to 1.   \nAfter a hardware reset, t he DSP is in idle mode, which means it \ndoes not execute any instru ction.  \nBecause  the I2C port is the default serial port of  the ADE7854/ \nADE7858/ ADE7868/ ADE7878, it becomes  active after a reset \nstate. If SPI is the port used by the external microprocessor, the \nprocedure to enable it must  be repeated immediately after the \nRESET pin is toggled back to high (see the Serial Interfaces  \nsection for details ).  \nAt this point, it is recommended to initialize all of the ADE78xx  \nregisters , enable data memory RAM protection,  and then write \n0x0001 into the run register to start the DSP . See the Digital \nSignal Processor  section for details on data memory RAM \nprotection and the run register . SOFTWARE RESET FUNCT IONALITY  \nBit 7 (SWRST) in the CONFIG register manages the software \nreset functionality in PSM0 mode. The default value of this bit is 0. If this bit is set to 1, then  the ADE7854/ ADE7858 /ADE7868/ \nADE7878 enter  the software  reset state. In thi s state, almost all \ninternal registers are set to their default values. In addition, the choice of wh ich serial port , I\n2C or SPI , is in use remains unchanged  \nif the  lock-in procedure has been executed  previously (see the \nSerial Interfaces  for details) . The register s that maintain their  \nvalue s despite the SWRST bit being set to 1 are  the CONFIG2  \nand LPOILVL registers . When the software reset ends,  Bit 7 \n(SWRST) in the CONFIG  register  is cleared to 0, the IRQ1  \ninterrupt pin is set low , and Bit 15 (RSTDONE) in the STATUS1 \nregister is set to 1. This bit is 0 during the transition period and \nbecomes 1 when the transition ends. The status bit is cleared and \nthe IRQ1  pin is set back high by writing to the STATUS1 register \nwith the corresponding bit set to 1.  \nAfter a software reset end s, the DSP is in idle mode, which \nmeans it does not execute any instruction. It is recommended  \nto initialize all the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nregisters and then enable th e data memory RAM protection and \nwrite 0x0001 into the run  register to start the DSP ( see the \nDigital Signal Processor  section for details on data memory \nRAM protection and the run register ). \nSoftware reset functio nality is not available in PSM1, PSM2, or \nPSM3 mode.  \nRev. H | Page 27 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTHEORY OF OPERATION  \nANALOG INPUTS  \nThe ADE7868/ ADE7878 have seven  analog inputs forming  \ncurrent  and voltage  channels . The ADE7854/ ADE7858 have six \nanalog inputs, not offering the neutral current. The current \nchannel s consist of four pairs of fully differential voltage inputs: \nIAP a nd IAN, IBP and IBN , ICP and ICN, and INP and INN . \nThese vol -tage input pairs have a maximum differential signal of \n±0.5 V.  In addition, the maximum signal level on analog inputs \nfor the IxP/IxN  pair is ±0.5 V with respect to AGND . The \nmaximum common -mode signal allowed on the inputs is ±2 5 mV . \nFigure 27  prese nts a schematic of the input for the current \nchannels and their relation to the maximum common -mode  \nvoltage . \nIAP, IBP,\nICP, OR INP\nIAN, IBN,\nICN, OR INNVCM V2V1+500mV\nVCMV1+ V2DIFFERENTIAL INPUT\nV1 + V 2 = 500mV MAX PEAK\nCOMMON MODE\nVCM = ±25mV MAX\n–500mV\n08510-010 \nFigure 27. Maximum Input Level, Current Channels, Gain = 1 \nAll inputs have a programmable gain amplifier (PGA) with a \npossible gain selection of 1, 2, 4, 8 , or 16. The gain of IA, IB , and \nIC inputs is set in B its[2:0] (PGA1 [2:0] ) of the gain  register. For \nthe ADE7868 and ADE7878 only, t he gain of the IN input is set \nin Bits[5:3] (PGA2 [2:0] ) of the gain register ; thus,  a different  gain \nfrom the IA, IB , or IC inputs  is possible. See Table 44 for details \non the gain register.  \nThe voltage channel has three single -ended voltage inputs: V AP , \nVBP, and VCP . These single -ended voltage inputs have a maximum  \ninput voltage  of ±0.5 V wi th respect to VN. In addition, the max -\nimum signal level on analog inputs for VxP and VN is ±0.5  V \nwith respect to AGND. The maximum common -mode signal \nallowed on the inputs is ±25 mV . Figure 28 presents a schemati c \nof the volta ge channels inputs and their relation to the maximum  \ncommon -mode voltage.  \nVAP, VBP,\nOR VCP\nVNVCMV1+500mV\nVCMV1DIFFERENTIAL INPUT\nV1 + V 2 = 500mV MAX PEAK\nCOMMON MODE\nVCM = ±25mV MAX\n–500mV\n08510-012 \nFigure 28. Maximum Input Level, Voltage Channels, Gain = 1  \nAll inputs have a programmable gain  with a possible gain \nselection of 1, 2, 4, 8,  or 16. To set the gain, use Bits[8:6] \n(PGA3 [2:0] ) in the gain  register  (see Table 44). Figure 29 shows how the gain selection from  the gain  register \nworks in both current and voltage channels.  \nK × V INGAIN\nSELECTION\nIxN, VNIxP,VyP\nVIN\nNOTES\n1. x = A, B, C, N\n    y = A, B, C.\n08510-011\n \nFigure 29. PGA in Current and Voltage Channels  \nANALOG -TO-DIGITAL CONVERSION  \nThe ADE7868 /ADE7878 have seven sigma -delta (Σ-Δ) analog -\nto-digital converters (ADC s), and the ADE7854/ ADE7858 have \nsix Σ -Δ ADCs . In P SM0 mode, all ADCs are active. In PSM 1 \nmod e, only the ADCs that measure the Phase A, Phase B, and \nPhase  C currents are active. The ADCs that measure the neutral \ncurrent and the  A, B, and C phase voltages are turned off. In \nPSM2 and PSM3 modes, the ADCs are powered down to \nminimize power consumption.  \nFor simplicity, the block diagram in Figure 30 shows a first -\norder  Σ-Δ ADC. The converter  is composed  of the Σ -Δ modulator  \nand the digital low -pass filter.  \n24DIGITAL\nLOW-PASS\nFILTER R\nC+\n–CLKIN/16\nINTEGRATOR\nVREF\n1-BIT DACLATCHED\nCOMPARATORANALOG\nLOW-PASS FILTER\n.....10100101.....+\n–\n08510-013 \nFigure 30. First -Order Σ-∆ ADC  \nA Σ-Δ modulator converts the input signal into a continuous \nserial stream of 1s and 0s at a rate determined by the sampling \nclock. In the  ADE7854/ ADE7858/ ADE7868/ ADE7878, the \nsampling clock is  equal to 1.024  MHz  (CLKIN/16). The 1 -bit \nDAC in the feedback loop is driven by the serial data stream. \nThe DAC output is subtracted from the input signal. If the loop \ngain is high enough, t he average value of the D AC out put (and , \ntherefore , the bit stream) can approach that of the input signal \nlevel. For any given input value in a single sampling interval, the \ndata from the 1 -bit ADC is virtually meaningless. Only when a \nlarge number of samples are  averaged is a mea ningful result \nobtained. This averaging is carried out in the second part of the ADC, the digital low -pass filter. By averaging a large number of \nbits from the modulator, the low -pass filter can produce 24 -bit \ndata -words that are proportional to the input signal level.  \nThe Σ-Δ converter uses two techniques to achieve high resolu -\ntion from what is essentially a 1 -bit conversion technique. The \nfirst is oversampling. Oversampling means that the signal is sampled at a rate (frequency)  that is many times higher than  \nRev. H | Page 28 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nthe bandwidt h of interest. For example, the sampling rate in  \nthe ADE7854/ ADE7858/ ADE7868/ ADE7878 is 1.024 MHz , \nand th e bandwidth  of interest is 40  Hz to 2 kHz. Oversampling \nhas the effect of spreading the quantization noise (noise due to \nsampling) over a wider bandwidth. Wit h the noise spread more \nthinly over a wider bandwidth, the quantization noise in the band \nof interest is lowered, as shown in  Figure 31. However, oversam -\npling  alone is not efficient enough to improve the signal -to-noise \nratio  (SNR) in the band of interest. For example, an oversampling \nfactor  of 4 is required just to increase the SNR by a mere  6 dB \n(1 bit). To keep the oversampling ratio at a reasonable level, it is \npossible to shape the quantization noise so that the majority of \nthe noise lies at the higher frequencies. In the Σ-Δ modulator, \nthe noise is shaped by the integrator, which has a high- pass -type \nresponse f or the quantization noise. This is the second technique  \nused to achieve high resolution. The result is that most of the \nnoise is at the higher frequencies where it c an be removed by \nthe digital low -pass filter. This noise shaping is shown in Figure 31 . \nNOISESIGNA L\nNOISESIGNA L0 24 512\nFREQUENC Y (kHz)\nHIGH RESOLUTION\nOUTPUT FROM\nDIGITAL LPF1024\n0 24 512\nFREQUENC Y (kHz)1024DIGITAL FILTER\nSHAPED NOISEANTIALIAS FI LTER\n(RC)\nSAMPLING\nFREQUENC Y\n08510-014 \nFigure 31. Noise Red uction Due to Oversampling and  \nNoise Shaping in the Analog Modulator  \nAntialiasi ng Filter  \nFigure 30 also shows an analog low -pass filter (RC) on the input \nto the ADC. This filter is placed outside  the ADE7854/ ADE7858 / \nADE7868/ ADE7878, and its role is to prevent aliasing. Aliasing \nis an artifact of all sampled sys tems as shown  in Figure 32. Aliasing  \nmeans that frequency components in the input signal to the \nADC, which are higher than half the sampling rate of the ADC, \nappear in the sampled signal at a frequency below half t he \nsampling rate. Frequency components above half the sampling freque ncy (also know n as the Nyquist frequency, that is , 512  kHz)  \nare imaged or folded back down below 512 kHz. This happens with all ADCs regardless of the architecture. In the example shown, only freque ncies near the sampling frequency,  that is , 1.024 MHz,  \nmove into the band of interest for metering,  that is , 40 Hz to \n2 kHz. To attenuate the high frequency (near 1.024  MHz)  noise and prevent the distortion of the band of interest, a low -pass \nfiler (LPF)  must  be introduced. For conventional current \nsensors, it is recommended to use one RC filter with a corner frequency of 5  kHz for the attenuation to be sufficiently high at \nthe sampling frequency of 1.024  MHz. The 20  dB per decade \nattenuation of this filter is usually sufficient to eliminate the effects of aliasing for conventional current sensors . However, for a \ndi/dt sensor such as a Rogowski coil, the sensor has a 20 dB per \ndecade gain. This neutralizes the 20 dB per decade attenuation \nproduced  by the LPF. Therefore, when using a di/dt sensor, take \ncare to offset the 20 dB per decade gain. One simple approach is to cascade one additional  RC filter , thereby producing  a −40 dB \nper decade attenuation.  \nALIASING EFFECTSSAMPLING\nFREQUENC Y\nIMAGE\nFREQUENCIES0 2 4 512\nFREQUENC Y (kHz)1024\n08510-015 \nFigure 32. Aliasing Effects  \nADC Transfer Function  \nAll ADCs in the ADE7854/ ADE7858/ ADE7 868/ADE7878 are \ndesigned to produce the same 24 -bit signed output code for the \nsame input signal level. With a full -scale  input  signal of 0.5  V \nand an internal refere nce of 1.2 V , the ADC output code is nomi -\nnally  5,928,256 (0x5A7540) . The code from the ADC can  vary \nbetween 0x800000 ( −8,388,608) and 0x7FFFFF (+8,388,607); \nthis is equivalent to an input signal level of ±0.7 07 V.  H o w e v e r, \nfor specified performance,  do not exceed the nominal range of \n±0.5  V; ADC performance is guaranteed only for input signals \nlower than ±0.5  V. \nCURRENT CHANNEL  ADC  \nFigure 33 shows the ADC and signal processing pat h for \nInput  IA of the current channels ( it is the same for IB and IC). \nThe ADC outputs are signed twos complement 24 -bit data -\nwords and are available at a rate of 8 kSPS (thousand samples \nper second). With the specified full -scale analog input signal  \nof ±0.5 V , the ADC produces its maximum output code value. \nFigure 33 shows a full -scale voltage signal applied to the differ -\nential inputs  (IAP and IAN ). The ADC output swings between \n−5,928,256 (0xA58AC0) and  +5,928,256 (0x5A7540). The \ninput, IN, corresponds to the neutral current of a 3 -phase \nsystem  (available in the ADE7868 and ADE7878 only) . If no \nneutral line is present, connect this input to AGND. The datapath of the neutral current is similar to the path of the \nphase currents  as shown in  Figure 34. \n \nRev. H | Page 29 of 100 \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 30 of 100 AIGAIN[23:0]DSP\nREFERENCE HPFDIS\n[23:0]DIGITAL\nINTEGRATORINTEN BIT\nCONFIG[0]\nTOTAL/FUNDAMENTAL\nACTIVE AND REACTIVE\nPOWER CALCULATIONCURRENT PEAK,\nOVERCURRENT\nDETECT\nIAWV WAVEFORM\nSAMPLE REGISTERCURRENT RMS (IRMS)\nCALCULATION\nHPFADC PGA1IAPZX DETECTION\nPGA1 BITS\nGAIN[2:0]\n×1, ×2, ×4, ×8, ×16\nVIN\nVINIAN\nANALOG INPUT RANGE ADC OUTPUT RANGE0x5A7540 =\n+5,928,256ZX SIGN AL\nDATA RANGE\n0V\n0xA58AC0 =\n–5,928,256\n0x5A7540 =\n+5,928,256CURRENT CHANNEL\nDATA RANGE AFTER\nINTEGRATION\n0V\n0xA58AC0 =\n–5,928,2560x5A7540 =\n+5,928,256CURRENT CHANNEL\nDATA RANGE\n0V\n0xA58AC0 =\n–5,928,256+0.5V/GAIN\n–0.5V/GAIN0VLPF1\n08510-019 \nFigure 33. Current Channel Signal Path \nNIGAIN[23:0]DSP\nREFERENCE\nDIGITAL\nINTEGRATORINTEN BIT\nCONFIG[0]\nINWV WAVEFORM\nSAMPLE REGISTERCURRENT RMS (IRMS)\nCALCULATION\nHPFADC PGA2INPPGA2 BITS\nGAIN[5:3]\n×1, ×2, ×4, ×8, ×16\nVIN\nINN\n08510-120HPFDIS\n[23:0]\n \nFigure 34. Neutral Current Signal Path ( ADE7868 , ADE7878  Only) \nCurrent Waveform Gain Registers \nThere is a multiplier in the signal path of each phase and \nneutral current. The current waveform can be changed by \n±100% by writing a corresponding twos complement number to the 24-bit signed current waveform gain registers (AIGAIN, \nBIGAIN, CIGAIN, and NIGAIN). For example, if 0x400000 is \nwritten to those registers, the ADC output is scaled up by 50%. To scale the input by −50%, write 0xC00000 to the registers. Equation 3 describes mathematically the function of the current \nwaveform gain registers. \nCurrent Waveform  = \n\uf0f7\uf0f7\n\uf0f8\uf0f6\n\uf0e7\uf0e7\n\uf0e8\uf0e6\uf02b \uf0b42321Register Gain Current of ContentOutput ADC  (3) \nChanging the content of the AIGAIN, BIGAIN, CIGAIN, or \nINGAIN registers affects all calculations based on its current; \nthat is, it affects the corresponding phase active/reactive/ apparent energy and current rms calculation. In addition, \nwaveform samples scale accordingly. \nNote that the serial ports of the ADE7854 , ADE7858 , ADE7868 , \nand/or ADE7878  work on 32-, 16-, or 8-bit words, and the DSP \nworks on 28 bits. The 24-bit AIGAIN, BIGAIN, CIGAIN, and \nNIGAIN registers are accessed as 32-bit registers with the four most significant bits (MSBs) padded with 0s and sign extended \nto 28 bits. See Figure 35 for details. \n31 28 27 24 23 0\n24-BIT NUMBER 0000\nBITS[27:24] ARE\nEQUAL TO BIT 23BIT 23 IS A SIGN BIT\n08510-016 \nFigure 35. 24-Bit xIGAIN Transmitted as 32-Bit Words  \nCurrent Channel HPF \nThe ADC outputs can contain a dc offset. This offset can create \nerrors in power and rms calculations. High-pass filters (HPFs) \nare placed in the signal path of the phase and neutral currents \nand of the phase voltages. If enabled, the HPF eliminates any dc offset on the current channel. All filters are implemented in the DSP and, by default, they are all enabled: the 24-bit HPFDIS register is cleared to 0x00000000. All filters are disabled by setting HPFDIS to any nonzero value. \nAs stated in the Current Waveform Gain Registers section, the \nserial ports of the ADE78xx  work on 32-, 16-, or 8-bit words. \nThe HPFDIS register is accessed as a 32-bit register with eight \nMSBs padded with 0s. See Figure 36 for details. \n31 24 23 0\n24-BIT NUMBER 0000 0000\n08510-017 \nFigure 36. 24-Bit HPFDIS Register Transmitted as 32-Bit Word \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nCurrent Channel Sampling   \nThe waveform samples of the current channel are taken at the \noutput of HPF a nd stored in the 24 -bit signed registers,  IAW V,  \nI B W V,  ICWV , and INWV  (ADE7868 and ADE7878 only)  at a \nrate of 8  kSPS. All power and rms calculati ons remain uninter -\nrupted during this process. B it 17 (DREADY) in the STATUS0 \nregister is set w hen the IAWV , IBWV , ICWV , and INWV  registers  \nare available to  be read  using the I2C or SPI serial port . Setting \nBit 17 (DREADY) in the MASK0 register enables an interrupt \nto be set wh en the DREADY flag is set.  See the Digital Signal \nProcessor  section for more details on B it DREADY .  \nAs stated  in the Current Waveform Gain Registers  section , the \nserial ports of the ADE78xx  work on 32 -, 16-, or 8-bit words . \nWhen the IAW V,  I B W V,  I C W V , and INWV  24-bit signed \nregisters are read from the  ADE78xx  (INWV is available on \nADE7868/ ADE7878 only) , they are transmitt ed sign extended \nto 32  bits. See Figure 37 for details. \n31 24 2322 0\n24-BIT SIGNED NUMBER\nBITS[31:24] ARE\nEQUAL TO BIT 23BIT 23 IS A SIGN BIT\n08510-018 \nFigure 37. 24- Bit IxWV Register Transmitted as 32- Bit Signed Word  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 devices each \ncontain  a high sp eed data capture (HSDC) port that is specially \ndesigned to provide fast access to the waveform sample registers. \nSee the  HSDC Interface  section for more details.  \ndi/dt  CURRENT  SENSOR AND DIGITAL INTEGRATOR  \nThe di/d t sensor detects changes in the magnetic field caused by \nthe ac current. Figure 38 shows the principle of a di/dt current \nsensor. \nMAGNETIC FIELD CRE ATED BY  CURRENT\n(DIRECT LY PROPORTIONA LTO CURRENT)\n+  EMF (ELECTROMOTIVE FORCE)\n–  INDUCED B Y CHANGES IN\nMAGNETIC FLUX DENSIT Y (di/dt)\n08510-020 \nFigure 38. Principle of a di/dt Current Sensor  \nThe flux d ensity of a magnetic field induced by a current is \ndirectly proportional to the magnitude of the current. The \nchanges in the magnetic flux density passing through a conductor  loop generate an electromotive force (EMF) between the two \nends of the loop. The  EMF is a voltage signal that is propor -\ntional to the di/dt of the current. The voltage output from the di/dt current sensor is determined by the mutual inductance between the current carrying conductor and the di/dt sensor.  \nDue to the di/dt sensor, t he cu rrent signal needs to be filtered \nbefore it can be used  for power measurement. On each phase and \nneutral current  datapath , there is a built -in digital integrator to \nrecover the current signal from the di/dt sensor. The digital inte -\ngrator is disabled by de fault when the ADE78xx  is powered up \nand after a reset. Setting  Bit 0 (INTEN) of the CONFIG register \nturns on the integrator. Figure 39 and Figure 40 show the \nmagnitude and phase response of the digital integrator.  \nNote that the integrator has a −20 dB/dec attenuation and approximately −90° phase shift. When combined with a di/dt sensor, the result ing magnitude and pha se response should be a \nflat gain over the frequency band of interest. However, the di/dt sensor has a 20 dB/dec gain associated with it and generates sig -\nnificant high frequency noise. An antialiasing filter of at least the second ord er is needed to avoid noise alias ing back in the \nband of interest when the ADC is sampling (see the Antialiasing \nFilter  section).  \n50\n0\n–50\n–100–500MAGNITUDE (dB) PHASE (Degrees)\n0 500 1000 1500 2000 2500 3000 3500 4000\nFREQUENC Y (Hz)0.01 0.1 1 10 100 1000\nFREQUENC Y (Hz)\n08510-116 \nFigure 39. Combined Gain and Phase Response of the  \nDigit al Integrator  \nThe DICOEFF 24 -bit signed register is used in the digital \nintegrator algorithm. At power -up or after a reset, its value is \n0x000000. Before turning on the integrator, this register must  be \ninitialized with 0xFF F8000. DICOEFF is not used when the \nintegrator is turned off and can remain  at 0x000000 in th at case.  \nRev. H | Page 31 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \n–30–15\n–20\n–25\n–89.96\n–89.97\n–89.98\n–89.99MAGNITUDE (dB) PHASE (Degrees)\n30 35 40 45 50 55 60 65 70\nFREQUENC Y (Hz)30 35 40 45 50 55 60 65 70\nFREQUENC Y (Hz)\n08510-101 \nFigure 40. Combined Gain and Phase Response of the  \nDigital Integrator (40 Hz to 70 Hz)  \nAs stated in the Current Wavef orm Gain Registers  section , the \nserial ports of the ADE7854/ ADE7858/ ADE7868/ ADE7878 work \non 32 -, 16-, or 8-bit words. Similar to the registers shown  in \nFigure 35, the DICOEFF  24-bit signed register is accessed as a 32-bit register wi th four MSBs padded with 0s  and sign \nextended to 28 bits , which practically means it is transmitted \nequal to 0xFFF8000 . \nWhen the digital integrator is switched off, the ADE7854/  \nADE7858/  ADE7868/ ADE7878 can be used directly with a \nconventional current sensor, such as a curren t transformer (CT).  \nVOLTAGE CHANNEL ADC  \nFigure 41 shows the ADC and signal processing chain for \nInput  VA in the voltage channel. The VB and VC channels  \nhave similar processing chains. The ADC outputs are signed \ntwos complement 24 -bit words and are available at a rate of \n8 kSPS. With the specified full -scale analog input signal of  \n±0.5 V , the ADC produces its maximum output code value.  \nFigure 41 shows  a full -scale voltage signal b eing applied to the \ndifferential inputs  (VA and VN ). The ADC output swings \nbetween −5, 928,256 (0xA5 8AC0)  and +5,928,256 (0x5A7540) .  \nAVGAIN[23:0]REFERENCE HPFDIS\n[23:0]DSP\nTOTAL/FUNDAMEN TAL\nACTIVE AND REACTIVE\nPOWER CALCUL ATIONVOLT AGE PEAK,\nOVE RVOLT AGE,\nSAG DETECT\nVAWVWAVEFORM\nSAMPLE REGISTERCURRENT RMS (VRMS)\nCALCUL ATION\nHPFADC PGA3VAP\nZX DETECTIONPGA3 BITS\nGAIN[8:6]\n×1, ×2, ×4, ×8, ×16\nVIN\nVINVN\nANALOG INPUT RANGE ANALOG OUTPUT RANGE0x5A7540 =\n+5,928,256ZX SIGNA L\nDATA RANGE\n0V\n0xA58AC0 =\n–5,928,2560x5A7540 =\n+5,928,256VOLT AGE CHANNE L\nDATA RANGE\n0V\n0xA58AC0 =\n–5,928,256+0.5V/GAIN\n–0.5V/GAIN0VLPF1\n08510-025 \nFigure 41. Voltage Channel Datapath  \nRev. H | Page  32 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nVoltage Waveform Gain Registers  \nThere is a multip lier in the signal path of each phase voltage. \nThe volta ge waveform can be changed by ±10 0% by writing  \na correspond ing twos complement number to the 24 -bit signed \nvoltage  waveform gain registers (AVGAIN, BVGAIN , and \nCVGAIN). For example, if 0x400000 is wr itten to those registers , \nthe ADC output is scaled up by 50%. To scale the input by − 50%,  \nwrite 0xC00000 to the registers. Equation  4 describes mathe -\nmatically the function of the current waveform gain registers.  \nVoltage Waveform  = \n\uf8f7\uf8f7\n\uf8f8\uf8f6\n\uf8ec\uf8ec\n\uf8ed\uf8eb+×2321Register Gain Voltageof ContentOutput ADC  (4) \nChanging the content of the AVGAIN, BVGAIN , and CVGAIN  \nregisters  affects all calculations based on its voltage; that is, it \naffects the corresponding phase active/reactive/apparent energy \nand voltage  rms calculation. In addition, waveform samples are \nscaled accordingly.  \nAs stated  in the Current  Waveform Gain Registers  section , the \nserial ports of  the ADE78xx  work on  32-, 16-, or 8-bit words , \nand the DSP works on 28 bits . As presented in Figure 35, the \nAVGAIN, BVGAIN , and CVGAIN registers  are accessed as  \n32-bit registers with four MSBs  padded with 0s and sign \nextended to 28 bits.  \nVoltage Channel HPF  \nAs explained  in the Current Channel HP F section, the ADC \noutputs can contain a dc offset that can create errors in power \nand rms calculations. HPF s are placed in the signal path of the \nphase voltages, similar to the ones in the current channels. The HPFDIS register can enable or disable the f ilters. See the \nCurrent Channel HPF  section for more details.  \nVoltage Channel Sampling  \nThe waveform samples of the voltage  channel are taken at the \noutput of HPF and stored into VAWV , VBWV , and VCWV  \n24-bit signed registers at a rate of 8  kSPS. All power and rms \ncalculations remain uninterrupted during this process. Bit 17 \n(DREADY) in the STATUS0  register is set when the VAW V,  \nVBWV , and VCWV registers are available to be read using the \nI2C or SPI serial port . Settin g Bit 17 (DREADY) in the MASK0  \nregister enables an interrupt to be set when the DREADY flag is set. See the Digital Signal Processor  section for more details on \nBit DREADY .  \nAs stated  in the Current Waveform Gain Registers  section , the \nserial ports of the ADE78xx  work on 32 -, 16-, or 8 -bit words. \nSimilar to registers pres ented in Figure 37, the V AWV , VBWV , \nand VCWV 24 -bit signed registers are transmitted sign \nextended to 32 bits.  \nThe ADE7854 /ADE7858/ ADE7868/ ADE7878 each contain  an \nHSDC port e specially designed to provide fast access to the \nwaveform sample registers . See the HSDC Interface  section for \nmore details.  CHANGING PHASE VOLTA GE DATA PATH  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 can direct one \nphase voltage input to the computational datapath of another \nphase. For example, P hase A voltage can  be introduced  in the \nPhase B computational  datapath , which mean s all powers \ncomputed by  the ADE78xx  in Phase  B are  based on P hase A \nvoltage and P hase B current.  \nBits[9:8] (VTOIA[1:0]) of the CONFIG register manage what phase voltage is directed to Phase A computational data path. If VTOIA[1:0] = 00 (default value), the Phase A voltage is directed to the Phase A computational data path. If VTOIA[1:0] = 01, the Phase B voltage is directed to the  Phase A computational \ndata path. If VTOIA[1:0] = 10, the Phase C voltage is directed  \nto the P hase A computational data path . If VTOIA[1:0] = 11,  \nthe \nADE7854/ ADE7858/ ADE7868/ ADE7878 behaves as if \nVTOIA[1:0] = 00.  \nBits[11:10] (VTOIB[1:0]) of the CONFIG register manage  \nwhat p hase voltage is directed to the Phase B computational \ndata path. If VTOIB[1:0] = 00 (default value), the Phase B \nvoltage is directed to the Phase B computational data path.  \nIf VTOIB[1:0] = 01, the Phase C voltage is directed to the Phas e B computational d ata path. If VTOIB[1:0] = 10, the Phase A \nvoltage is directed  to the  Phase B  computational data path. If \nVTOIB[1:0] = 11, the ADE7854 /ADE7858/ ADE 7868/ ADE7878 \nbehaves as  if VTOIB[1:0] = 00.  \nBits[13:12] (VTOIC[1:0]) of the CONFIG register manage what \nphase voltage is directed t o the Phase C computational data \npath . If VTOIC[1:0] = 00 (default value), the Phase C voltage is \ndirected to Phase C computational data path, if VTOIC[1:0] = 01, the Phase A voltage is directed to the Phase C computational \ndata path. If VTOIC[1:0] = 10, t he Phase B voltage is directed to \nthe Phase C computational data path. If VTOIC[1:0] = 11, the \nADE7854/ ADE7858/ ADE7868 /ADE7878 behaves as if \nVTOIC[1:0] = 00.  \n \n \n \n \nRev. H | Page 33 of 100 \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 34 of 100 IA\nVA\nIB\nVB\nIC\nVCPHASE A\nCOMPUTATIONAL\nDATAPATH\nPHASE B\nCOMPUTATIONAL\nDATAPATH\nPHASE C\nCOMPUTATIONAL\nDATAPATHVTOIB[1:0] = 10,\nPHASE A VOLTAGE\nDIRECTED\nTO PHASE B\nVTOIC[1:0] = 10,\nPHASE B VOLTAGE\nDIRECTED\nTO PHASE C\nVTOIA[1:0] = 10,\nPHASE C VOLTAGE\nDIRECTED\nTO PHASE ACPHCALBPHCALAPHCAL\n08510-026 \nFigure 42. Phase Voltages Used in Different Datapaths \nFigure 42 presents the case in which Phase A voltage is used in \nthe Phase B datapath, Phase B voltage is used in the Phase C \ndatapath, and Phase C voltage is used in the Phase A datapath. \nPOWER QUALITY MEASUREMENTS \nZero-Crossing Detection \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 have a zero-\ncrossing (ZX) detection circuit on the phase current and voltage \nchannels. The neutral current datapath does not contain a zero-\ncrossing detection circuit. Zero-crossing events are used as a \ntime base for various power quality measurements and in the \ncalibration process.  \nThe output of LPF1 is used to generate zero crossing events. \nThe low-pass filter is intended to eliminate all harmonics of 50 Hz and 60 Hz systems, and to help identify the zero-crossing events on the fundamental components of both current and voltage channels.  \nThe digital filter has a pole at 80 Hz and is clocked at 256 kHz. \nAs a result, there is a phase lag between the analog input signal \n(one of IA, IB, IC, V A, VB, and VC) and the output of LPF1. The error in ZX detection is 0.0703° for 50 Hz systems (0.0843° for 60 Hz systems). The phase lag response of LPF1 results in a time delay of approximately 31.4° or 1.74 ms (at 50 Hz) between \nits input and output. The overall delay between the zero crossing \non the analog inputs and ZX detection obtained after LPF1 is about 39.6° or 2.2 ms (at 50 Hz). The ADC and HPF introduce the additional delay. The LPF1 cannot be disabled to assure a good resolution of the ZX detection. Figure 43 shows how the zero-crossing signal is detected.  xIGAIN[23:0] OR\nxVGAIN[23:0]REFERENCE HPFDIS\n[23:0]DSP\nHPFPGA ADCIA, IB, IC,\nOR\nVA, VB, VCZX\nDETECTION\nLPF1\nIA, IB, IC,\nOR VA, VB, VC39.6° OR 2.2ms @ 50Hz\n1\n0.855\n0VZX ZXZX\nZX\nLPF1 OUTPUT\n08510-027 \nFigure 43. Zero-Crossing Detection on Voltage and Current Channels \nTo provide further protection from noise, input signals to the \nvoltage channel with amplitude lower than 10% of full scale do not generate zero-crossing events at all. The Current Channel ZX detection circuit is active for all input signals independent of their \namplitudes. \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 contain six zero-\ncrossing detection circuits, one for each phase voltage and \ncurrent channel. Each circuit drives one flag in the STATUS1 \nregister. If a circuit placed in the Phase A voltage channel detects one zero-crossing event, Bit 9 (ZXVA) in the STATUS1 \nregister is set to 1.  \nSimilarly, the Phase B voltage circuit drives Bit 10 (ZXVB), the \nPhase C voltage circuit drives Bit 11 (ZXVC), and circuits placed  in the current channel drive Bit 12 (ZXIA), Bit 13 (ZXIB), and \nBit 14 (ZXIC) in the STATUS1 register. If a ZX detection bit is \nset in the MASK1 register, the IRQ1\n interrupt pin is driven low \nand the corresponding status flag is set to 1. The status bit is cleared and the IRQ1\n pin is set to high by writing to the STATUS1 \nregister with the status bit set to 1. \nZero-Crossing Timeout \nEvery zero-crossing detection circuit has an associated timeout \nregister. This register is loaded with the value written into the \n16-bit ZXTOUT register and is decremented (1 LSB) every \n62.5 μs (16 kHz clock). The register is reset to the ZXTOUT \nvalue every time a zero crossing is detected. The default value of this register is 0xFFFF. If the timeout register decrements to 0 before a zero crossing is detected, one of Bits[8:3] of the STATUS1 register is set to 1. Bit 3 (ZXTOV A), Bit 4 (ZXTOVB), \nand Bit 5 (ZXTOVC) in the STATUS1 register refer to Phase A, \nPhase B, and Phase C of the voltage channel; Bit 6 (ZXTOIA), Bit 7 (ZXTOIB), and Bit 8 (ZXTOIC) in the STATUS1 register \nrefer to Phase A, Phase B, and Phase C of the current channel.  \nIf a ZXTOIx or ZXTOVx bit is set in the MASK1 register, the \nIRQ1\n interrupt pin is driven low when the corresponding status bit \nis set to 1. The status bit is cleared and the IRQ1  pin is returned to \nhigh by writing to the STATUS1 register with the status bit set to 1. \nThe resolution of the ZXOUT register is 62.5 μs (16 kHz clock) \nper LSB. Thus, the maximum timeout period for an interrupt is \n4.096 sec: 216/16 kHz. \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nFigure 44 shows the mechanism of the zero -crossing timeout \ndetection when the voltage or the current signal stays at a fixed \ndc level for more than 62.5 µs × ZXTOUT µs.  \n16-BIT INTERNA L\nREGISTER VALUE\nZXTOUT\nVOLT AGE\nOR\nCURRENT\nSIGNA L\nIRQ1 INTERRUPT PINZXZOxy FLAG IN\nSTATUS1[31:0], x = V, A\ny =A, B, C0V\n08510-028 \nFigure 44. Zero -Crossing Timeout Detecti on \n \nPhase Sequence Detection  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have on-chip \nphase sequence error detection circuit s. This detection  works \non phase voltages and considers only the zero crossings \ndetermined by their negative- to-positive transitions. The regular \nsuccession of these zero -crossing events is Phase A followed by \nPhase B followed by Phase C (see Figure 46 ). If the sequence of \nzero-crossing events is , instead , Phase A  followed by Phase C \nfollowed by P hase B, then B it 19 (SEQERR) in the STATUS1 \nregister is set.  \nIf Bit 19 (SEQERR) in the MASK1  register is set to 1 and a \nphase sequence error event is triggered, the  IRQ1  interrupt pin \nis driven low. The status bit is cleared and the IRQ1  pin is  set \nhigh by writing  to the STATUS1 register with the Status Bit  19 \n(SEQERR ) set to 1.  \nThe phase sequence error detection circuit is functional only when the  ADE78xx  is connected  in a 3 -phase , 4-wire, three  voltage \nsensors configuration ( Bits[5:4] , CONSEL[1:0] in the ACCMODE  \nregister , set to 00).  In all other configurations, only two voltage \nsensors are used ; therefore , it is not recommended to use the \ndetection circuit. In these cases, use the time intervals between \nphase voltages to analyze the phase sequence (see the Time \nInterval Between Phases  section for details).  \nFigure 45 presents the case in which Phase A voltage is not \nfollowed by Phase B voltage  but by Phase C voltage.  Every time \na negative -to-positive zero crossing occurs, Bit 19 (SEQERR) in \nthe STATUS1 register  is set to 1 because such zero crossings  on \nPhase  C, Phase B, or Phase A cann ot come after zero crossings  \nfrom Phase  A, Phase C, or respectively , Phase B zero crossings.  ZX B ZX CPHASE C PHASE B PHASE A\nA, B, C PHASE\nVOLTAGES AFTER\nLPF1\nBIT 19 (SEQERR) IN\nSTATUS1 REGISTER\nIRQ1ZX A\nSTATUS1[19] SET TO 1 STATUS1[19] CANCELLED\nBY A WRITE TO THE\nSTATUS1 REGISTER WITH\nSEQERR BIT SET\n08510-029 \nFigure 45. SEQERR Bit Set to 1 When Phase A Voltage Is Followed by   \nPhase C Voltage  \nOnce a phase sequence error has been detected, the  time \nmeasurement between various phase voltages (see the Time \nInterval Between Phases  section) can help to identify which \nphase voltage should be considered with another phase current \nin the computational datapath . Bits[9:8] (VTOIA[1:0]), Bits[11: 10] \n(VTOIB[1:0] ), and Bits[ 13:12]  (VTOIC[1:0]) in the CONFIG  \nregister can be used to direct one phase voltage to the datapath \nof another phase. S ee the Changing Phase Voltage Datapa th \nsection for details. \nTime Interval Between Phases  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have the capa -\nbility to measure the time delay between phase voltages, between  \nphase currents , or between voltages and currents of the same \nphase. The negative -to-positive  transitions id entified by the zero -\ncrossing detection circuit are used as start and stop measuring \npoints . Only one set of such measurements is available at one time, \nbased on B its[10:9] (ANGLESEL[1:0]) in  the COMPMODE \nregister.   \nZX C ZX BPHASE B PHASE C PHASE  A\nZX A\n08510-030 \nFigure 46. Regular Succession of Phase  A, Phase B, and Phase C  \nWhen the ANGLESEL[1:0] bits are set to 00, the default value, \nthe delays between voltages and currents on the same phase are \nmeasured. The delay between Phase A voltage and Phase A \ncurrent is stored in the  16-bit unsigned ANGLE0 register ( see \nFigure 47 for details). In a similar way, the delays between voltages  \nand currents on Phase B and Phase C are stored in the ANGLE1 \nand ANGLE2 registers , respectively . \nRev. H | Page 35 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nPHASE  A\nCURRENT\nANGLE0PHASE  A\nVOLTAGE\n08510-031 \nFigure 47. Delay Between Phase A Voltage and Phase A Current Is  \nStored in the ANGLE0  Register  \nWhen the ANGLESEL[1:0] bits are set to 01, the delays between \nphase voltages are measured. The delay between Phase A voltage  \nand Phase C voltag e is stored into  the ANGLE0  register . The \ndelay between Phase B voltage and Phase C voltage is stored in \nthe ANGLE1 register , and the delay between Phase A voltage \nand Phase B voltage is stored in  the ANGLE2 register (see \nFigure 48 for details). \nWhen  the ANGLESEL[1:0] bits are set to 10, the delays between \nphase currents are measured. Similar to delays between phase \nvoltag es, the delay between Phase A and Phase C currents is stored  \ninto the ANGLE0 register, the dela y between Phase  B and Phase  C \ncurrents i s stored in  the ANGLE1 register , and the delay between  \nPhase A and Phase B currents is stored into the ANGLE2 \nregister (see Figure 48 for details). \nPHASE B PHASE C PHASE  A\nANGLE2\nANGLE0ANGLE1\n08510-032 \nFigure 48. Delays Between Phase Voltages (Currents)  \nThe ANGLE0, ANGLE1 , and ANGLE2 registers are 16 -bit \nunsigned registers with 1  LSB corresponding to 3.90625 μs \n(256 kHz clock), which means a resolution of  0.0703° (360°  × \n50 Hz/256 kHz) for 50  Hz system s and 0.0843 ° (360°  × 60 Hz/ \n256 kHz) for 60  Hz systems. The delays between phase voltages \nor phase currents are used to characterize how balanced the \nload is. The delays between phase voltages and currents are \nused to compute the power factor on each phas e as shown in \nthe following Equation 5 : \ncosφx = cos\n\uf8fa\uf8fa\n\uf8fb\uf8f9\n\uf8ef\uf8ef\n\uf8f0\uf8ee ××kHz256360LINEfANGLEx\uf06f\n (5) \nwhere fLINE = 50 Hz or 60  Hz. \nPeriod Measurement  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 provide  the \nperiod measurement of the line in the voltage channel. Bits [1:0] \n(PERSEL[1:0]) in the MMODE register select the phase voltage \nused for this measurement. The period  register is a 16 -bit \nunsigned register and  update s every line period. Because of the LPF1 filter (see Figure 43), a settling time of 30  ms to 40 ms is \nassociated with this filter before the mea surement is stable.  \nThe period measurement has a resolution of 3.9 0625 μs/LSB \n(256 k Hz clock), which represents 0.0195% (50 Hz/256 kHz) \nwhen the line fre quency is 50 Hz  and 0.0234% (60 Hz/256 kHz) \nwhen t he line frequency is 60  Hz. The value of the period register \nfor 50  Hz networks  is approximately 5120 (256 kHz/50  Hz) and \nfor 60 Hz networks is approximately 4267 (256 kHz/60  Hz). The \nlength of the register enables  the measurement of line frequencies  \nas low as 3.9 Hz (256  kHz/216). The period register is stable at \n±1 LSB when the line is established and the measurement does \nnot change.  \nThe following expressions can  be used to compute the line \nperiod and frequency using the  period  register:  \n[]sec3E2561+=0] PERIOD[15:TL  (6) \n]Hz[13E256\n+=0] PERIOD[15:fL  (7) \nPhase Voltage  Sag Detection  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 can be pro -\ngrammed to detect when the abs olute value of any phase voltage \ndrops below a certain peak value for a number of half- line cycles. \nThe phase where this event t akes place is identified in B its[14:12] \n(VSPHASE[ x]) of the PHSTATUS register. This condition is \nillustrated in Figure 49. \nPHASEA VOLTAGE\nBIT 16 (SAG) IN\nSTATUS1[31:0]\nVSPHASE[0] =\nPHSTATUS[12]IRQ1 PINFULL SCALE\nSAGLVL[23:0]\nFULL SCALE\nSAGLVL[23:0]SAGCYC[7:0]= 0x4PHASE B VOLTAGE\nVSPHASE[1] =\nPHSTATUS[13]STATUS[16]AND\nPHSTATUS[13]\nSETTO1\n08510-033STATUS1[16]AND\nPHSTATUS[12]\nCANCE LLED B YA\nWRITETO\nSTATUS1[31:0]\nWITH SAG BITSET SAGCYC[7:0]= 0x4\n \nFigure 49. SAG Detection  \nRev. H | Page  36 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nFigure 49 shows Phase A voltage falling below a threshold that \nis set i n the  SAG level register (SAGLVL) for four half -line c ycles \n(SAGCYC  = 4). When Bit 16 ( SAG ) in the STATUS1 register is set \nto 1 to indicate the con dition, Bit VSPHASE[0] in the PHSTATUS  \nregister is also set to 1 because the event happened on P hase A \nBit 16 (SAG ) in the  STATUS1  register. A ll Bits[ 14:12] (VSPHA SE[2] , \nVSPHASE[1], and VSPHASE[0] ) of the PHSTATUS  register (n ot \njust the  VSPHASE[0]  bit) are erased by writing the STATUS1 \nregister with the SAG bit set to 1.  \nThe SAGCYC register represents the number of half -line cycles \nthe p hase voltage must remain bel ow the level indicated in the \nSAGLVL register to trigger a  SAG condition ; 0 is not  a valid \nnumber for SAGCYC. For example, when the  SAG cycle \n(SAGCYC[7:0])  contains 0x07, the  SAG  flag in the STATUS1 \nregister is set at the end of the seventh half line cycle  for which \nthe line voltage falls below the threshold. If B it 16 (SAG ) in \nMASK1  is set, the IRQ1  interrupt pin is driven low in case of  \na SAG event in the same moment the Status Bit 16 ( SAG ) in \nSTATUS1 register is set to 1. The  SAG statu s bit in the STATUS1 \nregister and all B its[14:12] (VSPHASE[2], VSPHASE[1], and \nVSPHASE[0] ]) of the PHSTATUS register are cleared , and the \nIRQ1  pin is returned to  high by writing to the STATUS1 \nregister  with the status bit set to 1.  \nWhen the Phase B voltage falls below the indicated threshold \ninto the SAGLVL register for two line cycles, B it VSPHASE[1] \nin the PHSTATUS  register is set to 1 , and Bit VSPHASE[0]  is \ncleared to 0 . Simultaneously , Bit 16 ( SAG ) in the STATUS1 register  \nis set to 1 to indicate the condition.  \nNote that the internal zero -crossing counter is always active. By \nsetting the SAGLVL register, the first SAG detection result is, \ntherefore, not executed  across a full SAGCYC period. Writing to  \nthe SAGCYC register when the SAGLV L register  is already initia-\nlized resets the zero -crossing counter, thus ensuring that the first \nSAG detection result is obtained across a full SAGCYC period.  \nThe recommended procedure to manage  SAG events is the \nfollowing:  \n1. Enable  SAG interrupts in the MASK1 register by setting \nBit 16 (SAG ) to 1.  \n2. When a  SAG event happens, the IRQ1  interrupt pin goes \nlow and Bit 16 ( SAG ) in the STATUS1  is set to 1 . \n3. The STATUS1 register is read with Bit 16 ( SAG ) set to 1.  \n4. The PHSTATUS  register  is read, iden tifying on which \nphase or phases a SAG event happened.  \n5. The STATUS1 register  is written with B it 16 ( SAG ) set to 1. \nImmediately , the SAG bit and all Bits[ 14:12] (VSPHASE[ 2], \nVSPHASE[1], and VSPHASE[0] ) of the PHSTATUS register \nare erased . \nSAG Level Set  \nThe conten t of the SAGLVL[23:0]  SAG level register is compared \nto the absolute value of the output from HPF. Writing 5,928,256 \n(0x5A7540)  to the SAGLVL register, puts the SAG detection \nlevel at full scale  (see the Volta ge Channel  ADC section) , thus ; the SAG event is triggered continuously. Writing 0x00 or 0x01 \nputs the  SAG detection level at 0, therefore,  the SAG event is \nnever triggered.  \nAs stated  in the  Current Waveform Gain Registers  section , the \nserial ports of  the ADE78xx  work  on 32 -, 16-, or 8-bit words. \nSimilar to the register presented in  Figure 36, the SAGLVL \nregister is accessed as a 32-bit register  with  eight  MSBs  padded \nwith 0s.   \nPeak Detection  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 record  the \nmaximum absolute values reached by the voltage and current \nchannel s over a certain number of half -line cycles and stores \nthem into the less significant 24 bits of the VPEAK and IPEAK \n32-bit registers.  \nThe PEAKCYC register contains the number of half -line cycles \nused as a time base for the measurement. The circuit  uses the \nzero-crossing points identified by the zero -crossing detection  \ncircuit. Bits [4:2] (PEAKSEL[2:0]) in the MMODE register select \nthe phases upon which the peak measurement is performed . Bit 2 \nselects Phase A, B it 3 selects Phase B , and Bit 4 selects Phase C. \nSelecting more than one phase to monitor the peak values \ndecre ases proportionally the measurement period indicated in \nthe PEAKCYC  register because zero crossings from more \nphase s are involved in the process. When a new peak value is \ndetermined, one of Bits[26:24] (IPPHASE[2:0] or VPPHASE[2:0])  \nin the IPEAK and VPEAK  registers is set to 1 , identifying the \nphase that triggered the peak detection  event . For example, if a \npeak value has been identified on Phase A current , Bit 24 \n(IPPHASE[0]) in the IPEAK register is set to 1. If next time a \nnew peak value is measured on Phase B, B it 24 (IPPHASE[0])  \nof the IPEAK register is cleared to 0 , and Bit 25 (IPPHASE[1]) \nof the IPEAK register is set to 1. Figure 50  shows  the composition \nof the IPEAK and VPEAK registers.  \nPEAK DETECTED\nON PHASE C0000031 2726252423 0\n24 BIT UNSIGNED NUMBER\nPEAK DETECTED\nON PHASE  AIPPHASE/VPPHASE BITS\nPEAK DETECTED\nON PHASE B\n08510-034  \nFigure 50. Composition of IPEAK[31:0] and VPEAK[31:0] Registers  \nRev. H | Page 37 of 100 \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 38 of 100 PHASE A\nCURRENT\nPHASE B\nCURRENTBIT 24\nOF IPEAK\nBIT 25\nOF IPEAKPEAK VALUE WRITTEN INT O\nIPEAK AT THE END OF FIRST\nPEAKCYC PERIOD\nEND OF FIRST\nPEAKCYC = 16 PERIOD\nBIT 24 OF IPEAK\nCLEARED TO 0 ATTHE END OF SECONDPEAKCYC PERIOD\nBIT 25 OF IPEAKSET TO 1 AT THEEND OF SECONDPEAKCYC PERIODEND OF SECONDPEAKCYC = 16 PERIOD\nPEAK VALUE WRITTEN INTO\nIPEAK AT THE END OF SECONDPEAKCYC PERIOD\n08510-035 \nFigure 51. Peak Level Detection \nFigure 51 shows how the ADE78xx  records the peak value on the \ncurrent channel when measurements on Phase A and Phase B are \nenabled (Bit PEAKSEL[2:0] in the MMODE register are 011). PEAKCYC is set to 16, meaning that the peak measurement cycle is four line periods. The maximum absolute value of Phase A is the greatest during the first four line periods (PEAKCYC = 16), \nso the maximum absolute value is written into the less signifi-\ncant 24 bits of the IPEAK register, and Bit 24 (IPPHASE[0]) of the IPEAK register is set to 1 at the end of the period. This bit remains at 1 for the duration of the second PEAKCYC period of four line cycles. The maximum absolute value of Phase B is the greatest during the second PEAKCYC period; therefore, the \nmaximum absolute value is written into the less significant \n24 bits of the IPEAK register, and Bit 25 (IPPHASE[1]) in the \nIPEAK register is set to 1 at the end of the period. \nAt the end of the peak detection period in the current channel, \nBit 23 (PKI) in the STATUS1 register is set to 1. If Bit 23 (PKI) \nin the MASK1 register is set, the IRQ1\n interrupt pin is driven low \nat the end of PEAKCYC period and Status Bit 23 (PKI) in the \nSTATUS1 register is set to 1. In a similar way, at the end of the peak detection period in the voltage channel, Bit 24 (PKV) in the \nSTATUS1 register is set to 1. If Bit 24 (PKV) in the MASK1 \nregister is set, the IRQ1\n interrupt pin is driven low at the end of \nPEAKCYC period and Status Bit 24 (PKV) in the STATUS1 \nregister is set to 1. To find the phase that triggered the interrupt, one of either the IPEAK or VPEAK registers is read immediately after reading the STATUS1 register. Next, the status bits are \ncleared, and the IRQ1\n pin is set to high by writing to the \nSTATUS1 register with the status bit set to 1.  \nNote that the internal zero-crossing counter is always active. By \nsetting Bits[4:2] (PEAKSEL[2:0]) in the MMODE register, the \nfirst peak detection result is, therefore, not executed across a full \nPEAKCYC period. Writing to the PEAKCYC register when the PEAKSEL[2:0] bits are set resets the zero-crossing counter, thereby ensuring that the first peak detection result is obtained \nacross a full PEAKCYC period. \nOvervoltage and Overcurrent Detection \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 detect when the \ninstantaneous absolute value measured on the voltage and \ncurrent channels becomes greater than the thresholds set in the OVLVL and OILVL 24-bit unsigned registers. If Bit 18 (OV) in \nthe MASK1 register is set, the IRQ1\n interrupt pin is driven low \nin case of an overvoltage event. There are two status flags set when the IRQ1\n interrupt pin is driven low: Bit 18 (OV) in the \nSTATUS1 register and one of Bits[11:9] (OVPHASE[2:0]) in the \nPHSTATUS register to identify the phase that generated the overvoltage. The Status Bit 18 (OV) in the STATUS1 register \nand all Bits[11:9] (OVPHASE[2:0]) in the PHSTATUS register \nare cleared, and the IRQ1\n pin is set to high by writing to the \nSTATUS1 register with the status bit set to 1. Figure 52 presents \novervoltage detection in Phase A voltage. \nOVLVL[23:0]\nBIT 18 (OV) OF\nSTATUS1\nBIT 9 (OVPHASE)\nOF PHSTATUSPHASE A\nVOLTAGE CHANNELOVERVOLTAGE\nDETECTED\nSTATUS1[18] AND\nPHSTATUS[9]\nCANCELLED BY A\nWRITE OF STATUS1\nWITH OV BIT SET.\n08510-036 \nFigure 52. Overvoltage Detection \nWhenever the absolute instantaneous value of the voltage goes \nabove the threshold from the OVLVL register, Bit 18 (OV) in the STATUS1 register and Bit 9 (OVPHASE[0]) in the PHSTATUS register are set to 1. Bit 18 (OV) of the STATUS1 register and \nBit 9 (OVPHASE[0]) in the PHSTATUS register are cancelled \nwhen the STATUS1 register is written with Bit 18 (OV) set to 1.  \nThe recommended procedure to manage overvoltage events is \nthe following: \n1. Enable OV interrupts in the MASK1 register by setting \nBit 18 (OV) to 1. \n2. When an overvoltage event happens, the IRQ1\n interrupt \npin goes low. \n3. The STATUS1 register is read with Bit 18 (OV) set to 1. \n4. The PHSTATUS register is read, identifying on which \nphase or phases an overvoltage event happened. \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \n5. The STATUS1 register is written with B it 18 (OV) set to 1. \nIn this moment, B it OV is e rased and also all B its[11:9] \n(OVPHASE[2:0]) of the PHSTATUS register.  \nIn case of an overcurrent event, if B it 17 (OI) in the MASK1  \nregister is set, the IRQ1  interrupt pin is driven low. Immediately ,  \nBit 17 (OI) in the STATUS1 register a nd one of Bits[5:3] \n(OIPHASE[2:0]) in the PHSTATUS register , which identify  \nthe phase that generated the interrupt, are set. To f ind t he  \nphase that triggered the interrupt,  the PHSTATUS register \nis read immediately after reading the STATUS1 register . Next, \nStatus Bit  17 (OI) in the STATUS1 register and Bits[5:3] \n(OIPHASE[2:0]) in the PHSTATUS register are cleared and the \nIRQ1  pin is set to high by writing to the STATUS1 register with \nthe status bit set to 1. The process is similar with o vervoltage \ndetection.  \nOvervoltage and Overcurrent Level Set \nThe content of the overvoltage (OVLVL ), and overcurrent , \n(OILVL ) 24-bit unsigned registers is compared to the absolute \nvalue of the voltage and current channels. The maximum  value of \nthese registers is the maximum value of the HPF outputs:  \n+5,928,256 (0x5A7540) . When the OVLVL or OILVL register is  \nequal to this value, the overvoltage or overcurrent conditions \nare never  detected. Writing 0x0 to these registers signifies the \novervoltage or overcurren t conditions are continuously detected , \nand the corresponding interrupts are permanently triggered.  \nAs stated  in the Current Waveform Gain Registers  section,  the \nserial ports of  the ADE78xx  work on  32-, 16-, or 8-bit words. \nSimilar to the register presented in  Figure 36, OILVL and \nOVLVL registers are  accessed as 32- bit registers with the eight  \nMSBs  padded with 0s.  \nNeutral Current Mismatc h—ADE7868, ADE7878 \nNeutral current mismatch is available in the ADE7868 and \nADE7878 only. In 3-phase systems, the neutral current is equal \nto the algebraic sum of the p hase currents  \nIN(t) = I A(t) + IB(t) + I C(t) \nIf there is a mismatch between these two quantities, then a \ntamper situation may have occurred in the system.  \nThe ADE7868/ ADE7878 compute  the sum of the phase \ncurrents adding the content of the IAWV , IBWV , and ICWV \nregiste rs, and storing the result into the ISUM 28 -bit signed \nregister: I SUM(t) = I A(t) + I B(t) + I C(t). ISUM is computed every \n125 µs (8  kHz frequency), the rate at which the current samples \nare available , and B it 17 (DREADY) in the STATUS0  register is \nused to s ignal when the ISUM register can  be read. See the \nDigital Signal Processor  section  for more details on B it DREADY .  \nTo recover I SUM(t) value from the ISUM register, use the \nfollowing expression:  \nFS\nMAXSUM IADCISUM[27:0]t I × =)(  \nwhere:  ADC MAX = 5,928,256, the ADC output when the input is at full \nscale . \nIFS is the full -scale ADC phase current.  \nThe ADE7868/ ADE7878 compute  the difference between the \nabsolute values of ISUM and the neutral current from the \nINWV register, take  its absolute v alue and compare  it against \nthe ISUMLVL threshold. If ISUMLVL INWV ISUM ≤ − , \nthen it is assumed that the neutral current is equal to the sum  \nof the phase currents , and the system functions correctly. If \nISUMLVL INWV ISUM > − , then a tamper situation m ay \nhave occ urred , and Bit 20 (MISMTCH) in the STATUS1 register  \nis set to 1. An interrupt attached to the flag can  be enabled by \nsetting Bit 20 (MISMTCH) in the MASK1  register. If enabled, \nthe IRQ1  pin is set low when Status B it MISMTCH is  set to 1. \nThe status bit is cleared and  the IRQ1  pin is set back to high by \nwriting to the STATUS1 register with Bit 20 (MISMTCH) set to 1.  \nIf ISUMLVL INWV ISUM ≤ − , then MISMTCH  = 0 \nIf ISUMLVL INWV ISUM > − , then MISMTCH  = 1 \nISUMLVL , the positive threshold used in the process, is a 24 -bit \nsigned register. Because  it is used in a comparison with an \nabsolute value, always set ISUMLVL  as a positive number, \nsomewhere  between 0x00000 and 0x7FFFFF. ISUMLVL uses \nthe same scale of the curren t ADCs outputs, so writing \n+5,928,256 (0x5A7540) to the ISUMLVL register puts the \nmismatch detection level at full scale ; see the Current Channel  \nADC section for details . Writing 0x000000, the default value, or \na negative value, signifies the MISMTCH  event is always triggered. \nThe right value for the application should be written into the ISUMLVL  register after power -up or after a hardware/software \nreset to avoid continuously triggering MISMTCH events.  \nAs stated  in the Current Waveform Gain Registers  section , the \nserial ports of the ADE7868/ ADE7878 work  on 32 -, 16-, or 8-bit \nwords and the DSP works on 28 bits. As presented  in Figure 53, \nISUM , the  28-bit signed register , is accessed as a 32 -bit register \nwith the four  most significant bit s padded with 0s.  \n31 2827\nBIT 27 IS A SIGN BIT0\n28-BIT SIGNED NUMBER 0000\n08510-250\n \nFigure 53. The ISUM[27:0] Register  is Transmitted A s a 32- Bit W ord  \nSimilar to the registers presented in Figure 35 , the ISUMLVL \nregister is accessed as a 32 -bit register  with four most significant \nbits padded with 0s and sign extended to 28 bits.  \nPHASE COMPENSATION  \nAs described in the Current Channel  ADC  and Voltage Channel  \nADC sections , the datapath for both current and voltages is the \nsame. The phase error between current and voltage signals introduced by  the ADE7854/ ADE7858/ ADE 7868/ ADE7878  \nis negligible. However,  the ADE7854/ ADE7858 /ADE7868/  \nADE7878 must work with transducers that may have inherent \nRev. H | Page 39 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nphase errors. For example,  a current transformer (CT) with a \nphase error of 0.1° to 3° is not uncommon. These phase errors \ncan vary from part to part, and they must be corrected to \nperform accurate power calculations.  \nThe errors associated with phase mismatch are particularly \nnoticeable at low power factors. The  ADE78xx  provide s a means  \nof digitally calibrating these small phase errors. The ADE78xx  \nallow s a small time delay or time advance to be introduced into \nthe signal processing chain to compensate for the small phase \nerrors.  \nThe phase calibration registers (APHCAL, BPHCAL, and \nCPHCAL)  are 10 -bit registers that can vary the t ime advance \nin the v oltage channel signal path from  −374.0 µs  to +61.5 μs . \nNegative values written to the PHCAL registers represent a time advance  whereas  positive values r epresent a time delay. One LSB  \nis equivalent to 0.976 µs of time delay or time advance (clock \nrate of 1.024 MHz). With a line frequency  of 60 Hz, this gives \na phase resolution of 0.0211° (360° × 60 Hz/1.024 MHz) at  the \nfundamental. This corresponds to a total correction range of \n−8.079° to +1.329° at 60 Hz. At 50  Hz, the correction range is  \n−6.732° to +1.107° and the resolution is 0.0176°  (360° × 50 Hz/ \n1.024 MHz) . \nGiven a phase error of x degrees , measured using the phase \nvoltage as the reference, the corresponding LSBs are computed \ndividing x by the phase resolution (0.0211°/LSB for 60 Hz and \n0.0176°/LSB for 50 Hz). Results between − 383 and +63 only are acceptable ; numbers outside this range are not accepted. If the \ncurrent leads the voltage, the result is negative and  the absolute \nvalue is written into the PHCAL registers. If the current lags  \nthe voltage, the result is positive and 512 is added to the result \nbefore writing it into xPHCAL.  \nAPHCAL , \nBPHCAL , or \nCPHCAL  =   \n\uf8f4\uf8f4\n\uf8fe\uf8f4\uf8f4\n\uf8fd\uf8fc\n\uf8f4\uf8f4\n\uf8f3\uf8f4\uf8f4\n\uf8f2\uf8f1\n>+≤\n0 ,512_0 ,_\nxresolution phasexxresolution phasex\n (8) \nFigure 55  illustrates how the phase compensation is used to remove \nx = −1° phase lead in IA of the current channel from the external  \ncurrent transducer (equivalent of 55.5  µs for 50  Hz systems). To \ncancel the lead (1°) in the current channel of Phase  A, a phase \nlead mu st be introduced into the corresponding voltage channel.  \nUsing Equation 8, APHCAL is 57  least significant bits , rounded \nup from 56.8. The phase lead is achieved by introducing a time \ndelay of 55.73 µs into the Phase A current.  \nAs stated  in the Current Waveform Gain Regis ters section , the \nserial ports of  the ADE78xx  work on  32-, 16-, or 8-bit words.  \nAs shown  in Figure 54, APHCAL, BPHCAL , and CPHCAL  \n10-bit registers are accessed as 16 -bit registers with the six  MSBs  \npadded with 0s.  \n0000 0015 109 0\nxPHCA L\n08510-038  \nFigure 54. xPHCAL Registers Communicated As 16 -Bit Regist ers \n \nPHASE\nCALIBR ATION\nAPHCA L = 57\nADC PGA3VAP\nVA\nVNADC PGA1IAP\nIA\nIAN\nPHASE COMPENS ATION\nACHIEVED DEL AYING\nIA BY 56µs\n50Hz1°\nVAIA\nVAIA\n08510-039 \nFigure 55. Phase Calibration on Voltage Channels  \n \nRev. H | Page  40 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nREFERE NCE CIRCUIT  \nThe nominal reference voltage at the REF IN/OUT  pin is 1.2 V . This \nis the reference voltage for the ADCs in the ADE7854/ \nADE7858/ ADE78 68/ADE7878. Use a typical external reference \nvoltage of 1.2 V to overdrive the REF IN/OUT  pin. The temperature \ncoefficient of the in ternal voltage reference is calculated based \non the endpoint method. To calculate the drift over \ntemperature, the values of the voltage reference at endpoints (−40 °C and +85°C) are measured and compared to the \nreference value at 25°C , which in turn provide s the slope of the \ntemperature coefficient curve. Figure 56 is a typical \nrepresentation of the drift over temperature.  It contains two \ncurves: Curve X and Curve Y , which are typical representations \nof two possible curvatures that are observed over the entire \nspecified temperature range.  \n+85°C+25°C\n–40°CCURVE Y\nCURVE X+85°C –40°C\nC' A'REFERENCE VOLTAGE\nTEMPERATURE (°C)AB\nC\n08510-555 \nFigure 56. Internal Voltage Reference Temperature Drift  \nFigure 56 shows that independent consideration of two reg ions \nis necessary for accurate analysis of the drift over temperature, \nas follows: \n• Considering the region between Point A and Point B  in \nCurve X , the reference value increases with an increase in \ntemperature; thus, the curve has a positive slope from A to \nB. This results in a positive temperature coefficient in this \nregion.   \n• Considering the region between Point B and Point C  in \nCurve X , the slope of the curve is negative because the \nvoltage reference decreases with an increase in \ntemperature; thus, this reg ion of the curve has a negative \ntemperature coefficient.  \n• Based on similar logic, Curve Y has a negative temperature \ncoefficient between Point A ’ and PointB  and a positive \ntemperature coefficient between Point B and PointC ’. The drift curve on any particu lar IC can be matched with either \nof these sample curves. The general relationship between the \nabsolute value of the voltage reference at a particular endpoint \ntemperature and the temperature coefficient for that region of \nthe curve is explained by the fol lowing two equations:  \nVREF (−40°C) = VREF (+25°C)  × ( )\uf8f7\uf8f8\uf8f6\uf8ec\uf8ed\uf8eb °−°−α+610C25C401c \nVREF ( 85°C) = VREF (25°C) × ( )\uf8f7\n\uf8f8\uf8f6\uf8ec\n\uf8ed\uf8eb °−°α+610C25C851h \nwhere αc and αh are cold and hot temperature coefficients, \nrespectively, calculated by  \n( )C25C40  \nC)25(C)25( C)40(\n°−°−−\n=α°+°+ °−\nREFREF REF\ncVV V\n× 106 ppm/°C  \n( )C25C85  \nC) (25C) (25 C)85(\n°−°−\n=α°° °\nREFREF REF\nhVV V\n× 106 ppm/°C  \nAs the sign of cold and hot temperature co efficients  can vary \nfrom one IC to another, the typical drift is specified for the \nwhole range with a plus -minus sign( ±). To find the typical , \nminimum  and maximum temperature coefficients , as listed in \nthe Specifications  section, data based on the end -point method \nis collected on ICs spread out over different lots. The minimum and maximum temperature coefficents denote that the drift of \nany particu lar IC will be within those limits , over the specified \ntemperature range, with reference to 25 °C. See Figure  57 and \nFigure 58 for the device -to-device variation of the drif t.  \n08510-256NUMBER OF PARTS\nCOLD TEMPERATURE COEFFICIENT (ppm/°C)–50–45–40–35–30 –5–20–15–10 –5 05101520253035404550\n \nFigure  57. Histogram of the Reference Drift from −40°C to +25°C \nRev. H | Page 41 of 100 \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 42 of 100 \n08510-257NUMBER OF PARTS\nHOT TEMPERATURE COEFFICIENT (ppm/°C)–50 –45 –40 –35 –30 –5 –20 –15 –10 –5 0 5 10 15 20 25 30 35 40 45 50\n \nFigure 58. Histogram of the Reference Drift from 25°C to 85°C \nBecause the reference is used for all ADCs, any x% drift in the \nreference results in a 2x% deviation of the meter accuracy. The \nreference drift resulting from temperature changes is usually very \nsmall and, typically, much smaller than the drift of other \ncomponents on a meter.  \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878  use the internal \nvoltage reference when Bit 0 (EXTREFEN) in the CONFIG2 \nregister is cleared to 0 (the default value); the external voltage reference is used when the bit is set to 1. Set the CONFIG2 register \nduring the PSM0 mode; its value is maintained during the PSM1, \nPSM2, and PSM3 power modes. \nDIGITAL SIGNAL PROCESSOR \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 contain a fixed \nfunction digital signal processor (DSP) that computes all powers \nand rms values. It contains program memory ROM and data \nmemory RAM.  \nThe program used for the power and rms computations is \nstored in the program memory ROM and the processor executes  it every 8 kHz. The end of the computations is signaled by \nsetting Bit 17 (DREADY) to 1 in the STATUS0 register. An \ninterrupt attached to this flag can be enabled by setting Bit 17 \n(DREADY) in the MASK0 register. If enabled, the IRQ0\n pin is \nset low and Status Bit DREADY is set to 1 at the end of the computations. The status bit is cleared and the IRQ0\n pin is set \nto high by writing to the STATUS0 register with Bit 17 (DREADY) \nset to 1. \nThe registers used by the DSP are located in the data memory \nRAM, at addresses between 0x4380 and 0x43BE. The width of this memory is 28 bits. Within the DSP core, the DSP contains a \ntwo stage pipeline. This means that when a single register needs \nto be initialized, two more writes are required to ensure the value has been written into RAM, and if two or more registers need to be initialized, the last register must be written two more \ntimes to ensure the value has been written into RAM.  \nAs explained in the Power-Up Procedure section, at power-up \nor after a hardware or software reset, the DSP is in idle mode. \nNo instruction is executed. All the registers located in the data memory RAM are initialized at 0, their default values, and they \ncan be read/written without any restriction. The run register, used to start and stop the DSP , is cleared to 0x0000. The run register needs to be written with 0x0001 for the DSP to start code execution.  \nTo protect the integrity of the data stored in the data memory \nRAM of the DSP (addresses between 0x4380 and 0x43BE),  \na write protection mechanism is available. By default, the protection is disabled and registers placed between 0x4380 and 0x43BE can be written without restriction. When the protection is enabled, no writes to these registers is allowed. Registers can \nbe always read, without restriction, independent of the write \nprotection state.  \nTo enable the protection, write 0xAD to an internal 8-bit \nregister located at Address 0xE7FE, followed by a write of 0x80 \nto an internal 8-bit register located at Address 0xE7E3.  \nIt is recommended to enable the write protection after the \nregisters have been initialized. If any data memory RAM based register needs to be changed, simply disable the protection, change the value and then re-enable the protection. There is  no need to stop the DSP to change these registers. \nTo disable the protection, write 0xAD to an internal 8-bit \nregister located at Address 0xE7FE, followed by a write of 0x00 \nto an internal 8-bit register located at Address 0xE7E3.  \nThe recommended procedure to initialize the ADE7854 / \nADE7858 /ADE7868 /ADE7878 registers at power up is as \nfollows: \n\uf0b7 Initialize the AIGAIN, BIGAIN, CIGAIN, and NIGAIN \nregisters. \n\uf0b7 Start the DSP by setting run = 1.  \n\uf0b7 Initialize all the other data memory RAM registers. Write \nthe last register in the queue three times to ensure its  value was written into the RAM. Initialize all of the other ADE7854 /ADE7858 /ADE7868 /ADE7878 registers with the \nexception of the CFMODE register. \n\uf0b7 Read the energy registers xW ATTHR, xFW ATTHR, \nxV ARHR, xFV ARHR, and xV AHR to erase their content \nand start energy accumulation from a known state. \n\uf0b7  Clear Bit 9 (CF1DIS), Bit 10 (CF2DIS), and Bit 11 \n(CF3DIS) in the CFMODE register to enable pulses at  the CF1, CF2, and CF3 pins. Do this initialization last,  so no spurious pulses are generated while the ADE7854 / \nADE7858 /ADE7868 /ADE7878 are initialized. \n\uf0b7 Enable the write protection by writing 0xAD to an internal 8-bit register located at Address 0xE7FE, followed by a write of 0x80 to an internal 8-bit register located at Address 0xE7E3. \n\uf0b7 Read back all data memory RAM registers to ensure they were initialized with the desired values.  \n\uf0b7 In the remote case that one or more registers are not initia-\nlized correctly, disable the protection by writing 0xAD to \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nan internal 8 -bit register located at Address  0xE7FE,  followed \nby a write of 0x00 to an internal 8 -bit register located at \nAddress  0xE7E3. Reinitialize the registers. Write the last \nregister in the queue three times. Enable the write protec -\ntion by writing 0xAD to an internal 8 -bit register located \nat Address 0xE7FE, foll owed by a write of 0x80 to an internal \n8-bit reg ister located at Address 0xE7E3 . \nThere is no obvious reason to stop the DSP if the ADE78xx  is \nmaintained in PSM0 normal mode. All ADE78xx  registers, \nincluding ones located in the data memory RAM, can be \nmodified without stopping the DSP . However, to stop the DSP , \n0x0000 has to be written into run register. To restart the DSP , \none of the following procedures must be followed:  \n• If the ADE7854 /ADE7858/ ADE7868/ ADE7878 registers \nlocated in the data memory RAM have not been modified, \nwrite 0x0001 into the run register to start the DSP .  \n• If the ADE7854 /ADE7858/ ADE7868/ ADE7878 registers \nlocated in the dat a memory RAM have to be modified, first \nexecute a software or a hardware reset, and then follow the \nrecommended procedure to initialize the registers at power up.  \nAs mentioned in the Power Management  section, when  the \nADE7854/ ADE7858/ ADE7868 /ADE7878 switch out of PSM0 \npower mode, it is recommended  to stop the DSP by writing \n0x0000 into the run register (see Figure 11 and Table 12 for \nthe recommended ac tions when changing power modes).  \nROOT MEAN SQUARE MEA SUREMENT  \nRoot mean square (rms) is a measurement of the magnitude of \nan ac signal. Its definition can be both practical and mathemati cal. \nDefined practically, the rms value assigned to an ac signal is t he \namount of dc required to produce an equivalent amount of \npower in the load. Mathematically, the rms value of a conti -\nnuous signal f(t) is defined as  \n()dttftrmsF∫=t\n02 1 (9) \nFor time sampling signals, rms calculation involves squaring the \nsignal, tak ing the average, and obtaining the square root.  \n[]∑\n==N\nNnfNrmsF\n12 1 (10) \nEquation 10 implies that for signals containing harmonics, the \nrms calculation contains the contribution of all harmonics, not \nonly the fundamental.  The ADE78xx  uses two different methods  \nto calcul ate rms values. The first one is very accurate and is active \nonly in PSM0 mode. The second one is less accurate, uses the estimation of the mean absolute value (mav) measurement, is \nactive in PSM0 and PSM1 modes , and is available for the \nADE7868 and ADE7878 only.  \nThe first method is to low- pass filter the square of the input \nsignal (LPF) and take the square root of the result (see Figure 59 ).  ()k\nkk γtωk F tf + =∑∞\n=sin2 )(\n1 (11) \nThen \n()() ∑∑∑\n∞\n≠=∞\n=∞\n=\nγ+ω×γ+ω××++γ+ω −=\nmkmkm k m kkk k\nkk\ntm tk F Ftk F F tf\n1,12\n12 2\nsin sin 2 2)2 2cos( )(\n (12) \nAfter the LPF and the execution of the square root, the rms \nvalue of f(t) is obtained  by \n∑∞\n==\n12\nkkF F  (13) \nThe rms calculation based on this method is simultaneously \nprocessed on all  seven analog input channels. Each result is \navailable in the 24-bit registers : AIRMS, BIRMS, CIRMS, \nAVRMS, BVRMS , CVRMS , and NIRMS  (NIRMS is available \non the ADE7868 and ADE7878  only) .  \nThe second  method computes the absolute value of the input \nsigna l and then filters it to extract its dc component. It computes  \nthe absolute mean value of the i nput. If the input signal in \nEquation 12 has a fundamental component  only, its average \nvalue is  \n\uf8fa\uf8fa\uf8fa\n\uf8fb\uf8f9\n\uf8ef\uf8ef\uf8ef\n\uf8f0\uf8ee\n××− ××= ∫ ∫T\nT1T\n1 DC dttω F dttω FTF\n22\n0) sin( 2 ) sin( 21 \n1 DC FπF ××= 22 \nThe ca lculation based on this method is simultaneously processed  \nonly on the three phase currents. Each result is available in the \n20-bit registers , which are available on the ADE7868 and \nADE7878 only : AIMAV , BMAV , and CMAV . Note that the \nproportionality between mav and rms values is maintained for \nthe fundamental com ponents  only. If harmonics are present in the \ncurrent chann el, the mean absolute value is no  longer  \nproportional to rms.  \nCurrent  RMS Calculation  \nThis section  presents the first approach to compute the rms \nvalues of all phase and neutral currents.  \nFigure 59 shows the detai l of the signal processing chain for the \nrms calculation on one of the phases of the current channel. The current channel rms value is processed from the samples \nused in the current channel. The current rms values are signed \n24-bit values and they are stor ed into the AIRMS, BIRMS,  CIRMS , \nand NIRMS  (ADE7868/ ADE7878 only)  registers. The update \nrate of the current rms measurement is 8  kHz. \nWith the specified full -scale analog input signal of 0.5 V , the \nADC produces an output code that is approximately ±5, 928,256. \nThe eq uivalent rms value of a full -scale sinusoidal signal is \n4,191, 910 (0x3FF6A6), independent of the line frequency . If \nRev. H | Page 43 of 100 \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 44 of 100 the integrator is enabled, that is, when Bit 0 (INTEN) in the \nCONFIG register is set to 1, the equivalent rms value of a full-scale sinusoidal signal at 50 Hz is 4,191,910 (0x3FF6A6) and at \n60 Hz is 3,493,258 (0x354D8A). \nThe accuracy of the current rms is typically 0.1% error from  \nthe full-scale input down to 1/1000 of the full-scale input when \nPGA = 1. Additionally, this measurement has a bandwidth of \n2 kHz. It is recommended to read the rms registers synchronous \nto the voltage zero crossings to ensure stability. The IRQ1\n inter-\nrupt can be used to indicate when a zero crossing has occurred \n(see the Interrupts section). Table 13 shows the settling time for the I rms measurement, which is the time it takes for the rms register to reflect the value at the input to the current channel \nwhen starting from 0 to full scale. However, during the chip power-up and DSP reset cases, it would typically take about \n1.2 seconds for a FS/1000 signal to be settled.  \nTable 13. Settling Time for I rms Measurement \nIntegrator Status 50 Hz Input signals 60 Hz Input signals \nIntegrator Off 440 ms 440 ms \nIntegrator On 550 ms 500 ms \nAs stated in the Current Waveform Gain Registers section, the \nserial ports of the ADE78xx  work on 32-, 16-, or 8-bit words. \nSimilar to the register presented in Figure 36, the AIRMS, BIRMS, CIRMS, and NIRMS ( ADE7868  and ADE7878 only) \n24-bit signed registers are accessed as 32-bit registers with the eight MSBs padded with 0s. \n0xA58AC0 =\n–5,928,2560x5A7540 =\n5,928,256\n0VCURRENT SIGNAL FROM\nHPF OR INTEGRATOR\n(IF ENABLED) LPFx2 √27xIRMSOS[23:0]\nxIRMS[23:0]\n08510-040 \nFigure 59. Current RMS Signal Processing \n \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 45 of 100 Current RMS Offset Compensation \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 incorporate a \ncurrent rms offset compensation register for each phase: \nAIRMSOS, BIRMSOS, CIRMSOS registers, and the NIRMSOS \nregister for ADE7868  and ADE7878 only. These are 24-bit \nsigned registers that are used to remove offsets in the current rms calculations. An offset can exist in the rms calculation due to input noises that are integrated in the dc component of I\n2(t). \nThe current rms offset register is multiplied by 128 and added to the squared current rms before the square root is executed. Assuming that the maximum value from the current rms calculation is 4,191,910 with full-scale ac inputs (50 Hz), one LSB of \nthe current rms offset represents 0.00037% ((\n128 41912\uf02b /4191 \n− 1) × 100) of the rms measurement at 60 dB down from full \nscale. Conduct offset calibration at low current; avoid using \ncurrents equal to zero for this purpose. \nIRMSOS rms I rms I \uf0b4 \uf02b \uf03d1282\n0  (14) \nwhere I rms 0 is the rms measurement without offset correction.  \nAs stated in the Current Waveform Gain Registers section, the \nserial ports of the ADE78xx  work on 32-, 16-, or 8-bit words \nand the DSP works on 28 bits. Similar to the register presented \nin Figure 35, the AIRMSOS, BIRMSOS, CIRMSOS, and \nNIRMSOS ( ADE7868/ ADE7878  only) 24-bit signed registers \nare accessed as 32-bit registers with four MSBs padded with 0s \nand sign extended to 28 bits. \nCurrent Mean Absolute Value Calculation— ADE7868 \nand ADE7878 Only \nThis section presents the second approach to estimate the rms \nvalues of all phase currents using the mean absolute value (mav) method. This approach is used in PSM1 mode, which is available to the ADE7868  and ADE7878  only, to allow energy accumu-\nlation based on current rms values when the missing neutral case demonstrates to be a tamper attack. This datapath is active also in PSM0 mode to allow for its gain calibration. The gain is used in the external microprocessor during PSM1 mode. The mav value of the neutral current is not computed using this method. Figure 60 shows the details of the signal processing \nchain for the mav calculation on one of the phases of the current \nchannel. \nCURRENT SIGNAL\nCOMING FROM ADCxIMAV[23:0]\nHPF LPF|X|\n08510-251 \nFigure 60. Current MAV Signal Processing for PSM1 Mode \nThe current channel mav value is processed from the samples \nused in the current channel waveform sampling mode. The \nsamples are passed through a high-pass filter to eliminate the \neventual dc offsets introduced by the ADCs and the absolute values are computed. The outputs of this block are then filtered to obtain the average. The current mav values are unsigned 20-bit values and they are stored in the AIMAV , BIMAV , and CIMAV \nregisters. The update rate of this mav measurement is 8 kHz. 207000207500208000208500209000209500210000210500211000211500212000\n45 50 55\nFREQUENCY (Hz)LSB\n60 65\n08510-252\n \nFigure 61. xIMAV Register Values at Full Scale, 45 Hz to 65 Hz Line \nFrequencies \nThe mav values of full-scale sinusoidal signals of 50 Hz and \n60 Hz are 209,686 and 210,921, respectively. As seen in Figure 61, there is a 1.25% variation between the mav estimate at 45 Hz and the one at 65 Hz for full-scale sinusoidal inputs. The accuracy \nof the current mav is typically 0.5% error from the full-scale \ninput down to 1/100 of the full-scale input. Additionally, this measurement has a bandwidth of 2 kHz. The settling time for the current mav measurement, that is the time it takes for the mav register to reflect the value at the input to the current channel within 0.5% error, is 500 ms. However, during the first \nmeasurement after entering this mode, it takes a longer time to \nsettle to the correct value. \nAs stated in the Current Waveform Gain Registers section, the \nserial ports of the ADE7868 /ADE7878  work on 32-, 16-, or  \n8-bit words. As presented in Figure 62, the AIMAV , BIMAV , and CIMA V 20-bit unsigned registers are accessed as 32-bit registers \nwith the 12 MSBs padded with 0s. \n31 20 19 0\n20-BIT UNSIGNED NUMBER 0000 0000 0000\n08510-253 \nFigure 62. xIMAV Registers Transmitted as 32-Bit Registers \nCurrent MAV Gain and Offset Compensation \nThe current rms values stored in the AIMAV , BIMAV , and \nCIMAV registers can be calibrated using gain and offset \ncoefficients corresponding to each phase. It is recommended to calculate the gains in PSM0 mode by supplying the ADE7868 / \nADE7878  with nominal currents. The offsets can be estimated \nby supplying the ADE7868 /ADE7878 with low currents, usually \nequal to the minimum value at which the accuracy is required. \nEvery time the external microcontroller reads the AIMAV ,  \nBIMAV , and CIMAV registers, it uses these coefficients stored \nin its memory to correct them. \nVoltage Channel RMS Calculation \nFigure 63 shows the detail of the signal processing chain for the \nrms calculation on one of the phases of the voltage channel. The \nvoltage channel rms value is processed from the samples used in \nthe voltage channel. The voltage rms values are signed 24-bit \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nvalues and they are stored into the R egisters AVRMS , BVRMS , and \nCVRMS. The update rate of the current rms measurement is 8  kHz. \nWith the specified full -scale analog input signal of 0.5 V , the \nADC produces an output code that is appr oximately ±5 ,928,256.  \nThe equivalent rms value of a full -scale sinusoidal signal is  \n4,191,910 (0x3FF6A6), independent of the line frequency . \nThe accuracy of the voltage rms is typically 0.1% error from the \nfull-scale input down to 1/1000 of the full -scale input. Additionally, \nthis measurement has a bandwidth of 2  kHz. It is recommended \nto read the rms registers synchronous to the voltage zero crossings  to ensure stability. The IRQ1  interrupt can be used to indicate \nwhen a zero crossing has  occurred (see the Interrupts  section).  \nThe settling time for the V  rms measurement is 440 ms for both \n50 Hz and 60 Hz input signals. The V  rms measurement settling \ntime is the time it takes for the rms register  to reflect the value \nat the input to the voltage channel  when starting from 0.  \nAs stated in the Current Waveform Gain Registers  section,  the \nserial ports of the  ADE78xx  work on 32 -, 16-, or 8-bit words. \nSimilar to the register presented in  Figure 36, the AVRMS, \nBVRMS , and CVRMS 24- bit signed registers are accessed as  \n32-bit registers with the eight MSBs  padded with 0s.  \n0xA58AC0 =\n–5,928,2560x5A7540 =\n5,928,256\n0VVOLT AGE SIGNA L\nFROM HPFLPFx2 √27xVRMSOS[23:0]\nxVRMS[23:0]\n08510-041 \nFigure 63. Voltage RMS Signal Processing  \n \nRev. H | Page  46 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 47 of 100 Voltage RMS Offset Compensation \nThe ADE78xx  incorporates voltage rms offset compensation \nregisters for each phase: AVRMSOS, BVRMSOS, and CVRMSOS. \nThese are 24-bit signed registers used to remove offsets in the \nvoltage rms calculations. An offset can exist in the rms calculation due to input noises that are integrated in the dc component of V\n2(t). The voltage rms offset register is multiplied by 128 and \nadded to the squared current rms before the square root is \nexecuted. Assuming that the maximum value from the voltage \nrms calculation is 4,191,910 with full-scale ac inputs (50 Hz), one LSB of the voltage rms offset represents 0.00037% \n((\n128 41912\uf02b /4191 − 1) × 100) of the rms measurement at \n60 dB down from full scale. Conduct offset calibration at low \ncurrent; avoid using voltages equal to zero for this purpose.  \nVRMSOS rms V rms V \uf0b4 \uf02b \uf03d 1282\n0  (15) \nwhere V rms 0 is the rms measurement without offset correction.  \nAs stated in the Current Waveform Gain Registers section, the \nserial ports of the ADE78xx  work on 32-, 16-, or 8-bit words \nand the DSP works on 28 bits. Similar to registers presented in Figure 35, the AVRMSOS, BVRMSOS, and CVRMSOS 24-bit registers are accessed as 32-bit registers with the four most significant bits padded with 0s and sign extended to 28 bits. \nACTIVE POWER CALCULATION \nThe ADE7854 /ADE7858 /ADE7868 /ADE7878 compute the \ntotal active power on every phase. Total active power considers in its calculation all fundamental and harmonic components of the voltages and currents. In addition, the ADE7878  computes \nthe fundamental active power, the power determined only by \nthe fundamental components of the voltages and currents. \nTotal Active Power Calculation \nElectrical power is defined as the rate of energy flow from source \nto load, and it is given by the product of the voltage and current \nwaveforms. The resulting waveform is called the instantaneous power signal, and it is equal to the rate of energy flow at every \ninstant of time. The unit of power is the watt or joules/sec. If an ac system is supplied by a voltage, v(t), and consumes the current, \ni(t), and each of them contains harmonics, then \nsin 2 ) (\n1\uf0e5\uf0a5\n\uf03d\uf03d\nkkV t v (kωt + φ k) (16) \n\uf028\uf029k\nkk γ t ω k I t i\uf02b \uf03d\uf0e5\uf0a5\n\uf03dsin 2 ) (\n1 \nwhere: \nVk, Ik are rms voltage and current, respectively, of each \nharmonic. φ\nk, γk are the phase delays of each harmonic. \nThe instantaneous power in an ac system is  \np(t) = v(t) × i(t) =\uf0e5\uf0a5\n\uf03d1kk kI Vcos(φk – γk) −\uf0e5\uf0a5\n\uf03d1kk kI Vcos(2kωt  + φ k + γ k) + \n\uf0e5\uf0a5\n\uf0b9\uf03d\nm km kmkI V\n1 ,{cos[( k − m)ωt + φ k – γm] – cos[( k + m)ωt + φ k + γm]}  \n (17) \nThe average power over an integral number of line cycles (n) is \ngiven by the expression in Equation 18. \nP = \uf028\uf029\uf0e5\uf0f2\uf0a5\n\uf03d\uf03d\n1 01\nkk knT\nI V dt t p\nnTcos(φk – γk) (18) \nwhere: \nT is the line cycle period.  \nP is referred to as the total active or total real power.  \nNote that the total active power is equal to the dc component of \nthe instantaneous power signal p(t) in Equation 17, that is,  \n\uf0e5\uf0a5\n\uf03d1kk kI Vcos(φk – γk) \nThis is the expression used to calculate the total active power in the ADE78xx  for each phase. The expression of fundamental active \npower is obtained from Equation 18 with k = 1, as follows: \nFP = V\n1I1 cos( φ1 – γ1) (19) \nFigure 64 shows how the ADE78xx  computes the total active \npower on each phase. First, it multiplies the current and voltage signals in each phase. Next, it extracts the dc component of the \ninstantaneous power signal in each phase (A, B, and C) using \nLPF2, the low-pass filter.  \nHPFDIS\n[23:0]\nHPFLPFHPFDIS\n[23:0]DIGITAL\nINTEGRATOR\nHPF\nVAIAAWGAIN AWATTOS\nAWATT\n24APHCALINSTANTANEOUS\nPHASE A ACTIVE\nPOWER\n08510-145DIGITAL SIGNAL PROCESSORAVGAINAIGAIN\n \nFigure 64. Total Active Power Datapath \n \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nIf the phase currents and voltages contain only the fundamental \ncomponent, are in phase (that  is φ1 = γ 1 = 0), and they correspond  \nto full -scale ADC inputs, then multiplying them re sults in an \ninstantaneous power  signal that has a dc component , V 1 × I 1, \nand a sinusoidal component , V 1 × I 1 cos(2ωt); Figure 65 shows \nthe corresponding waveforms.  \nINSTANTANEOUS\nPOWER SIGNAL\nINSTANTANEOUS\nACTIVE POWER\nSIGNAL: V rms ×I rmsp(t)= V rms × I rms – V rms × I rms × cos(2ωt)\n0x3FED4D6\n67,032,278\nV rms × I rms\n0x1FF6A6B =\n33,516,139\n0x000 0000\ni(t) = √2×I rms ×sin(ωt)\nv(t) = √2×V rms ×sin(ωt)\n08510-043 \nFigure 65. Active Power Calculation  \nBecause LPF2 does not have an ideal brick wall frequency \nresponse (see Figure 66), the active power signal has some \nripple due to the instantaneous power signal. This ripple is sinusoidal and has a frequency equal to twice the line frequency. \nBecause the ripple is sinusoidal in nature, it is removed when \nthe active power signal is integrated over time to calculate the \nenergy.  \n0\n–5\n–10\n–15\n–20\n–25\n0.1 1 3 10\nFREQUENCY (Hz)MAGNITUDE (dB)\n08510-103 \nFigure 66. Frequency Response of the LPF Used  \nto Filter Instantaneous Power in Each Phase  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 store  the \ninstantaneous total phase active powers into the AWAT T,  \nBWAT T , and CW ATT registers. The ir expression is  \n∑∞\n=××=\n1k FSk\nFSk\nII\nVVxWATT cos(φk – γk) × PMAX × 421 (20) \nwhere:   \nVFS, IFS are the rms value s of the phase voltage and current when \nthe ADC inputs are at full scale.  PMAX  = 33,516,139; it  is the instantaneous power computed \nwhen the ADC inputs are at full scale and i n phase.  \nThe xW ATT[23:0]  waveform registers can  be accessed using \nvarious serial ports. R efer to  the Waveform Sampling Mode  \nsection  for more details.  \nFundamental Active Power Calculation— ADE7878 Only  \nThe ADE7878 computes the fundamental active power using  \na proprietary algorithm that requires some initializations function \nof the freq uency of the network and its nominal voltage measured \nin the voltage channel. B it 14 (SELFREQ) in the COMPMODE \nregister must be set according to the frequency of the network in \nwhich the ADE7878 is connected. If the network frequency is \n50 Hz, clear this bit to 0 (the default value). If the network fre -\nquency is 60  Hz, set this bit to 1. In addition, initialize the VLEVE L \n24-bit signed register with a positive value based on the \nfollowing expression:  \n520,491×=\nnFS\nVVVLEVEL  (21) \nwhere:  \nVFS is the rms value of the phase voltages when the ADC inputs \nare at full scale.  \nVn is the rms nominal value of the phase voltage.  \nAs stated in the Current Waveform Gain Registers  section , the \nserial ports of the ADE7878 work on 32 -, 16-, or 8-bit words \nand the DSP works on 28 bits. Similar to the registers presented \nin Figure 35, the VLEVEL 24 -bit signed register is accessed as  a \n32-bit register  with four most significant bits padded with 0s \nand sign extended to 28 bits.  \nTable 14 presents the settling time for the fundamental active \npower measurement.  \nTable 14. Settling Tim e for Fundamental Active Power  \nInput Signals  \n63% F ull Scale  100% F ull Scale \n375 ms  875 ms  \nActive Power Gain Calibration  \nNote that the average active power result from the LPF2 output \nin each phase can be scaled by ± 100% by writing to the phase’s \nwatt ga in 24 -bit register (AWGAIN, BWGAIN, CWGAIN , \nAFWGAIN, BFWGAIN , or CFWGAIN ). The xWGAIN \nregisters are placed in each phase of the total active power \ndatapath , and the xFWGAIN (available for the ADE7878 only) \nregisters are placed in each phase of the fundamental active power datapath . The watt gain registers are twos complement, \nsigned registers and have a resolution of  2\n−23/LSB . Equation 2 2 \ndescribes mathematically the function of the watt gain registers.  \n\uf8f7\n\uf8f8\uf8f6\uf8ec\n\uf8ed\uf8eb+×=\n2321 2gisterRe Gain WattOutput LPFData Power Average\n (22) \nRev. H | Page  48 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nThe output is scaled by −50% by writing 0xC00000 to the watt \ngain registers , and it is increased by +50% by writing 0x400000 \nto them. These registers are used  to calibrate the active power \n(or energy) calculation in  the ADE7854/ ADE7858/ ADE7868/ \nADE7878for each phase.  \nAs stated in the Current Waveform Gain Registers  section , the \nserial ports of the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nwork on 32- , 16-, or 8-bit wor ds, and the DSP works on 28 bits . \nSimilar to registers presented in Figure 35 , AWGAIN, BWGAIN , \nCWGAIN , AFWGAIN, BFWGAIN, and CFWGAIN  24-bit \nsigned registers are accessed as 32-bit registers with the four \nMSBs padde d with 0s  and sign extended to 28 bits . \nActive Power Offset Calibration  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 incorporate  a \nwatt offset 24 -bit register on each phase and on each active \npower. The AWAT T O S , BW ATTOS , and CW ATTOS registers \ncompensate the offsets in the to tal active  power calculations , \nand the AFW ATTOS, BFW ATTOS , and CFW ATTOS registers \ncompen sate offsets in the fundamental active power calculations . \nThese are signed twos complement, 24 -bit registers that are \nused to remove offsets in the active power calculations. An  \noffset ca n exist in the power calculation due to crosstalk between  \nchannels on the PCB or in the chip itself. One LSB in the active \npower offset register is equivalent to 1 LSB in the active power \nmultiplier output. With full -scale current and voltage inp uts, \nthe LPF2 output is PMAX  = 33,516,139. At −80 dB down from \nthe full scale (active power scaled down 104 times), one LSB of \nthe active power offset register represents 0.0 298% of PMAX.  \nAs stated  in the Current Waveform Gain Registers  section , the \nserial po rts of the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nwork on 32- , 16-, or 8-bit words  and the DSP works on 28 bits . \nSimilar to registers presented in Figure 35, the AW ATTOS, \nBW ATTOS, CW ATTOS , AFW ATTOS, BFW ATTOS, and \nCFW ATTOS  24-bit signed regis ters are accessed as 32- bit \nregisters with the four MSBs  padded with 0s  and sign extended \nto 28 bits . \nSign of Active Power Calculation  \nThe average active power is a signed calculation. If the phase \ndifference between the current and voltage waveform is mor e \nthan 90°, the average power becomes negative. Negative power \nindicates that energy is being injected back on the grid. The \nADE78xx  has sign detection circuitry for active power  \ncalculations.  It can monitor the total active powers or the \nfundamental active powers.  As described in the Active Energy Calculation  section, the active energy accumulation is performed  \nin two stages. Every time a  sign change is detected in the energy \naccumulation at the end of the first stage, that is , after the energy  \naccumulated into the internal accumulator reaches the WTHR  \nregister  threshold, a dedicated interrupt is triggered. The si gn of \neach phase active po wer can be read in the PHSI GN register.  \nBit 6 (REV APSEL) in the ACCMODE register sets the type  \nof active power being monitored. When REV APSEL is 0,  the default value, the total active power is monitored. When \nREV APSEL is 1, the fundamental active power is monitored.  \nBits[ 8:6] (REV APC, REV APB , and REV APA , respectively ) in the \nSTATUS0  register are set when a sign change occurs in the  \npower selected by Bit 6 (REV APSEL) in the ACCMODE \nregister .  \nBits[2:0] (CWSIGN, BWSIGN , and AWSIGN, respectively ) in \nthe P HSIGN register are set simultaneously with the REV APC, \nREV APB , and REV APA bits. They indicate the sign of the power.  \nWhen they are 0, the corresponding power is positive. When \nthey are 1, the corresponding power is negative.  \nBit REV APx of STATUS0  and Bit xWS IGN in the PHSIGN \nregister refer to the total active power of Phase x , the power type \nbeing selected by Bit 6 (REV APSEL) in the ACCMODE register . \nInterrup ts attached to B its[8:6] (REV APC, REV APB , and REVAPA , \nrespectively ) in the STATUS0  register can be ena bled by setting \nBits[8:6] in the MASK0  register. If enabled, the IRQ0  pin is set \nlow, and the status bit is set to 1 whenever a change of sign occurs . \nTo find the phase that triggered the interrupt, the PHSIGN register \nis read immediately  after reading the STATUS0  register . Next,  the \nstatus bit is cleared and  the IRQ0  pin is returned to high by writing \nto the STATUS0 register with the corresponding  bit set to 1.  \nActive Energy Calculation  \nAs previously stated, power is def ined as the rate of energy flow. \nThis relationship can be expressed mathematically as  \ndtdEnergyPower=  (23) \nConversely, energy  is given as the integral of power , as follows: \n()dttp Energy∫=  (24) \nTot al and fundamental active energy accumulati ons are always \nsigned operation s. Negative energy is subtracted from the active \nenergy contents.  \n \nRev. H | Page 49 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nHPFDIS\n[23:0]\nHPFHPFDIS\n[23:0]DIGITAL\nINTEGR ATOR\nREVAPA BIT IN\nSTATUS0[31:0]\nHPF\nVAIA\nAWGAIN AWA TTOS\nAPHCA LACCUMUL ATOR\n24WTHR[47:0]\nAWA TTAWA TTHR[31:0]\n32-BIT\nREGISTERLPF2\n08510-044DIGITAL SIGNAL PROCESSORAVGAINAIGAIN\n \nFigure 67. Total Active Energy Accumulation  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 achieve  the \nintegration of the active power signal in two stages (s ee Figure 67 ). \nThe process is identical for both  total and fundamental active \npowers. The first stage is accomplished  inside the DSP: every \n125 µs (8 kHz frequency)  the instantaneous phase total  or funda -\nmental  active power is accumulated into an internal register. \nWhen a threshold is reached, a pulse is generated at the processor  \nport , and the threshold is subtracted from the internal register. \nThe sign of the energy in this moment is considered the sign of \nthe act ive power (see Sign of Active Power Calculation  section \nfor deta ils). The second stage is done outside the DSP and consists \nof accum ulating the pulses generated by the processor into internal \n32-bit accumulation re gisters. The content of these registers is \ntransferred to watt -hour registers , x WAT T H R  and xFW ATTHR,  \nwhen  these registers are accessed.  \nWTHR[47:0]\n1 DS P PULSE = 1LSB OF WATTHR[31:0]ACTIVE POWER\nACCUMUL ATION\nIN DS P\nDSP\nGENER ATED\nPULSES\n08510-045 \nFigure 68. Active Power Accumulation Inside the DSP   \nFigure 68 explains this process. The WTHR 48 -bit signed register \ncontains the threshold. It is introduced by the user and is common  \nfor all phase total and fundamental active  powers . Its value \ndepends on how much energy is assigned to one LSB of watt -\nhour registers. When a derivative of active energy (wh) of [10n \nwh], where n is an integer, is desired as one LSB of the \nxW ATTHR register,  then, the xW ATT HR register can be \ncomputed using the following equation:  \nFS FSn\nS\nI Vf PMAXWTHR××××=10 3600 (25) where:  \nPMAX  = 33,516,139 = 0x1FF6A6B as the instantaneous power \ncomputed when the ADC inputs are at full scale.  \nfS = 8 kHz, the frequency with which the DSP computes the \ninstantaneous power.  \nVFS, IFS are the rms values of phase voltages and currents when \nthe ADC inputs are at full scale.  \nThe maximum va lue that can  be written on WTHR is 247 − 1. \nThe minimum value is 0x0, but it is recommended to write a number equal to or greater than PMAX. Never use n egative \nnumbers.  \nWTHR is a 48 -bit register. As stated in the Current Waveform \nGain Registers  section , the serial ports of  the ADE7854/ ADE7858/ \nADE7868/ ADE7878work on  32-, 16-, or 8-bit words. As shown  \nin Figure 69, the WTHR register is accessed as two 32 -bit \nregist ers (WTHR1 and WTHR0), each having eight MSBs  \npadded with 0s.  \nWTHR[47:0]\n47 24\n31 2423 0 31 2423 023 0\nWTHR1[31:0] WTHR0[31:0]0000 0000 24 BIT SIGNED NUMBER 0000 0000 24 BIT SIGNED NUMBER\n08510-046 \nFigure 69. WTHR[47:0] Communicated As Two 32- Bit Reg isters  \nThis discrete time accumulation or summation is equivalent to \nintegration in continuous time  following the description in \nEquation 2 6. \n() ()\n\uf8fe\uf8fd\uf8fc\n\uf8f3\uf8f2\uf8f1× = = ∑ ∫∞\n=→00TLim\nnT nTp dttp Energy  (26) \nwhere:  \nn is the discrete time sample number.  \nT is the sample period.   \nIn the ADE7854/ ADE7858/ ADE7868/ ADE7878, the total phase \nactive powers are accumulated in the AW ATTHR, BW ATTHR , and \nC WAT T H R  3 2 -bit signed registers , and the fundamental phase \nactive powers are accumulated in AFW ATTHR, BFW ATTHR, and \nRev. H | Page  50 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nCFW ATTHR 32 -bit signed registers . The active energy register \ncontent can roll over to full -scale negative (0x80000000) and \ncontinue increasing i n value when the active power is positive. \nConversely,  if the active power is negative, the energy register \nunder flow s to full-scale positive (0x7FFFFFFF) and continue s \ndecreasing in value . \nBit 0 (AEHF) in the STATUS0  register is set when B it 30 of  \none of the xW ATTHR registers chang es, signifying one of these \nregisters is half full. If the active power is positive, the watt -hour \nregister becomes half full when it increments from 0x3FFF  FFFF to \n0x4000 0000. If the active power is negative, the watt -hour \nregister becomes half full when  it decrements from 0xC000 \n0000 to 0xBFFF FFFF. Similarly, Bit 1 (FAEHF) in STATUS0  \nregister, is set when Bit 30 of one of the xFW ATTHR registers \nchanges, signifying one of these registers is half full.  \nSetting Bits[1:0] in the MASK0  register enable the FAEHF and \nAEHF interrupts, respectively. If enabled, the IRQ0  pin is set \nlow and the status bit is set to 1 whenever one of the energy \nregisters , xW ATTHR (for the AEHF interrupt) or xFW ATTHR \n(for the FAEHF interrupt), become  half full. The status bit is \ncleared and  the IRQ0  pin is set to logic  high by writing to the \nSTATUS0 register with the corresponding bit set to 1.  \nSetting Bit 6 (RSTREAD) of  the LCY CMODE register enables a \nread -with -reset for all watt- hour accumulation registers, that is, \nthe registers are reset to 0 after a read operation.  \nIntegration Time Under Steady Load  \nThe discrete time sample period (T) for the accumulation register  \nis 125 µs (8  kHz frequency ). With full -scale sinusoidal signals \non the analog inpu ts and the watt gain registers set to 0x00000, the \naverage  word value from each LPF2 is PMAX  = 33,516,139 = \n0x1FF6A6B . If the WTHR  register  threshold is set at the PMAX \nlevel, this means the DSP generates a pulse that is added at watt -\nhour registers every 125 µs.  \nThe maximum value that can be stored in the watt- hour \naccumulation register before it overflows is 231 − 1 or \n0x7FFFFFFF. The integration time is calculated as  \nTime  = 0x7FFF,FFFF × 125 μs = 74 hr 33 min 55 sec (27) \nEnergy Accumulation Modes  \nThe active power accumulated in each watt -hour accumulation \n32-bit register (AW ATTHR, BW ATTHR,  CW ATTHR , \nA F WAT T H R ,  B F WA TTHR, and CFW ATTHR ) depends on the \nconfigur ation of B it 5 and Bit 4 (CONSEL  bits) in the ACCMODE  \nregister. The various  configurations are described in Table 15. \n \n \n   Table 15. Inputs to Watt -Hour Accumulation Registers  \nCONSEL  AWAT THR  BWAT THR  CWATTHR  \n00  VA × IA  VB × IB  VC × IC  \n01 VA × IA 0 VC × IC  \n10  VA × IA  VB × IB  VC × IC  \n  VB = −VA − VC   \n11  VA × IA  VB × IB  VC × IC  \n  VB = −VA   \nDepending on the polyphase meter service, choose the appro -\npriate formula to calculate the active energy. The American \nANSI C12.10 standard defines the different configurations of \nthe meter. Table 16 describes which mode to choose  in these \nvarious  configurations.  \nTable 16. Meter Form Configuration  \nANSI Meter Form Configuration  CONSEL  \n5S/13S  3-wire del ta 01 \n6S/14S 4-wire wye  10 \n8S/15S 4-wire delt a 11 \n9S/16S 4-wire wye  00 \nBits[1:0] (W ATTACC[1:0]) in the ACCMODE register determine \nhow the CF frequency output can  be generated as a function of \nthe total a nd fundamental active powers. Whereas  the watt- hour \naccumulation registers accumul ate the active power in a signed \nformat, the frequency output can  be generated in signed mode \nor in absolute mode  as a function of the W ATTACC[1:0]  bits. \nSee the Energy -to-Frequency Conversion  section for details. \nLine Cycle Active Energy Accumulation Mode  \nIn line cycle energy accumulation mode, the energy accumula -\ntion is synchronized to the voltage channel zero crossings s uch \nthat active energy is  accumulated over an integral number of \nhalf line cycles. The advant age of summing the active energy \nover an integer number of line cycles is that the sinusoidal compo -\nnent in the active energy is reduced to 0. This eliminates any \nripple in the energy calculation and allows the energy to be \naccumulated accurately over  a shorter time. By using the line \ncycle energy accumulation mode, the energy calibration can be \ngreatly simplified, and the time required to calibrate the meter \ncan be significantly reduced. In line cycle energy accumulation mode, the ADE7854/ ADE7858 /ADE7868/ ADE7878 transfer  the \nactive energy accumulated in the 32 -bit internal accumulation \nregisters into the x WAT T HR or  x F WAT T H R  registers after an \nintegral number of line cycles, as shown in Figure 70 . The \nnumber of half  line cycles is speci fied in the LINECYC register.  \nRev. H | Page 51 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nZERO-\nCROSSING\nDETECTION\n(PHASE A)\nZERO-\nCROSSING\nDETECTION\n(PHASE B)CALIBR ATION\nCONTRO L\nZERO-\nCROSSING\nDETECTION\n(PHASE C)LINECYC[15:0]\nAWATTHR[31:0]ZXSEL[0] IN\nLCYCMODE[7:0]\nZXSEL[1] IN\nLCYCMODE[7:0]\nZXSEL[2] IN\nLCYCMODE[7:0]\nOUTPUT\nFROM LPF2AWGAINAWATTOS\nACCUMUL ATOR\nWTHR[47:0]32-BIT\nREGISTER\n08510-147 \nFigure 70. Line Cycle Active Energy Accumulation Mode  \nThe line cycle energy accumulation mode is activated by setting \nBit 0 (LW ATT) in the LCYCMODE register. The energy accu -\nmulation over an integer number of half line cycles is written  \nto the watt -hour accumulation registers after LINECYC number \nof half line cycles is  detected. When using the line cycle \naccumulation mode, the B it 6 (RSTREAD) of the LCYCMODE \nregister should be set to Logic 0 because the read with reset of \nwatt -hour register s is not available in this mode.  \nPhase A, Phase B, and Phase C zero crossings are, respectively, \ninclu ded when counting the number of half  line cycles by setting \nBits[5:3] (ZXSEL[x]) in the LCYCMODE register. Any co mbi-\nnation of the zero crossings from all three phases can be used for counting the zero crossing. Select o nly one phase at a time \nfor inclusion in the zero crossings count during calibration . \nThe number of zero crossings is specified by the LINECYC  16-bit \nunsigned register. The ADE78xx  can accumulate active power \nfor up to 65,535 combined zero crossings. Note that the internal \nzero -crossing counter is always active. By setting B it 0 (LW ATT) \nin the LCYCMODE register, the first energy accumulation \nresult is, therefore, incorrect. Writing to the LINECYC register \nwhen the LW ATT bit is set resets the zero -crossing counter, thus \nensuring that the first energy accumulation result is accu rate.  \nAt the end of an energy calibration cycle, B it 5 (LENERGY) in \nthe STATUS0  register is set. If the corresponding mask bit in \nthe MASK0  interrupt mask register is enabled, the \nIRQ0  pin \nalso goes active low. The status bit is cleared a nd the IRQ0  pin is \nset to  high again by writing to the STATUS0 register with the \ncorresponding bit set to 1.  Because the active power is integrated on an integer number of half-line cycles in this mode, the sinusoidal components are \nreduced to 0, eliminating any ripple in the energy calculation. \nTherefore, total energy accumulated using the line  cycle \naccumulation mode is  \n()∑ ∫∞\n=+\n= =\n1kkknTt\ntIV nT dttp e cos(φk – γk) (28) \nwhere nT is the accumulation time.  \nNote that line cycle active energy accumulation uses the same signal path as the active energy accumulation. The LSB size of \nthese two methods is equivalent.  \nREACTIVE POWER CALCU LATION— ADE7858, \nADE7868, ADE7878 ONLY  \nThe ADE7858/ ADE7868/ ADE7878 can compute the total \nreactive  power on every phase . Total reactive power integrates  \nall funda mental and harmonic components of the voltages and \ncurrents. The ADE7878 also computes the fundamental reactive \npower, the power determined only by the fundamental \ncompone nts of the voltages and currents . \nA load that contains a reactive element (inductor or capacitor) \nproduces a phase difference between the applied ac voltage and \nthe resulting current. The power associated with reactive elements  \nis called reactive power, an d its unit is V AR. Reactive power is \ndefined as the product of the voltage and current waveforms when  \nall harmonic components of one of these signals are phase \nshifted by 90°.  \nEquation 31 gives an expression for the instantaneous reactive \npower signal in an ac system when the phase of the current \nchannel is shifted by +90°.  \n∑∞\n==\n12 )(\nkkV tv sin(kωt + φk) (29) \n()k\nkk γtωk I ti + =∑∞\n=sin2 )(\n1 (30) \n\uf8f7\uf8f8\uf8f6\uf8ec\uf8ed\uf8eb++ =∑∞\n= 2sin2 )('\n1πγtωk I tik\nkk   \nwhere iʹ(t) is the current waveform with all harmonic \ncomponents phase shifted by 90°.  \nNext, the instantaneous reactive  power , q(t), can be expressed as  \nq(t) = v(t) × iʹ(t) (31) \n∑∞\n=×=\n12 )(\nkkkIV tq sin(kωt + φk) × sin(kωt  + γk + 2π) + \n∑∞\n≠=\nmkmkmkIV\n1,× 2sin( kωt + φk) × sin(mωt  + γm + 2π) \nRev. H | Page  52 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nNote  that q(t) can be rewritten as  \n∑∞\n==\n1)(\nkkkIV tq {cos(φk − γk − 2π) − cos(2 kωt + φk + γk + 2π)} + \n∑∞\n≠=\nmkmkmkIV\n1,{cos[(k – m)ωt + φ k − γk − 2π]− \ncos[(k + m)ωt + φ k + γk + 2π]} (32) \nThe average total reactive power over an integral number of line \ncycles (n) is given by the expression in Equation 33. \n()∫∑∞\n== =nT\nkkkIV dttqnTQ\n0 11cos(φk – γk − 2π) (33) \n∑∞\n==\n1kkkIV Q sin(φk – γk) \nwhere:  \nT is the period of the line cycle.   \nQ is referred to as the total reactive power. Note that the total \nreactive powe r is equal to the dc component of the instantaneous  \nreactive power signal q(t) in Equation 3 2, that is,  \n∑∞\n=1kkkIV  sin(φk – γk) \nThis is the relationship used to calculate the total reactive power \nin the ADE7858 /ADE7868/ ADE7878 for each phase. The \ninstantaneous reactive p ower signal , q(t), is generated by multi -\nplying each harmonic of the voltage signals by  the 90° phase -\nshifted corresponding harmonic of the current in each phase.  \nThe ADE7858/ ADE7868/ ADE7878 store  the instantaneous \ntotal phase reactive powers into the AVAR ,  BVAR , and CV AR \nregisters. Their expression is  \n∑∞\n=××=\n1k FSk\nFSk\nII\nVVxVAR sin(φk – γk) × PMAX × 421 (34) \nwhere:  \nVFS, IFS are the rms value s of the phase voltage and current when \nthe ADC inputs are at full scale.  \nPMAX  = 33,516,139, the instantaneous power computed when \nthe ADC inputs are at full scale and in phase.  \nThe xV AR waveform registers can  be accessed using various \nserial port s. Refer to  the Waveform Sampling Mode  section  for \nmore details.  \nThe expression of fundamental reactive power is obtained from Equation  33 with k = 1, as follows: \nFQ = V\n1I1 sin(φ1 – γ1) \nThe ADE7878 computes the fundamental reactive power using \na proprietary algorith m that requires some initializa tion function  \nof the frequency of the network and its nominal voltage measured  \nin the voltage channel. These initializations are  introduced in \nthe Active Power Calculation  section and are common for both \nfundamental active and reactive powers.  Table  17 presents the settling time for the fundamental reactive \npower measurement, which is the time it takes the power to \nreflect the value at the input of the ADE7878. \nTable 17. Settling Time for Fundamental Reactive Power  \nInput Signals  \n63% Full Scale  100% Full Scale  \n375 ms  875 ms  \nReactive Power Ga in Calibration  \nThe average reactive power in each phase can be scaled by  \n±100% by writing to one of the phase’s  V AR gain 24 -bit register s \n(AV ARGAIN, BV ARGAIN, CV ARGAIN, AFV ARGAIN, \nBFV ARGAIN , or CFV ARGAIN).  The xV ARGAIN registers are \nplaced in each phase o f the total reactive power datapath . The \nxFV ARGAIN registers are placed in each phase of the fundamental  \nreactive power data path.  The xVA R GAIN registers are twos com -\nplement signed registers and have a resolution of  2−23/LSB . The \nfunction of the xVA R GAIN  registers is expressed by  \n\uf8f7\n\uf8f8\uf8f6\uf8ec\n\uf8ed\uf8eb+×=\n2321 2gisterRe xVARGAINOutput LPFPower Reactive Average\n (35) \nThe output is scaled by – 50% by writing 0xC00000 to the \nxV ARGAIN  registers and increased by +50% by writing \n0x400000 to them. These registers can be used to calibrate the \nreactive power (or energy) gai n in the ADE78xx  for each phase.  \nAs stated in the Current Waveform Gain Registers  section, the \nserial ports of the ADE7858/ ADE7868/ ADE7878 work on 32 -, \n16-, or 8 -bit words and the DSP works on 28 bits. Similar to \nregisters presented in Fi gure 35, the AVARGAIN, BV ARGAIN, \nCV ARGAIN, AFV ARGAIN, BFV ARGAIN, and CFV ARGAIN \n24-bit signed registers are accessed as  32-bit registers with the \nfour MSBs  padded with 0s  and sign extended to 28 bits . \nReactive Power Offset Calibration  \nThe ADE7858/ ADE7868/ ADE7878 provide  a reactive power  \noffset register on each phase and on each reactive power. AV AROS, \nBVA R O S ,  and CV AROS registers compensate the o ffsets in the \ntotal reactive power calculations , whereas AFV AROS, BFV AROS, \nand CFV AROS registers compensate offsets in the fundamental \nreactive power calculations. These are signed twos complement, \n24-bit registers that are used to remove offsets in the re active \npower calculations. An offset can exist in the power calculation due to crosstalk between channels on the PCB or in the chip itself. The offset resolution of the registers is the same as for the \nactive power offset registers (see the Active Power Offset \nCalibration  section).  \nAs stated in the Current Waveform Gain Registers  section , the \nserial ports of the ADE7858/ ADE7868/ ADE7878 work on 32 -, \n16-, or 8-bit words  and the DSP works on 28 bits . Similar to the  \nregisters presented in Figure 35, the AV AROS, BV AROS, and \nC VA R OS 24- bit signed registers are accessed as 32 -bit registers \nwith the four MSBs  padded with 0s  and sign extended to 28 bits . \nRev. H | Page 53 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nSign of Reactive Power Calculation  \nNote that the reactive power is a signed calculation. Table 18 \nsummarizes the relationship between the phase difference between \nthe voltage and the current and the sign of the resulting  reactive \npower calculation.  \nThe ADE7858/ ADE7868/ ADE7878 have sign detection circuitry  \nfor reac tive power calculations  that can monitor the total reactive  \npowers or the fundamental reactive powers.  As described in the \nReactive Energy Calculation  section, the reactive energy accu -\nmulation is executed in two stages. Every time a sign change is \ndetected in the energy accumulation at the end of the first stage, \nthat is , after the energy accumulated into the internal  accumulator  \nreaches the VA RTH R  register threshold, a dedicated interrupt is \ntriggered.  The sign of each phase reactive power can be read in \nthe PHSIGN register.  Bit 7 (REVRPSEL) in the ACCMODE \nregister sets the type of reactive power being monitored. When REVRPSEL is 0, the default value, the total reactive power is monitored. When REVRPSEL is 1, then the fundamental \nreactive power is monitored.  \nBits[12:10]  (REVRPC, REVRPB , and REVRPA , respectively )  \nin the STATUS0  register are set when a sign change occu rs in \nthe power selected by Bit 7 (REVRPSEL) in the ACCMODE \nregister .  \nBits[6:4] (CVARSIGN, BVARSIGN , and  AV ARSIGN , respectively ) \nin the PHSIGN register are set simultaneously  with the REVRPC, \nREVRPB , and REVRPA bits. They indicate the sign of the reactive  \npower. When the y are 0, the reactive  power is positive. When \nthey are 1, the reactive  power is negative.  \nBit REVRPx of the STATUS0  register  and Bit xV ARSIGN in the \nPHSIGN register refer to the reactive power of P hase x , the \npower type being selected by Bit REVRPSEL in AC CMODE \nregister.  \nSetting Bits[12:10] in the MASK0  register enables the REVRPC, \nREVRPB , and REVRPA  interrupts , respectively . If enabled, the \nIRQ0  pin is set low and the status bit is set to 1 whenever a change \nof sign occurs. To f ind t he ph ase that triggered the interrupt, \nthe PHSIGN register is read immediately after reading the \nSTATUS0  register . Next,  the status bit is cleared and  the IRQ0  \npin is set to  high by writing to the STATUS0 register with the \ncorresponding bit se t to 1.  \nTable 18. Sign of Reactive Power Calculation  \nΦ1 Integrator  Sign of Reactive Power  \nBetween 0 to +18 0  Off  Positive  \nBetween −180  to 0  Off  Negative  \nBetween 0 to +18 0  On  Positive  \nBetween −18 0 to 0  On  Negative  \n1 Φ is defined as the phase angle of the voltage signal minus the current \nsignal ; that is, Φ  is positive if the load is inductive and negative if the load is \ncapacitive.  \nReactive Energy Calculation  \nReactive energy is defined as the integral of reactive power.  \nReactive Energy  = ∫q(t)dt  (36) Both t otal and fundamental reactive energy ac cumulation s are \nalways a signed operation. Negative energy is subtracted from \nthe reactive energy contents.   \nSimilar to active power, the ADE7858/ ADE7868/ ADE7878 \nachieve  the integration of the reactive power signal in two \nstages (see Figure 71). The process is identical for both total and \nfundamental reactive powers.  \n• The first stage is conducted inside t he DSP: every 125 µs \n(8 kHz frequency), the instantaneous phase total reactive  \nor fundamental power is accumulated into an internal \nregister. When a threshold is reached, a pulse is generated \nat the processor port and the threshold is subtracted from \nthe i nternal register. The sign of the energy in this moment \nis considered the sign of the reactive power (see the Sign of Reactive Power Calculation  section for details).  \n• The sec ond stage is performed  outside the DSP a nd consists \nin accumulating the pulses generated by the processor into internal 32 -bit accumulation registers. The content of these \nregisters is transferred to the var-hour registers ( xV ARHR and \nxFV ARHR)  when these registers are accessed. AV ARHR, \nBV ARHR, C VA RH R , AFW ATTHR, BFW ATTHR, and \nCFW ATTHR  represent phase fundamental  reactive powers. \nFigure 68 from the Active Energy Calculation  section explains \nthis process. The V ARTHR 48- bit signed register contains the \nthreshold  and i t is introduced by the user. It is common for both \ntotal and fundamental phase reactive  powers. Its value depends \non how much energy is assigned to one LSB of var -hour  \nregisters. When a derivative of react ive energy (varh) of [10\nn \nvarh], where n is an integer, is desired as one LSB of the \nxV ARHR register; then, the xVAR THR register can be computed \nusing the following equation:  \nFS FSn\ns\nI Vf PMAXVARTHR××××=10 3600 \nwhere:  \nPMAX  = 33,516,139 = 0x1FF6A6B , the instantaneous p ower \ncomputed when the ADC inputs are at full scale.  \nfS = 8 kHz, the frequency with which the DSP computes the \ninstantaneous power.  \nVFS, IFS are the rms values of phase voltages and currents when \nthe ADC inputs are at full scale.  \nThe maximum valu e that ma y be written on the VA RT H R  \nregister  is 247 − 1. The minimum value is 0x0, but it is \nrecommended to write a number equal to or greater than \nPMAX. Never use n egative numbers.  \nV ARTHR is a 48 -bit register. As previously stated  in the Voltage \nWaveform Gain Registers  section , the serial ports of the ADE7858 / \nADE7868/ ADE7878 work on  32-, 16-, or 8-bit words. Sim ilar to \nthe WTHR register shown  in Figure 69, V ARTHR is accessed as \ntwo 32 -bit registers (V ARTHR1 and V ARTHR0), each having eight \nMSBs  padded with 0s . \nRev. H | Page  54 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nThis discrete time accumulation or summation is equivalent to \nintegrat ion in continuous time following the expression in \nEquation  37: \n() ()\n\uf8fe\uf8fd\uf8fc\n\uf8f3\uf8f2\uf8f1× == ∑ ∫∞\n=→00TLim\nnT nTq dttq ergy ReactiveEn  (37) \nwhere:  \nn is the discrete time sample number.  \nT is the sample period.  \nOn the ADE7858/ ADE7868/ ADE7878, the total phase reactive \npowers are accumulated in the AV ARHR, BV ARHR , and \nCV ARH R 32 -bit signed registers.  The fundamental phase reactive \npowers are accumulated in the AFV ARHR, BFV ARHR, and \nCFV ARHR 32-bit signed registers.  The reactive energy register \ncontent can roll over to full -scale negative (0x80000000) and \ncontinue increasing in value when the reactive power is positive. \nConversely, if the reactive power is negative, the energy register \nunder flows to full -scale positive (0x7FFFFFFF) and continue s \nto decreas e in value.  Bit 2 (REHF) in the STATUS0  register is set when B it 30 of \none of the xV ARHR registers changes, signifying one of these \nregisters is half full. If the reactive power is positive,  the var -hour \nregister becomes half full when it increments from 0x3FFF  FFFF  \nto 0x4000 0000. If the reactive power is negative, the var -hour \nregister becomes half full when it decrements from 0xC000 0000  \nto 0xBFFF FFFF. Analogously, Bit 3 (FREHF) in the ST ATUS0  \nregister is set when Bit 30 of one of the xFV ARHR registers \nchanges, signifying one of these registers is half full.  \nSetting Bits[3:2] in the MASK0  register enable the FREHF and \nREHF interrupts, respectively.  If enabled, the IRQ0  pin is set \nlow and the status bit is set to 1 whenever one of the energy \nregisters , xV ARHR (for REHF interrupt)  or xFV ARHR (for \nFREHF interrupt), becomes half full. The status bit is cleared \nand the IRQ0  pin is set to  high by writing to the  STATUS0 \nregister with the corresponding bit set to 1.  \nSetting Bit 6 (RSTREAD) of the LCY CMODE  register enables a \nread -with -reset for all var -hour accumulation registers, that is, \nthe registers are reset to 0 after a read operation.  \n \nAVGAINHPFDIS\n[23:0]\nHPFAIGAINHPFDIS\n[23:0]DIGITAL\nINTEGRATOR\nREVRPA BIT IN\nSTATUS0[31:0]\nHPF\nVAIAAVARGAIN\nAVAROS\nAPHCALACCUMULATOR\nVARTHR[47:0]AVARHR[31:0]\n32-BIT\nREGISTERTOTAL\nREACTIVE\nPOWER\nALGORITHM\n08510-245DIGITAL SIGNAL PROCESSOR 24AVAR\n \nFigure 71. Total Reactive Energy Accumulation  \n \nRev. H | Page 55 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nIntegration Time Under A Steady Load  \nThe discrete time sample period (T) for the accumulation register  \nis 125 µs (8 kHz frequency ). With full -scale pure sinusoidal signals \non the analog inputs  and a 90° phase difference between the vol -\ntage and the current signal (the largest possible reactive power),  \nthe average word value representing the reactive power is PMAX  = \n33,516,139 = 0x1FF6A6B .  If  t he  VA RT H R  threshold is set at the \nPMAX level, this means the DSP generates a pulse that is added \nat the var-hour  registers every 125 µs.  \nThe maximum value that can be stored in the var -hour \naccumulation register before it overflows is 231 − 1 or \n0x7FFFFFFF. The integration time is calculated as  \nTime  = 0x7FFF,FFFF × 125 μs = 74 hr 33 min 55 sec (38) \nEnergy Accumulation Modes  \nThe reactive power accumulated in each var -hour accumulation \n32-bit register (AV ARHR, BV ARHR,  CVARHR , AFV ARHR, \nBFV ARHR, and CFV ARHR) depends on the configuration of \nBits[5:4] (CONSEL [1:0]) in the ACC MODE register, in correlation  \nwith the watt -hour registers. The different configurations are \ndescribed in Table 19 . Note that IA ’/IB’/IC’ are the phase -shifted  \ncurrent waveform s. \nTable 19. Inputs to Var -Hour  Accumulation Registers  \nCONSEL[1 :0]  AVARHR, \nAFVARHR  BVARHR, BFVARHR  CVARHR, CFVARHR  \n00  VA × IA’  VB × IB’  VC × IC ’  \n01  VA × IA’  0 VC × IC’  \n10  VA × IA’  VB × IB’  VC × IC ’  \n  VB = −VA − VC   \n11  VA × IA’  VB × IB’  VC × IC ’  \n  VB = −VA   \nBits[3:2] (V ARACC[1:0]) in the ACCMODE register determine \nhow CF frequency output can  be a generated function of the total \nand fundamental reactive powers. While the var -hour accumu-\nlation  registers accumulate the reactive power in a signed \nformat, the frequency output can be generated in either the signed \nmode or the  sign adjusted mode  function of V ARACC[1:0] . See \nthe Energy -to-Frequency Conversion  section  for details.  \nLine Cycle Reactive Energy Accumulation Mode  \nAs mentioned in the Line Cycle Active Energy Accumulation \nMode  section, in line cycle energy accumulation mode, the \nenergy accumula tion can be synchroni zed to the voltage \nchannel zero crossings so that reactive energy can be accu -\nmulated over an integral number of half line cycles. In this mode, the ADE7858/ ADE7868/ ADE7878 transfer  the \nreactive energy accumulated in the 32 -bit internal accumulation \nregisters into the xV ARHR or xFV ARHR registers  after an \nintegral number of line cycles, as shown in Figure 72. The \nnumber of half line cycles is specified in the LINECYC register. \nThe line cycle reactive energy accumulation mode is activated by  \nsetting Bit 1 (LV AR) in the LCYCMODE register. The total reactive \nenergy accumulated over an integer number of ha lf line cy cles \nor zero crossings is available  in the var -hour accumulation  registers \nafter the number of zero crossings specified in the LINECYC reg-\nister is detected . When using the line cycle accumulation mode, \nBit 6 (RSTREAD) of the LCYCMODE register should  be set to \nLogic 0 because a  read with the reset of var -hour registers is not \navailable in this mode.  \nZERO-\nCROSSING\nDETECTION\n(PHASE A)\nZERO-\nCROSSING\nDETECTION\n(PHASE B)CALIBR ATION\nCONTRO L\nZERO-\nCROSSING\nDETECTION\n(PHASE C)LINECYC[15:0]\nAVARHR[31:0]ZXSEL[0] IN\nLCYCMODE[7:0]\nZXSEL[1] IN\nLCYCMODE[7:0]\nZXSEL[2] IN\nLCYCMODE[7:0]\nOUTPUT\nFROM\nTOTAL\nREACTIVE\nPOWER\nALGORITHMAVARGAINAVAROS\nACCUMUL ATOR\nVARTHR[47:0]32-BIT\nREGISTER\n08510-146 \nFigure 72. Line Cycle Total Rea ctive Energy Accumulation Mode  \nPhase A, Phase B, and Phase C zero crossings are, respectively, \ninclude d when counting the number of half  line cycles by setting  \nBits[5:3] (ZXSEL[ x]) in the LCYCMODE register. Any combi -\nnation of the zero crossings from all three phases can be used for counting the zero crossing. Select o nly one phase at a time \nfor incl usion in the zero -crossings count during calibration . \nFor details on setting the LINECYC register and the Bit 5 \n(LENERGY) in the MASK0 interrupt mask register  associated  \nwith the line cycle accumulation mode, see the Line Cycle \nActive Energy Accumulation Mode  section.  \n \n  \n \n \nRev. H | Page  56 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nAPPARENT POWER CALCU LATION  \nApparent power is defined as the maximum power that can be \ndelivered to a load. One way to obtain the apparent power is by  \nmultiplying the voltage rms  value by the curre nt rms value  (also \ncalled the arithmetic apparent power)  \nS = V rms × I rms (39) \nwhere : \nS is the apparent power.  \nV rms and I rms are the rms voltage and current, respectively.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 compute the \narithmetic apparent power on each phase. Figure 73 illustrates \nthe signal processing in each phase for the calculation of the \napparent power in the ADE78xx . Because  V rms and I  rms con-\ntain all harmonic information, the apparent power computed by \nthe ADE78xx  is total apparent power.  The ADE7878 does not \ncompute fundamental apparent power because it does not measure the rms values of the fundamental voltages and currents.  The ADE7854/ ADE7858/ ADE7868/ ADE7878 store  the instan -\ntaneous phase apparent powers into the AVA ,  BVA , and CV A \nregisters. Their expression is  \n421×××= PMAXII\nVVxVA\nFS FS (40) \nwhere:  \nV, I are the rms values of the phase voltage and current.  \nVFS, IFS are the rms values of the phase voltage and current when \nthe ADC inputs are at full scale.  \nPMAX  = 33,516,139, the instantaneous power computed when \nthe ADC inputs are at full scale and in phase.  \nThe xV A[23:0] waveform registers may be accessed using various serial ports. R efer to  the Waveform Sampling Mode  \nsection  for more details.  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 can compute the \napparent power in an alternative  way by multiplying the phase \nrms current by an rms voltage introduced externally. See the \nApparent Power Calculation Using VNOM  section  for details. \nAVAHR[31:0]AVAGAIN\nDIGITAL SIGNA L PROCESSORAIRMS\nACCUMUL ATOR\nAVRMSVATHR[47:0] AVA\n2432-BIT REGISTER\n08510-048 \nFigure 73. Apparent Power Data Flow and Apparent Energy Accumulation  \n \nRev. H | Page 57 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nApparent Power Gain Calibration  \nThe average apparent power result in each phase can be scaled \nby ±100% by writing to one of the phase’s V AGAIN  24-bit register s \n(AV AGAIN, BV AGAIN , or CVAG AIN). The V AGAIN registers \nare twos complement, signed registers and have a resolution of 2\n−23/LSB. The function of the x VAGAIN  registers is expressed \nmathematically as  \n\uf8f7\n\uf8f8\uf8f6\uf8ec\n\uf8ed\uf8eb+××=\n2321Register VAGAINrmsI rmsVPower Apparent Average\n (41) \nThe output is scaled by – 50% by writing 0xC00000 to the \nx VAG A I N  registers , and it is increased by +50% by writing \n0x400000 to them. These registers c alibrate the apparent power  \n(or energy) calculation in the ADE7854/ ADE7858/ ADE7868/ \nADE7878 for each phase.  \nAs previously stated  in the Current Waveform Gain Registers  \nsection , the serial ports of the ADE78xx  work on 32 -, 16-, or 8-bit \nwords and the DSP works on 28 bits. Similar to registers presented in Figure 35 , the AV AGAIN, BV AGAIN, and CV AGAIN 24 -bit \nregisters a re accessed as 32 -bit registers with the four MSBs  \npadded with 0s and sign extended to 28 bits.  \nApparent Power Offset Calibration  \nEach rms measurement includes an offset compensation register   \nto calibrate and eliminate the dc component in the rms value (see the Root Mean Square Measurement section). The voltage \nand current rms values are multiplied together in the apparent power signal processing. As no additional offsets are created in the multiplication of the rm s values, there is no specific offset \ncompensation in the apparent  power signal processing. The offset \ncompensation of the apparent  power measurement in each phase is \naccomplished  by calibrating each individual rms measurement.  \nApparent Power Calculation U sing VNOM  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 can compute the \napparent power by multiplying the phase rms current by an rms \nvolta ge introduced externally in the VNOM 24- bit signed register.  \nWhen one of B its[13:11] (VNOMCEN, VNOMBEN, or \nVNOMAEN) in the COMPMODE register is se t to 1, the \napparent power in the corresponding phase ( Phase x for \nVNOMxEN) is computed in this way. When the VNOMxEN \nbits are cleared to 0, the default value, then the arithmetic \napparent power is computed.  \nThe VNOM register contains a number determined b y V, the \ndesired rms voltage , and VFS, the rms value of the phase voltage \nwhen the ADC inputs are at full scale:  \n910,191,4×=\nFSVVVNOM  (42) \nwhere V is the desired nominal phase rms voltage.  \n \n As stated  in the Curr ent Waveform Gain Registers , the serial \nports of the ADE78xx  work on 32 -, 16-, or 8 -bit words. Similar \nto the register presented in Figu re 36, the VNOM 24 -bit sign ed \nregister is accessed as a 32 -bit register with the eight MSBs \npadded with 0s.  \nApparent Energy Calculation  \nApparent energy is defined as the integral of apparent power.  \nApparent Energy = ∫s(t)dt (43) \nSimilar to active and reactive powers, the ADE7854/ ADE7858/ \nADE7868/ ADE7878 achieve  the integration of the apparent power  \nsignal in two stages (see Figure 73). The first stage is conducted \ninside the DSP: every 125 µs (8 kHz frequency), the instanta-\nneous phase apparent power is accumulated into an internal register. When a threshold is reached, a pulse is generated at the processor port and the t hreshold is subtracted from the intern al \nregister. The second stage is c onducted outside the DSP and \nconsists of accumulating the pulses generated by the processor \ninto internal 32 -bit accumulation registers. The content of these \nregisters is transferred to the VA-hour registers , x VA H R , when \nthese registers are accessed. Figure 68 from the Active Energy \nCalculation  section illustrates this process. The V ATHR 48 -bit \nregister contains the threshold. Its value depends on how much \nenerg y is assigned t o one LSB of the VA-hour registers. When a \nderivative of  apparent energy  (VA h ) of [10\nn VA h ] ,  where n is an \ninteger, is desired as one LSB of the x VA H R  register ; then, the \nxVATHR register  can be computed using the following equation:  \nFS FSn\ns\nI Vf PMAXVATHR××××=10 3600 \nwhere:  \nPMAX  = 33,516,139 = 0x1FF6A6B, the instantaneous power \ncomputed when the ADC inputs are at full scale.  \nfS = 8 kHz , the frequency with which the DSP computes the \ninstantaneous power.  \nVFS, IFS are the rms values of phase voltages and currents when \nthe ADC inputs are at full scale.  \nVAT H R  i s  a 48-bit register. As previously stated  in the Current \nWaveform Gain Registers  section , the serial ports of the ADE7854 / \nADE7858/ ADE7868/ ADE7878 work on 32 -, 16-, or 8 -bit words. \nSimilar to th e WTHR register presented in Figure 69, the VATH R  \nregister is accessed as two 32 -bit registers (V ATHR1  and VATHR0) , \neach having eight MSBs padded with 0s.  \nThis discrete time accumulation or summation is equivalent to \nintegration in continuous time following the description in \nEquation 4 4. \n() ()\n\uf8fe\uf8fd\uf8fc\n\uf8f3\uf8f2\uf8f1× == ∑ ∫∞\n=→00TLim\nnT nTs dtts ergy ApparentEn  (44) \nwhere:  \nn is the discrete time sample number.  \nT is the sample period.  \nRev. H | Page  58 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 59 of 100 In the ADE7854 /ADE7858 /ADE7868/ ADE7878 , the phase \napparent powers are accumulated in the AV AHR, BV AHR, and \nCV AHR 32-bit signed registers. The apparent energy register content can roll over to full-scale negative (0x80000000) and \ncontinue increasing in value when the apparent power is  \npositive.  \nBit 4 (V AEHF) in the STATUS0 register is set when Bit 30 of one of \nthe xV AHR registers changes, signifying one of these registers is half full. As the apparent power is always positive and the xV AHR registers are signed, the V A-hour registers become half full when they increment from 0x3FFFFFFF to 0x4000 0000. Interrupts \nattached to Bit V AEHF in the STATUS0 register can be enabled by \nsetting Bit 4 in the MASK0 register. If enabled, the IRQ0\n pin is set \nlow and the status bit is set to 1 whenever one of the Energy \nRegisters xV AHR becomes half full. The status bit is cleared and \nthe IRQ0  pin is set to high by writing to the STATUS0 register \nwith the corresponding bit set to 1. \nSetting Bit 6 (RSTREAD) of the LCYCMODE register enables \na read-with-reset for all xV AHR accumulation registers, that is, \nthe registers are reset to 0 after a read operation. \nIntegration Time Under Steady Load \nThe discrete time sample period for the accumulation register is \n125 μs (8 kHz frequency). With full-scale pure sinusoidal signals \non the analog inputs, the average word value representing the apparent power is PMAX. If the V ATHR threshold register is set at the PMAX level, this means the DSP generates a pulse that \nis added at the xV AHR registers every 125 μs. The maximum value that can be stored in the xV AHR \naccumulation register before it overflows is 2\n31 − 1 or \n0x7FFFFFFF. The integration time is calculated as \nTime = 0x7FFF,FFFF × 125 μs = 74 hr 33 min 55 sec (45) \nEnergy Accumulation Mode \nThe apparent power accumulated in each accumulation register \ndepends on the configuration of Bits[5:4] (CONSEL[1:0]) in the \nACCMODE register. The various configurations are described \nin Table 20.  \nTable 20. Inputs to VA-Hou r Accumulation Registers \nCONSEL[1:0] AVAHR BVAHR CVAHR \n00 AVRMS × AIRMS BVRMS × BIRMS CVRMS × CIRMS \n01 AVRMS × AIRMS 0 CVRMS × CIRMS \n10 AVRMS × AIRMS BVRMS × BIRMS CVRMS × CIRMS \n  VB = −VA − VC  \n11 AVRMS × AIRMS BVRMS × BIRMS CVRMS × CIRMS \n  VB = −VA  \nLine Cycle Apparent Energy Accumulation Mode \nAs described in the Line Cycle Active Energy Accumulation \nMode section, in line cycle energy accumulation mode, the \nenergy accumulation can be synchronized to the voltage channel \nzero crossings allowing apparent energy to be accumulated over an integral number of half line cycles. In this mode, the ADE7854 / \nADE7858 /ADE7868 /ADE7878 transfer the apparent energy \naccumulated in the 32-bit internal accumulation registers into \nthe xV AHR registers after an integral number of line cycles, as \nshown in Figure 74. The number of half line cycles is specified \nin the LINECYC register. \nZERO-\nCROSSING\nDETECTION\n(PHASE A)\nZERO-\nCROSSING\nDETECTION\n(PHASE B)CALIBRATION\nCONTROL\nZERO-\nCROSSING\nDETECTION\n(PHASE C)LINECYC[15:0]\nAVAHR[31:0]ZXSEL[0] IN\nLCYCMODE[7:0]\nZXSEL[1] IN\nLCYCMODE[7:0]\nZXSEL[2] IN\nLCYCMODE[7:0]\nAVAGAIN AIRMS\nAVRMSACCUMULATOR\nVAHR[47:0]32-BIT\nREGISTER\n08510-049 \nFigure 74. Line Cycle Apparent Energy Accumulation Mode \n \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nThe line cycle apparent energy accumulation mode is activated \nby setting B it 2 (LV A) in the LCYCMODE register. The apparent \nenergy accumulated over an integer number of zero cr ossings is \nwritten to the  x VA H R  accumulation registers after the number \nof zero crossings specified in LINECYC register is detected . When  \nusing the l ine cycle accumulation mode, set Bit 6 (RSTREAD) of \nthe LCYCMODE register to Logic 0 because a  read with th e reset \nof x VA H R  registers is not available in this mode.  \nPhase A, Phase B, and Phase C zero crossings are, respectively, included when counting the number of half line cycles by setting  \nBits[5:3] ( ZXSEL[ x]) in the LCYCMODE register. Any combi -\nnation of th e zero crossings from all three phases can be used \nfor counting the zero crossing. Select only one phase at a time \nfor inclusion in the zero -crossings count during calibration.  \nFor details on setting the LINECYC register and Bit 5 (LENERGY)  \nin the MASK0 in terrupt mask register associated with the line \ncycle accumulation mode, see the Line Cycle Active Energy \nAccumulation Mode  section.  \nWAVEFORM SAMPLING MO DE \nThe waveform samples of the current and voltage waveform, \nthe active, reactive, an d apparent power out puts are stored \nevery  125 µs (8  kHz rate) into 24 -bit signed registers that can  be \naccessed through various serial ports of the ADE7854/ ADE7858 / \nADE7868/ ADE7878. Table 21  provides  a list of  registers and their \ndescription s. \nTable 21. Waveform Registers List  \nRegister  Description  \nIAWV  Phase A current  \nVAWV  Phase A voltage  \nIBWV  Phase B current  \nVBWV Phase B voltage  \nICWV  Phase C current  \nVCWV  Phase C voltage  \nINWV  Neutra l current , available in the ADE7868 \nand ADE7878 only  \nAVA  Phase A apparent power  \nBVA  Phase B apparent power  \nCVA  Phase C apparent power  \nAWAT T  Phase A active power  \nBWAT T  Phase B active power  \nCWAT T  Phase C active power  \nAVAR  Phase A reactive power  \nBVAR  Phase B reactive power  \nCVAR  Phase C reactive power  \nBit 17 (DREADY) in  the STATUS0  register can be used  to \nsignal when the registers list ed in Table 21 can be read using \nI2C or SPI serial ports. An interrupt attached to the flag can  be \nenabled by setting B it 17 (DREADY) in the MASK0  register.  \nSee the Digital Signal Processor  section  for more details on \nBit DREADY. \n The ADE7854/ ADE7858/ ADE7868/ ADE7878 contain  a high \nspeed data capture (HSDC) port that is specially designed to \nprovide fast access to the waveform sample registers. R ead the \nHSDC Interface  section for more details.  \nAs stated  in the Current Waveform Gain Registers  section , the \nserial ports of the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nwork on  32-, 16-, or 8-bit words. All regist ers listed in Table 21 \nare transmitted signed extended from 24  bits to 32 bits (see \nFigure 37).  \nENERGY -TO -FREQUENCY CONVERSION  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 provide three  \nfrequency outp ut pins: CF1, CF2 , and CF3. The CF3 pin is \nmultiplexed with the HSCLK pin of the HSDC interface. When \nHSDC is enabled, the CF3 functionality is disabled at the pin. \nCF1 and CF2 pins are always available. After initial calibration \nat manufacturing, the manu facturer or end customer verif ies \nthe energy meter calibration. One convenient way to verify the meter calibration is to provide an output frequency propor -\ntional to the active, reactive, or apparent powers under steady \nload conditions. This output frequen cy can provide a simple, \nsingle -wire, optically isolated interface to external calibration \nequipment.  Figure 75 illustrates the energy -to-frequency \nconversion in the ADE7854/ ADE7858/ ADE7868/ ADE7878.  \nThe DSP computes the instantaneous values of all phase powers: \ntotal active, fundamental active, total reactive, fundamental reactive, and apparent. The process in which the energy is sign accumulated in various xW ATTHR, xV ARHR, and xV AHR \nregisters has already been described in the energy c alculation \nsections: Active Energy Calculation , Reactive Energy Calculation , \nand Apparent Energy Calculation . In the energy -to-frequency \nconversion process, the instantaneous powers generate signals \nat the frequency output pins (CF1, CF2, and CF3). One digital -\nto-frequency converter is used for every CFx pin. Every converter  \nsums certain phase powers and generates a signal proportion al \nto the sum. Two sets of bits decide what powers are converted.  \nFirst, Bits[2:0] (TERMSEL1[2:0]), Bits[5:3] (TERMSEL2[2:0]), and Bits[8:6] (TERMSEL3[2:0]) of the COMPMODE register \ndecide which phases, or which combination of phases, are added.   \nThe TERM SEL1 bits refer to the CF1 pin, the TERMSEL2 bits \nrefer to the CF2 pin, and the TERMSEL3 bits refer to the CF3 \npin. The TERMSELx[0] bits manage Phase A. When set to 1, Phase A power is included in the sum of powers at the CFx converter. When cleared to 0, Phase A power is not included. \nThe TERMSELx[1] bits manage Phase B, and the TERMSELx[2]  \nbits manage Phase C. Setting all TERMSELx bits to 1 means all \n3-phase powers are added at the CFx converter. Clearing all \nTERMSELx bits to 0 means no phase power is add ed and no  \nCF pulse is generated.  \n \n \nRev. H | Page  60 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nSecond, Bits[2:0] (CF1SEL[2:0]), Bits[5:3] (CF2SEL[2:0]), and \nBits[8:6] (CF3SEL[2:0]) in the CFMODE register decide what \ntype of power is used at the inputs of the CF1, CF2, and CF3 \nconverters, respectively. Table 22 shows the values that CFxSEL \ncan have: total active, total reactive (available in the ADE7858, \nADE7868, and ADE7878 only), apparent, fundamental active \n(available in the ADE7878 only), or fundamental reactive \n(available in the ADE7878 only) powers.  \n \n  \n \n \n    Table 22. CFxSEL Bits Description  \nCFxSEL  Description  Registers  \nLatched When \nCFxLATCH = 1  \n000 CFx signal proportional to the \nsum of total phase active \npowers  AWAT THR, \nBWAT THR, CWAT THR  \n001 CFx signal proportional to the sum of total phase reactive \npowers ( ADE7858/ ADE7868/ \nADE7878)  AVARHR, BVARHR, \nCVARHR  \n010 CFx signal proportional to the \nsum of phase apparent powers  AVAHR, BVAHR, \nCVAHR  \n011 CFx signal proportional to the \nsum of fundamental phase \nactive powers ( ADE7878 only)  AFWATTHR, \nBFWATTHR, \nCFWATTHR  \n100 CFx signal proportional to the \nsum of fundamental phase \nreactive powers (ADE7878 only) AFVARHR, \nBFVARHR, \nCFVARHR  \n101 to 111 Reserved   \n \n08510-050DIGITAL SIGNAL\nPROCESSORINSTANTANEOUS\nPHASE A ACTIVE\nPOWER\nINSTANTANEOUS\nPHASE B ACTIVE\nPOWER\nINSTANTANEOUS\nPHASE C ACTIVE\nPOWERTERMSELx BITS IN\nCOMPMODE\nWTHR[47:0]FREQUENCY\nDIVIDER27\n27VA\nVAR\nFWATT 1\nFVAR 1WATTCFxSEL BITS\nIN CFMODE\nREVPSUMx BIT OFSTATUS0[31:0]\nCFxDENACCUMULATOR\nCFx PULSE\nOUTPUT\n1FWATT AND FVAR FOR ADE7878 ONLY. \nFigure 75. Energy -to-Frequency Conversion  \n \nRev. H | Page 61 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nBy default, the TERMSELx bit s are all 1 and the CF1SEL bits are \n000, the CF2SEL  bits are 001, and the CF3SEL bits are 010 . This \nmeans that by default, the CF1 digital -to-frequency converter  \nproduce s signals proportional to the sum of all 3 -phase total \nactive powers , CF2 produces sign als proportional to total \nreactive powers , and CF3 produces signals proportional to \napparent powers . \nSimilar to the energy accumulation process, the energy -to-\nfrequency con version is accomplished  in two stages. In the first \nstage, the instantaneous phase p owers obtained from the DSP at \nthe 8 kHz rate are shifted left by seven  bits and then accumulate \ninto a n internal  register at a 1 MHz rate. When a threshold is \nreached, a pulse is generated and the threshold is subtracted \nfrom the internal register. The si gn of the energy in this moment \nis considered the sign of the sum of phase powers (see the Sign \nof Sum -of-Phase Powers in the CFx Datapath  section for details) . \nThe threshold is the same threshold used in various active, \nreactiv e, and apparent  energy accumulators in the DSP, such \nas the WTHR ,  VA RT H R , or  VAT H R registers , except for bei ng \nshifted left by seven bits. The advantage of accumulating the \ninstantaneous powers at the 1 MHz rate is that the ripple at the \nCFx pins is greatly diminished.   \nThe second stage consists of the  frequency divider by the \nCFxDEN 16 -bit unsigned registers. The values of CFxDEN \ndepend on the meter constant (MC), measured in impulses/k Wh \nand how much energy is assigned to one LSB of various energy \nregisters:  xW ATTHR, xV ARHR, and so forth.  Supposing  a deri -\nvative of wh [10n wh], n a positive or negative integer, is desired \nas one LSB of x WAT T H R  register . Then , CFxDEN is as follows: \nnMCCFxDEN10] imp/kwh[103\n×=  (46) \nThe derivative of wh  must be chos en in such a way to obtain a \nCFxDEN  register content greater than 1. If CFxDEN  = 1, then \nthe CFx pin  stays active low for only 1  µs, therefore,  avoid this \nnumber. The frequency converter cannot accommodate fractional  \nresults ; the result of the division mus t be rounded to the nearest \ninteger. If CFxDEN is set equal to 0, then  the ADE78xx  considers  it \nto be  equal to 1.  \nThe pulse output for all digital -to-frequency converters stays  \nlow for 80  ms if the pulse period is larger than 160  ms (6.25  Hz). If \nthe pulse period is smaller than 160  ms and CFxDEN is an even \nnumber , the duty cycle of the pulse output is exactly 50%. If the \npulse period is smaller than 160  ms and CFxDEN is an odd \nnumber, the duty cycle of the pulse output is  \n(1+1/ CFxDEN ) × 50%  \n \n \n   The pulse output is active low and preferably connected to an \nLED , as shown in Figure 76. \nVDD\nCFx PIN\n08510-051 \nFigure 76. CFx Pin Recommend ed Connection  \nBits[11:9] (CF3DIS, CF2DIS , and CF1DIS) of the CFMODE \nregister decide if the frequency converter output is generated \nat the CF3, CF2 , or CF1 pin . When B it CFxDIS is set to 1  (the \ndefault value) , the CFx pin is disabled and the pin stays high.  \nWhen Bit CFxDIS is cleared to 0, the correspond ing CFx pin \noutput g enerates an active low signal.  \nBits[16:14] (CF3, CF2, CF1) in the Interrupt Mask Reg ister MASK0  \nmanage the CF3, CF2 , and CF1 related interrupts. When the \nCFx bits are set, whenever a high -to-low transition at the corres -\nponding  frequency converter output occurs, an interrupt IRQ0  \nis triggered and a status bit in the STATUS0  register is set to 1. \nThe interrupt is available even if the CFx output is not enabled \nby the CFxDI S bits in the CFMODE  register . \nSynchronizing Energy Registers with CFx Outputs  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 contain  a feature \nthat allows synchronizing the content of phase energy accu -\nmulation registers with the generation of a CFx pulse. When \na high- to-low transition  at one frequency converter output \noccurs, the content of all internal phase energy registers that relate to the power being output at CFx pin is latched into hour  \nregisters and then resets  to 0. S ee Table 22  for the list of registers \nthat are latched based on the CFxSEL[2:0] bits in the CFMODE  \nregister. All 3 -phase registers are latched independent of the \nTERMSELx bits of the COMPMODE register. The process is \nshown in Figure  77 for CF1SEL[2:0]  = 010 (apparent powers \ncontribute at the  CF1 pin) and CFCYC  = 2. \nThe CFCYC 8 -bit unsigned register contains the number of high to \nlow transitions at the frequency converter output between two \nconsecutive latches.  Avoid w riting a new va lue into  the CFCYC \nregister during  a high- to-low transition at any CFx pin. \nCFCYC = 2\nAVAHR, B VAHR,\nCVAHR L ATCHED\nENERG Y REGISTERS\nRESETAVAHR, B VAHR,\nCVAHR L ATCHED\nENERG Y REGISTERS\nRESETCF1 PULSE\nBASED ON\nPHASE  AAND\nPHASE B\nAPPARENT\nPOWERS\n08510-052 \nFigure 77. Synchronizing AVAHR and BVAHR with CF1  \n \nBits[14:12]  (CF3LATCH, CF2LATCH, and CF1LATCH) of the \nCFMODE register enable this process when set to 1. When \ncleared to 0, the default state, no latch occurs. The process is \navailable even if the CFx output is not enabled by the CFxDIS \nbits in the CFMODE  register . \nRev. H | Page  62 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nCF Outputs for Various Accumulation M odes  \nBits[1:0] (W ATTACC[1:0]) in the ACCMODE register d eter-\nmine the accumulation modes of the total active  and fundamental  \npowers when signals proportional to the active powers are chosen \nat the CFx pins ( the CFxSEL[2:0 ] bits in the CFMODE register \nequal  000 or 011 ). When W ATTACC[1:0]  = 00 (the default value) , \nthe activ e powers are sign accumulated before entering the energy -\nto-frequen cy converter. Figure 78  shows how  signed active power  \naccumulation works. In  this mode, the CFx pulses synchronize \nperfectly with the ac tive energy accumulated in x WAT T H R  regis -\nters because the powers are sign a ccumulated in both data  paths.   \nNEG POS POS APNOLOAD\nSIGN = POSITIVENEGNO-LOAD\nTHRESHOLDACTIVE POWERNO-LOAD\nTHRESHOLDACTIVE ENERG Y\nREVAPx BIT\nIN STATUS0\nxWSIGN BIT\nIN PHSIGN\n08510-053 \nFigure 78. Active Power Signed Accumulation Mode  \nWhen W ATTACC[1:0]  = 11, the active powers are accumulated \nin absolute mod e. When the powers are negative, they change \nsign and accumulate together with the positive power. Figure 79  \nshows how  absolute active power accumulation works. Note \nthat in this mode, the  x WAT T H R  r egisters continu e to accumulate  \nactive powers in signed mode, even if the CFx pulses are gener -\nated based on the absolute accumulation mode.  \nW ATTACC[1:0] settings of 01 and 10 are reserved. The ADE7854/ ADE7858/ ADE7868 /ADE7878 behave identically to \nthe case when W ATTACC[1:0] = 00.  \nBits[3:2] (V ARACC[1:0]) in the ACCMODE register determine the \naccumulation modes of the total and fundamental reactive powers when signals proportional to the reactive powers are chosen at the \nCFx pins ( the CFxSEL[2:0] bits in the CFMODE register equal \n001 or 100). When V ARACC[1:0]  = 00, the default value, the \nreactive powers are sign accumulated before entering the energy -to-frequency converter. Figure 80 shows how  signed \nreactive power accumulation works. I n this mode, the CFx  \npulses synchronize perfectly with the reactive energy accumu -\nlated  in the x VA R H R  registers because the powers are sign \naccumulated in both datapath s. NEG POS POS APNOLOAD\nSIGN = POSITIVENEGNO-LOAD\nTHRESHOLDACTIVE POWERNO-LOAD\nTHRESHOLDACTIVE ENERG Y\nREVAPx BIT\nIN STATUS0\nxWSIGN BIT\nIN PHSIGN\n08510-054 \nFigure 79. Active Power Absolute Accumulation Mode  \nNEG POS POS VARNOLOAD\nSIGN = POSITIVENEGNO-LOAD\nTHRESHOLDREACTIVE\nPOWERNO-LOAD\nTHRESHOLDREACTIVE\nENERG Y\nREVRPx BIT\nIN STA TUS0\nxVARSIGN BIT\nIN PHSIGN\n08510-153 \nFigure 80. Reactive Power Signed Accumulation Mode  \nWhen VARACC[1:0]  = 10, the reactive powers are accumulated \ndepending on the sign of the corresponding active power. If the \nactive power is positive, the reactive power is accumulated as is. If the activ e power is negative, the sign of the reactive power is \nchanged for accumulation. Figure 81 shows how  the sign adjusted  \nreactive power accumulation mode works. I n this mode, the \nxV ARHR registers continue to accumula te reactive powers in \nsigned mode, even if the  CFx pulses are generated based on the \nsign adjusted accumulation mode.  \nV ARACC[1:0] settings of 01 and 11 are reserved. The ADE7854/ ADE7858/ ADE7868 /ADE7878 behave identically to \nthe case when V ARACC[1:0] = 00.  \nRev. H | Page 63 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nPOS POS VARNOLOAD\nSIGN = POSITIVENEGNO-LOAD\nTHRESHOLDNO-LOAD\nTHRESHOLD\nNO-LOAD\nTHRESHOLDREACTIVE\nPOWER\nACTIVE\nPOWERREACTIVE\nENERG Y\nREVRPx BIT\nIN STATUS0\nxVARSIGN BIT\nIN PHSIGN\n08510-155 \nFigure 81. Reactive Power Accumulation  in Sign Adjusted Mode  \nSign of S um -of-Phase Powers in  the CFx Datap ath  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have sign \ndetection  circuitry for the sum of phase powers that are used in \nthe CFx datapath. As seen in the beginning of  the Energy -to-\nFrequency Conversion  section , the energy accumulation in the \nCFx data path is executed in two stages. Every time a sign change is \ndetected  in the energy accumulation at the end of the first stage, \nthat i s, after the energy accumulated into the accumulator \nreaches one of the WTHR, V ARTHR , or V ATHR thresholds, a \ndedicated interrupt can  be triggered synchronously  with the \ncorresponding CFx pulse. The sign of each sum can  be read in \nthe PHSIGN register.  \nBit 18, Bit 13, and Bit 9 (REVPSUM3, REVPSUM2, and \nREVPSUM1 , respectively ) of the STATUS0  register are set \nto 1 when a sign change of the sum of powers in CF3, CF2 , \nor CF1 datapaths occurs. To correlate these events with the \npulses generated at the CFx pins, af ter a sign change occurs, \nBit REVPSUM3, Bit REVPSUM2 , and Bit REVPSUM1 are set \nin the same moment in which a high -to-low transition at the \nCF3, CF2 , and CF1 pin, respectively , occurs.  \nBit 8,  Bit 7, and Bit 3 (SUM3SIGN, SUM2SIGN , and SUM1SIGN , \nrespective ly) of the PHSIGN  register are set in the same moment  \nwith Bit REVPSUM3, Bit REVPSUM2 , and Bit REVPSUM1 and \nindicate the sign of the sum of phase powers. When cleared to \n0, the sum is positive. When set to 1, the sum is negative.  \nInterrupts attached to Bit  18, Bit 13, and Bit 9 (REVPSUM3, \nREVPSUM2, and REVPSUM1 , respectively ) in the STATUS0  \nregister are enabled by setting Bit 18, Bit 13, and Bit 9 in the \nMASK0  register. If enabled, the IRQ0  pin is set low , and the \nstatus bit is set to 1 whe never a change of sign occurs. To f ind \nthe phase that triggered the interrupt, the PHSIGN register is \nread immediately after reading the STATUS0  register . Next,  the \nstatus bit is cleared , and the IRQ0  pin is set high again by writing   \nto the STATUS0 register with the corresponding bit set to 1.  NO LOAD CONDITION  \nThe no load condition is defined in metering equipment standards \nas occurring when the voltage is applied to the meter and no cur -\nrent flows in the current circuit. To eliminate an y creep effects in \nthe meter, the ADE7854/ ADE7858/ ADE7868/ ADE7878contain  \nthree separate no load detection circuits: one related to the total \nactive and reactive powers  (ADE7858/ ADE7868/ ADE7878 \nonly) , one related to the fundamental active and reactive powers  \n(ADE7878 only) , and one related to the  apparent powers . \nNo Load Detection Based On Total Active , Reactive \nPowers  \nThis no load condition is triggered when the absolute values of \nboth phase total active and reactive powers are less than or equal \nto positive thresholds indicated in the respective APNOLOAD \nand V ARNOLOAD signed 24-bit registers. I n this case, the total \nactive and reactive energies of that phase are not accumulated \nand no CFx pulses are generated based on these energies. The \nAPNOLOAD register represents the positive no load level of \nactive power relative to PMAX, the maximum active power obtained when full -scale voltages and currents are provided at \nADC inputs. The V ARNOLOAD register represents the positi ve \nno load level of reactive power relative to PMAX. The expres -\nsion used to comp ute APNOLOAD signed 2 4-bit value is   \nPMAXII\nVVAPNOLOAD\nFSNOLOAD\nFSn× ×=  (47) \nwhere:  \nPMAX  = 33,516,139 = 0x1FF6A6B , the instantaneous power \ncomputed when the ADC inputs are at full scale . \nVFS, IFS are the rms values of phase voltages and currents when \nthe ADC inputs are at full scale.  \nVn is the nominal rms value of phase voltage.  \nINOLOAD  is the minimum rms value of phase current the meter \nstarts measuring.  \nThe V ARNOLOAD register usually contains the same value as \nthe APNOLOAD  register . When APNOLOAD and V ARNOLOAD \nare set to negative values , the no load detection circuit is disabled.  \nNote that the ADE7854 measure s only the total active powers. \nTo ensure good functionality of the ADE7854 no-load circuit, \nset the V ARNOLOAD register at 0x800000.   \nAs previously stated  in the Current Waveform Gain Registers  \nsection , the serial ports of  the ADE78xx  work on  32-, 16-, or \n8-bit words  and the DSP works on 28 bits . APNOLOAD and \nV ARNOLOAD 24-bit signed registers are ac cessed as 32- bit \nregisters with  the four MSBs padded with 0s and sign extended \nto 28 bits . See Figure 35 for details. \nBit 0 (NLOAD) in the STATUS1 register is set when this no \nload condition in one of the three phases is triggered. Bits [2:0] \n(NLPHASE[2:0]) in the PHNOLOAD register indicate the state \nof all phases relative to a no load condition and are set simulta -\nneously with B it NLOAD in the STATUS1 register . NLPHASE[0] \nindicates the state of Phase A , NLPHASE[1] i ndicates the state \nRev. H | Page  64 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nof Phase B, and NLPHASE[2] indicates the state of P hase C. \nWhen Bit NLPHASE[x]  is cleared to 0, it means the phase is out \nof a no load condition. When set to 1, it means the phase is in  a \nno load condition.  \nAn interrupt attached to B it 0 (NLOAD) in the STATUS1 \nregister can be enabled by setting B it 0 in the MASK1  register. \nIf enabled, the IRQ1  pin is set to low, and the status bit is set \nto 1 whenever one of three phases enters or exits this no load \ncondition. To find th e phase that triggered the interrupt, the \nPHNOLOAD register is read immediately after reading the \nSTATUS1 register . Next , the status bit is cleared , and the IRQ1  \npin is set to  high by writing to the STATUS1 register with the \ncorresponding  bit set to 1.  \nNo Load Detection Based on Fundamental Active and \nReactive Powers —ADE7878 Only  \nThis no  load condition (available on the ADE7878 only) is \ntriggered when the absolute values of bo th phase fundamental \nactive and reactive powers are less than or equal to the respective \nAPNOLOAD and V ARNOLOAD  positive thresholds. In this \ncase, the fundamental active and reactive energies of that phase are not accumulated , and no CFx pulses are generated based on \nthese energies. APNOLOAD and V ARNOLOAD are the same \nno load thresholds set for the total active and reactive powers. \nWhen APNOLOAD and V ARNOLOAD are set to negative \nvalues, this no load detection circuit is disabled.  \nBit 1 (FNLOAD) in the STATUS1 register is set when this no \nload condition in one of the three phases is triggered. Bits [5:3] \n(FNLPHASE[2:0]) in the PHNOLOAD register indicate the \nstate of all phases relative to a no load condition and are set \nsimultaneously with Bit FNLOAD in the STATUS1  register . \nFNLPHASE[0] indicates the state of Phase A , FNLPHASE[1] \nindicates the state of P hase B, and FNLPHASE[2] indicates the \nstate of P hase C. When B it FNLPHASE[x] is cleared to 0, it \nmeans the phase is out of the no load condition. When set to 1, \nit means the phase is in a no load condition.  \nAn interrupt attached to the B it 1 (FNLOAD) in the STATUS1 \nregister can be enabled by setting B it 1 in the MASK1  register. If \nenabled, the \nIRQ1  pin is set low and the status bit is set to 1 \nwhenever one of three phases enters or exits this no  load \ncondition. To find the phase that triggered the interrupt, the \nPHNOLOAD register  is read immediately after reading the \nSTATUS1  register . Then the status bit is cleared and the IRQ1  \npin is set back high by writing to the STATUS1 register with the \ncorresponding bit set to 1.  \nNo Load Detection Based o n Apparent Pow er \nThis no load condition is triggered when the absolute value \nof phase apparent power is less than or equal to  the threshold \nindicated in the V ANOLOAD 24-bit signed register.  In this \ncase, the apparent energy of that phase is not accumulated and no CF x pulses are generated based on this energy. The \nV ANOLOAD register  represents the positive no load level \nof apparent power relative to P MAX, the maximum appare nt power obtained when full -scale voltages and currents are \nprovided  at the ADC inputs. Th e expression used to com pute \nthe VANOLOAD signed 24 -bit value is   \nPMAXII\nVVVANOLOAD\nFSNOLOAD\nFSn× ×=  (48) \nwhere : \nPMAX  = 33,516,139 = 0x1FF6A6B , the instantaneous apparent \npower computed when the ADC inputs are at full scale . \nVFS, IFS are the rms values of phase volta ges and currents when \nthe ADC inputs are at full scale.  \nVn is the nominal rms value of phase voltage.  \nINOLOAD  is the minimum rms value of phase current the meter \nstarts measuring.  \nWhen the V ANOLOAD register is set to negative values , the no \nload detection  circuit is disabled.  \nAs stated in the Current Waveform Gain Registers  section,  the \nserial ports of  the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nwork on 32- , 16-, or 8-bit words  and the DSP works on 28 bits . \nSimilar to the registers presented in  Figure 35, the V ANOLOAD \n24-bit signed register is accessed as a 32- bit register  with the \nfour MSBs padded with 0s and sign extended to 28 bits . \nBit 2 (V ANLOAD) in the STATUS1 register is set when this no \nload condition in one of the three phases is triggered. Bits [8:6] \n(V ANLPHASE[2:0]) in the PHNOLOAD register indicate the \nstate of all phases relative to a no load condition and they are set \nsimultaneously with Bit V ANLOAD in the STATUS1 register : \n• Bit V ANLPHASE[0]  indicates the state of Phase A . \n• Bit V ANLPHASE[1]  indicates  the state of P hase B . \n• Bit V ANLPHASE[2] indicates the state of P hase C.  \nWhen Bit VA N L P HA SE [ x ] is cleared to 0, it means the phase is \nout of no load condition. When set to 1, it means the phase is in \nno load condition.  \nAn interrupt attached to  Bit 2 (V ANLOAD) in the STATUS1 \nregister is enabled by setting B it 2 in the MASK1  register. If \nenabled, the IRQ1  pin is set low and the status bit is set to 1 \nwhenever one of three phases ente rs or exits this no load \ncondition. To find the phase that triggered the interrupt, the \nPHNOLOAD register is read immediately after reading the \nSTATUS1 register . Next,  the status bit is cleared , and the IRQ1  \npin is set to  high by writing to the STATUS1 register with the \ncorresponding bit set to 1.   \nCHECKSUM REGISTER  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have a checksum \n32-bit register , CHECKSUM , that ensures certain very important  \nconfiguration registers maintain their desired value during \nNormal Power Mode PSM 0. \nThe registers covered by this register are MASK0 , MASK1 , \nCOMPMODE , gain , CFMODE, CF1DEN, CF2DEN, CF3DEN, \nCONFIG , MMODE, ACCMODE, LCYCMODE, HSDC_CFG, \nand another six 8 -bit reserved internal registers that always have \nRev. H | Page 65 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \ndefault values. The ADE78xx  compute s the cyclic redundancy \ncheck (CRC) based on the IEEE802.3 standard. The registers \nare introduced one -by-one into a linear feedback shift register \n(LFSR) based generator starting w ith the least  significant bit (as \nshown  in Figure 82). The 32 -bit result is written in the \nCHEC KSUM register. After power -up or a hardware/software \nreset, the CRC is computed on the default values of the registers  \ngiving t he results presented in the Table 23 . \nTable 23. Default Values of CHECKSUM and of I nternal \nRegisters CRC  \nPart No. Default Value of \nCHECKSUM  CRC of Internal \nRegisters  \nADE7854  0x44C48F8 0x391FBDDD  \nADE7858  0xD6744F93  0x3E7D0FC1  \nADE7868  0x93D774E6 0x23F7C7B1 \nADE7878  0x33666787 0x2D32A389 \nFigure 83 shows  how the LFSR works. The MASK0, MASK1, \nCOMPMODE,  gain , CFMODE, CF1DEN, CF2DEN, CF3DEN, \nCONFIG, MMODE, ACCMODE, LCYCMODE, and HSDC_CFG \nregister s, and the six 8 -bit reserved internal registers form the \nbits [a 255, a254,…, a 0] used by LFSR . Bit a0 is the  least  significant \nbit of the first internal register to enter LFSR; Bit a255 is the  most \nsignificant bit of the MAS K0 register, the last register to enter \nLFSR. The formulas  that govern LFSR are as follows : \nbi(0) = 1, i = 0, 1, 2, …, 31, the initial state of the bits that form \nthe CRC. Bit b0 is the  least  significant bit, and Bit b 31 is the most \nsignificant.  gi, i = 0, 1, 2, …, 31 are the coefficients of the generating \npolynomial defined by the IEEE802.3 standard as follows:  \nG(x) = x32 + x26 + x23 + x22 + x16 + x12 + x11 + x10 + x8 + x7 + \nx5 + x4 + x2 + x + 1 (49) \ng0 = g1 = g2 = g4 = g5 = g7 = 1 \ng8 = g10 = g11 = g12 = g16 = g22 =g23= g26 = 1 (50) \nAll of the other g i coefficients are equal to 0.  \nFB(j) = a j – 1 XOR b31(j – 1) (51) \nb0(j) = FB (j) AND g 0 (52) \nbi(j) = FB(j) AND g i XOR bi − 1(j – 1), i = 1, 2, 3, ..., 31  (53) \nEquation  51, Equation  52, and Equation 5 3 must be  repeated for \nj = 1, 2, …, 256. The value written into the CHECKSUM register  \ncontains the Bit  bi(256) , i = 0, 1, …, 31. The value of the CRC , \nafter the bits from the reserved internal register have passed \nthrough LF SR, is obtained at Step j = 48 and is  presented in the \nTable 23.  \nTwo different approaches can  be followed in using the CHECK -\nSUM register. One is to compute the CRC b ased on  the relations \n(47) to (53) and then compare the value against the CHECKSUM  \nregister. Another is to periodically read the CHECKSUM register.  \nIf two consecutive readings differ, it can  be assumed that one of \nthe registers has changed value and theref ore, the ADE7854, \nADE7858, ADE7868, or ADE7878 has changed configuration. \nThe recommended response is to initiate a hardware/software reset that sets the values of all registers to the default, including \nthe reserved ones, and then reinitialize the configuration registers . \n31 0 015 015 0 0 15 31\n255 248 240 232 224 2167 07 07 07 0\n00 7 0 7\n40 32 24 16 87MASK0 MASK1 COMPMODE CFMODE GAININTERNA L\nREGISTERINTERNA L\nREGISTERINTERNA L\nREGISTERINTERNA L\nREGISTERINTERNA L\nREGISTERINTERNA L\nREGISTER\nLFSR\nGENER ATOR\n08510-055 \nFigure 82. CHECKSUM Register Cal culation  \n \n \nb0\nLFSRFBg0 g1 g2 g31\nb1g3\nb2 b31\na255,a254,....,a2,a1,a0\n08510-056 \nFigure 83. LFSR Generator Use d in CHECKSUM Register Calcul ation  \nINTERRUPTS  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have two interrupt \npins, IRQ0  and IRQ1 . Each of the  pins is managed by a 32 -bit \ninterrupt mask register, MASK0  and MASK1 , respectively . To \nenable an interrupt, a bit in the MASKx register must  be set to 1. To disable it, the bit must  be cleared to 0. Two 32 -bit status \nregisters, STATUS0  and STATUS1 , are associated with the  inter -\nrupts. When an interrupt event occurs in  the ADE78xx , the \ncorresponding flag in the interrupt status reg ister is set to a Logic 1 \n(see Table 37  and Table 38). If the mask bit for this interrupt in \nthe int errupt mask register is Logic  1, then the IRQx  logic output  \nRev. H | Page  66 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \ngoes active low. The flag bits in the interrupt status register are set \nirrespective of the state of the mask bits. To determine the source \nof the interrupt, the MCU should perform a read of the corres -\nponding STATUSx register and identify which bit is set to  1. To \nerase the flag in the status register, write back to the STATUSx \nregister with the flag  set to 1. After  an interrupt pin goes low, the \nstatus register is read and the source of the interrupt is identified. Then , the status register is written back without any change to \nclear the status flag to 0. The  \nIRQx  pin remains low until the \nstatus flag is cancelled.  \nBy default, all interrupts are disabled.  However, the RSTDONE \ninterrupt is an exception. This interrupt can never be masked (disabled) and , therefore , Bit 15 (RSTDONE) in the MASK1  \nregister does not have any functionality. The \nIRQ1  pin always \ngoes low , and Bit 15 (RSTDONE) in the STATUS1  register  is set \nto 1 whenever a power -up or a hardware/software reset process  \nends.  To cancel the s tatus flag, the STATUS1 register has to be \nwritten with Bit 15  (RSTDONE) set to 1.  \nCertain interrupts are used in conjunction with other status registers . The following bits in the MASK1 register work in  \nconjunction with the status bits in the PHNOLOAD reg ister: \n• Bit 0 (NLOAD ) \n• Bit1 (FNLOAD), available in the ADE7878 only  \n• Bit 2 (VA N L OA D )  \nThe following bits in the MASK1 register work with the status bits \nin the PHSTATUS register:  \n• Bit 16, ( SAG )  \n• Bit 17 (OI)  \n• Bit 18 (OV)  \nThe following bits in the MASK1 register work with the status bits in the IPEAK and VPEAK registers, respectively:  \n• Bit 23 (PKI)   \n• Bit 24 (PKV)  \n \nThe following bits in the MASK0 register work with the status bits in the PHS IGN register:  \n• Bits[6:8] (REV APx)  \n• Bits[ 10:12]  (REVRPx) , available in the ADE7858, \nADE7868, and ADE7878 only  \n• Bit 9, Bit 13, and Bit  18 (REVPSUMx)   When the STATUSx register is read and one of these bits is set \nto 1, the status register associated with the bit  is immediately \nread to identify the phase that triggered the interrupt and only at that time can the  STATUSx register be written back with th e bit \nset to 1 . \nUsing the Interrupts with an MCU  \nFigure 84 shows a timing diagram that illustrates a suggested \nimplementation of the ADE7854 /ADE7858/ ADE7868/ ADE7878 \ninterrupt management using an MCU. At Time t 1, the IRQx pin \ngoes active low indicating that one or more interrupt events have occurred in  the ADE78xx , at which point the following \nsteps should be taken:  \n1. Tie the \nIRQx pin to a negative -edge -triggered external \ninterrupt on the MCU.  \n2. On detection of the negative edge, configure the MCU to \nstart executing its interrupt service routine (ISR).  \n3. On entering the ISR, disable all interrupts using the global \ninterru pt mask bit. At this point, the MCU external interrupt \nflag can be cleared to capture interrupt events that occur \nduring the current ISR.  \n4. When the MCU interrupt flag is cleared, a read from \nSTATUSx, the interrupt status register , is carried out. The \ninterrupt sta tus register content is used to determine the \nsource of the interrupt(s) and , hence , the appropriate \naction to be taken.  \n5. The same STATUSx content is written back into  the \nADE78xx  to clear the status flag(s) and reset  the IRQx  line \nto logic high (t 2).  \nIf a subsequent interrupt event occurs during the ISR (t 3), that \nevent is recorded by the MCU external interrupt flag being set \nagain.  \nOn returning from the ISR, the global interrupt mask bit is \ncleared (same instruction cycle) and the external interrupt flag uses the MCU to jump to its ISR once again. This ensures that the MCU does not miss any external interrupts.  \nFigure 85 shows a recommended timing diagram when the \nstatus bits in the STATUSx registers work in conjunction with \nbits in other registers. W hen the \nIRQx  pin goes active low, the \nSTATUSx register is read , and if one of these bits is 1, a secon d  \n   \nRev. H | Page 67 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nJUMP\nTO ISRGLOBA L\nINTERRUPT\nMASKCLEAR MCU\nINTERRUPT\nFLAGREAD\nSTATUSxJUMP\nTO ISRWRITE\nBACK\nSTATUSxISRACTION\n(BASED ON S TATUSx CONTENTS)ISR RETURN\nGLOBA L INTERRUPT\nMASK RESETMCU\nINTERRUPT\nFLAG SET\nPROGRAM\nSEQUENCEt1 t2 t3\nIRQx\n08510-057 \nFigure 84. Interrupt Mana gement  \nJUMP\nTO ISRGLOBA L\nINTERRUPT\nMASKCLEAR MCU\nINTERRUPT\nFLAGREAD\nSTATUSxREAD\nPHxJUMP\nTO ISRWRITE\nBACK\nSTATUSxISRACTION\n(BASED ON S TATUSx CONTENTS)ISR RETURN\nGLOBA L INTERRUPT\nMASK RESETMCU\nINTERRUPT\nFLAG SET\nPROGRAM\nSEQUENCEt1 t2 t3\nIRQx\n08510-058 \nFigure 85. Interrupt Manage ment when PHSTATUS, IPEAK, VPEAK , or PHSIGN Registers are Inv olved  \nstatus register is read immediately to identify the phase that \ntrigg ered the interrupt. The name, PHx, in Figure 85 denotes \none of the PHSTATUS, IPEAK, VPEAK, or PHSIGN registers. \nThen, STATUSx is written back to clear the status flag(s). \nSERIAL INTERFACES  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 have three serial \nport interfaces: one fully licensed I2C interface, one serial \nperipheral interface (SPI) , and one high speed data capture port \n(HSDC). As the SPI pins are multiplexed with some of the pins \nof the I2C and HSDC ports, the ADE78xx  accept s two confi -\ngurations: one using the SPI port only and one using the I2C \nport in conjunction with the HSDC port.  \nSerial Interface Choic e \nAfter reset, the HSDC port is always disabled. Choose  between \nthe I2C and SPI port s by manipulating the SS/HSA  pin after \npower -up or after a hardware reset. If the SS/HSA  pin is kept \nhigh, then  the ADE7854/ ADE7858/ ADE7868 /ADE7878 use the \nI2C port until a new hardware reset is executed. If  the SS/HSA  \npin is toggled high to low three  times after power -up or after a \nhardware reset, the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nuse the SPI port until a new hardware reset is executed. This \nmanipulation of the SS/HSA  pin can be accomplished in two \nways . First,  use the SS/HSA  pin of the master device ( that is,  the \nmicrocontroller) as a regular I/O pin and toggle it three  times . \nSecond,  execute three  SPI write operations to a location in the \naddress space that is not allocated to  a specific ADE78xx  register \n(for example 0xEBFF , where eight  bit writes can be executed ). \nThese writes  allow the SS/HSA  pin to toggle three  times. See the \nSPI Write Operation  section for details on the write protocol \ninvolved.  \n \n   After the serial port choice is completed , it needs to be locked. \nConsequently,  the active port remains in use until a hardware \nreset is execu ted in PSM0 no rmal mode or until a power -down . \nIf I\n2C is the active serial port, Bit 1 (I2C_LOCK) of the CONFIG2  \nregister must be set to 1 to lock it in. From this moment,  the \nADE7854/ ADE7858/ ADE7868 /ADE7878 ignore spurious \ntoggling  of the  SS pin and an even tual switch into using the SPI \nport is no longer possible. If the SPI is the active serial port, any \nwrite to the CONFIG2 register locks the port. From this moment , \na switc h into using the I2C port is no longer possible.  Once locked,  \nthe serial port choice is maintained when the ADE78xx  changes \nPSMx  power modes.  \nThe functionality of the ADE78xx  is access ible via several on -\nchip registers. The contents of these registers can be updated or \nread using  either the I2C or SPI interfaces. The HSDC port provides  \nthe stat e of up to 1 6 registers representing instantaneous values of  \nphase voltages and neutral curren ts, and active, reactive , and \napparent powers.  \nI2C-Compatible Interface  \nThe ADE7854/ ADE7858/ ADE7868/ ADE7878 support s a fully \nlicensed I2C interface. The I2C interface is implemented as a full \nhardware slave. SDA is the data I/O pin, and SCL is the serial \nclock. These two pins  are shared with the MOSI and SCLK pins \nof the on -chip SPI interface. The maximum serial clock frequency  \nsupported by this interface is 400  kHz. \nThe two pins used for data transfer, SDA and SCL , are confi -\ngured  in a w ire-AND ’e d format tha t allows arbitrati on in a \nmulti master system.  \nThe transfer sequence of an I2C system consists of a master device  \ninitiating a transfer by generating a start  condition while the bus \nis idle. The master transmits the address of the slave device and the direction of the data t ransfer in the initial address transfer. If \nthe slave acknowledges , the data transfer is initiated. This con -\ntinues until the master issues a stop condition , and the bus \nbecomes idle .  \n \nRev. H | Page  68 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nI2C Write Operation  \nThe write operation using the I2C interface of the  ADE7854/ \nADE7858/ ADE7868/ ADE7878 initiate  when the master generates  \na start condition and consists in one byte representing the \naddress of the ADE78xx  followed by the 16 -bit address of the \ntarget register and by the value of the register.  \nThe most significant seven  bits of the address byte constitute \nthe address of the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nand they are equal to 0111000 b. Bit 0 of the address byte is  a read /write  bit. Because this is a write operation, it has to be \ncleared to 0 ; therefore,  the first byte of the write operation is \n0x70. After every byte is received, the ADE7854 /ADE7858/ \nADE7868/ ADE7878 generate an acknowledge. As registers can  \nhave 8, 16 , or 32 bits , after the last bit of the register is transmitted  \nand the ADE78xx  ackno wledges the transfer, the master gene -\nrates a stop condition. The addresses and the register content \nare sent with the most significant bit first. S ee Figure 86 for \ndetails of the I2C write operation.  \nACKNOWLEDGE\nGENERATED BY\nADE78xxSTART\nSTOP\nS\nA\nC\nKA\nC\nKA\nC\nKA\nC\nKA\nC\nKA\nC\nKA\nC\nKS 015\nSLAVE ADDRESSMSB 8 BITS OF\nREGISTER ADDRESSLSB 8 BITS OF\nREGISTER ADDRESSBYTE 3  (MSB)\nOF REGISTERBYTE 2 OF REGISTER BYTE 1 OF REGISTERBYTE 0 (LSB) OF\nREGISTER8 7 0 31 24 23 16 15 8 0 7\n1110000\n08510-059 \nFigure 86. I2C Write Operation of a 32- Bit Register  \n \nRev. H | Page 69 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nI2C Read Operation  \nThe read operation using the I2C interface of the ADE7854/ \nADE7858/ ADE7868/ ADE7878 is accomplished in two stages. \nThe first stage sets the pointer to the address of the register. The \nseco nd stage reads the content of the register.  \nAs seen in Figure 87, the first stage initiates when the master \ngenerates a start condition and consists in one byte representing \nthe address of the ADE7854/ ADE7858/ ADE7868/ ADE7878 \nfollowed by the 16 -bit address of the target register. The ADE78xx  \nacknowledges every byte received. The address byte is similar to \nthe address byte of a write operation and is equal to 0 x70 (see \nthe I2C Write Operation  section for details). After the last byte \nof the register address has been sent and acknowledged by the ADE7854/ ADE7858/ ADE7868 /ADE7878, the second stage \nbegins w ith the master generating a new start c ondition followed  \nby an ad dress byte. The most significant seven bits of this address \nbyte constitute the address of the ADE78xx , and they are equal to \n0111000b. Bit  0 of the add ress byte is a read/ write  bit. Because this \nis a read operation, it must be set to 1; thus, the first by te of the \nread operation is 0x71. After this byte is received , the ADE78xx  \ngenerates an acknowledge. Then, the ADE78xx  sends the value \nof the register, and  after every eight bits are received, the master \ngenerates an acknowledge. All the bytes are  sent with the most \nsignificant bit first. Because  registers can have 8, 16, or 32 bits, \nafter the last bit of the register is received, the master do es not \nacknowledge the transfer  but generates a stop condition.  \nACKNOWLEDGE\nGENERATED BY\nADE78xx\nACKNOWLEDGE\nGENERATED BY\nMASTERSTART\nS\nA\nCKACKAC\nK015\nSLAVE ADDRESSMSB 8 BITS OF\nREGISTER ADDRESSLSB 8 BITS OF\nREGISTER ADDRESS8 7 0\n1110000START\nSTOP\nS\nA\nCKACKACKACK\nS 0\nSLAVE ADDRESSBYTE 3  (MSB)\nOF REGISTERBYTE 2 OF\nREGISTERBYTE 1 OF\nREGISTERBYTE 0 (LSB)\nOF REGISTER31 24 23 16 15 8 0 7\n1110001\nACKNOWLEDGE\n GENERATED BY\nADE78xxN\nO\nA\nC\nK\n08510-060\n \nFigure 87. I2C Read Operation of a 32- Bit Registe r \nRev. H | Page  70 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 71 of 100 SPI-Compatible Interface \nThe SPI of the ADE7854 /ADE7858 /ADE7868 /ADE7878  is \nalways a slave of the communication and consists of four pins \n(with dual functions): SCLK/SCL, MOSI/SDA, MISO/HSD, and \nSS/HSA. The functions used in the SPI-compatible interface are \nSCLK, MOSI, MISO, and SS. The serial clock for a data transfer \nis applied at the SCLK logic input. All data transfer operations synchronize to the serial clock. Data shifts into the ADE78xx  at \nthe MOSI logic input on the falling edge of SCLK and the ADE78xx  samples it on the rising edge of SCLK. Data shifts out \nof the ADE7854 /ADE7858 /ADE7868/ ADE7878  at the MISO \nlogic output on a falling edge of SCLK and can be sampled by the master device on the raising edge of SCLK. The most significant bit of the word is shifted in and out first. The maximum serial clock frequency supported by this interface is 2.5 MHz. MISO stays in high impedance when no data is transmitted from the ADE7854 /ADE7858 /ADE7868/ ADE7878 . \nSee Figure 88 for details of the connection between the \nADE78xx  SPI and a master device containing an SPI interface. \nThe SS\n logic input is the chip select input. This input is used \nwhen multiple devices share the serial bus. Drive the SS input \nlow for the entire data transfer operation. Bringing SS high \nduring a data transfer operation aborts the transfer and places \nthe serial bus in a high impedance state. A new transfer can \nthen be initiated by returning the SS logic input to low. However, \nbecause aborting a data transfer before completion leaves the \naccessed register in a state that cannot be guaranteed, every time a register is written, its value should be verified by reading it back. The protocol is similar to the protocol used in I\n2C \ninterface. MOSI/SDA\nMISO/HSD\nSCLK/SCLADE78xx\nMOSI\nMISO\nSCKSPI DEVICE\nSS/HSA SS\n08510-061 \nFigure 88. Connecting ADE78xx  SPI with an SPI Device \nSPI Read Operation \nThe read operation using the SPI interface of the ADE7854 / \nADE7858 /ADE7868 /ADE7878  initiate when the master sets the \nSS/HSA pin low and begins sending one byte, representing the \naddress of the ADE7854 /ADE7858 /ADE7868 /ADE7878 , on the \nMOSI line. The master sets data on the MOSI line starting with \nthe first high-to-low transition of SCLK. The SPI of the ADE78xx  \nsamples data on the low-to-high transitions of SCLK. The most \nsignificant seven bits of the address byte can have any value, but as a good programming practice, they should be different from \n0111000b, the seven bits used in the I\n2C protocol. Bit 0 (read/ write ) \nof the address byte must be 1 for a read operation. Next, the \nmaster sends the 16-bit address of the register that is read. After \nthe ADE78xx  receives the last bit of address of the register on a \nlow-to-high transition of SCLK, it begins to transmit its contents \non the MISO line when the next SCLK high-to-low transition occurs; thus, the master can sample the data on a low-to-high SCLK transition. After the master receives the last bit, it sets the \nSS\n and SCLK lines high and the communication ends. The data \nlines, MOSI and MISO, go into a high impedance state. See \nFigure 89 for details of the SPI read operation. \n \n1 015 14SCLK\nMOSI\nMISO10\n31 30 1 00000 0 0\nREGISTER VALUEREGISTER ADDRESSSS\n08510-062 \nFigure 89. SPI Read Operation of a 32-Bit Register \n \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nSPI Write Operation  \nThe write operation using the SPI interface of the ADE78xx  \ninitiates when the master sets  the SS/HSA  pin low and begins \nsending one byte representing the addres s of the ADE7854/ \nADE7858/ ADE7868/ ADE7878 on the MOSI line. The master \nsets data on the MOSI line starting with the first high -to-low \ntransition of SCLK. The SPI of the ADE78xx  sample s data on \nthe l ow-to-high transitions of SCLK. The most significant seven  \nbits of the address byte can have any value, but as a good pro -\ngramming practice, they should be different from 0111000 b, the seven bits used in the I2C protocol. Bit 0 (read/ write ) of the \naddress byte must be 0 for a write operation. Next, the master \nsends both the 16 -bit address of the register that is written and \nthe 32 -, 16-, or 8-bit value of that register without losing any \nSCLK cycle. After the last bit is transmitted, the m aster sets the \nSS and SCLK lines high at the end of the SCLK cycle and the \ncommunication ends. The data lines , MOSI and MISO , go in to \na high impedance state.  See Figure 90 for det ails of the SPI w rite \noperation.   \n \n \n01514SCLK\nMOSI103130 10\n00 0 0000REGISTER ADDRESS REGISTER VALUESS\n08510-063 \nFigure 90. SPI Write Operation of a 32- Bit Register  \nRev. H | Page  72 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 73 of 100 HSDC Interface \nThe high speed data capture (HSDC) interface is disabled after \ndefault. It can be used only if the ADE7854 /ADE7858 /ADE7868 / \nADE7878  is configured with an I2C interface. The SPI interface \nof the ADE7854 /ADE7858 /ADE7868/ ADE7878  cannot be used \nsimultaneously with HSDC. \nBit 6 (HSDCEN) in the CONFIG register activates HSDC when \nset to 1. If Bit HSDCEN is cleared to 0, the default value, the HSDC interface is disabled. Setting Bit HSDCEN to 1 when SPI is in use does not have any effect. HSDC is an interface for \nsending to an external device (usually a microprocessor or a \nDSP) up to sixteen 32-bit words. The words represent the instantaneous values of the phase currents and voltages, neutral current, and active, reactive, and apparent powers. The registers being transmitted include IAWV , V AWV , IBWV , VBWV , ICWV , \nVCWV , INWV , A V A, BV A, CV A, AW ATT, BW ATT, CW ATT, \nAV AR, BV AR, and CV AR. All are 24-bit registers that are sign extended to 32-bits (see Figure 37 for details). In the case of ADE7854  and ADE7858 , the INWV register is not available. In \nits place, the HSDC transmits one 32-bit word always equal \nto 0. In addition, the AV AR, BV AR, and CV AR registers are not \navailable in the ADE7854 . In their place, the HSDC transmits \nthree 32-bit words that are always equal to 0.  \nHSDC can be interfaced with SPI or similar interfaces. HSDC is \nalways a master of the communication and consists of three pins: HSA, HSD, and HSCLK. HSA represents the select signal. It stays active low or high when a word is transmitted and it is \nusually connected to the select pin of the slave. HSD sends data \nto the slave and it is usually connected to the data input pin of the slave. HSCLK is the serial clock line that is generated by the ADE7854 /ADE7858 /ADE7868 /ADE7878  and it is usually con-\nnected to the serial clock input of the slave. Figure 91 shows the connections between the ADE78xx  HSDC and slave devices \ncontaining an SPI interface. \n08510-064MISO/HSD\nCF3/HSCLKADE78xx\nMISO\nSCKSPI DEVICE\nSS/HSA SS\n \nFigure 91. Connecting the ADE78xx  HSDC with an SPI \nThe HSDC communication is managed by the HSDC_CFG \nregister (see Table 53). It is recommended to set the HSDC_CFG register to the desired value before enabling the port using Bit 6 (HSDCEN) in the CONFIG register. In this way, the state of \nvarious pins belonging to the HSDC port do not take levels incon-\nsistent with the desired HSDC behavior. After a hardware reset \nor after power-up, the MISO/HSD and SS\n/HSA pins are set high. \n \n   Bit 0 (HCLK) in the HSDC_CFG register determines the serial \nclock frequency of the HSDC communication. When HCLK is 0 (the default value), the clock frequency is 8 MHz. When HCLK  is 1, the clock frequency is 4 MHz. A bit of data is transmitted \nfor every HSCLK high-to-low transition. The slave device that \nreceives data from HSDC samples the HSD line on the low-to-\nhigh transition of HSCLK. \nThe words can be transmitted as 32-bit packages or as 8-bit \npackages. When Bit 1 (HSIZE) in the HSDC_CFG register is 0 (the default value), the words are transmitted as 32-bit packages. When Bit HSIZE is 1, the registers are transmitted as 8-bit packages. The HSDC interface transmits the words MSB first. \nBit 2 (HGAP) introduces a gap of seven HSCLK cycles between \npackages when Bit 2 (HGAP) is set to 1. When Bit HGAP is cleared \nto 0 (the default value), no gap is introduced between packages and the communication time is shortest. In this case, HSIZE does not have any influence on the communication and a data bit is placed on the HSD line with every HSCLK high-to-low transition. \nBits[4:3] (HXFER[1:0]) decide how many words are transmitted. \nWhen HXFER[1:0] is 00, the default value, then all 16 words are \ntransmitted. When HXFER[1:0] is 01, only the words representing the instantaneous values of phase and neutral currents and phase voltages are transmitted in the following order: IAWV , V AWV , IBWV , VBWV , ICWV , VCWV , and one 32-bit word that is always \nequal to INWV . When HXFER[1:0] is 10, only the instantaneous \nvalues of phase powers are transmitted in the following order: AV A, BV A, CV A, AW ATT, BW ATT, CW ATT , A V AR, BV AR, and CV AR. The value, 11, for HXFER[1:0] is reserved and writing it is \nequivalent to writing 00, the default value. \nBit 5 (HSAPOL) determines the polarity of HSA function of the \nSS\n/HSA pin during communication. When HSAPOL is 0 (the \ndefault value), HSA is active low during the communication. This means that HSA stays high when no communication is in \nprogress. When a communication is executed, HSA is low when \nthe 32-bit or 8-bit packages are transferred, and is high during \nthe gaps. When HSAPOL is 1, the HSA function of the SS\n/HSA \npin is active high during the communication. This means that \nHSA stays low when no communication is in progress. When a communication is executed, HSA is high when the 32-bit or  \n8-bit packages are transferred, and is low during the gaps. \nBits[7:6] of the HSDC_CFG register are reserved. Any value \nwritten into these bits does not have any consequence on HSDC behavior. \nFigure 92 shows the HSDC transfer protocol for HGAP = 0, \nHXFER[1:0] = 00 and HSAPOL = 0. Note that the HSDC \ninterface sets a data bit on the HSD line every HSCLK high- \nto-low transition and the value of Bit HSIZE is irrelevant. \n   \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 74 of 100 Figure 93 shows the HSDC transfer protocol for HSIZE = 0, \nHGAP = 1, HXFER[1:0] = 00, and HSAPOL = 0. Note that the \nHSDC interface introduces a seven-HSCLK cycles gap between \nevery 32-bit word.  \nFigure 94 shows the HSDC transfer protocol for HSIZE = 1, \nHGAP = 1, HXFER[1:0] = 00, and HSAPOL = 0. Note that the \nHSDC interface introduces a seven-HSCLK cycles gap between \nevery 8-bit word. \nSee Table 53 for the HSDC_CFG register and descriptions for \nthe HCLK, HSIZE, HGAP , HXFER[1:0], and HSAPOL bits. Table 24 lists the time it takes to execute an HSDC data transfer for all HSDC_CFG register settings. For some settings, the transfer time is less than 125 μs (8 kHz), the waveform sample registers update rate. This means the HSDC port transmits data \nevery sampling cycle. For settings in which the transfer time is \ngreater than 125 μs, the HSDC port transmits data only in the first of two consecutive 8 kHz sampling cycles. This means it \ntransmits registers at an effective rate of 4 kHz. \nTable 24. Communication Times for Various HSDC Settings \nHXFER[1:0] HGAP HSIZE1 HCLK Communication Time (μs) \n00 0 N/A 0 64 \n00 0 N/A 1 128 \n00 1 0 0 77.125 \n00 1 0 1 154.25 \n00 1 1 0 119.25 \n00 1 1 1 238.25 \n01 0 N/A 0 28 \n01 0 N/A 1 56 \n01 1 0 0 33.25 \n01 1 0 1 66.5 \n01 1 1 0 51.625 \n01 1 1 1 103.25 \n10 0 N/A 0 36 \n10 0 N/A 1 72 \n10 1 0 0 43 \n10 1 0 1 86 \n10 1 1 0 66.625 \n10 1 1 1 133.25 \n \n1 N/A means not applicable. \n \nHSCL K\nHSD\nHSA0 31 0 31 0 31 0 31\nIAVW (32 BITS) VAWV (32 BITS) IBWV (32 BITS) CVAR (32 BITS)\n08510-066 \nFigure 92. HSDC Communication for HGAP = 0, HXFER[1:0] = 00, and HSAPOL = 0; HSIZE Is Irrelevant \n \nHSCL K\nHSD\nHSA0 31 0 31 0 31\nIAVW (32-BIT)\n7 HCLK CYCLESVAWV (32-BIT) IBWV (32-BIT)\n7 HCLK CYCLES0 31\nCVAR (32-BIT)\n08510-067 \nFigure 93. HSDC Communication for HSIZE = 0, HGAP = 1, HXFER[1:0] = 00, and HSAPOL = 0 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878\n \nRev. H | Page 75 of 100  \nHSCLK\nHSD\nHSA24 31 16 23 8 15 0 7\nIAVW (BYTE 3)\n7 HCLK CYCLESIAWV (BYTE 2) IAWV (BYTE 1) CVAR (BYTE 0)\n7 HCLK CYCLES\n08510-068 \nFigure 94. HSDC Communication for HSIZE = 1, HGAP = 1, HXFER[1:0] = 00, and HSAPOL = 0 \nQUICK SETUP AS ENERGY METER \nAn energy meter is usually characterized by the nominal \ncurrent I n, nominal voltage V n, nominal frequency f n, and the \nmeter constant MC. \nTo quickly s etup the ADE7878 , execute the following steps: \n1. Select the PGA gains in the phase currents, voltages, and \nneutral current channels: Bits [2:0] (PGA1), Bits [5:3] \n(PGA2) and Bits [8:6] (PGA3) in the Gain register. \n2. If Rogowski coils are used, enable the digital integrators in the phase and neutral currents: Bit 0 (INTEN) set to 1 in CONFIG register. \n3. If f\nn=60 Hz, set Bit 14 (SELFREQ) in COMPMODE \nregister ( ADE7878  only). \n4. Initialize WTHR1 and WTHR0 registers based on Equation 25. Make V ARTHR1 ( ADE7858 , ADE7868 , and \nADE7878  only) and V ATHR1 equal to WTHR1 and \nVA RT H R 0  ( ADE7858, ADE7868 , and ADE7878  only) and \nVAT H R 0  e q u a l  to  W T H R 0 .  \n5. Initialize CF1DEN, CF2DEN, and CF3DEN based on Equation 26. \n6. Initialize VLEVEL ( ADE7878  only) and VNOM registers \nbased on Equation 21 and Equation 42. \n7. Enable the data memory RAM protection by writing 0xAD to an internal 8-bit register located at Address 0xE7FE followed by a write of 0x80 to an internal 8-bit register located at Address 0xE7E3. \n8. Start the DSP by setting Run=1. \n9. Read the energy registers xW ATTHR, xV ARHR (ADE7858 , ADE7868 , and ADE7878 only), xV AHR, \nxFW ATTHR, and xFV ARHR ( ADE7878  only) to erase \ntheir content and start energy accumulation from a known state. \n10. Enable the CF1, CF2 and CF3 frequency converter outputs \nby clearing bits 9, 10 and 11 (CF1DIS, CF2DIS, and \nCF3DIS) to 0 in CFMODE register.  \nLAYOUT GUIDELINES \nFigure 95 presents a basic schematic of the ADE7878 together \nwith its surrounding circuitry: decoupling capacitors at pins VDD, AVDD, DVDD and REF\nin/out, the 16.384 MHz crystal and \nits load capacitors. The rest of the pins are dependent on the particular application and are not shown here. The ADE7854 , ADE7858  and ADE7868  have an identical approach to the \ndecoupling capacitors, the crystal and its load capacitors.  \n \n08510-086C1\n4.7µFC2\n0.22µFC3\n4.7µFC40.22µF\nC5\n0.1µFC6\n10µF\nU1\nC7\n0.1µF172\n3\n4\n789\n12\n13\n14151618\n23\n221927\n36\n38PM0\nPM1\nRESETIAP\nIAN\nIBPIBNICP\nICN\nINPINN\nVN\nVAPVBP\nVCP\nCLKINSCLK/SCLMOSI/SDA2824 265\n29\n32\n371\n10\n11\n2021NC\nADE7878ACPZ\n30\n31\n40\n25PAD\n6AGNDPAD\nDGND393433\n35C10\n4.7µF\nC8\n20pFR1\n5MΩY1\n16.384MHz2\n1 C920pFAVDD\nDVDD\nVDD\nREF IN/OUT\nCLKOUT\nIRQ0\nIRQ1\nCF1\nCF2\nCF3/HSCLK\nMISQ/HSD\nSS/HSA\n \nFigure 95. ADE7878  Crystal and Capacitors Connections \nFigure 96 and Figure 97 present a proposed layout of a printed \ncircuit board (PCB) with two layers that have the components placed only on the top of the board. Following these layout \nguidelines will help in creating a low noise design with higher \nimmunity to EMC influences. \nThe VDD, AVDD, DVDD and REF\nin/out pins have each two \ndecoupling capacitors, one of uF order and a ceramic one of \n220nF or 100nF. These ceramic capaci tors need to be placed the \nclosest the the ADE7878  as they decouple high frequency \nnoises, while the uF ones need to be placed in close proximity. \nThe crystal load capacitors need to be placed closest to the \nADE7878 , while the crystal can be placed in close proximity. \nADE7854/ADE7858/ADE7868/ADE7878 Data Sheet\n \nRev. H | Page 76 of 100 08510-087 \nFigure 96. ADE7878  Top Layer Printed Circuit Board \nThe exposed pad of the ADE7878  is soldered to an equivalent \npad on the PCB. The AGND and DGND traces of the ADE7878  \nare then routed directly into the PCB pad.  \nThe bottom layer is composed mainly of a ground plane \nsurrounding as much as possible the crystal traces. \n08510-088 \nFigure 97. ADE7878  Bottom Layer Printed Circuit Board \n \nCRYSTAL CIRCUIT \nA digital clock signal of 16.384 MHz can be provided to the \nCLKIN pin of the ADE7854 /ADE7858 /ADE7868 /ADE7878 . \nAlternatively, attach a crystal of the specified frequency, as shown in Figure 98. CL 1 and CL 2 denote the capacitances of the \nceramic capacitors attached to the crystal pins, whereas CP 1 and \nCP 2 denote the parasitic capacitances on those pins.  \nThe recommended typical value of total capacitance at each \nclock pin, CLKIN and CLKOUT, is 24 pF, which means that \nTotal Capacitance = CP 1 + CL 1 = CP 2 + CL 2 = 24 pF \nCrystal manufacturer data sheets specify the load capacitance \nvalue. A total capacitance of 24 pF, per clock pin, is recommended; \ntherefore, select a crystal with a 12 pF load capacitance. In \naddition, when selecting the ceramic capacitors, CL 1 and CL 2, \nthe parasitic capacitances, CP 1 and CP 2, on the crystal pins of \nthe IC must be taken into account. Thus, the values of CL 1 and \nCL 2 must be based on the following expression: \nCL 1 = CL 2 = 2 × Crystal Load Capacitance  − CP 1 \nwhere CP 1 = CP 2. \nFor example, if a 12 pF crystal is chosen and the parasitic capacitances on the clock pins are CP\n1 = CP 2 = 2 pF, the ceramic \ncapacitors that must be used in the crystal circuit are CL 1 = CL 2 \n= 22 pF. \nThe Evaluation Board EV AL-ADE7878EBZ uses the crystal \nVM6-1D11C12-TR-16.384MHZ (maximum drive level 1 mW; \nmaximum ESR 20 Ω; load capacitance 12 pF). It is recommended \nthat the same crystal, or a crystal with similar specifications, be \nselected. Lower values of ESR and load capacitance and higher \nvalues of drive level capability of the crystal are preferable.  \nIt is also recommended that a 5 MΩ resistor be attached in \nparallel to the crystal, as shown in Figure 98.   \nCLKOUTCLKINCL2\nCP1\nGNDGND\nCL1CP2\n16.384MHz CRYSTAL 5MΩ ADE78xx IC\n08510-123 \nFigure 98. Crystal Circuit \nADE7878 EVALUATION BOARD \nAn evaluation board built upon the ADE7878  configuration \nsupports all ADE7854, ADE7858 , ADE7868 , and ADE7878  \ncomponents. Visit www.analog.com/ADE7878 for details. \nDIE VERSION \nThe register named version identifies the version of the die. It is \nan 8-bit, read-only version register located at Address 0xE707. \n \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nSILICON ANOMALY  \nThis anomaly list describes the known issues with the ADE7854, ADE7858, ADE7868, and ADE7878 silicon identified by the version \nregister (Address 0xE707) being equal to 2, to 4 , and to 5 .  \nAnalog Devices, Inc., is committed, through future silicon revisions, to continuously improve silicon functionality. Analog D evices tries \nto ensure that these future silicon revisions remain compatible with your present software/systems by implementing the recomm ended \nworkarounds outlined here.  \nADE7854/ ADE7858/ ADE7868/ ADE7878 FUNCTIONALITY ISSUES  \nSilicon Revision \nIdentifier  Chip Marking  Silicon Status  Anomaly Sheet  No. of Reported Issues  \nVersion = 2  ADE7854ACPZ  Released  Rev. A  4 (er001, er002, er003, er004)  \n ADE7858ACPZ     \n ADE7868ACPZ     \n ADE7878ACPZ     \nVersion = 4  ADE7854ACPZ  Released  Rev. B  1 (er005)  \n ADE7858ACPZ     \n ADE7868ACPZ     \n ADE7878ACPZ     \nVersion  = 5 ADE7854ACPZ  Released  Rev. C  1 (er005)  \n ADE7858ACPZ     \n ADE7868ACPZ     \n ADE7878ACPZ     \nFUNCTIONALITY ISSUES  \nTable 25. Offset RMS Registers Cannot be Set to Negative Values [er001, Version = 2 Silicon]  \nBackground  When the AIRMSOS, AVRMSOS, BIRMSOS, BVRMSOS, CIRMSOS, CVRMSOS, and NIRMSOS registers are set to a negative \nvalue, for sufficiently small i nputs, the argument of the square root used in the rms data path may become negative. In \nthis case, the corresponding AIRMS, AVRMS, BIRMS, BVRMS, CIRMS, or CVRMS rms register is automatically set to 0. \nIssue  Negative values for the AIRMSOS, AVRMSOS, BIRMSOS, BVRMSOS, CIRMSOS, CVRMSOS, and NIRMSOS registers are not \nsupported in the silicon version identified by the version register being equal to 2.  \nWorkaround  Do not use negative values for the AIRMSOS, AVRMSOS, BIRMSOS, BVRMSOS, CIRMSOS, CVRMSOS, and NIRM SOS \nregisters.  \n If further details on this issue are required, please use the following website to submit your query:  \nwww.analog.com/en/content/technical_support_page/fca.htm l. \nRelated  Issues  None.  \nRev. H | Page  77 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTable 26. Values Written to the CF1DEN, CF2DEN, CF3DEN, SAGLVL, and ZXTOUT Registers May Not Be Immediately Used By \nADE7854, ADE7858, ADE7868, ADE7878 [er002, Version = 2 Silicon ] \nBackground  Usually, the CF1DEN, CF2DEN, CF3DEN, SAGLVL, and ZXTOUT registers initialize immediately after power- up or after a \nhardware/software reset. After the RUN register is set to 1 , the energy -to-frequency converter (for CF1DEN, CF2DEN, and CF3DEN), the \nphase voltage sag detector (for SAGLVL), and the zero -crossing timeout circuit (for ZXTOUT) use these values immediately.  \nIssue  After the CF1DEN register is initialized with a new value after power- up or a hardware/software reset, the new value may be \ndelayed and, therefore, not immediately available for use by the energy -to-frequency converter. It is, however, used by the \nconverter after the first high -to-low transition is triggered  at t the CF1 pin using the CF1DEN default value (0x0).  \n CF2DEN and CF3DEN registers present similar behavior at the CF2 and CF3 pins, respectively. CF1DEN, CF2DEN and CF3DEN \nabove behavior has been corrected in Version = 4 silicon.  \n After the SAGLVL reg ister is initialized with a new value after power -up or a hardware or software reset, the new value may be \ndelayed and not available for immediate use by the phase voltage sag detector. However, it is used by the detector after at l east \none phase voltage rises above 10% of the full -scale input at the phase voltage ADCs. \n After the ZXTOUT register is initialized with a new value after power -up or a hardware or software reset, the new value may be \ndelayed and not available for immediate use by the zero -cross ing timeout circuit. However, the circuit does use the new value \nafter at least one phase voltage rises above 10% of the full -scale input at the phase voltage ADCs.  \nWorkaround  If the behavior outlined in the Issue row does not conflict with the meter spec ification, then the new values of the CF1DEN, \nCF2DEN, CF3DEN, SAGLVL, and ZXTOUT registers may be written one time only.  \n If the behavior is not acceptable, write the new value into the CF1DEN, CF2DEN, and CF3DEN registers eight consecutive times.  \nThis en sures the probability of the new value not being considered immediately by the energy -to-frequency converter becomes \nlower than 0.2 ppm.  \n Usually, at least one of the phase voltages is greater than 10% of full scale after power -up or after a hardware/software reset. If \nthis cannot be guaranteed, then the SAGLVL and ZXTOUT registers should also be written eight consecutive times to reduce the \nprobability of not being considered immediately by the phase voltage sag detector and zero -crossing timeout circuit . \nRelated  Issues  None.  \nTable 27. The Read -Only RMS Registers May Show the Wrong Value [er003, Version = 2 Silicon]  \nBackground  The read -only rms registers (AVRMS, BVRMS, CVRMS, AIRMS, BIRMS, CIRMS, and NIRMS) can be read without re strictions at \nany time.  \nIssue  The fixed function DSP of ADE7854 , ADE7858, ADE7868, and ADE7878 computes all the powers and rms values in a loop \nwith a period of 125 µs (8 kHz frequency). If two rms registers are accessed (read) consecutively, the value of the second \nregister may be corrupted. Consequently, the apparent power computed during that 125 µs cycle is also corrupted. The \nrms calculation recovers in the next 125 µs cycle, and all the rms and apparent power values compute  correctly.  \n The issue appears independent of the communication type, SPI or I2C, when the time between the start of two \nconsecutive rms readings is lower than 265 µs. The issue affects only the rms registers; all of the other registers of ADE7854, ADE7858 , ADE7868, and ADE7878 can be accessed without any restrictions.  \nWorkaround  The rms registers can be read one at a time with at least 265 µs between the start of the readings. DREADY interrupt at the \nIRQ0  pin can be used to time one rms register reading every three consecutive DREADY interrupts. This ensures 375 µs \nbetween the start of the rms readings.  \n Alternatively, the rms registers can be read interleaved with readings of other registers that are not affected by this \nrestriction as long as the time between the start of two consecutive rms register readings is 265 μs.  \nRelated  Issues  None.  \nTable 28. To Obtain Best Accuracy Performance, Internal Setting Must Be Changed [er004, Versio n = 2 Silicon]  \nBackground  Internal default settings provide best accuracy performance for ADE7854 , ADE785 8, ADE7868 , and ADE7878 .  \nIssue  It was found that if a different setting is used, the accuracy performance can be improved.  \nWorkaround  To enable a new setting for this internal register, execute two consecutive 8 -bit register write operations:  \n The first write operation: 0xAD is written to Address 0xE7FE.  \n The second write operation: 0x01 is written to Address 0xE7E2.  \n The write operations must be executed consecutively without any other read/write operation in between. As a verification that the value was captured correctly, a simple 8 -bit read of Address 0xE7E2 should show the 0x01 value.  \nRelated  Issues  None.  \nRev. H | Page 78 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 29. Values Written to the SAGLVL and ZXTOUT Registers May Not Be Immediately Used by ADE7854, ADE7858, \nADE7868, and ADE7878 [er005, Version = 4 and Version = 5 Silicon s] \nBackground  Usually, the SAGLVL and ZXTOUT registers initialize immediately after power -up or after a hardware/sof tware reset. After \nthe run register is set t o 1, the phase voltage sag detector (for SAGLVL), and the zero -crossing timeout circuit (for ZXTOUT) \nuse these values immediately.  \nIssue  After the SAGLVL register is initialized with a new value after power -up or a hardware or software reset, the new valu e \nmay be delayed and not available for immediate use by the phase voltage sag detector. However, it is used by the \ndetector after at least one phase voltage rises above 10% of the full -scale input at the phase voltage ADCs.  \n After the ZXTOUT register is initialized with a new value after power -up or a hardware or software reset, the new value \nmay be delayed and not available for immediate use by the zero -crossing timeout circuit. However, the circuit does use \nthe new value after at least one phase voltage rises above 10% of the full -scale input at the phase voltage ADCs.  \nWorkaround  Usually, at least one of the phase voltages is greater than 10% of full scale after power -up or after a hardware/software \nreset. If this cannot be guaranteed, then the SAGLVL and ZXTOUT registers should be written eight consecutive times to \nreduce the probability of not being considered immediately by the phase voltage sag detector and zero -crossing timeout \ncircuit below 0.2 ppm.  \nRelated  Issues  None.  \nSECTION 1. ADE7854/ ADE7858/ ADE7868/ ADE7878 FUNCTIONALITY ISSUES  \nReference \nNumber  Description  Status  \ner001  Offset rms registers cannot be set to negative values.  Identified  \ner002 Values written to the CF1DEN, CF2DEN, CF2DEN, SAGLVL, and ZXTOUT registers may not be immediately \nused by ADE7854 , ADE7858, ADE7868, and ADE7878. Identified  \ner003 The read -only rms registers may show the wrong value.  Identified  \ner004 To obtain best accuracy performance, internal setting must be changed.  Identified  \ner005  Values written to the SAGLVL and ZXTOUT registers may not be immediately used by ADE7854 , ADE7858 , \nADE7868, and ADE7878. Identified  \n \nThis c ompletes the Silicon Anomaly  section.  \nRev. H | Page  79 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nREGISTERS LIST  \nTable 30. Registers List Located in DSP Data Me mory RAM  \nAddress  Register \nName  R/W1  Bit Length  Bit Length D uring \nCommunication\n2 Type 3 Default \nValue  Description  \n0x4380  AIGAIN  R/W  24 32 ZPSE S 0x000000  Phase A current gain adjust . \n0x4381 AVGAIN  R/W  24 32 ZPSE S 0x000000 Phase A voltage gain adjust . \n0x4382 BIGAIN  R/W  24 32 ZPSE S 0x000000 Phase B current gain adjust . \n0x4383 BVGAIN  R/W  24 32 ZPSE S 0x000000 Phase B voltage gain adjust . \n0x4384 CIGAIN  R/W  24 32 ZPSE S 0x000000 Phase C current gain adjust . \n0x4385  CVGAIN  R/W  24 32 ZPSE S 0x000000  Phase C voltage gain adjust . \n0x4386 NIGAIN   R/W  24 32 ZPSE  S 0x000000 Neutral current gain adjus t (ADE7868 and \nADE7878 only).  \n0x4387 AIRMSOS  R/W  24 32 ZPSE  S 0x000000 Phase A current rms offset . \n0x4388 AVRMSOS  R/W  24 32 ZPSE  S 0x000000 Phase A voltage rms offset . \n0x4389 BIRMSOS  R/W  24 32 ZPSE  S 0x000000 Phase B current rms offset . \n0x438A  BVRMSOS  R/W  24 32 ZPSE  S 0x000000  Phase B voltage rms offset . \n0x438B CIRMSOS R/W  24 32 ZPSE  S 0x000000 Phase C current rms offset . \n0x438C CVRMSOS  R/W  24 32 ZPSE  S 0x000000 Phase C voltage rms offset . \n0x438D NIRMSOS  R/W  24 32 ZPSE  S 0x000000 Neutral current rms offset  (ADE7868 and \nADE7878 only).  \n0x438E AVAGAIN  R/W  24 32 ZPSE  S 0x000000 Phase A apparent power gain adjust . \n0x438F BVAGAIN  R/W  24 32 ZPSE  S 0x000000 Phase B apparent power gain adjust . \n0x4390 CVAGAIN  R/W  24 32 ZPSE  S 0x000000 Phase C apparent power gain adjust . \n0x4391 AWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase A total active power gain adjust . \n0x4392 AWAT TOS  R/W  24 32 ZPSE  S 0x000000 Phase A total active power offset adjust . \n0x4393 BWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase B total active power gain adjust . \n0x4394  BWAT TOS  R/W 24 32 ZPSE  S 0x000000  Phase B total active power offset adjust . \n0x4395 CWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase C total active power gain adjust . \n0x4396 CWAT TOS  R/W  24 32 ZPSE  S 0x000000 Phase C total active power offset adjust . \n0x4397 AVARGAIN  R/W  24 32 ZPSE  S 0x000000 Phase A total reactive power gain adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x4398 AVAROS  R/W  24 32 ZPSE  S 0x000000 Phase A total reactive power offset adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x4399 BVARGAIN  R/W  24 32 ZPSE  S 0x000000 Phase B total reactive power gain adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x439A BVAROS  R/W  24 32 ZPSE  S 0x000000 Phase B total reactive power offset adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x439B  CVARGAIN  R/W  24 32 ZPSE  S 0x000000  Phase C total reactive power gain adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x439C CVAROS  R/W  24 32 ZPSE  S 0x000000 Phase C total reactive power offset adjust  \n(ADE7858, ADE7868, and ADE7878 ). \n0x439D  AFWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase A fundamental active power gain \nadjust . Location reserved for ADE7854, \nADE7858, and ADE7868. \n0x439E  AFWAT TOS  R/W  24 32 ZPSE  S 0x000000 Phase A fundamental active power offset \nadjust . Location reserved for ADE7854, \nADE7858, and ADE7868. \n0x439F BFWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase B fundamental active power gain \nadjust  (ADE7878 only).  \n0x43A0 BFWATTOS  R/W  24 32 ZPSE  S 0x000000 Phase B fundamental active power offset \nadjust  (ADE7878 only).  \n0x43A1  CFWGAIN  R/W  24 32 ZPSE  S 0x000000 Phase C fundamental active power gain \nadjust . \n0x43A2  CFWATTOS R/W  24 32 ZPSE  S 0x000000 Phase C fundamental active power offset adjust  (ADE7878 only).  \nRev. H | Page 80 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nAddress  Register \nName  R/W1  Bit Length  Bit Length D uring \nCommunication\n2 Type 3 Default \nValue  Description  \n0x43A3  AFVARGAIN  R/W  24 32 ZPSE  S 0x000000 Phase A  fundamental reactive power gain \nadjust  (ADE7878 only).  \n0x43A4 AFVARO S R/W  24 32 ZPSE  S 0x000000 Phase A fundamental reactive power \noffset adjust  (ADE7878 only).  \n0x43A5 BFVARGAIN  R/W  24 32 ZPSE  S 0x000000 Phase B fundamental reactive power gain adjust  (ADE787 8 only).  \n0x43A6  BFVAROS  R/W  24 32 ZPSE  S 0x000000 Phase B fundamental reactive power offset adjust  (ADE7878 only).  \n0x43A7 CFVARGAIN  R/W  24 32 ZPSE  S 0x000000 Phase C fundamental reactive power gain \nadjust  (ADE7878 only).  \n0x43A8  CFVAROS R/W  24 32 ZPSE  S 0x000000 Phase C fundamental reactive power \noffset adjust  (ADE7878 only).  \n0x43A9 VATHR1  R/W  24 32 ZP  U 0x000000 Most significant 24  bits of VATHR[47:0] \nthreshold used in phase apparent power \ndatapath . \n0x43AA VATHR0  R/W  24 32 ZP  U 0x000000 Less signifi cant 24  bits of VATHR[47:0] \nthreshold used in phase apparent power datapath . \n0x43AB WTHR1  R/W  24 32 ZP  U 0x000000 Most significant 24  bits of WTHR[47:0] \nthreshold used in phase total/fundamental  \nactive power datapath. \n0x43AC WTHR0  R/W  24 32 ZP  U 0x000000 Less significant 24  bits of WTHR[47:0] \nthreshold used in phase total/fundamental  \nactive power datapath. \n0x43AD VARTHR1  R/W  24 32 ZP  U 0x000000 Most significant 24 bits of VARTHR[47:0] \nthreshold used in phase total/fundamental \nreactiv e power datapath  (ADE7858, \nADE786 8, and ADE7878).  \n0x43AE VARTHR0  R/W  24 32 ZP  U 0x000000 Less significant 24  bits of  VARTHR[47:0] \nthreshold used in phase total/fundamental reactive power datapath  (ADE7858, \nADE7868, and ADE7878).  \n0x43AF Reserved  N/A4 N/A4 N/A4 N/A4 0x000000 This memory location should be kept at \n0x000000 for proper operation. \n0x43B0 VANOLOAD R/W  24 32 ZPSE  S 0x0000000 No load threshold in the apparent power \ndatapath . \n0x43B1  APNOLOAD  R/W  24 32 ZPSE  S 0x0000000  No load threshold in the total/fundamental \nactive power datapath. \n0x43B2 VARNOLOAD R/W  24 32 ZPSE S 0x0000000 No load threshold in the total/fundamental \nreactive power datapath . Location \nreserved for ADE7854. \n0x43B3  VLEVEL  R/W 24 32 ZPSE  S 0x000000 Register used in the algorithm that \ncomputes the fundamental active and \nreactive powers  (ADE7878 only).  \n0x43B4 Reserved  N/A4 N/A4 N/A4 N/A4 0x000000 This location should not be written for \nproper operation.  \n0x43B5 DICOEFF  R/W  24 32 ZPSE  S 0x0000000 Register used in the digital integrator algorithm. If the integrator is turned on, it \nmust be set at 0xFF8000.\n In practice, it  is \ntransmitted as 0xFFF8000. \n0x43B6 HPFDIS  R/W  24 32 ZP  U 0x000000 Disables/enables the HPF in the current \ndatapath (see Table 34). \n0x43B7  Reserved  N/A4 N/A4 N/A4 N/A4 0x000000 This memory location  should be kept at \n0x000000 for proper operation . \n0x43B8 ISUMLVL  R/W  24 32 ZPSE  S 0x000000 Threshold used in comparison between the sum of phase currents and the neutral \ncurrent  (ADE7868 and ADE7878 only).  \nRev. H | Page  81 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nAddress  Register \nName  R/W1  Bit Length  Bit Length D uring \nCommunication\n2 Type 3 Default \nValue  Description  \n0x43B9 to \n0x43BE Reserved  N/A4 N/A4 N/A4 N/A4 0x000000 These memory locations should be kept at 0x000000 for proper operation. \n0x43BF ISUM R 28 32 ZP  S N/A4 Sum of IAWV, IBWV, and ICWV registers  \n(ADE7868 and ADE7878 only).  \n0x43C0 AIRMS  R 24 32 ZP  S N/A4 Phase A current rms value . \n0x43C1 AVRMS  R 24 32 ZP  S N/A4 Phase A voltage rms value . \n0x43C2 BIRMS  R 24 32 ZP  S N/A4 Phase B current rms value . \n0x43C3 BVRMS  R 24 32 ZP S N/A4 Phase B voltage rms value . \n0x43C4  CIRMS  R 24 32 ZP  S N/A4 Phase C current rms value . \n0x43C5 CVRMS  R 24 32 ZP  S N/A4 Phase C voltage rms value . \n0x43C6 NIRMS  R 24 32 ZP  S N/A4 Neutral current rms value ( ADE7868 and \nADE7878 only).  \n0x43C7 to 0x43FF Reserved  N/A\n4 N/A4 N/A4 N/A4 N/A4 These memory locations should not be written for proper operation. \n1 R is read, and W is write.  \n2 32 ZPSE = 24- bit signed register that is transmitted as a 32 -bit word with four MSBs padded with 0s and sign extended to 28 bits. Whereas 32 ZP = 28- or 24- bit signed \nor unsigned register that is transmitted as a 32 -bit word with four MSBs or eight MSBs, respectively, padded with 0s.  \n3 U is unsigned register, and S is signed register in twos complement format.  \n4 N/A means not applicable.  \nTable 31. Internal DSP Memory RAM Registers \nAddress  Register \nName  R/W1 Bit Length  Bit Length  \nDuring \nCommunication  Type\n2  Default Value  Description  \n0xE203 Reserved  R/W  16 16 U 0x0000 This memory location should not be written for \nproper operation.  \n0xE228 Run R/W  16 16 U 0x0000 Run register starts and stops the DSP . S ee the \nDigital Signal Processor   section for more det ails. \n1 R is read, and W is write.  \n2 U is unsigned register, and S is signed register in twos complement format.  \nTable 32. Billable Registers  \nAddress  Register  \nName  R/W1, 2 Bit \nLength2 Bit Length \nDuring \nCommunication2 Type2, 3  Default \nValue  Description  \n0xE400 AWAT THR  R 32 32 S 0x00000000 Phase A total active energy accumulation. \n0xE401 BWAT THR  R 32 32 S 0x00000000 Phase B total active energy accumulation. \n0xE402 CWAT THR  R 32 32 S 0x00000000 Phase C total active energy accumulation. \n0xE403  AFWATTHR  R 32 32 S 0x00000000 Phase A fundamental active energy \naccumulation ( ADE7878 only).  \n0xE404 BFWAT THR  R 32 32 S 0x00000000 Phase B fundamental active energy accumulation ( ADE7878 only).  \n0xE405 CFWATTHR R 32 32 S 0x00000000 Phase C fundamental active energy accumulation ( ADE7878 only).  \n0xE406 AVARHR  R 32 32 S 0x00000000 Phase A total reactive energy accumulation  \n(ADE7858, ADE7868, and ADE7878  only).  \n0xE407 BVARHR  R 32 32 S 0x00000000 Phase B total reactive energy accumulation \n(ADE7858, ADE7868, and ADE7878  only).  \n0xE408 CVARHR  R 32 32 S 0x00000000 Phase C total reactive energy accumulation  \n(ADE7858, ADE7868, and ADE787 8 only).  \n0xE409   AFVARHR  R 32 32 S 0x00000000  Phase A fundamental reactive energy \naccumulation ( ADE7878 only).  \n0xE40A BFVARHR  R 32 32 S 0x00000000 Phase B fundamental reactive energy \naccumulation ( ADE7878 only).  \n0xE40B CFVARHR R 32 32 S 0x00000000 Phase C fundamental reactive energy \naccumulation ( ADE7878 only).  \nRev. H | Page 82 of 100  \n \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nAddress  Register  \nName  R/W1, 2 Bit \nLength2 Bit Length \nDuring \nCommunication2 Type2, 3  Default \nValue  Description  \n0xE40C AVAHR  R 32 32 S 0x00000000 Phase A apparent energy accumulation. \n0xE40D  BVAHR  R 32 32 S 0x00000000  Phase B apparent energy accumulation . \n0xE40E CVAHR  R 32 32 S 0x00000000 Phase C appar ent energy accumulation . \n1 R is read , and W is write.  \n2 N/A is not applicable.  \n3 U is unsigned register, and S is signed register in two s complement format . \nTable 33. Configuration and Power Quality Registe rs \nAddress  Register \nName  R/W1 Bit Length  Bit Length  \nDuring Communication\n2 Type3  Default  \nValue4 Description  \n0xE500 IPEAK  R 32 32 U N/A Current peak regis ter. See Figure 50 \nand Table 35 for details about its \ncomposition.  \n0xE501 VPEAK  R 32 32 U N/A Voltage peak register. See Figure 50 \nand Table 36 for details about its \ncomposition.  \n0xE502  STATUS0  R/W 32 32 U N/A Interrupt Status Register 0. See Table 37 . \n0xE503 STATUS1 R/W 32 32 U N/A Interrupt Status Register 1 . See Table 38 . \n0xE504  AIMAV  R 20 32 ZP  U N/A  Phase A current mean absolute value \ncomputed during PSM0 and PSM1 \nmodes  (ADE7868 and ADE7878 only).  \n0xE505 BIMAV  R 20 32 ZP  U N/A  Phase B current mean absolute value computed during PSM0 and PSM1 \nmodes  (ADE7868 and ADE7878 only).  \n0xE506 CIMAV  R 20 32 ZP  U N/A  Phase C current mean absolute value \ncomputed during PSM0 and PSM1 \nmodes  (ADE7868 and ADE7878 only).  \n0xE507  OILVL  R/W  24 32 ZP  U 0xFFFFFF  Overcurrent threshold . \n0xE508 OVLVL  R/W 24 32 ZP  U 0xFFFFFF Overvoltage threshold . \n0xE509 SAGLVL  R/W  24 32 ZP  U 0x000000 Voltage  SAG level threshold . \n0xE50A MASK0  R/W  32 32 U 0x00000000 Interrupt Enable Register 0. See Table 39 . \n0xE50B MASK1  R/W  32 32 U 0x00000000 Interrupt Enable Register 1. See Table 40 . \n0xE50C IAWV  R 24 32 SE  S N/A Instantaneous value of Phase A current . \n0xE50D IBWV  R 24 32 SE  S N/A Instantaneous value of Phase B current . \n0xE50E ICWV  R 24 32 SE  S N/A Instantaneous value of Phase C current . \n0xE50F INWV  R 24 32 SE  S N/A  Instantaneous value of neutral current  \n(ADE7868 and ADE7878 only).  \n0xE510 VAWV  R 24 32 SE  S N/A Instantaneous value of Phase A voltage . \n0xE511 VBWV R 24 32 SE  S N/A Instantaneous value of Phase B voltage . \n0xE512 VCWV  R 24 32 SE  S N/A Instantaneous value of Phase C voltage . \n0xE513 AWAT T  R 24 32 SE  S N/A Instantaneous value of Phase A total \nactive power . \n0xE514 BWAT T  R 24 32 SE  S N/A Instantaneous value of Phase B total active pow er. \n0xE515  CWAT T  R 24 32 SE  S N/A Instantaneous value of Phase C total \nactive power . \n0xE516 AVAR  R 24 32 SE  S N/A Instantaneous value of Phase A total \nreactive power  (ADE7858, ADE7868, \nand ADE7878 only).  \n0xE517 BVAR  R 24 32 SE  S N/A Instantaneous value of Phase B total \nreactive power  (ADE7858, ADE7868, \nand ADE7878 only).  \n0xE518 CVAR  R 24 32 SE  S N/A Instantaneous value of Phase C total \nreactive power  (ADE7858, ADE7868, \nand ADE7878 only).  \nRev. H | Page  83 of 100  \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nAddress  Register \nName  R/W1 Bit Length  Bit Length  \nDuring \nCommunication\n2 Type3  Default  \nValue4 Description  \n0xE519 AVA  R 24 32 SE  S N/A Instantaneous value of Phase A \napparent power . \n0xE51A BVA  R 24 32 SE  S N/A Instantaneous value of P hase B \napparent power . \n0xE51B CVA  R 24 32 SE  S N/A Instantaneous value of Phase C \napparent power . \n0xE51F  CHE CKSUM  R 32 32 U 0x33666787  Checksum verification. See  the \nChecksum Register  section for details . \n0xE520 VNOM  R/W  24 32 ZP  S 0x000000 Nominal phase voltage rms used in the \nalternative computation of the \napparent po wer. When the VNOMxEN \nbit is set, the applied voltage input in \nthe corresponding phase is ignored \nand all corresponding rms voltage \ninstances are replaced by the value in the VNOM register.  \n0xE521 to \n0xE52E Reserved       These addresses should not be writ ten \nfor proper operation. \n0xE600 PHSTATUS R 16 16 U N/A Phase peak register. S ee Table 41. \n0xE601 ANGLE0  R 16 16 U N/A Time Delay 0. See the Time Interval \nBetween Phases  section for details . \n0xE602 ANGLE1  R 16 16 U N/A Time Delay 1. See the Time Interval \nBetween Phases  section for details . \n0xE603  ANGLE2  R 16 16 U N/A Time Delay 2. See  the Time Interval \nBetween Phases  section for details . \n0xE604 to \n0xE606 Reserved       These addresses should not be written \nfor proper operation. \n0xE607 PERIOD  R 16 16 U N/A Network line period . \n0xE608 PHNOLOAD R 16 16 U N/A Phase no load regist er. See Table 42. \n0xE609 to \n0xE60B Reserved       These addresses should not be written for proper operation. \n0xE60C LINECYC  R/W  16 16 U 0xFFFF Line cycle accumulation mode count . \n0xE60D ZXTOUT  R/W  16 16 U 0xFFFF Zero-crossi ng timeout count. \n0xE60E COMPMODE  R/W  16 16 U 0x01FF Computation- mode register. See  \nTable 43 . \n0xE60F Gain R/W  16 16 U 0x0000 PGA gains at ADC inputs. See Table 44. \n0xE6 10 CFMODE  R/W  16 16 U 0x0E88 CFx configuration register. See Table 45 . \n0xE611 CF1DEN R/W  16 16 U 0x0000 CF1 denominator . \n0xE612 CF2DEN R/W  16 16 U 0x0000 CF2 denominator . \n0xE613 CF3DEN R/W  16 16 U 0x0000 CF3 den ominator . \n0xE614  APHCAL  R/W  10 16 ZP  S 0x0000  Phase calibration of Phase A. See  \nTable 46 . \n0xE615 BPHCAL  R/W  10 16 ZP  S 0x0000 Phase calibration of Phase B. See Table 46 . \n0xE616 CPHCAL  R/W  10 16 ZP  S 0x0000 Phase calibration of Phase C. See Table 46 . \n0xE617 PHSIGN  R 16 16 U N/A Power sign register. See Table 47. \n0xE618 CONFIG  R/W  16 16 U 0x0000 ADE7878 configuration register. See \nTable 48. \n0xE700 MMODE  R/W  8 8 U 0x1C Measurement mode register.  \nSee Table 49. \n0xE701 ACCMODE  R/W  8 8 U 0x00 Accumulation mode register.  \nSee Table 50. \n0xE702  LCYCMODE  R/W  8 8 U 0x78  Line accumulation mode behavior. S ee \nTable 52. \n0xE703 PEAKCYC R/W  8 8 U 0x00 Peak detection half line cycles . \n0xE704 SAGCYC R/W  8 8 U 0x00 SAG detection half line cycles . \nRev. H | Page 84 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nAddress  Register \nName  R/W1 Bit Length  Bit Length  \nDuring \nCommunication\n2 Type3  Default  \nValue4 Description  \n0xE705 CFCYC R/W  8 8 U 0x01 Number of CF pulses between two \nconsecutive energy latches. See the \nSynchronizing Energy Registers with \nCFx Outputs  section. \n0xE706 HSDC_CFG R/W  8 8 U 0x00 HSDC configuration register. See Table 53 . \n0xE707 Version  R 8 8 U  Version of die . \n0xEBFF  Reserved   8 8   This ad dress can be used in manipulating  \nthe SS/HSA pin when SPI  is chosen as \nthe active port. See the Serial Interfaces  \nsection for details . \n0xEC00 LPOILVL  R/W  8 8 U 0x07 Overcurrent threshold used during PSM2 mode ( ADE7868 and ADE7878 \nonly). S ee Table 54 in which the register \nis detailed.  \n0xEC01 CONFIG2  R/W  8 8 U 0x00 Configuration r egister used during \nPSM1 mode. See Table 55. \n1 R is read, and W is write.  \n2 32 ZP = 24- or 2 0-bit signed or unsigned register that is transmitted as a 32 -bit word with 8 or  12 MSB s, respectively , padded with 0s. 32 SE = 24 -bit signed register that \nis transmitted as a 32 -bit word sign extended to 32 bits. 16 ZP = 10- bit unsigned register that is transmitted as a 16 -bit word with six  MSBs  padded with 0s . \n3 U is unsigned register, and S is signed register in two s complement format . \n4 N/A is not applicable.  \nTable 34. HPFDIS Register ( Address 0x43B6)  \nBit \nLocation  Default Value  Description  \n23:0 00000000 When HPFDIS = 0x00000000, then all high -pass filters in voltage and current channels are enabled. When the \nregister  is set to any nonzero value, all high- pass filters are disabled.  \nTable 35. IPEAK Register ( Address 0xE500)  \nBit Location  Bit Mnemonic  Default Value  Description  \n23:0 IPEAKVAL[23:0]  0 These bits contain the peak value determined in the current channel.  \n24 IPPHASE[0]  0 When this bit is set to 1, Phase A current generated IPEAKVAL[23:0] value.  \n25 IPPHASE[1]  0 When this bit is set to 1, Phase B current  generated IPEAKVAL[23:0] value.  \n26 IPPHASE[2]  0 When this bit is set to 1, Phase C current generated IPEAKVAL[23:0] value.  \n31:27  00000 These bits are always 0.  \nTable 36. VPEAK Register ( Address 0xE501)  \nBit Location  Bit Mnemonic  Default Value  Description  \n23:0 VPEAKVAL[23:0]  0 These bits contain the peak value determined in the voltage channel.  \n24 VPPHASE[0]  0 When this bit is set to 1, Phase A voltage generated VPEAKVAL[23:0] value.  \n25 VPPHASE[1]  0 When this bit is set to 1, P hase B voltage generated VPEAKVAL[23:0] value.  \n26 VPPHASE[2]  0 When this bit is set to 1, Phase C voltage generated VPEAKVAL[23:0] value.  \n31:27  00000 These bits are always 0.  \nTable 37. STATUS0 Register (Address 0xE502) \nBit \nLocat ion Bit Mnemonic  Default V alue  Description   \n0 AEHF  0 When this bit is set to 1, it indicates that B it 30 of any one of the  total active energy \nregisters ( AWAT THR, BWAT THR, or CWAT THR ) has changed.  \n1 FAEHF  0 When this bit is set to 1, it indicates that Bit 30 of any one of the fundamental active \nenergy registers,  FWATTHR, BFWATTHR, or CFWATTHR, has changed. This bit is always 0 \nfor ADE7854, ADE7858, and ADE7868. \n2 REHF  0 When this bit is set to 1, it indicates that B it 30 of any one of the total reactive energy \nregisters (AVARHR, BVARHR, or CVARHR ) has changed.  This bit is always 0 for ADE7854. \nRev. H | Page  85 of 100  \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nBit \nLocat ion Bit Mnemonic  Default  Value  Description   \n3 FREHF  0 When this bit is set to 1, it indicates that Bit 30 of any one of the fundamental reactive \nenergy registers, AFVARHR, BFVARHR, or CFVARHR, has changed.  This bit is always 0 for \nADE7854, ADE7858 , and ADE7868 . \n4 VAEHF  0 When this bit is set to 1, it indicates that B it 30 of any one of  the apparent energy \nregisters (AVAHR, BVAHR, or CVAHR ) has changed.  \n5 LENERGY  0 When this bit is set to 1, in line energy accumulation mode, it indicates the end of an \nintegration over an integer number of half line cycles set in the LINECYC register.  \n6 REVAPA  0 When this bit is set to 1,  it indicates that the Phase A active power identified by Bit 6 \n(REVAPSEL) in the ACCMO DE register (total or fundamental) has changed sign.  The sign \nitself is indicated in B it 0 (AWSIGN) of the PHSIGN register (see Table 47). \n7 REVAPB  0 When this bit is set to 1, it indicates that the Phase B active power identified by Bit 6 \n(REVAPSEL) in the ACCMODE register (total or fundamental) has changed sign. The sign \nitself is indicated in B it 1 (BWSIGN) of the PHSIGN register (see Table 47). \n8 REVAPC  0 When this bit  is set to 1,  it indicates that the Phase C active power identified by Bit  6 \n(REVAPSEL) in the ACCMODE register (total or fundamental) has changed sign. The sign \nitself is indicated in B it 2 (CWSIGN) of the PHSIGN register (see Table 47).  \n9 REVPSUM1  0 When this bit is set to 1, it indicates that the sum of all phase powers in the CF1 datapath \nhas changed sign. The sign itself is indicated in B it 3 (SUM1SIGN) of the PHSIGN register \n(see Table 47). \n10 REVRPA  0 When this bit is set to 1, it indicates that the Phase A reactive power identified by Bit 7 \n(REVRPSEL) in the ACCMODE register (total or fundamental) has changed sign. The sign \nitself is indicated in B it 4 (AVARSIGN) o f the PHSIGN register (see Table 47). This bit is \nalways 0 for ADE7854. \n11 REVRPB  0 When t his bit is set to 1, it indicates that the Phase B reactive power identified by Bit 7 \n(REVRPSEL) in the ACCMODE register (total or fundamental) has changed sign. The sign \nitself is indicated in B it 5 (BVARSIGN) of the PHSIGN register (see Table 47). This bit is \nalways 0 for ADE7854. \n12 REVRPC  0 When this bit is set to 1, it indicates that the P hase C reactive power identified by Bit 7 \n(REVRPSEL) in the ACCMODE register (total or fundamental) has changed sign. The sign \nitself is indicated in B it 6 (CVARSIGN) of the PHSIGN register (see Table 47). This bit  is \nalways 0 for ADE7854. \n13 REVPSUM2  0 When this bit is set to 1, it indicates that the sum of all phase powers in the CF2 datapath  \nhas changed sign. The sign itself is indicated in B it 7 (SUM2SIGN) of the PHSIGN register \n(see Table 47). \n14 CF1  When this bit is set to 1, it indicates a high to low transition has occurred at CF1 pin; that \nis, an active low pulse has been generated. The bit is set even if the CF1 output is disabled \nby setting B it 9 (CF1DIS) to 1 in the CFMODE register. The type of power used at the CF1 \npin is determined by Bits[ 2:0] (CF1SEL [2:0] ) in the CFMODE register (see Table 45). \n15 CF2  When this bit is set to 1, it indicates a high -to-low transition has occurred at the CF2 pin ; \nthat is , an active low pulse has been generated. The bit is set even if the CF2 output is \ndisabled by setting Bit 10 (CF2DIS) to 1 in the CFMODE register. The type of power used at \nthe CF2 pin is determined by B its[5:3] (CF2SEL [2:0] ) in the CFMODE register (see Table 45 ). \n16 CF3  When this bit is set to 1, it indicates a high-to -low transition has occurred at CF3 pin; that \nis, an active low pulse has been generated. The bit is set even if the CF3 output is disabled \nby setting B it 11 (CF3DIS) to 1 in the CFMODE register. The type of power used at t he CF3 \npin is deter mined by B its[8:6] (CF3SEL [2:0] ) in the CFMODE register (see Table 45 ). \n17 DREADY  0 When this bit is set to 1, it indicates that all periodical (at 8  kHz rate) DSP computations \nhave finished.  \n18 REVPSUM3  0 When t his bit is set to 1, it indicates that the sum of all phase powers in the CF3 datapath \nhas changed sign. The sign itself is indicated in B it 8 (SUM3SIGN) of the PHSIGN register \n(see Table 47). \n31:19 Reserved  0 0000 0000 0000 Reserved. These bits are always 0.  \nRev. H| Page 86 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 38. STATUS1 Register (Ad dress 0xE503)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 NLOAD  0 When this bit is set to 1, it indicates that at least one phase entered no load condition based \non total active and reactive powers. The phase is indicated in B its[2:0] (NLPHASE [x]) in the \nPHNOLOAD register (see Table 42).  \n1 FNLOAD  0 When this bit is set to 1, it indicates that at least o ne phase entered no load condition based \non fundamental active and reactive powers. The phase is indicated in Bits[5:3] (FNLPHASE [x]) \nin PHNOLOAD register (see Table 42 in which this register is described).  This bi t is always 0 \nfor ADE7854, ADE7858, and ADE7868. \n2 VANLOAD 0 When this bit is set to 1, it indicates that at least one phase entered no load condition based \non apparent power. The phase is indicated in B its[8:6] (VANLPHASE[x] ) in the PHNOLOAD \nregister (see Table 42).  \n3 ZXTOVA  0 When this bit is set to 1, it indicates a zero crossing on Phase A voltage is missing.  \n4 ZXTOVB  0 When this bit is set to  1, it indicates a zero crossing on Phase B voltage is missing.  \n5 ZXTOVC  0 When this bit is set to 1, it indicates a zero crossing on Phase C voltage is missing.  \n6 ZXTOIA  0 When this bit is set to 1, it indicates a zero crossing on Phase A current is mis sing.  \n7 ZXTOIB  0 When this bit is set to 1, it indicates a zero crossing on Phase B current is missing.  \n8 ZXTOIC  0 When this bit is set to 1, it indicates a zero crossing on Phase C current is missing.  \n9 ZXVA  0 When this bit is set to 1, it indicates a zero crossing has been detected on Phase A voltage.  \n10 ZXVB  0 When this bit is set to 1, it indicates a zero crossing has been detected on Phase B voltage.  \n11 ZXVC  0 When this bit is set to 1, it indicates a zero crossing has been detected on Phase C voltage.  \n12 ZXIA  0 When this bit is set to 1, it indicates a zero crossing has been detected on Phase A current.  \n13 ZXIB  0 When this bit is set to 1, it indicates a zero crossing has been detected on Phase B current.  \n14 ZXIC  0 When this bit is set to 1, it  indicates a zero crossing has been detected on Phase C current.  \n15 RSTDONE  1 In case of a software reset command, B it 7 (SWRST) is set to 1 in the CONFIG  register, or a \ntransition from PSM1, PSM2 , or PSM3 to PSM0, or a hardware reset, this bit is set to 1 at the \nend of the transition process and after all registers changed value to default. The IRQ1  pin \ngoes low to signal this moment because this interrupt cannot be disabled.  \n16 SAG  0 When this bit is set to 1, it indicates a  SAG event  has occurred on one of the phases indicated \nby Bits[14:12]  (VSPHASE[x] ) in the PHSTATUS register (see Table 41). \n17 OI 0 When this bit is set to 1, it indicates an overcurrent event has occurred on one of the phases \nindicated by Bits[ 5:3] (OIPHASE[x] ) in the PHSTATUS register (see Table 41). \n18 OV 0 When this bit is set to 1, it indicates an overvoltage event has occurred on one of the phases indicated by Bits[ 11:9]  (OVPH ASE [x]) in the PHSTATUS register (see Table 41). \n19 SEQERR  0 When this bit is set to 1, it indicates a negative -to-positive zero crossing on Phase A voltage \nwas not followed by a negative -to-positive zero crossing  on Phase B voltage  but by a \nnegative -to-positive zero crossing on Phase C voltage.  \n20 MISMTCH  0 When this bit is set to 1, it indicates ISUMLVL INWV ISUM > − , where ISUMLVL  is \nindicated in  the ISUMLVL register . This bit is always 0 for ADE7854  and ADE7858.  \n21 Reserved  1 Reserved. This bit is always set to 1.  \n22 Reserved  0 Reserved. This bit is always set to 0.  \n23 PKI 0 When this bit is set to 1, it indicates that the period used to detect the peak value in the \ncurrent channel has ended. The IPEAK register cont ains the peak value and the phase where \nthe peak has been detected (see Table 35). \n24 PKV  0 When this bit is set to 1, it indicates that the period used to detect the peak value in the voltage channel has ended. V PEAK register contains the peak value and the phase where the \npeak has been detected (see Table 36). \n31:25 Reserved  000 0000  Reserved. These bits are always 0.  \nRev. H| Page 87 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTable 39. MASK0  Register (Ad dress 0xE50A)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 AEHF  0 When this bit is set to 1, it enables an interrupt when B it 30 of any one of the  total active \nenergy registers ( AWAT THR, BWAT THR, or CWAT THR ) changes.  \n1 FAEHF  0 When this bit is set to 1, it enables an interrupt when Bit 30 of any one of the fundamental \nactive energy registers (AFWATTHR, BFWATTHR, or CFWATTHR) changes.  Setting t his bit to1 \ndoes not have any consequence for ADE7854, ADE7858, and ADE7868.  \n2 REHF  0 When this bit is set to 1, it enables an interrupt when B it 30 of any one of the t otal reactive \nenergy registers ( AVARHR, BVARHR, CVARHR ) changes.  Setting this bit to1 does not have any \nconsequence for ADE7854.  \n3 FREHF  0 When this bit is set to 1, it enables an interrupt when Bit 30 of any one of the fundamental \nreactive energy register s (AFVARHR, BFVARHR, or CFVARHR) changes.  Setting this bit to1 \ndoes not have any consequence for ADE7854, ADE7858, and ADE7868. \n4 VAEHF  0 When this bit is set to 1, it enables an interrupt when Bit 30 of any one of the apparent \nenergy registers  (AVAHR, BVAHR, or CVAHR ) changes.  \n5 LENERGY  0 When this bit is set to 1, in line energy accumulation mode, it enables an interrupt at the end \nof an integration over an integer number of half line cyc les set in the LINECYC register.  \n6 REVAPA  0 When this bit is set to 1, it enables an interrupt when the Phase A active power identified by \nBit 6 (REVAPSEL) in the ACCMODE register (total or fundamental) changes sign.  \n7 REVAPB  0 When this bit is set to 1 , it enables an interrupt when the Phase B active power identified by \nBit 6 (REVAPSEL) in the ACCMODE register (total or fundamental) changes sign.  \n8 REVAPC  0 When this bit is set to 1, it enables an interrupt when the Phase C active power identified by Bit 6 (REVAPSEL) in the ACCMODE register (total or fundamental) changes sign.  \n9 REVPSUM1  0 When this bit is set to 1, it enables an interrupt when the sum of all phase powers in the CF1 datapath changes sign.  \n10 REVRPA  0 When this bit is set to 1, it ena bles an interrupt when the Phase A reactive power identified \nby Bit 7 (REVRPSEL) in the ACCMODE register (total or fundamental) changes sign.  Setting \nthis bit to1 does not have any consequence for ADE7854. \n11 REVRPB  0 When this bit is set to 1, it enables an interrupt when the Phase B reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total or fundamental) changes s ign.\n Setting \nthis bit to1 does not have any consequence for ADE7854. \n12 REVRPC  0 When this bit is set to 1, it enables an interrupt when the Phase C reactive power identified \nby Bit 7 (REVRPSEL) in the ACCMODE register (total or fundamental) changes sign.  Setting \nthis bit to1 does not have any consequence for ADE7854. \n13 REVPSUM2  0 When this bit is set to 1, it enables an interrupt when the sum of all phase powers in the CF2 \ndatapath changes sign.  \n14 CF1  When this bit is set to 1, it enables an interrupt when a high-to -low transition occurs at the \nCF1 pin, that is, an active low pulse is generated. The interrupt can be enabled even if the \nCF1 output is disabled by setting B it 9 (CF1DIS) to 1 in the CFMODE register. The type of \npower used at the CF1 pin is determined by B its[2:0] (CF1SEL [2:0] ) in the CFMODE register \n(see Table 45). \n15 CF2  When this bit is set to 1, it enables an interrupt when a high-to -low transition occurs at CF2 \npin, that is, an active low pulse is generated. The interrupt may be enabled even if the CF2 \noutput is disabled by setting B it 10 (CF2DIS) to 1 in  the CFMODE register. The type of power  \nused at the CF2 pin is determined by Bits[ 5:3] (CF2SEL [2:0] ) in the CFMODE  register (see Table 45 ). \n16 CF3  When this bit is set to 1, it enables an interrupt when a high to low transition occurs at CF3 pin, that is, an active low pulse is generated. The interrupt may be enabled even if the CF3 \noutput is disabled by setti ng Bit 11 (CF3DIS) to 1 in the CFMODE register. The type of power  \nused at the CF3 pin is determined by Bits[ 8:6] (CF3SEL [2:0] ) in the CFMODE register (see Table 45 ). \n17 DREADY  0 When this bit is set to 1, it enabl es an interrupt when all periodical (at 8  kHz rate) DSP \ncomputations finish.  \n18 REVPSUM3  0 When this bit is set to 1, it enables an interrupt when the sum of all phase powers in the CF3 \ndatapath changes sign.  \n31:19 Reserved  00 0000 0000 \n0000 Reserved. T hese bits do not manage any functionality.  \nRev. H| Page 88 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 40. MASK1  Register (Ad dress 0xE50B)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 NLOAD  0 When this bit is set to 1, it enables an interrupt when at least one phase enters n o load \ncondition based on total active and reactive powers.  \n1 FNLOAD  0 When this bit is set to 1, it enables an interrupt when at least one phase enters no load \ncondition based on fundamental active and reactive powers.  Setting this bit to  1 does not \nhave any consequence for ADE7854, ADE7858, and ADE7868.  \n2 VANLOAD 0 When this bit is set to 1, it enables an interrupt when at least one phase enters no load condition based on apparent power.   \n3 ZXTOVA  0 When this bit is set to 1, it enables an interrupt when a zero crossing on Phase A voltage is \nmissing . \n4 ZXTOVB  0 When this bit is set to 1, it enables an interrupt when a zero crossing on Phase B voltage is \nmissing . \n5 ZXTOVC  0 When this bi t is set to 1, it enables an interrupt when a zero crossing on Phase C voltage is \nmissing . \n6 ZXTOIA  0 When this bit is set to 1, it enables an interrupt when a zero crossing on Phase A current is \nmissing . \n7 ZXTOIB  0 When this bit is set to 1, it enables an interrupt when a zero crossing on Phase B current is \nmissing.  \n8 ZXTOIC  0 When this bit is set to 1, it enables an interrupt when a zero crossing on Phase C current is \nmissing.  \n9 ZXVA  0 When this bit is set to 1, it enables an interrupt when a zero cro ssing is detected on Phase A \nvoltage.  \n10 ZXVB  0 When this bit is set to 1, it enables an interrupt when a zero crossing is detected on Phase B \nvoltage.  \n11 ZXVC  0 When this bit is set to 1, it enables an interrupt when a zero crossing is detected on Phase  C \nvoltage.  \n12 ZXIA  0 When this bit is set to 1, it enables an interrupt when a zero crossing is detected on Phase A current.  \n13 ZXIB  0 When this bit is set to 1, it enables an interrupt when a zero crossing is detected on Phase B \ncurrent.  \n14 ZXIC  0 Whe n this bit is set to 1, it enables an interrupt when a zero crossing is detected on Phase C \ncurrent.  \n15 RSTDONE  0 Because the RSTDONE interrupt cannot be disabled, this bit does not have any functionality \nattached. It can be set to 1 or cleared to 0 witho ut having any effect.  \n16 SAG  0 When this bit is set to 1, it enables an interrupt when a SAG event occurs on one of the \nphases indicated by Bits[ 14:12]  (VSPHASE [x]) in the PHSTATUS register (see Table 41). \n17 OI 0 When this bit is set to 1, it enables an interrupt when an overcurrent event occurs on one of \nthe phases indicated by Bits[ 5:3] (OIPHASE[x] ) in the PHSTATUS register (see Table 41). \n18 OV 0 When this bit is set to 1, it enables an interrupt when an overvoltage event occurs on one of the phases indicated by Bits[ 11:9]  (OVPHASE [x]) in the PHSTATUS register (see Table 41). \n19 SEQERR  0 When this bit is set to 1, it enables an interrupt when a negative -to-positive zero crossing on \nPhase  A voltage is not followed by a negative -to-positive zero crossing on Phase B voltage, \nbut by a negative -to-positive zero crossing on Phase C voltage.  \n20 MISMTCH  0 When this bit is set to 1, it  enables an interrupt when ISUMLVL INWV ISUM > −  is \ngreater than the value indicated in  ISUMLVL register.  Setting this bit to1 does not have any \nconsequence for ADE7854 and ADE7858.  \n22:21  Reserved  00 Reserved. These bits do not manage any functionality.  \n23 PKI 0 When this bit is set to 1, it enables an interrupt when the period used to detect the peak \nvalue in the current channel has ended.  \n24 PKV  0 When this bit is set to 1, it enables an interrupt when the period used to detect the peak value in the voltage channel has ended.  \n31:25 Reserved  000 0000  Reserved. These bits do not manage any functionality.  \nRev. H| Page 89 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTable 41. PHSTATUS Register (Ad dress 0xE600)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n2:0 Reserved  000 Reserved . These bit s are always 0.  \n3 OIPHASE[0]  0 When this bit is set to 1, Phase A current generates  Bit 17 (OI) in the STATUS1 register . \n4 OIPHASE[1]  0 When this bit is set to 1, Phase B current generate s Bit 17 (OI) in the STATUS1 register . \n5 OIPHASE[2 ] 0 When this bi t is set to 1, Phase C current generates  Bit 17 (OI) in the STATUS1 register . \n8:6 Reserved  000 Reserved. These bits are always 0.  \n9 OVPHASE[0]  0 When this bit is set to 1, Phase A voltage generate s Bit 18 (OV) in the STATUS1 register . \n10 OVPHASE[1]  0 When this bit is set to 1, Phase B voltage generate s Bit 18 (OV) in the STATUS1 register . \n11 OVPHASE[2]  0 When this bit is set to 1, Phase C voltage generate s Bit 18 (OV) in the STATUS1 register . \n12 VSPHASE[0]  0 When this bit is set to 1, Phase A voltage g enerate s Bit 16 ( SAG ) in the STATUS1 register . \n13 VSPHASE[1]  0 When this bit is set to 1, Phase B voltage generate s Bit 16 (SAG ) in the STATUS1 register . \n14 VSPHASE[2]  0 When this bit is set to 1, Phase C voltage generate s Bit16 (SAG ) in the STATUS1 regi ster. \n15 Reserved  0 Reserved . This bit is always 0.  \nTable 42. PHNOLOAD Register (Addr ess 0xE608)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 NLPHASE[0]  0 0: Phase A is out of no load condition based on total active/reac tive powers.  \n   1: Phase A is in no load condition based on total active/reactive powers. Bit set together with \nBit 0 (NLOAD) in the STATUS1 register . \n   The ADE7854 no load condition is based only on the total active powers.  \n1 NLPHASE[1]  0 0: Phase B is out of no load condition based on total active/reactive powers.  \n   1: Phase B is in no load condition based on total active/reacti ve powers. Bit set together with \nBit 0 (NLOAD) in the STATUS1 register . \n   The ADE7854 no load condition is based only on the total active powers.  \n2 NLPHASE[2]  0 0: Phase C is out of no load condition based on total active/reactive powers.  \n   1: Phase C is in no load condition based on total active/reactive powers. Bit set together with \nBit 0 (NLOAD) in the STATUS1 register . \n   The ADE7854 no load condition is based only on the total active powers.  \n3 FNLPHASE[0]  0 0: Phase A is out of no load condition based on fundamental active/reactive powers. This bit \nis always 0 for ADE7854, ADE7858 , and ADE7868 . \n   1: Phase A is in no load condition based on fundamental active/reactive powers. This bit is \nset together with Bit 1 (FNLOAD) in STATUS1.   \n4 FNLPHASE[1]  0 0: Phase B is out of no load condition based on fundamental active/reactive powers. This bit \nis always 0 for ADE7854, ADE7858 , and ADE7868 . \n   1: Phase B is in no load condition based on fundamental active/reactive powers. This bit is \nset together with Bit 1 (FNLOAD) in STATUS1.  \n5 FNLPHASE[2]  0 0: Phase C is out of no load condition based on fundamental active/reactive powers.  This bit \nis always 0 for ADE7854, ADE7858 , and ADE7868 . \n   1: Phase C is in no load condition based on fundamental active/reactive powers. This bit is \nset together with Bit 1 (FNLOAD) in STATU S1.  \n6 VANLPHASE[0]  0 0: Phase A is out of no load condition based on apparent power.  \n   1: Phase A is in no load condition based on apparent power. Bit set together with Bit 2 (VANLOAD) in the STATUS1 register . \n7 VANLPHASE[1]  0 0: Phase B is out of no load condition based on apparent power.  \n   1: Phase B is in no load condition based on apparent power. Bit set together with Bit 2 \n(VANLOAD) in the STATUS1 register . \n8 VANLPHASE[2]  0 0: Phase C is out of no load condition based on apparent power.  \n   1: Phase C is in no load condition based on apparent power. Bit set together with Bit 2 \n(VANLOAD) in the STATUS1 register . \n15:9 Reserved  000 0000  Reserved . These bits are always 0.  \nRev. H| Page 90 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 43. COMPMODE Register (Ad dress 0xE60E)  \nBit \nLoc ation  Bit Mnemonic  Default  Value  Description  \n0 TERMSEL1[0]  1 Setting all TERMSEL1[2:0] to 1 signifies the sum of all three  phases is included in the CF1 \noutput. Phase A is included in the CF1 outputs calculations . \n1 TERMSEL1[1]  1 Phase B is included in t he CF1 outputs calculations . \n2 TERMSEL1[2]  1 Phase C is included in the CF1 outputs calculations . \n3 TERMSEL2[0]  1 Setting all TERMSEL2[2:0] to 1 signifies the sum of all three  phases is included in the CF2 \noutput. Phase A is included in the CF2 outputs c alculations . \n4 TERMSEL2[1]  1 Phase B is included in the CF2 outputs calculations . \n5 TERMSEL2[2]  1 Phase C is included in the CF2 outputs calculations . \n6 TERMSEL3[0]  1 Setting a ll TERMSEL3[2:0] to 1 signifies the sum of all three  phases is included in the CF3 \noutput. Phase A is included in the CF3 outputs calculations . \n7 TERMSEL3[1]  1 Phase B is included in the CF3 outputs calculations . \n8 TERMSEL3[2]  1 Phase C is included in the CF3 outputs calculations . \n10:9 ANGLESEL[1:0]  00 00: the angles between pha se voltages and phase currents are measured . \n   01: the angles between phase voltages are measured.  \n   10: the angles between phase currents are measured.  \n   11: no angles are measured.  \n11 VNOMAEN  0 When this bit is 0, the apparent power on Phase A is computed regularly.  \n   When this bit is 1, the apparent power on Phase A is computed using VNOM register instead \nof regular measured rms phase voltage.  The applied Phase A voltage input is ignored, and all \nPhase A rms voltage instances are replaced by the value in the VNOM register.  \n12 VNOMBEN  0 When this bit is 0, the apparent power on Phase B is computed regularly.  \n   When this bit is 1, the apparent power on Phase B is computed using VNOM register instead \nof regular measured rms phase voltage.  The a pplied Phase B voltage input is ignored, and all \nPhase B rms voltage instances are replaced by the value in the VNOM register.  \n13 VNOMCEN  0 When this bit is 0, the apparent power on Phase C is computed regularly.  \n   When this bit is 1, the apparent powe r on Phase C is computed using VNOM register instead \nof regular measured rms phase voltage.  The applied Phase C voltage input is ignored, and all \nPhase C rms voltage instances are replaced by the value in the VNOM register.  \n14 SELFREQ  0 When the ADE7878 is connected to 50 Hz networks, this bit should be cleared to 0 (default \nvalue). When the ADE7878 is connected to 60 Hz networks, this bit should be set to 1.  This \nbit does not have any consequence for ADE7854, ADE7858, and ADE7868.  \n15 Reserved  0 This bit is 0 by default and it does not manage any functionality.  \nTable 44. Gain Register (Addre ss 0xE60F)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n2:0 PGA1[2:0]  000 Phase currents gain selection.  \n000: gain = 1. \n001: gain = 2 . \n010: gain = 4. \n011: gain = 8. \n100: gain = 16. \n101, 110, 111: reserved. When set, the ADE7854/ ADE7858/ ADE7868/ ADE7878 behave  \nlike PGA1 [2:0] = 000. \n5:3 PGA2[2:0]  000 Neutral current gain se lection . \n   000: gain = 1. These bits are always 000 for ADE7854  and ADE7858 . \n   001: gain = 2 . \n   010: gain = 4. \n   011: gain = 8. \n   100: gain = 16. \n   101, 110, 111: reserved. When set, the ADE7868/ ADE7878 behave  like PGA2[2:0] = \n000. \nRev. H| Page 91 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \n8:6 PGA3[2:0]  000 Phase voltage s gain selection.  \n000: gain = 1. \n001: gain = 2. \n010: gain = 4. \n011: gain = 8. \n100: gain = 16. \n101, 110, 111: reserved. When set, the ADE7854/ ADE7858/ ADE7868 /ADE7878 behave \nlike PGA3[2:0] = 000. \n15:9 Reserved  000 0000  Reserved. These bits do not manage  any functionality.  \nTable 45. CFMODE Register (Ad dress 0xE610)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description   \n2:0 CF1SEL[2:0]  000 000: the CF1 frequency is proportional to the sum of total active powers on each phase \nidentif ied by Bits[2:0] (TERMSEL1 [x]) in the  COMPMODE register.  \n001: the CF1 frequency is proportional to the sum of total reactive powers on each phase \nidentified by Bits[2:0] (TERMSEL1 [x]) in the  COMPMODE register.  This condition does not \nhave any consequence for the ADE7854.  \n010: the CF1 frequency is proportional to the sum of apparent powers on each phase \nidentified by Bits[2:0] (T ERMSEL1 [x]) in the  COMPMODE register.  \n011: the CF1 frequency is proportional to the sum of fundamental active powers on each \nphase identified by Bits[2:0] (TERMSEL1 [x]) in the  COMPMODE register.  This condition does \nnot have any consequence for the ADE7854, ADE7858, and ADE7868. \n100: the CF1 frequency is proportional to the sum of fundamental reactive powers on each \nphase identified by Bits[2:0] (TERMSEL1 [x]) in the  COMPMODE register.  This condition does \nnot have any consequence for the ADE7854, ADE7858, and ADE7868. \n101, 110, 111: reserved. When set, the CF1 signal is not generated . \n5:3 CF2SEL[2:0]  001 000: the CF2 frequency is proportional to the sum of total active powers on each phase \nidentified by Bits[5:3] (TERMSEL2 [x]) in the  COMPMODE register.  \n001: the CF2 frequency is proportional to the sum of total reactive powers on each phase identified by Bits[5:3] ( TERMSEL2 [x]) in the  COMPMODE register.\n This condition does not \nhave any consequence for the ADE7854.  \n010: the CF2 frequency is pr oportional to the sum of apparent powers on each phase \nidentified by Bits[5:3] (TERMSEL2 [x]) in the  COMPMODE register.  \n011: the CF2 frequency is proportional to the sum of fundamental active powers on each \nphase identified by Bits[5:3] (TERMSEL2 [x]) in the COMPMODE register.  This condition does \nnot have any consequence for the ADE7854, ADE7858, and ADE7868. \n100: the CF2 frequency is proportional to the sum of fundamental reactive powe rs on each \nphase identified by Bits[5:3] (TERMSEL2 [x]) in the  COMPMODE register.  This condition does \nnot have any consequence for the A DE7854, ADE7858, and ADE7868. \n101,110,111: reserved . When set, the CF2 signal is not generated.  \n8:6 CF3SEL[2:0]  010 000: the CF3 frequency is proportional to the sum of total active powers on each phase identified by Bits[8:6] (TERMSEL3 [x]) in the  COMPMODE register.  \n001: the CF3 frequency is proportio nal to the sum of total reactive powers on each phase \nidentified by Bits[8:6] (TERMSEL3 [x]) in the  COMPMODE register.  This condition does not \nhave any consequence for the ADE7854.  \n010: the CF3 frequency is proportional to the sum of apparent powers on each phase identified by Bits[8:6] (TERMSEL3 [x]) in the  COMPMODE register.  \n011: CF3 frequency is proportional to the sum of fundamental active powers on each phase identified by Bits[8:6] (TERMSEL3 [x]) in the  COMPMODE register.\n This condition does not \nhave any consequence for the ADE7854, ADE7858 , and ADE7868 . \n100: CF3 frequency is proportional to the sum of fundamental reactive powers on each \nphase identified by Bits[8:6] (TERMSEL3 [x]) in the  COMPMODE register.  This condition does \nnot have any consequence for the ADE7854, ADE7858, and ADE7868. \n101,110,111: reserved. When set, the CF 3 signal is not generated.  \n9 CF1DIS 1 When this bit is set to 1, the CF1 output is disabled. The respective digital to frequency \nconverter remains enabled even if CF1 DIS = 1.  \n   When this bit is set to 0, the CF1 output is enabled.  \nRev. H| Page 92 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nBit \nLocation  Bit Mnemonic  Default  Value  Description   \n10 CF2DIS 1 When this bit is set to 1, the CF2 output is disabled. The respective digital to frequency \nconverter remains enabled even if CF2DIS  = 1.  \n   When this bit is set to 0, the CF2 output is enabled.  \n11 CF3DIS 1 When this bit is set to 1, the CF3 output is disabled. The respective digital to frequency \nconverter remains enabled even if CF3DIS  = 1.  \n   When this bit is set to 0, the CF3 output is enabled.  \n12 CF1LATCH  0 When this bit is set to 1, the content of the corresponding energy registers is latched when a \nCF1 pulse is generated. S ee the Synchronizing Energy Registers with CFx Outputs  section.  \n13 CF2LATCH  0 When this bit is set to 1,  the content of the corresponding energy registers is latched when a \nCF2 pulse is generated. S ee the Synchronizing Energy Registers with CFx Outputs  section.  \n14 CF3LATCH  0 When this bit is set to 1, the content of  the corresponding energy registers is latched when a \nCF3 pulse is generated. S ee the Synchronizing Energy Registers with CFx Outputs  section.  \n15 Reserved  0 Reserved. This bit does not manage any functionality.  \nTable 46. APHCAL, BPHCAL, CPHCAL Registers (Address 0xE614, Address 0xE615, Address 0xE616)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n9:0 PHCALVAL  0000000000  If the current leads the voltage , these bits can vary only betwe en 0 and 383.  \nIf the current lags the voltage , these bits can vary only between 512 and 575.  \nIf the PHCALVAL bits are set with numbers between 384 and 511, the compensation behaves \nlike PHCALVAL set between 256 and 383.  \nIf the PHCALVAL bits are  set with numbers between 5 76 and 1023, the compensation \nbehaves like PHCALVAL bits set between 384 and 511.  \n15:10 Reserved  000000 Reserved. These bits do not manage any functionality.  \nTable 47. PHSIGN Register (Address 0xE617)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 AWSIGN  0 0: if the active power identified by Bit 6 (REVAPSEL) in the ACCMODE register (total of \nfundamental) on Phase A is positive.  \n1: if the active power identified by Bit 6 (REVAPSEL) in the ACCM ODE register (total of \nfundamental) on Phase A is negative.  \n1 BWSIGN  0 0: if the active power identified by Bit 6 (REVAPSEL) in the ACCMODE register (total of \nfundamental) on Phase B is positive.  \n   1: if the active power identified by Bit 6 (REVAPSEL) in the ACCMODE register (total of \nfundamental) on Phase B is negative.  \n2 CWSIGN  0 0: if the active power identified by Bit 6 (REVAPSEL) in the ACCMODE register (total of \nfundamental) on Phase C is positive.  \n   1: if the active power identified by Bit 6 (R EVAPSEL) bit in the ACCMODE register (total of \nfundamental) on Phase C is negative.  \n3 SUM1SIGN  0 0: if the sum of all phase powers in the CF1 datapath is positive.  \n   1: if the sum of all phase powers in the CF1 datapath is negative. Phase powers in the CF1 \ndatapath are identified by Bits[2:0] (TERMSEL1 [x]) of the  COMPMODE register and by  \nBits[2:0] (CF1SEL [x]) of the CFMODE register.  \n4 AVARSIGN  0 0: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total of \nfundamental) on Phase A is positive.  This bit is always 0 for ADE7854. \n   1: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE regist er (total of \nfundamental) on Phase A is negative.  \n5 BVARSIGN  0 0: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total of \nfundamental) on Phase B is positive.  This bit is always 0 for ADE7854. \n   1: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total of \nfundamental) on Phase B is negative.  \n6 CVARSIGN  0 0: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total of \nfundamental) on Phase C is positive.  This bit is always 0 for ADE7854. \n   1: if the reactive power identified by Bit 7 (REVRPSEL) in the ACCMODE register (total of \nfundamental) on Phase C is negative.  \nRev. H| Page 93 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n7 SUM2SIGN  0 0: if the sum of all phase powers in the CF2 datapath is positive.  \n   1: if the sum of all phase powe rs in the CF2 datapath is negative. Phase powers in the CF2 \ndatapath are identified by Bits[5:3] (TERMSEL2 [x]) of the  COMPMODE register and by \nBits[5:3] (CF2SEL [x]) of the CFMODE register.  \n8 SUM3SIGN  0 0: if the sum of all phase powers in the CF3 datapath  is positive.  \n   1: if the sum of all phase powers in the CF3 datapath is negative. Phase powers in the CF3 \ndatapath are identified by Bits[8:6] (TERMSEL3 [x]) of the  COMPMODE register and by \nBits[8:6] (CF3SEL [x]) of the CFMODE register.  \n15:9 Reserved  000 0000  Reserved . These bits are always 0.  \nTable 48. CONFIG Register (Ad dress 0xE618)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 INTEN  0 Integrator enable. When this bit is set to 1, the internal digital integrator is ena bled for use in \nmeters utilizing Rogowski c oils on all 3 -phase and neutral current inputs.  \n   When this bit is cleared to 0, the internal digital integrator is disabled.   \n2:1 Reserved  00 Reserved. These bits do not manage any functionality.  \n3 SWAP  0 When this bit is set to 1, the voltage channel outputs are swapped wit h the current channel \noutputs. Thus, the current channel information is present in the voltage channel registers \nand vice versa.  \n4 MOD1SHORT  0 When this bit is set to 1, the voltage channel ADCs behave as if the voltage inputs were put \nto ground.  \n5 MOD2SHORT  0 When this bit is set to 1, the current channel ADCs behave as if the voltage inputs were put to ground.  \n6 HSDCEN  0 When this bit is set to 1, the HSDC serial port is enabled and HSCLK functionality is chosen at CF3/HSCLK pin.  \n   When this bit is cleared to 0, HSDC is disabled and CF3 functionality is chosen at CF3/HSCLK pin.  \n7 SWRST  0 When this bit is set to 1, a software reset is initiated.  \n9:8 VTOIA[1:0]  00 These bits decid e what phase voltage is considered together with Phase A current in the \npower path.  \n00 = Phase A voltage.  \n01 = Phase B voltage.  \n10 = Phase C voltage.  \n11 = reserved. When set, the ADE7854/ ADE7858/ ADE7868/ ADE7878  behave  like VTOIA [1:0] = \n00. \n11:10 VTOIB[1:0]  00 These bits decide what phase voltage is considered together with Phase B current in the power path.  \n00 = Phase B voltage.  \n01 = Phase C voltage.  \n10 = Phase A voltage.  \n11 = reserved. When set, the ADE7854/ ADE7858/ ADE7868/ ADE7878  behave  like VTOIB[1:0] = \n00. \n13:12 VTOIC[1:0]  00 These bits decide what phase voltage is considered together with Phase C current in the \npower path.  \n00 = Phase C voltage.  \n01 = Phase A voltage.  \n10 = Phase B voltage.  \n11 = reserved. When set, the ADE7854/ ADE7858/ ADE7868/ ADE7878  behave  like VTOIC[1:0] = \n00. \n15:14 Reserved  0 Reserved. Th ese bits do not manage any functionality.  \nRev. H| Page 94 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nTable 49. MMODE Register (Add ress 0xE700)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description   \n1:0 PERSEL[1:0]  00 00: Phase A selected  as the source of the voltage line period measurement.  \n01: Phase B selected as the source of the voltage line period measurement.  \n10: Phase C selected as the source of the voltage line period measurement.  \n11: reserved. When set, the ADE7854 /ADE7858 /ADE7868 /ADE7878  behave  like PERSEL[1:0] = 00.  \n2 PEAKSEL[0]  1 PEAKSEL[2:0] bits can all be set to 1 simultaneously to allow peak detection on all three  \nphases simultaneously. If more than one PEAKSEL[2:0] bits are set to 1, then the peak \nmeasurement period indicated in t he PEAKCYC register decreases accordingly because zero \ncrossings are detected on more than one phase.  \n   When this bit is set to 1, Phase A is selected for the voltage and current peak registers.  \n3 PEAKSEL[1]  1 When this bit is set to 1, Phase B is selec ted for the voltage and current peak registers . \n4 PEAKSEL[2]  1 When this bit is set to 1, Phase C is selected for the voltage and current peak registers . \n7:5 Reserved  000 Reserved. These bits do not manage any functionality.  \nTable 50. ACCMODE Register (Address 0xE701)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description   \n1:0 WATTACC[1:0]  00 00: signed accumulation mode of the total and fundamental active powers.  Fundamental \nactive powers are available in the ADE7878.  \n01: reserved. When set, the device behaves like WATTACC[1:0] = 00. \n10: reserved. When set, the device behaves like WATTACC[1:0] = 00. \n11: absolute accumulation mode of the total and  fundamental active powers.  \n3:2 VARACC[1:0]  00 00: signed accumulation of the total and fundamental reactive powers.  Total reactive powers \nare available in the ADE7858, ADE7868, and ADE7878. Fundamental reactive powers are \navailable in the  ADE7878. These bits a re always 00 for the ADE7854 . \n01: reserved. When set, the device  behaves like VARACC[1:0] = 00.  \n10: the total and fundamental reactive powers are accumulated , depending on the sign of \nthe total and fundamental active power: if the active power is positiv e, the reactive power is \naccumulated as is, whereas if the active power is negative, the reactive power is accumulated  \nwith reversed sign.  \n11: reserved. When set, the  device  behave  like VARACC[1:0] = 00.  \n5:4 CONSEL[1:0]  00 These bits select the inputs  to the energy accumulation registers. IA’ , IB’ , and IC’ are IA, IB, and \nIC shifted respectively by −90°. See Table 51. \n00: 3 -phase four  wires with three  voltage sensors.  \n01: 3 -phase three  wires delta conn ection.  \n10: 3-phase four  wires with two  voltage sensors.  \n11: 3-phase four  wires delta connection.  \n6 REVAPSEL  0 0: The total active power on each phase is used to trigger a bit in the STATUS0 register as \nfollows: on Phase A triggers Bit 6 (REVAPA),  on Phase B triggers Bit 7 (REVAPB), and on \nPhase  C triggers Bit 8 (REVAPC).  This bit is always 0 for the ADE7854 , ADE7858, and ADE7868.  \n   1: The fundamental active power on each phase is used to trigger a bit in the STATUS0 \nregister as follows: on P hase A trigger s Bit 6 (REVAPA) , on Phase B triggers Bit 7 (REVAPB), \nand on Phase C triggers Bit 8 (REVAPC).  \n7 REVRPSEL  0 0: The total re active power on each phase is used to trigger a bit in the STATUS0 register as \nfollows: on  Phase A trigger s Bit 10 (REVRPA) , on Phase B triggers Bit 11 (REVRPB), and on \nPhase C triggers Bit 12 (REVRPC).  This bit is always 0 for the ADE7854 , ADE7858, and \nADE7868.  \n   1: The fundamental re active power on each phase is used to trigger a bit in the STATUS0 \nregister as follows:  on Phase A trigger s Bit 10 (REVRPA) , on Phase B triggers Bit 11 (REVRPB), \nand on Phase C triggers Bit 12 (REVRPC).  \nRev. H| Page 95 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nTable 51. CONSEL[1:0] Bits in Energy Registers  \nEnergy Registers CONSEL[1:0]  = 00 CONSEL[1:0]  = 01 CONSEL[1:0]  = 10 CONSEL[1:0]  = 11 \nAWATTHR, AFWATTHR  VA × IA VA × IA VA × IA VA × IA \nBWAT THR, BFWAT THR  VB × IB 0 VB = −VA − VC VB = −VA  \n   VB × IB  VB × IB  \nCWATTHR, CFWATTHR  VC × IC VC × IC VC × IC VC × IC \nAVARHR, AFVARHR  VA × IA’ VA × IA’ VA × IA’ VA × IA’ \nBVARHR, BFVARHR  VB × IB’ 0 VB = −VA − VC VB = −VA \n   VB × IB’  VB × IB’  \nCVARHR, CFVARHR  VC × IC’ VC × IC’ VC × IC’ VC × IC’ \nAVAHR  VA rms × IA rms VA rms × IA rms  VA rms × IA rms  VA rms × IA rms  \nBVAHR  VB rms × IB rms 0 VB rms × IB rms  VB rms × IB rms  \nCVAHR  VC rms × IC rms VC rms × IC rms  VC rms × IC rms  VC rms × IC rms  \nTable 52. LCYCMODE  Register (Addr ess 0xE702)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 LWATT  0 0: the watt -hour accumulation registers (AWATTHR, BWATTHR, CWATTHR , AFWATTHR, \nBFWATTHR, and CFWATTHR ) are placed in regular accumulation mode.  \n   1: the watt -hour ac cumulation registers (AWATTHR, BWATTHR , CWAT THR , AFWATTHR, \nBFWATTHR, and CFWATTHR ) are placed into line cycle accumulation mode.  \n1 LVAR  0 0: the var -hour accumulation registers (AVARHR, BVARHR, and CVARHR) are placed in regular \naccumulation mode.  This bit  is always 0 for the ADE7854. \n   1: the var -hour accumulation registers (AVARHR, BVARHR, and CVARHR) are placed into line -\ncycle accu mulation mode.  \n2 LVA 0 0: the VA-hour accumulation registers (AVAHR, BVAHR, and CVAHR) are placed in regular \naccumulation mode.   \n   1: the VA-hour accumulation registers (AVAHR, BVAHR, and CVAHR) are placed into line -cycle \naccumulation mode.  \n3 ZXSEL[0]  1 0: Phase A is not selected for zero -crossings counts in the line cycle accumulation mode.  \n   1: Phase A is selected for zero -crossings counts in the line cycle accumulation mode. If more \nthan one phase is selected for zero -crossing detection, the accumu lation time is shorten ed \naccordingly . \n4 ZXSEL[1]  1 0: Phase B is not selected for zero -crossings counts in the line cycle accumulation mode.  \n   1: Phase B is selected for zero -crossings counts in the line cycle accumulation mode.  \n5 ZXSEL[2]  1 0: Phase C  is not selected for zero -crossings counts in the line cycle accumulation mode.  \n   1: Phase C is selected for zero -crossings counts in the line cycle accumulation mode.  \n6 RSTREAD  1 0: read-with -reset of all energy registers is disabled. Clear t his bit to 0 when B its[2:0] (LWATT, \nLVAR, and LVA) are set to 1.  \n   1: enables read-with -reset of all xWATTHR, xVARHR, xVAHR , xFWATTHR, and xFVARHR  \nregisters. This means a read of those registers resets them to 0.  \n7 Reserved  0 Reserved. This bit does not manage an y functionality.  \nTable 53. HSDC_CFG Register (Ad dress 0xE706)  \nBit  \nLocation  Bit Mnemonic  Default  Value  Description  \n0 HCLK  0 0: HSCLK is 8 MHz . \n   1: HSCLK is 4 MHz.  \n1 HSIZE  0 0: HSDC transmits the 32-bit registers in 32 -bit pack ages, most significant bit first.  \n   1: HSDC transmits the 32-bit registers in 8 -bit packages, most significant bit first.  \n2 HGAP  0 0: no gap is introduced between packages.  \n   1: a gap of seven HCLK cycles is introduced between packages.  \nRev. H| Page 96 of 100 \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nBit  \nLocation  Bit Mnemonic  Default  Value  Description  \n4:3 HXFER[1 :0] 00 00 =  for ADE7854 , HSDC transmits sixteen 32 -bit words in the following order: IAWV, VAWV, \nIBWV, VBWV, ICWV, and VCWV, one 32 -bit word equal to 0, AVA, BVA, CVA, AWATT, BWATT, \nand CWATT, three 32 -bit words equal to 0. For ADE7858, HSDC transmits sixteen 32 -bit \nwords in the following order: IAWV, VAWV, IBWV, VBWV, ICWV, and VCWV, one 32 -bit word \nequal to 0, AVA, BVA, CVA, AWATT, BWATT, CWATT, AVAR, BVAR, and CVAR. F or the ADE7868 \nand ADE7878 , HSDC transmits sixteen 32 -bit words in the following order: IAWV, VAWV, IBWV,  \nVBWV, ICWV, VCWV,  INWV,  AVA, BVA, CVA, AWATT, BWATT, CWATT, AVAR, BVAR, and CVAR.  \n   01 = f or the ADE7854 and ADE7858 , HSDC transmits six instantaneous values of currents \nand voltages: IAWV, VAWV, IBWV, VBWV, ICWV, and VCWV, and one 32 -bit word equal to 0. \nFor the ADE7868 and ADE7878, HSDC transmits seven instantaneous values of currents and \nvoltages: IAWV, VAWV, IBWV, VBWV, ICWV, VCWV, and INWV.  \n   10 = f or the ADE7854, HSDC transmits six instantaneous values of phase powers: AVA, BVA, \nCVA, AWATT, BWATT, and CWATT and three 32 -bit words equal to 0. For the ADE7858 , \nADE7868, and ADE7878, HSDC transmits nine instantaneous values of phase powers:  AVA, \nBVA, CVA, AWATT, BWATT, CWATT, AVAR, BVAR, and CVAR.  \n   11 = reserved. If set, the ADE7854/ ADE7858/ ADE7868 /ADE7878 behave  as if HXFER[1:0] = 00.  \n5 HSAPOL  0 0: SS/HSA  output pin is active low.  \n   1: SS/HSA output pin is active high.  \n7:6 Reserved  00 Reserved. These bits do not manage any functionality.  \nTable 54. LPOILVL Register (Address 0xEC00)1 \nBit Locatio n Bit Mnemonic  Default Value  Description  \n2:0 LPOIL[2:0]  111 Threshold is put at a value corresponding to full scale multiplied by LPOIL/8 . \n7:3 LPLINE[4:0]  00000 The measurement period is (LPLINE  + 1)/50 seconds . \n1 The LPOILVL register is available only for the ADE7868 and ADE7878;  it is reserved for ADE7854 and ADE7858.  \nTable 55. CONFIG2 Register (Ad dress 0xEC01)  \nBit \nLocation  Bit Mnemonic  Default  Value  Description  \n0 EXTREFEN  0 When this bit is 0, it signifies that the internal voltage reference is u sed in the ADCs.  \n   When this bit is 1, an external reference is connected to the Pin 17 REF IN/OUT . \n1 I2C_LOCK  0 When this bit is 0, the SS/HSA pin can be toggled  three  times to activate the SPI port. If I2C is \nthe active serial port, this bit must be set to 1 to lock it in. From this moment on, spurious \ntoggling  of the  SS/HSA  pin and an eventual switch into using the SPI port is no longer possible.  If \nSPI is the active serial port, any write to CONFIG2 register locks the port. From this moment \non, a switch into using I2C port is no longer possible.  Once locked, the serial port choice is \nmaintained when the  ADE7854/ ADE7858/ ADE7868 /ADE7878 change  PSMx power modes.  \n7:2 Reserved  0 Reserved. These bits do not manage any functionality.  \n \n \nRev. H| Page 97 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nOUTL INE DIMENSIONS \n \n05-06-20 11-A0.50\nBSC\nBOTTOM VIEW TOP VIEWPIN 1\nINDIC ATOR\nEXPOSED\nPADPIN 1\nINDIC ATOR\nSEATING\nPLANE0.05 MAX\n0.02 NOM\n0.20 REFCOPLANARITY\n0.080.30\n0.230.186.106.00 SQ5.90\n0.800.750.70FOR PROPER CONNECTION OF\nTHE EXPOSED PAD, REFER TOTHE PIN CONFIGURATION ANDFUNCTION DESCRIPTIONSSECTION OF THIS DATA SHEET.0.45\n0.400.350.25 MIN4.454.30 SQ4.25\nCOMPLIANT TO JEDEC STANDARDS MO-220- WJJD .40\n1\n11 20213031\n10\n \nFigure 99. 40-Lead Lead Fram e Chip Scale Package [LFCSP_WQ]  \n6 mm x 6 mm Body, V ery Very Thin Quad  \n(CP-40-10) \nDimensions shown in millimeters  \n \nORDERING GUIDE  \nModel1 Temperature Range Package Description  Package Option  \nADE7854ACPZ −40°C to +85°C 40-Lead LFCSP_WQ  CP-40-10 \nADE7854ACPZ- RL −40°C to +85°C 40-Lead LFCSP_WQ, 13” Tape and Reel  CP-40-10 \nADE7858ACPZ −40°C to +85°C 40-Lead LFCSP_WQ  CP-40-10 \nADE7858ACPZ- RL −40°C to +85°C 40-Lead LFCSP_WQ, 13” Tape and Reel  CP-40-10 \nADE786 8ACPZ −40°C to +85°C 40-Lead LFCSP_WQ  CP-40-10 \nADE7868ACPZ- RL −40°C to +85°C 40-Lead LFCSP_WQ, 13” Tape and Reel  CP-40-10 \nADE7878ACPZ −40°C to +85°C 40-Lead LFCSP_WQ  CP-40-10 \nADE7878ACPZ- RL −40°C to +85°C 40-Lead LFCSP_WQ, 13” Tape and Reel  CP-40-10 \n1 Z = RoHS Compliant Part.  \n \n  \nRev. H| Page 98 of 100  \nData Sheet ADE7854/ADE7858/ADE7868/ADE7878  \n \nNOTES  \n \n \n  \n \n \nRev. H| Page 99 of 100 \nADE7854/ADE7858/ADE7868/ADE7878  Data Sheet \n \nNOTES  \n \n \n  \n \n \n \n \n \n \n \n   \n \n  \n    \n \n \n \n    \n \n \n   \n \n \nI2C refers to a communications protocol originally developed by Philips Semiconductors (now NXP Semiconductors).  \n \n©2010 –2014  Analog Devices, Inc. All rights reserved. Trademarks and   \n registered trademarks are the property of their respective owners.  \n  D08510- 0-4/14(H)  \n \nRev. H| Page 100 of 100 \n"}]
!==============================================================================!
### Component Summary: ADE7878ACPZ-RL

**Key Characteristics and Specifications:**

- **Voltage Ratings:** 
  - Supply Voltage (VDD): 2.4 V to 3.7 V (typical 3.3 V)
  - Reference Voltage: 1.2 V (±8%)

- **Current Ratings:** 
  - Maximum input signal levels: ±500 mV peak for current channels.

- **Power Consumption:**
  - Normal Power Mode (PSM0): 24.4 mA to 27.2 mA
  - Reduced Power Mode (PSM1): 6.0 mA
  - Low Power Mode (PSM2): 0.2 mA
  - Sleep Mode (PSM3): 1.7 µA

- **Operating Temperature Range:** 
  - -40°C to +85°C

- **Package Type:** 
  - 40-lead Lead Frame Chip Scale Package (LFCSP), Pb-free

- **Special Features:**
  - Highly accurate energy metering with less than 0.1% error in active/reactive energy.
  - Supports 3-phase, 3- or 4-wire configurations.
  - Dedicated ADC channel for neutral current input.
  - Low power battery mode for tamper detection.
  - Flexible I2C, SPI, and HSDC serial interfaces.
  - Supports various energy measurement standards (EN 50470, IEC 62053).

- **Moisture Sensitive Level (MSL):** 
  - MSL Level 3 per JEDEC J-STD-020E.

**Description:**
The ADE7878 is a polyphase multifunction energy metering integrated circuit (IC) designed for high-accuracy measurement of electrical energy in 3-phase systems. It incorporates advanced signal processing capabilities, including the ability to measure total active, reactive, and apparent energy, as well as fundamental active and reactive energy. The device features a digital signal processor (DSP) that executes the necessary calculations for energy measurement and power quality analysis.

**Typical Applications:**
- **Energy Metering Systems:** The ADE7878 is primarily used in smart meters and energy monitoring devices for residential, commercial, and industrial applications.
- **Power Quality Monitoring:** It can be utilized to assess power quality parameters, including voltage sags, swells, and harmonics.
- **Load Management:** The device aids in monitoring and managing electrical loads in various applications, ensuring efficient energy usage.
- **Renewable Energy Systems:** It is suitable for integration into systems that monitor energy production and consumption, such as solar inverters.

This summary provides a comprehensive overview of the ADE7878ACPZ-RL, highlighting its key specifications, functionality, and applications in energy metering and power quality monitoring.