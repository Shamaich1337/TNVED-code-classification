[{'role': 'system', 'content': 'You are a technical specialist with expertise in electronics. Your task is to analyze datasheets for electronic components and provide a concise summary of the product’s key characteristics and specifications. In addition, you need to gather textual information about the component, including its description and typical applications.Instructions:    Identify the correct component in the datasheet using the provided product code.    Summarize key parameters, including:        Voltage ratings        Current ratings        Power consumption        Operating temperature range        Package type        Special features or notes (if applicable)        Moisture Sensetive Level JEDEC J-STD-020E    Provide a short description of the component, including what it is (e.g., transistor, microcontroller, sensor) and its primary function.    Explain typical applications for the component (e.g., power management, signal processing, data storage, etc.).    Be thorough and accurate: Ensure the information corresponds specifically to the product code, as some datasheets cover multiple variants.Your goal is to create a clear and accurate technical summary that includes both key specifications and a description of what the component is used for.'}, {'role': 'user', 'content': 'Give me information about the component of KSZ8873MML production of MICROCHIP TECHNOLOGY from the text:\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 1Features\n• Advanced Swit ch Features\n- IEEE 802.1q VLAN Support for Up to 16 Groups \n(Full Range of VLAN IDs)\n- VLAN ID Tag/Untag Options, Per Port Basis\n- IEEE 802.1p/q Tag Insertion or Removal on a \nPer Port Basis (Egress)\n- Programmable Rate Limiting at the Ingress and \nEgress on a Per Port Basis\n- Broadcast Storm Protection with Percent Con-\ntrol (Global and Per Port Basis)\n- IEEE 802.1d Rapid Spanning Tree Protocol \nSupport\n- Tail Tag Mode (1 byte Added before FCS) Sup-\nport at Port 3 to Inform the Processor which Ingress Port Receives the Packets\n- Bypass Feature that Automatically Sustains the \nSwitch Function between Port 1 and Port 2 when CPU (Port 3 Interface) Goes into Sleep Mode\n- Self-Address Filtering Support\n- Individual MAC Address for Port 1 and Port 2- IGMP Snooping (IPv4) Support for Multicast \nPacket Filtering\n- IPv4/IPv6 QoS Support\n- MAC Filtering Function to Forward Unknown \nUnicast Packets to Specified Port\n• Comprehensive Confi guration Register Access\n- Serial Management Interface (SMI) to All Inter-\nnal Registers\n- MII Management (MIIM) Interface to PHY Reg-\nisters\n- High Speed SPI and I\n2C Interface to All Internal \nRegisters\n- I/O Pins Strapping and EEPROM to Program \nSelective Registers in Unmanaged Switch Mode\n- Control Registers Conf igurable on the Fly (Port-\nPriority, 802.1p/d/q, AN…)\n• QoS/CoS Packet Prioritization Support\n- Per Port, 802.1p and DiffServ-Based\n- Re-Mapping of 802.1p Priority Field Per Port \nBasis, Four Priority Levels\n• Proven Integrated 3-Port  10/100 Ethernet Switch\n- 3rd Generation Switch with Three MACs and \nOne PHY Fully Compliant with IEEE 802.3u Standard\n- Non-Blocking Switch Fabric Ensures Fast \nPacket Delivery by Utilizing a 1k MAC Address Lookup Table and a Store-and-Forward Archi-tecture- Full-Duplex IEEE 802.3x Flow Control (PAUSE) \nwith Force Mode Option\n- Half-Duplex Back Pressure Flow Control- HP Auto MDI-X for Reliable Detection of and \nCorrection for Straight-Through and Crossover Cables with Disable and Enable Option\n- MAC MII Interface Supports both MAC Mode \nand PHY Mode\n-L i n k M D\n® TDR-Based Cable Diagnostics Permit \nIdentification of Faulty Copper Cabling\n- Comprehensive LED Indicator Support for Link, \nActivity, Full-/Half-Duplex, and 10/100 Speed\n- HBM ESD Rating 3 kV\n• Switch Monitoring Features\n- Port Mirroring/Monitoring/Sniffing: Ingress and/\nor Egress Traffic to Any Port or MII\n- MIB Counters for Fully Compliant Statistics \nGathering, 34 MIB Counters Per Port\n- Loopback Modes for Remote Diagnostic of Fail-\nure\n• Low Power Dissipation\n- Full-Chip Software Po wer-Down (Register Con-\nfiguration Not Saved) \n- Full-Chip Hardware Power-Down (Register \nConfiguration Not Saved)\n- Energy-Detect Mode Support\n- Dynamic Clock Tree Shutdown Feature\n- Per Port Based Softwa re Power-Save on PHY \n(Idle Link Detection, Register Configuration Pre-served)\n- Voltages: Single 3.3V Supply with Internal 1.8V \nLDO for 3.3V VDDIO\n- Optional 3.3V, 2.5V, and 1.8V for VDDIO\n- Transceiver Power 3.3V for VDDA_3.3\n• Industrial Temperature Range: –40°C to +85°C• Available in a 64-Pin LQFP, Lead-Free Package\nApplications\n• VoIP Phone\n• Set-Top/Game Box\n• Automotive Ethernet\n• Industrial Control• IPTV POF\n• SOHO Residential Gateway\n• Broadband Gateway/Firewall/VPN• Integrated DSL/Cable Modem\n• Wireless LAN Access Point + Gateway\n• Standalone 10/100 SwitchKSZ8873MML\nIntegrated 3-Port 10/100 Managed Switch\nwith PHY\nKSZ8873MML\nDS00002776A-page 2  \uf0e3 2018 Microchip Technology Inc.TO OUR VALUED CUSTOMERS\nIt is our intention to provide our valued customers with the bes t documentation possible to ensure successful use of your Micro chip\nproducts. To this end, we will continue to improve our publicat ions to better suit your needs. Our publications will be refined  and\nenhanced as new volumes and updates are introduced. \nIf you have any questions or comments regardi ng this publication, please contact the Marketing Communications Department via\nE-mail at docerrors@microchip.com . We welcome your feedback.\nMost Current Data Sheet\nTo obtain the most up-to-date version of this data s heet, please register at our Worldwide Web site at:\nhttp://www.microchip.com\nYou can determine the version of a data sheet by examining its literature number found on the bottom outside corner of any page . \nThe last character of the literature number is the vers ion number, (e.g., DS30000000A is version A of document DS30000000).\nErrata\nAn errata sheet, describing minor operational differences fr om the data sheet and recommended workarounds, may exist for cur-\nrent devices. As device/documentation issues  become known to us, we will publish an er rata sheet. The errata will specify the\nrevision of silicon and revision of document to which it applies.\nTo determine if an errata sheet exists for a particu lar device, please check with one of the following:\n• Microchip’s Worldwide Web site; http://www.microchip.com\n• Your local Microchip sales office (see last page)\nWhen contacting a sales office, please spec ify which device, revision of silicon and data sheet (include -literature number) yo u are\nusing.\nCustomer Notification System\nRegister on our web site at www.microchip.com  to receive the most current information on all of our products.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 3KSZ8873MML\nTable of Contents\n1.0 Introduction .............................................................................................................. ....................................................................... 4\n2.0 Pin Description and Configuration ......................................................................................... ......................................................... 5\n3.0 Functional Description .................................................................................................... .............................................................. 11\n4.0 Register Descriptions ..................................................................................................... ............................................................... 34\n5.0 Operational Charac teristics ............................................................................................... ............................................................ 70\n6.0 Electrical Characteristics ................................................................................................ ............................................................... 71\n7.0 Timing Specifications ..................................................................................................... ............................................................... 73\n8.0 Reset Circuit ............................................................................................................. .................................................................... 83\n9.0 Selection of Isolation Transformers ....................................................................................... ....................................................... 84\n10.0 Package Outline .......................................................................................................... ................................................................ 85\nAppendix A: Data Sheet Revision History ....................................................................................... .................................................... 87\nThe Microchip Web Site ........................................................................................................ .............................................................. 88\nCustomer Change Notification Service .......................................................................................... ..................................................... 88\nCustomer Support .............................................................................................................. ................................................................. 88\nProduct Identification System ................................................................................................. ............................................................ 89\nKSZ8873MML\nDS00002776A-page 4  \uf0e3 2018 Microchip Technology Inc.1.0 INTRODUCTION\n1.1 General Description\nThe KSZ8873MML is a highly integrated 3-port switch on a chip  IC in the industry’s smallest  footprint. It is designed to\nenable a new generation of low-port-count,  cost-sensitive, and power efficient 10/100 Mbps switch systems. Low power\nconsumption, advanced power management, and sophisticated Qo S features (e.g., IPv6 priority classification support)\nmake this device ideal for IPTV, IP-STB, Vo IP, automotive, and indu strial applications.\nThe KSZ8873MML is designed to support the GREEN requirem ent in today’s switch syst ems. Advanced power man-\nagement schemes include hardware power down, software power down, per port power down, and energy detect mode\nthat shuts downs the transceiver when a port is idle.\nKSZ8873MML also offers a bypass mode that enables syste m-level power saving. In this mode, the processor con-\nnected to the switch through the MII interface can be shut down without impac ting the normal switch operation.\nThe configuration provided by the KSZ8873MML enables the flexibility to me et requirements of different applications: \n• KSZ8873MML: One 10/100BASE-T/TX tran sceiver and two MII interfaces.\nThe device is available in a RoHS-compliant 64-pin LQFP  package. An industrial-grade temperature version is also\navailable.\nFIGURE 1-1: SYSTEM  BLOCK DIAGRAM\n1K LOOK-UP\nENGINE\nQUEUE\nMANAGEMENT\nBUFFER\nMANAGEMENT\nFRAME\nBUFFERS\nMIB\nCOUNTERS\nEEPROM\nINTERFACE\nYTIROIRP ,GNIGGAT NALV ,LORTNOC WOLF ,OFIF\n10/100\nMAC 1\n10/100\nMAC 2\n10/100\nMAC 310/100\nT/TX\nPHY 22XMII\nHP AUTO\nMDIX\n2XMII\nSPI SPI\nCONTROL\nREGISTERSMIIM\nSMI\nSTRAP IN\nCONFIGURATIONLED\nDRIVERSI2C\nP2 LED[1:0]\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 5KSZ8873MML\n2.0 PIN DESCRIPTION AND CONFIGURATION\nFIGURE 2-1: 64-PIN 10 MM X 10 MM LQFP ASSIGNMENT, (TOP VIEW)\nP1LED1\nSMRXD10SMRXDV1SMTXER1/MII_LINK_1SMTXD13SMTXD12SMTXD11SMTXD10SMTXC1VDDIOGNDVDDCOSMTXEN1P1LED0P2LED1P2LED0\nRSTN\nVDDA_1.8\nAGND\nNC\nNC\nVDDA_3.3\nAGND\nISET\nVDDA_1.8\nRXM2\nRXP2\nAGND\nTXM2\nTXP2\nNC\nPWRDNSMRXD11\nSMRXD12\nSMRXD13\nSMRXC1\nSCOL1\nSDA_MDIO\nSCL_MDC\nINTRN\nSPISN\nSPIQ\nVDDC\nGND\nSMRXC3\nSCOL3\nSCRS364\n1\n2\n3\n4\n56\n7\n8\n9\n10\n11\n12\n13\n14\n15\n1648\n47\n46\n45\n4443\n42\n41\n40\n39\n38\n37\n36\n35\n34\n336362 61 60 59 58 57 5655 54 53 52 51 50 49\n17 18 19 20 21 22 23 24 2526 27 28 29 30 31 32SMTXD33\nSMRXD30SMRXD31SMRXD32SMRXD33SMRXDV3SMTXER3/MII_LINK_3SMTXC3VDDIOGNDSMTXD30SMTXD31SMTXD32SMTXEN3X2X1SCRS1\nKSZ8873MML\nDS00002776A-page 6  \uf0e3 2018 Microchip Technology Inc.TABLE 2-1: SIGNALS\nPin \nNumberPin\nNameType\nNote\n2-1Description\n1 RSTN IPU Hardware reset pin (active low)\n2 VDDA_1.8 P 1.8V analog core power input from VDDCO (pin 59)\n3A G N D G N D Analog ground\n4N C N C Unused pin. No external connection.\n5N C N C Unused pin. No external connection.\n6 VDDA_3.3 P 3.3V analog VDD\n7A G N D G N D Analog ground.\n8 ISET OSet physical transmit output current.\nPull-down this pin with an 11.8 k Ω 1% resistor to ground.\n9 VDDA_1.8 P1.8 analog VDD input power supply from VDDCO (pin 59) through external \nFerrite bead and capacitor.\n10 RXM2 I/O Physical receive or transmit signal (– differential)\n11 RXP2 I/O Physical receive or transmit signal (+ differential)\n12 AGND GND Analog ground.13 TXM2 I/O Physical transmit or receive signal (– differential)\n14 TXP2 I/O Physical transmit or receive signal (+ differential)\n15 NC NC No Connection\n16 PWRDN IPU Chip power down input (active low).\n17 X1 I 25 MHz or 50 MHz crystal/oscillator clock connections.\nPins (X1, X2) connect to a crystal. If an oscillator is used, X1 connects to a \n3.3V tolerant oscillator and X2 is a no connect.Note: Clock is ±50 ppm for both crystal and oscillator, the clock should be \napplied to X1 pin before reset voltage goes high.18 X2 O\n19 SMTXEN3 IPU Switch MII transmit enable\n20 SMTXD33 IPU Switch MII transmit data bit 3\n21 SMTXD32 IPU Switch MII transmit data bit 222 SMTXD31 IPU Switch MII transmit data bit 1\n23 SMTXD30 IPU Switch MII transmit data bit 0\n24 GND GND Digital ground\n25 VDDIO P3.3V, 2.5V, or 1.8V digital V\nDD input power supply for IO with well decoupling \ncapacitors.\n26 SMTXC3 I/OSwitch MII transmit clock (MII modes only)\nOutput in PHY MII mode\nInput in MAC MII.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 7KSZ8873MML\n27SMTXER3/\nMII_LINK_3IPUSwitch port 3 MII tran smit error in MII mode\n0 = MII link indicator from host in MII PHY mode. \n1 = No link on port 3 MII PHY mode and enable Bypass mode.\n28 SMRXDV3 IPU/OSwitch MII receive data valid\nStrap option: MII mode selection for port 3 \nPU = PHY mode.\nPD = MAC mode (In MAC mode, port 3 MII has to connect to a powered active external PHY for the normal operation) \n29 SMRXD33 IPU/OSwitch MII receive data bit 3\nStrap option: enable auto-ne gotiation on port 2 (P2ANEN)\nPU = Enable\nPD = Disable \n30 SMRXD32 IPU/OSwitch MII receive data bit 2\nStrap option: Force the speed on port 2 (P2SPD)PU = Force port 2 to 100BT if P2ANEN = 0\nPD = Force port 2 to 10BT if P2ANEN = 0\n31 SMRXD31 IPU/OSwitch MII receive data bit 1\nStrap option: Force duplex mode (P2DPX)\nPU = Port 2 default to full-duplex m ode if P2ANEN = 1 and auto-negotiation \nfails. Force port 2 in full-duplex mode if P2ANEN = 0.\nPD = Port 2 set to half-duplex mode if  P2ANEN = 1 and auto-negotiation fails. \nForce port 2 in half-duplex mode if P2ANEN = 0.\n32 SMRXD30 IPU/OSwitch MII receive data bit 0\nStrap option: Force flow control on port 2 (P2FFC)PU = Always enable (force) port 2 flow control feature.\nPD = Port 2 flow control feature ena ble is determined by auto-negotiation \nresult.\n33 SCRS3 IPU/O Switch MII carrier sense\n34 SCOL3 IPU/O Switch MII collision detect\n35 SMRXC3 I/OSwitch MII receive clock.\nOutput in PHY MII mode\nInput in MAC MII mode\n36 GND GND Digital ground\n37 VDDC P 1.8V digital core power input from VDDCO (pin 59).\n38 SPIQ IPU/OSPI slave mode: serial data output\nNote: an external pull-up is needed on this pin when it is in use.\n39 SPISN IPUSPI slave mode: chip select (active low)\nWhen SPISN is high, the KSZ8873MML  is deselected and SPIQ is held in \nhigh impedance state.\nA high-to-low transition is used  to initiate SPI data transfer.\nNote: An external pull-up is needed on this pin when it is in use.\n40 INTRN OPUInterrupt\nActive Low signal to host CPU to indicate an interrupt status bit is set. Refer \nto register 187 and 188.TABLE 2-1: SIGNALS (CONTINUED)\nPin \nNumberPin\nNameType\nNote\n2-1Description\nKSZ8873MML\nDS00002776A-page 8  \uf0e3 2018 Microchip Technology Inc.41 SCL_MDC I/OSPI slave mode/I2C slave mode: Clock input\nI2C master mode: Clock output\nMIIM: Clock input\n42 SDA_MDIO IPU/OSPI slave mode: serial data input\nI2C master/slave mode: Serial data input/output\nMIM: Data input/out\nNote: An external pull-up is needed on this pin when it is in use.\n43 SCRS1 I/O Switch MII carrier sense\n44 SCOL1 I/O Switch MII collision detect\n45 SMRXC1 I/OSwitch MII receive clock.\nOutput in PHY MII mode\nInput in MAC MII mode\n46 SMRXD13 IPU/OSwitch MII receive data bit 3\nStrap option: MII mode selection for port 1 \nPU = PHY mode.PD = MAC mode (In MAC mode, port 1 MII has to connect to an powered \nactive external PHY for the normal operation) \n47 SMRXD12 IPU/OSwitch MII receive data bit 2\nStrap option: Force the speed on port 1 (P1SPD)\nPU = Force port 1 to 100BTPD = Force port 1 to 10BT\n48 SMRXD11 IPU/OSwitch MII receive data bit 1\nStrap option: Force duplex mode on port 1 (P1DPX)\nPU = Port 1 default to full-duplex mode.\nPD = Port 1 set to half-duplex mode.\n49 SMRXD10 IPU/OSwitch MII receive data bit 0\nStrap option: Force flow control on port 1 (P1FFC)PU = Always enable (force) port 1 flow control feature.\nPD = Disable.\n50 SMRXDV1 IPD/OSwitch MII receive data valid\nStrap option: Force the speed on port 3 (P3SPD)\nPU = Force port 3 to 10BTPD = Force port 3 to 100BT\n51SMTXER1/\nMII_LINK_1IPDSwitch port 1 MII tran smit error in MII mode\n0 = MII link indicator from host in MII PHY mode. \n1 = No link on port 1 MII PHY mode and enable Bypass mode.\n52 SMTXD13 I Switch MII transmit data bit 3\n53 SMTXD12 I Switch MII transmit data bit 254 SMTXD11 I Switch MII transmit data bit 155 SMTXD10 I Switch MII transmit data bit 0TABLE 2-1: SIGNALS (CONTINUED)\nPin \nNumberPin\nNameType\nNote\n2-1Description\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 9KSZ8873MML\n56 SMTXC1 I/OSwitch MII transmit clock (MII modes only)\nOutput in PHY MII mode\nInput in MAC MII.\n57 VDDIO P3.3V, 2.5V, or 1.8V digital VDD input power supply for IO with well decoupling \ncapacitors.\n58 GND GND Digital ground\n59 VDDCO P1.8V core power voltage output (inter nal 1.8V LDO regulator output), this \n1.8V output pin provides power to  both VDDA_1.8 and VDDC input pins. \nNote: Internally 1.8V LDO regulator i nput comes from VDDIO. Do not connect \nan external power supply to VDDCO pin. The ferrite bead is requested \nbetween analog and digital 1.8V core power.\n60 SMTXEN1 I Switch MII transmit enable\n61 P1LED1 IPU/OPort 1 LED Indicators: (Not used)\nStrap option: Port 3 flow control selection(P3FFC)\nPU = Always enable (force) port 3 flow control featurePD = Disable \n62 P1LED0 IPD/OPort 1 LED Indicators: (Not used)\nStrap option: Port 3 duplex mode selection(P3DPX)\nPU = Port 3 set to half-duplex mode \nPD = Port 3 set to full-duplex mode (default)\n63 P2LED1 IPU/OPort 2 LED Indicators:\nDefault: Speed (refer to register 195 bit[5:4])Strap option:  Serial bus configuration\nPort 2 LED Indicators:\nDefault: Link/Act. (refer to register 195 bit[5:4])Strap option:  Serial bus configuration\nSerial bus configuration pins to sele ct mode of access to KSZ8873MML inter-\nnal registers.[P2LED1, P2LED0] = [0, 0] — I\n2C master (EEPROM) mode\n(If EEPROM is not detected, the KS Z8873MML will be c onfigured with the \ndefault values of its internal register s and the values of its strap-in pins.)\nInterface Signals Type Description\nSPIQ O Not used (tri-stated)\nSCL O I2C clock\nSDA I/O I2C data I/O\nSPIS_N I Not usedTABLE 2-1: SIGNALS (CONTINUED)\nPin \nNumberPin\nNameType\nNote\n2-1Description\nKSZ8873MML\nDS00002776A-page 10  \uf0e3 2018 Microchip Technology Inc.Note 2-1 P = power supply\nGND = groundI = input\nO = output\nI/O = bi-directionalIpu/O = Input with internal pull-up during reset; output pin otherwise.\nIpu = Input with internal pull-up.\nIpd = Input with internal pull-down.Opu = Output with internal pull-up.\nOpd = Output with internal pull-down.\nSpeed: Low (100BASE-TX), High (10BASE-T)Full-Duplex: Low (full-duplex), High (half-duplex)\nActivity: Toggle (transmit/receive activity)\nLink: Low (link), High (no link)64 P2LED0 IPU/O[P2LED1, P2LED0] = [0, 1] — I2C slave mode\nThe external I2C master will drive the SCL clock. \nThe KSZ8873MML device addresses are:\n1011_1111    <r ead>\n1011_1110    <write>\nInterface Signals Type Description\nSPIQ O Not used (tri-stated)\nSCL I I2C clock\nSDA I/O I2C data I/O\nSPIS_N I Not used\n[P2LED1, P2LED0] = [1, 0] — SPI slave modeInterface Signals Type Description\nSPIQ O SPI data out\nSCL I SPI clockSDA I SPI data in\nSPIS_N I SPI chip select\n[P2LED1, P2LED0] = [1, 1] – SMI/MIIM-mode\nIn SMI mode, the KSZ8873MML provides a ccess to all its internal 8-bit regis-\nters through its SCL_MDC and SDA_MDIO pins.\nIn MIIM mode, the KSZ8873MML provides  access to its 16-bit MIIM registers \nthrough its SDC_MDC and SDA_MDIO pins.TABLE 2-1: SIGNALS (CONTINUED)\nPin \nNumberPin\nNameType\nNote\n2-1Description\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 11KSZ8873MML\n3.0 FUNCTIONAL DESCRIPTION\nThe KSZ8873MML contains one 10/100 physical layer tran sceivers and three MAC units with an integrated Layer 2\nmanaged switch. \nThe KSZ8873MML has the flexibility to reside in either a managed or unmanaged design. In a managed design, the\nhost processor has complete control of the KSZ8873MML via the SMI interface, MIIM interface, SPI bus, or I2C bus. An\nunmanaged design is achieved throu gh I/O strapping and/or EEPROM pr ogramming at system reset time.\nOn the media side, the KSZ8873MML supports IEEE 802. 3 10BASE-T and 100BASE-TX on both PHY ports. Physical\nsignal transmission and reception are enhanced through the use of patented analog circui tries that make the design\nmore efficient and allow for lower power consumption and smaller chip die size.\n3.1 Physical Layer Transceiver\n3.1.1 100BASE-TX TRANSMIT\nThe 100BASE-TX transmit functi on performs parallel-to-serial  conversion, 4B/5B coding, scrambling, NRZ -to-NRZI con-\nversion, and MLT3 encoding and transmission. \nThe circuitry starts with a parallel-to-ser ial conversion, which converts the MII data from the MAC into a 125 MHz serial\nbit stream. The data and control stream is then converted into 4B/5B coding, followed by a scrambler. The serialized\ndata is further converted from NRZ-to-NR ZI format, and then transmitted in ML T3 current output. The output current is\nset by an external 1% 11.8 k Ω resistor for the 1:1 transformer ratio.\nThe output signal has a typical rise/fall time of 4 ns and complies with the ANSI TP-P MD standard regarding amplitude\nbalance, overshoot, and timing jitter. The wave-shaped 10 BASE-T output is also incorporated into the 100BASE-TX\ntransmitter.\n3.1.2 100BASE-TX RECEIVE\nThe 100BASE-TX receiver func tion performs adaptive equ alization, DC restoration, MLT3 -to-NRZI conversion, data and\nclock recovery, NRZI-to-NRZ conversi on, de-scrambling, 4B/5B decoding, and serial-to-parallel conversion. \nThe receiving side starts with the equaliz ation filter to compensate for inter-symbol  interference (ISI) over the twisted\npair cable. Because the amplitude loss and phase distortion is  a function of the cable length, the equalizer must adjust\nits characteristics to optimize performance.  In this design, the variable equalizer makes an initial estimation based on\ncomparisons of incoming signal strength against some known cable characteristics, and th en tunes itself for optimiza-\ntion. This is an ongoing process and self-adjusts against  environmental changes such as temperature variations.\nNext, the equalized signal goes through a DC restoration and da ta conversion block. The DC restoration circuit is used\nto compensate for the effect of baseline wander and to im prove the dynamic range. The differential data conversion\ncircuit converts the MLT3 format back to NR ZI. The slicing threshold is also adaptive.\nThe clock recovery circuit extracts the 125 MHz clock from the edges of the NRZI signal. This recovered clock is then\nused to convert the NRZI signal into the NRZ format. This si gnal is sent through the de-scrambler followed by the 4B/\n5B decoder. Finally, the NRZ serial data is converted to the MII format and provided as the input data to the MAC.\n3.1.3 PLL CLOCK SYNTHESIZER\nThe KSZ8873MML generat es 125 MHz, 62.5 MHz, and 31.25 MHz clocks fo r system timing. Internal clocks are gener-\nated from an external 25 MHz or 50 MHz crystal or oscillator.\n3.1.4 SCRAMBLER/DE-SCRAMBLER (100BASE-TX ONLY)\nThe purpose of the scrambler is to spr ead the power spectrum of the signal to reduce electromagnetic interference (EMI)\nand baseline wander. Transmitted data is scrambled throug h the use of an 11-bit wide linear feedback shift register\n(LFSR). The scrambler generates a 2047-bit non-repetitive s equence, and the receiver then  de-scrambles the incoming\ndata stream using the same sequence as at the transmitter.\n3.1.5 10BASE-T TRANSMIT\nThe 10BASE-T driver is incorporated with the 100BASE-TX dr iver to allow for transmission using the same magnetics.\nThey are internally wave-shaped and pre-emphasized into out puts with a typical 2.3V amp litude. The harmonic contents\nare at least 27 dB below the fundamental frequency when driven by an all-ones Manchester-encoded signal.\nKSZ8873MML\nDS00002776A-page 12  \uf0e3 2018 Microchip Technology Inc.3.1.6 10BASE-T RECEIVE\nOn the receive side, input buffers and level detecting squelch circuits are employed. A differential input receiver circuit\nand a phase-locked loop (PLL) perform the decoding functi on. The Manchester-encoded dat a stream is separated into\nclock signal and NRZ data. A squelch circuit rejects signa ls with levels less than 400 mV or with short pulse widths to\nprevent noise at the RXP or RXM input from falsely trigger ing the decoder. When the input exceeds the squelch limit,\nthe PLL locks onto the incoming  signal and the KSZ8873MML decodes a data frame. The receiver clock is maintained\nactive during idle periods in between data reception.\n3.1.7 MDI/MDI-X AUTO CROSSOVER\nTo eliminate the need for crossover cables between simi lar devices, the KSZ8873MML supports HP Auto MDI/MDI-X\nand IEEE 802.3u standard MDI/MDI-X auto crosso ver. HP Auto MDI/MDI-X is the default.\nThe auto-sense function detects remote transmit and receiv e pairs and correctly assigns transmit and receive pairs for\nthe KSZ8873MML device. This feature is extremely useful when end users are unaware of cable types and also saves\non an additional uplink configuration connection. The auto-cross over feature can be disabl ed through the port control\nregisters or MIIM PHY registers.\nThe IEEE 802.3u standard MDI and MDI- X definitions are illustrated in Table 3-1 .\n3.1.7.1 Straight Cable\nA straight cable connects an MDI device to an MD I-X device, or an MDI-X de vice to an MDI device. Figure 3-1  depicts\na typical straight cable connection between a NIC card (MDI) and a switch or hub (MDI-X).TABLE 3-1: MDI/MDI-X PIN DEFINITIONS\nMDI MDI-X\nRJ-45 Pins Signals RJ-45 Pins Signals\n1 TD+ 1 RD+\n2T D –2R D –\n3 RD+ 3 TD+6 RD– 6 TD–\nFIGURE 3-1: TYPICAL STRAIGHT CABLE CONNECTION\nReceive Pair Transmit Pair\nReceive Pair1\n2\n3\n4\n5\n6\n7\n81\n2\n3\n4\n5\n6\n7\n8Transmit Pair\nModular Connector\n(RJ-45)\nNICStraight\nCable10/100 Ethernet\nMedia Dependent Interface10/100 Ethernet\nMedia Dependent Interface\nModular Connector\n(RJ-45)\nHUB\n(Repeater or Switch)\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 13KSZ8873MML\n3.1.7.2 Crossover Cable\nA crossover cable connects an MDI device to another MD I device, or an MDI-X device to another MDI-X device.\nFigure 3-2  shows a typical crossover cable connection between two switches or hubs (two MDI-X devices).\nFIGURE 3-2: TYPICAL CROSSOVER CABLE CONNECTION\n \nReceive Pair Receive Pair\nTransmit Pair1\n2\n3\n4\n5\n6\n7\n81\n2\n3\n4\n5\n6\n7\n8Transmit Pair10/100 Ethernet\nMedia Dependent Interface10/100 Ethernet\nMedia Dependent Interface\nModular Connector (RJ-45)\nHUB\n(Repeater or Switch)Modular Connector (RJ-45)\nHUB\n(Repeater or Switch)Crossover\nCable\nKSZ8873MML\nDS00002776A-page 14  \uf0e3 2018 Microchip Technology Inc.3.1.8 AUTO-NEGOTIATION\nThe KSZ8873MML conforms to the auto -negotiation protocol, defined in Claus e 28 of the IEEE 802.3u specification.\nAuto-negotiation allows unshielded twisted pair (UTP) link partners to select the best common mode of operation. In\nauto-negotiation, link partners advertise their capabilities across the link to each other. If auto-negotiation is not sup-\nported or the KSZ8873MML link partner is forced to bypass auto-negotiation, the KSZ8873MML sets its operating mode\nby observing the signal at its receiver. This is known as parallel detection, and allows the KSZ8873MML to establish link\nby listening for a fixed signal protocol in the abs ence of auto-negotiation advertisement protocol.\nThe link up process is shown in Figure 3-3 .\nFIGURE 3-3: AUTO-NEGOTIATIO N AND PARALLEL OPERATION\n3.1.9 LINKMD® CABLE DIAGNOSTICS\nPort 2 of KSZ8873MML supports LinkMD®. The LinkMD® feature utilizes time domain reflectometry (TDR) to analyze\nthe cabling plant for common cabling problems such as  open circuits, short circuits, and impedance mismatches.\nLinkMD® works by sending a pulse of known amplitude and dura tion down the MDI and MDI-X pairs and then analyzes\nthe shape of the reflected signal. Timing the pulse duration give s an indication of the distance  to the cabling fault. Inter-\nnal circuitry displays the TDR information in a user-readable digital format.START AUTO-NEGOTIATION\nFORCE LINK SETTING\nLISTEN FOR 10BASE-T \nLINK PULSESLISTEN FOR 100BASE-TX\nIDLESATTEMPT AUTO-\nNEGOTIATION\nLINK MODE SETBYPASS AUTO- NEGOTIATION\nAND SET LINK MODE\nLINK MODE SET?PARALLEL\nOPERATION NO\nYES\nYESNO\nJOIN FLOW\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 15KSZ8873MML\n3.1.9.1 Access\nLinkMD® is initiated by accessing registers {42, 43}, the LinkMD® Control/Status registers for port 2, and in conjunction\nwith registers 45, Port Control Register 13.\nAlternatively, the MIIM PHY registers 0 and 29 can be used for LinkMD® access.\n3.1.9.2 Usage\nThe following is a sample procedure for usin g LinkMD with registers {42,43,45} on port 2.\n1. Disable auto MDI/MDI-X by writing a ‘1’ to register 45,  bit [2] to enable manual control over the differential pair\nused to transmit the LinkMD pulse.\n2. Start cable diagnostic test by writing a ‘1’ to regi ster 42, bit [4]. This enable bit is self-clearing.\n3. Wait (poll) for register 42, bit [4] to return a ‘0’, indicating cable diagnostic test is complete.\n4. Read cable diagnostic test results in register  42, bits [6:5]. The results are as follows:\n00 = normal condition (valid test)01 = open condition detected in cable (valid test)10 = short condition detected in cable (valid test)11 = cable diagnostic test failed (invalid test)\nThe ‘11’ case, invalid test, occurs when the KSZ8873MML is unable to shut down the link partner. In this instance, the\ntest is not run, because it would be impossible for the KSZ887 3MML to determine if the detected signal is a reflection\nof the signal generated or a signal from another source.\n5. Get distance to fault by concatenating re gister 42, bit [0] and register 43, bits  [7:0]; and multiplying the result by\na constant of 0.4. T he distance to the cable fault can be determined by the following formula:\nEQUATION 3-1:\nConcatenated values of registers 42 and 43 are converted to decimal before multiplying by 0.4.\nThe constant (0.4) may be calibrated for different cabling co nditions, including cables with a velocity of propagation that\nvaries significantly from the norm.\n3.2 Power Management\nThe KSZ8873MML supports enhanced power management featur e in low power state with energy detection to ensure\nlow-power dissipation during device idle periods. There are five operation modes under the power management function\nwhich is controlled by two bits in Register 195 (0xC3) and one bit in Register 29 (0x1D), 45(0x2D) as shown below:\nRegister 195 bit[1:0] = 00 Normal Operation ModeRegister 195 bit[1:0] = 01 Energy Detect ModeRegister 195 bit[1:0] = 10 Soft Power Down ModeRegister 195 bit[1:0] = 11 Power Saving ModeRegister 29, 45 bit 3 = 1 Port Based Power Down ModeTable 3-2  indicates all internal function blocks status under  four different power ma nagement operation modes.DD i s c e tan· to cable fault in meters \uf028\uf029 0.4 Register  26 bit [0] Register  27 bits [7:0] \uf0b4 \uf028\uf029\uf0b4 =\nKSZ8873MML\nDS00002776A-page 16  \uf0e3 2018 Microchip Technology Inc.3.2.1 NORMAL OPERATION MODE\nThis is the default setting bit[1:0] = 00 in register 195 after the chip power-up or hardware reset. When KSZ8873MML\nis in this normal operation mode, all PLL clocks are running, PHY and MAC are on, and the host interface is ready for\nCPU read or write. \nDuring the normal operation mode, the host CPU can set the bit[1:0] in register 195 to transit the current normal oper-\nation mode to any one of the other three power management operation modes.\n3.2.2 POWER SAVING MODE\nThe power saving mode is entered when auto-negotiation mode is  enabled, cable is disconnected, and by setting bit[1:0]\n= 11 in register 195. When KSZ 8873MML is in this mode, all PLL clocks are enabled, MAC is  on, all internal registers\nvalue will not change, and host interface is ready for CPU read or  write. In this mode, it ma inly controls the PHY trans-\nceiver on or off based on line status to achieve power sa ving. The PHY remains transmitting and only turns off the\nunused receiver block. Once activity resumes due to plugging a cable or attempting by the fa r end to establish link, the\nKSZ8873MML can automatically enabled the PHY power up to normal power state from power saving mode.\nDuring this power saving mode, the host CPU can set bit[1:0]  = 0 in register 195 to transit the current power saving mode\nto any one of the other three power management operation modes.\n3.2.3 ENERGY DETECT MODE\nThe energy detect mode provides a mechanism to save more power than in the normal operation mode when the\nKSZ8873MML is not connected to an active link partner. In this  mode, the device will save up to 87% of the power. If\nthe cable is not plugged, the KSZ8873MML c an automatically enter to a low power state, a.k.a., the energy detect mode.\nIn this mode, KSZ8873MML will keep transm itting 120 ns width pulses at a rate of one pulse per second. Once activity\nresumes due to plugging a cable or attempting by the far end to establish link, the KSZ8873MML can automatically\npower up to normal power state in energy detect mode.\nEnergy detect mode consists of two states, normal power st ate and low power state. Whil e in low power state, the\nKSZ8873MML reduces power consumption by disabling all circui try except the energy detect circuitry of the receiver.\nThe energy detect mode is entered by se tting bit[1:0] = 01 in register 195. When the KSZ8873MML is in this mode, it\nwill monitor the cable energy. If there is no energy on the cable for a time longer than pre-configured value at bit[7:0]\nGo-Sleep time in register 196, KSZ8873MML will go into a low power state. When KSZ8873MML is in low power state,\nit will keep monitoring the cable energy. Once the energy  is detected from the cable,  KSZ8873MML will enter normal\npower state. When KSZ8873MML is at norm al power state, it is able to tran smit or receive pa cket from the cable.\nIt will save about 87% of the power when MII interfac e is in PHY mode, pin SMTXER3/MII_LINK_3 or SMTXER1/\nMII_LINK_1 is connected to High, register 195 bit [1:0 ] = 01, bit 2 = 1(Disable PLL), not cables are connected.\n3.2.4 SOFT POWER DOWN MODE\nThe soft power down mode is entered by setting bit[1:0] = 10 in register 195. When KSZ8873MML is in this mode, all\nPLL clocks are disabled, the PHY and the MAC are off, all internal registers value will not change. When the host set\nbit[1:0] = 00 in register 195, this device will be back from  current soft power down mode to normal operation mode.\n3.2.5 PORT-BASED POWER DOWN MODE\nIn addition, the KSZ8873MML features a per-port power down mode. To save power, a PHY port that is not in use can\nbe powered down via port control regist er 45 bit 3, or MIIM PHY register. It will saves about 15 mA per port.TABLE 3-2: INTERNAL FUNCTION BLOCK STATUS\nKSZ8873MML Function \nBlocksPower Management Operation Modes\nNormal ModePower Saving \nModeEnergy Detect \nModeSoft Power Down \nMode\nInternal PLL Clock Enabled Enabled Disabled Disabled\nTx/Rx PHY EnabledRx unused block \ndisabledEnergy detect at Rx Disabled\nMAC Enabled Enabled Disabled Disabled\nHost Interface Enabled Enabled Disabled Disabled\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 17KSZ8873MML\n3.2.6 HARDWARE POWER DOWN\nKSZ8873 supports a hardware power down mode. When the pin PWRDN is active-low, the entire chip is powered down.\n3.3 MAC and Switch\n3.3.1 ADDRESS LOOKUP\nThe internal lookup table stores MAC addresses and their a ssociated information. It contains a 1K unicast address table\nplus switching information. \nThe KSZ8873MML is guaranteed to learn 1K addresses and di stinguishes itself from hash-based lookup tables, which\ndepending on the operating environment and probabilities, may not guarantee the absolute nu mber of addresses it can\nlearn.\n3.3.2 LEARNING\nThe internal lookup engine updates its table with a new entry if the following conditions are met: \n• The received packet\'s source address (SA) does not exist in the lookup table.\n• The received packet is good; the packet has no receiving errors, and is of legal length.\nThe lookup engine inserts the qualified SA into the table, al ong with the port number and time stamp. If the table is full,\nthe last entry of the table is deleted to make room for the new entry.\n3.3.3 MIGRATION\nThe internal lookup engine also monitors whether a station has moved. If a station has moved, it will update the table\naccordingly. Migration happens when the following conditions are met:\n• The received packet’s SA is in the table, but th e associated source port information is different.\n• The received packet is good; the packet has no receiving errors, and is of legal length.\nThe lookup engine will update the existing record in the table with the new source port information.\n3.3.4 AGING\nThe lookup engine updates the time stamp information of a record whenever the corresponding SA appears. The time\nstamp is used in the aging process. If a record is not updat ed for a period of time, the lookup engine removes the record\nfrom the table. The lookup engine co nstantly performs the aging process and will continuously remove aging records.\nThe aging period is about 200 seconds. This feature can be enabled or disabled through register 3 (0x03) bit [2].\n3.3.5 FORWARDING\nThe KSZ8873MML forwards packets using the algorith m that is depicted in the following flowcharts. Figure 3-4  shows\nstage one of the forwarding algorithm w here the search engine looks up the VLAN ID, static table, and dynamic table\nfor the destination address, and comes up with “port to forwar d 1” (PTF1). PTF1 is then further modified by spanning\ntree, IGMP snooping, port  mirroring, and port VLAN processes to come up  with “port to forward 2” (PTF2), as shown in\nFigure 3-5 . The packet is sent to PTF2.\nKSZ8873MML\nDS00002776A-page 18  \uf0e3 2018 Microchip Technology Inc.FIGURE 3-4: DESTINATION ADDR ESS LOOKUP FLOW CHART, STAGE 1\n \nStart\nVLAN ID\nValid?PTF1= NULL\nSearch Static\nTableSearch complete.\nGet PTF1 from\nStatic MAC Table\nDynamic Table\nSearch\nSearch complete.\nGet PTF1 from\nVLAN TableSearch complete.\nGet PTF1 from\nDynamic MAC\nTable\nPTF1- Search VLAN table\n- Ingress VLAN filtering\n- Discard NPVID check\nYESNO\nFOUND\nNOT\nFOUND\nFOUND\nNOT\nFOUNDThis search is based on\nDA or DA+FID\nThis search is based on\nDA+FID\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 19KSZ8873MML\nThe KSZ8873MML will not forward the following packets:\n1. Error packets: These include framing errors, Frame Chec k Sequence (FCS) errors, alignment errors, and illegal\nsize packet errors.\n2. IEEE802.3x PAUSE frames: KSZ8873MM L intercepts these packets and per forms full-duplex flow control\naccordingly.\n3. "Local" packets: Based on destination address (DA) look up. If the destination port from the lookup table matches\nthe port from which the packet origin ated, the packet is defined as local.\n3.3.6 SWITCHING ENGINE\nThe KSZ8873MML features a high-performance switching engi ne to move data to and from the MAC’s packet buffers.\nIt operates in store and forward mode, while the effi cient switching mechanism reduces overall latency. \nThe switching engine has a 32 kB internal frame buffer. This  buffer pool is shared between all three ports. There are a\ntotal of 256 buffers available. Each buffer is sized at 128 bytes.\n3.3.7 MAC OPERATION\nThe KSZ8873MML strictly abi des by IEEE 802.3 standards to maximize compatibility.\n3.3.7.1 Inter Packet Gap (IPG)\nIf a frame is successfully transmitted, the 96 bits time  IPG is measured between the two consecutive MTXEN. If the\ncurrent packet is experiencing collision, the 96 bits  time IPG is measured from MCRS and the next MTXEN.\n3.3.7.2 Back-Off Algorithm\nThe KSZ8873MML implements the IEEE 802.3 standard for the binary exponential back- off algorithm, and optional\n"aggressive mode" back-off. After 16 collisions, the packet is  optionally dropped depending on  the switch configuration\nfor register 4 (0x04) bit [3].FIGURE 3-5: DESTINATION ADDRESS R ESOLUTION FLOW CHART, STAGE 2\n \nSpanning Tree\nProcessPTF1\nIGMP Process\nPort Mirror\nProcess\nPort VLAN\nMembership\nCheck\nPTF2- Check receiving port\'s receive enable bit\n- Check destination port\'s transmit enable bit\n- Check whether packets are special (BPDU\n   or specified)\n- RX Mirror\n- TX Mirror- RX or TX Mirror- RX and TX Mirror- Applied to MAC #1 and MAC #2\n- MAC #3 is reserved for\n   microprocessor\n- IGMP will be forwarded to port 3\nKSZ8873MML\nDS00002776A-page 20  \uf0e3 2018 Microchip Technology Inc.3.3.7.3 Late Collision\nIf a transmit packet experiences collisions after 512 bit times of the transmission, the packet is dropped.\n3.3.7.4 Illegal Frames\nThe KSZ8873MML discards frames less than 64 bytes and ca n be programmed to accept frames up to1518 bytes, 1536\nbytes, or 1916 bytes. These maximum frame size settin gs are programmed in register 4 (0x04). Because the\nKSZ8873MML supports VLAN tags, the maximum si zing is adjusted when these tags are present.\n3.3.7.5 Full-Duplex Flow Control\nThe KSZ8873MML supports standard IEEE 802.3x flow control frames on both transmit and receive sides.\nOn the receive side, if the KSZ8873MML  receives a pause control frame, the KSZ8873MML will not transmit the next\nnormal frame until the timer, specified in the pause control fr ame, expires. If another pause frame is received before the\ncurrent timer expires, the timer will be updated with the new value in the second pause frame. During this period (while\nit is flow controlled), only flow control packets from the KSZ8873MML are transmitted.\nOn the transmit side, the KSZ8873MML has intelligent and effici ent ways to determine when to invoke flow control. The\nflow control is based on availability of  the system resources, including availa ble buffers, available transmit queues, and\navailable receive queues.\nThe KSZ8873MML will flow control a port that has just rece ived a packet if the destination port resource is busy. The\nKSZ8873MML issues a flow co ntrol frame (XOFF), containi ng the maximum pause time defined by t he IEEE 802.3x\nstandard. Once the resource is freed up, the KSZ8873MML sends out the other flow control frame (XON) with zero\npause time to turn off the flow control (turn on transmission to  the port). A hysteresis featur e is provided to prevent the\nflow control mechanism from being c onstantly activated and deactivated. \nThe KSZ8873MML flow controls all ports if the receive queue becomes full.\n3.3.7.6 Half-Duplex Backpressure\nA half-duplex backpressure option (not in  IEEE 802.3 standards) is also provided. The activation and deactivation con-\nditions are the same as full-duplex flow control. If backp ressure is required, the KSZ8873MML sends preambles to defer\nthe other stations\' transmission  (carrier sense deference).\nTo avoid jabber and excessive deference (as defined in the 802.3 standard), after a ce rtain time, the KSZ8873MML dis-\ncontinues the carrier sense and then raises  it again quickly. This short silent time  (no carrier sense) prevents other sta-\ntions from sending out packets t hus keeping other stations in a carrier sens e deferred state. If the port has packets to\nsend during a backpressure situation, the carrier sense ty pe backpressure is interrupted and those packets are trans-\nmitted instead. If there are no additional packets to send , carrier sense type backpressure is reactivated again until\nswitch resources free up. If a collision occurs, the binary exponential back-off algorithm is skipped and carrier sense is\ngenerated immediately, thus redu cing the chance of further collisions and carri er sense is maintained to prevent packet\nreception.\nTo ensure no packet loss in 10BASE-T or 100BASE-TX half -duplex modes, the user must enable the following:\n• Aggressive back-off (register 3 (0x03), bit [0])\n• No excessive collision drop (register 4 (0x04), bit [3])\nNote that these bits are not set as defaults because this is not the IEEE standard.\n3.3.7.7 Broadcast Storm Protection\nThe KSZ8873MML has an intelligent option to protect the swit ch system from receiving too many broadcast packets.\nAs the broadcast packets are forwarded to all ports except the source port, an excessive number of switch resources\n(bandwidth and available space in transmit queues) ma y be utilized. The KSZ8873MML has the option to include “mul-\nticast packets” for storm co ntrol. The broadcast storm rate paramete rs are programmed globally, and can be enabled\nor disabled on a per port basis. The rate is based on a 67 ms interval for 100BT and a 500 ms interval for 10BT. At the\nbeginning of each interval, the counter is cleared to zero, an d the rate limit mechanism st arts to count the number of\nbytes during the interval. The rate definition is described in register 6 (0x06) and 7 (0x07). The default setting is 0x63\n(99 decimal). This is equal to a rate of 1%, calculated as follows:\n148,800 frames/sec × 67 ms/interval × 1% = 99 frames/interval (approx.) = 0x63\nNote: 148,800 frames/sec is based on 64-byte block of packets in 100BASE-TX  with 12 bytes of IPG and 8 bytes of\npreamble between two packets.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 21KSZ8873MML\n3.3.7.8 Port Individual MAC Address and Source Port Filtering\nThe KSZ8873MML provide individual MAC address for port 1 and  port 2 respectively. They can be set at register 142-\n147 and 148-153. The packet will be filtered  if its source address matches the MAC address of port 1 or port 2 when the\nregister 21 and 37 bit 6 is set to 1 res pectively. For example, the packet will be dropped after it completes the loop of a\nring network.\nNote that for KSZ8873MML, port 1 means port 1’s MII and an external PHY here.\n3.3.8 MII INTERFACE OPERATION\nThe Media Independent Interface (MII) is  specified in Clause 22 of the IEEE 80 2.3u Standard. It provides a common\ninterface between physical layer and MAC layer devices. The MII provided by the KSZ8873MML is connected to\ndevice’s first MAC as port 1 MII and third MAC as port 3 MII. The interface contains two distinct groups of signals: one\nfor transmission and the other for reception. Table 3-3  describes the signals used by the MII bus.\nThe MII operates in either PHY mode or  MAC mode. The data interface is a nibbl e wide and runs at ¼ the network bit\nrate (not encoded). Additional signals on the transmit side indicate when data is valid or when an error occurs during\ntransmission. Similarly, the receive side has signals that co nvey when the data is valid and without physical layer errors.\nFor half duplex operation, the SCOL si gnal indicates if a collision has occurred during transmission. The selection of the\nPHY mode and MAC mode for port3 MII is by the strap pin SMRXDV3 and the port register 53 bit 7. The selection of\nthe PHY mode and MAC mode for port1 MII is by the strap pin SMRXD13 and the port register 21bit 7.\nThe KSZ8873MML does not provide the MRXER signal for PH Y mode operation and the MTXER signal for MAC mode\noperation. Normally, MRXER indicates a re ceive error coming from the physical layer device and MTXER indicates a\ntransmit error from the MAC device. Sinc e the switch filters error frames, these MII error signals are not used by the\nKSZ8873MML. So, for PHY mode operation, if the device  interfacing with the KSZ8873MML has an MRXER input pin,\nit needs to be tied low. And, for MAC mode operation, if  the device interfacing with the KSZ8873MML has an MTXER\ninput pin, it also needs to be tied low.\nThe KSZ8873MML provides a bypass feat ure in the MII PHY mode. Pin SMTXER3/ MII_LINK is used for MII link status.\nIf the host is power down, pin MII_LINK will go to high. In this case, no new ingress frames from port1 or port 2 will be\nsent out through port 3, and the frames for por t 3 already in packet memory will be flushed out.TABLE 3-3: MII SIGNALS\nPHY Mode Connections\nPin DescriptionMAC Mode Connections\nExternal MAC\nController SignalsKSZ8873MML \nPort 1,3\nPHY SignalsExternal PHY \nSignalsKSZ8873MML \nPort 1,3\nMAC Signals\nMTXEN SMTXEN Transmit Enable MTXEN SMRXDV\nMTXER SMTXER Transmit Error MTXER (NOT USED)\nMTXD3 SMTXD3 Transmit Data Bit 3 MTXD3 SMRXD3\nMTXD2 SMTXD2 Transmit Data Bit 2 MTXD2 SMRXD2MTXD1 SMTXD1 Transmit Data Bit 1 MTXD1 SMRXD1\nMTXD0 SMTXD0 Transmit Data Bit 0 MTXD0 SMRXD0\nMTXC SMTXC Transmit Clock MTXC SMRXC\nMCOL SCOL Collision Detection MCOL SCOL\nMCRS SCRS Carrier Sense MCRS SCRS\nMRXDV SMRXDV Receive Data Valid MRXDV SMTXENMRXER (NOT USED) Receive Error MRXER SMTXER\nMRXD3 SMRXD3 Receive Data Bit 3 MRXD3 SMTXD3\nMRXD2 SMRXD2 Receive Data Bit 2 MRXD2 SMTXD2MRXD1 SMRXD1 Receive Data Bit 1 MRXD1 SMTXD1\nMRXD0 SMRXD0 Receive Data Bit 0 MRXD0 SMTXD0\nMRXC SMRXC Receive Clock MRXC SMTXC\nKSZ8873MML\nDS00002776A-page 22  \uf0e3 2018 Microchip Technology Inc.3.3.9 MII MANAGEMENT (MIIM) INTERFACE\nThe KSZ8873MML supports the IEEE 802.3 MII Management In terface, also known as the Management Data Input/\nOutput (MDIO) Interface. This interface allows upper-lay er devices to monitor and control the states of the\nKSZ8873MML. An external device with MDC/MDIO capability is used to read the PHY status or configure the PHY set-\ntings. Further detail on the MIIM interface is found in Clause 22.2.4.5 of the IEEE 802.3u Specif ication and refer to 802.3\nsection 22.3.4 for the timing.\nThe MIIM interface consists of the following:• A physical connection that incorporates the da ta line (SDA_MDIO) and the clock line (SCL_MDC).\n• A specific protocol that operates across the aforementi oned physical connection that allows an external controller \nto communicate with the KSZ8873MML device.\n• Access to a set of eight 16-bit register s, consisting of six standard MIIM regi sters [0:5] and two custom MIIM regis-\nters [29, 31].\nThe MIIM Interface can operate up to a maximum clock speed of 5 MHz.Table 3-4  depicts the MII Management Interface frame format.\n3.3.10 SERIAL MANAGEMENT INTERFACE (SMI)\nThe SMI is the KSZ8873MML non-standard MIIM interface th at provides access to all KSZ8873MML configuration reg-\nisters. This interface allows an extern al device to completely monitor and control the states of the KSZ8873MML.\nThe SMI interface consists of the following:• A physical connection that incorporates the da ta line (SDA_MDIO) and the clock line (SCL_MDC).\n• A specific protocol that operates across the aforementi oned physical connection that allows an external controller \nto communicate with the KSZ8873MML device.\n• Access to all KSZ8873MML configuration registers. Regi ster access includes the Global, Port, and Advanced \nControl Registers 0-198 (0x00 – 0xC6), and indirect access to the standard MIIM regist ers [0:5] and custom MIIM \nregisters [29, 31].\nTable 3-5  depicts the SMI frame format.\nSMI register read access is selected when OP Code is set to “00” and bit 4 of the PHY addre ss is set to ‘1’. SMI register\nwrite access is selected when OP Code is set to “00” and bi t 4 of the PHY address is set to ‘0’. PHY address bit[3] is\nundefined for SMI register access, and hence can be se t to either ‘0’ or ‘1’ in read/write operations.\nTo access the KSZ8873MML registers 0-196 (0x00 – 0xC6), the following applies:• PHYAD[2:0] and REGAD[4:0] are concat enated to form the 8-bit address; t hat is, {PHYAD[2:0], REGAD[4:0]} = \nbits [7:0] of the 8-bit address.\n• TA bits [1:0] are ‘Z0’ means the processor MDIO pin is  changed to input Hi-Z from output mode and the followed \n‘0’ is the read response from device.\n• TA bits [1:0] are set to ‘10’ when write registers.\n• Registers are 8 data bits wide.\n- For read operation, data bits [15:8] are read back as 0’s. \n- For write operation, data bits [1 5:8] are not defined, and hence can be set to either ‘0’ or ‘1’.TABLE 3-4: MII MANAG EMENT FRAME FORMAT\nPreambleStart of \nFrameRead/\nWrite OP \nCodePHY \nAddress \nBits[4:0]REG \nAddress \nBits[4:0]TA Data Bits[15:0] Idle\nRead 32 1’s 01 10 AAAAA RRRRR Z0 DDDDDDDD_DDDDDDDD Z\nWrite 32 1’s 01 01 AAAAA RRRRR 10 DDDDDDDD_DDDDDDDD Z\nTABLE 3-5: SERIAL MANAGEMENT INTERFACE (SMI) FRAME FORMAT\nPreambleStart of \nFrameRead/\nWrite OP \nCodePHY \nAddress \nBits[4:0]REG \nAddress \nBits[4:0]TA Data Bits[15:0] Idle\nRead 32 1’s 01 00 1xRRR RRRRR Z0 0000_0000_DDDD_DDDD Z\nWrite 32 1’s 01 00 0xRRR RRRRR 10 xxxx_xxxx_DDDD_DDDD Z\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 23KSZ8873MML\nSMI register access is the same as the MIIM register access, exc ept for the register acce ss requirements presented in\nthis section.\n3.4 Advanced Switch Functions\n3.4.1 BYPASS MODE\nThe KSZ8873MML also offers a bypass mode that enables system-level power saving. When the CPU (connected to\nport 3 or port 1) enters a power saving mode, power down mo de or a sleep mode, the CPU can control pin 27 SMTX-\nER3/MII_LINK_3 or pin 51 SMTXER1/MII_ LINK_1 which can be tied high so that the KSZ8873MML detects this change\nand automatically switches to bypass mode in which the s witch function between port 2 and port 3/port 1 is sustained.\nIn bypass mode, the packets with DA to port 3 or port 1 will be dropped and bypass the internal buffer memory, making\nthe buffer memory more efficiency for data transfer. Spec ifically, energy detect mode with bypass mode enabled\nincreases power savings.\n3.4.2 IEEE 802.1Q VLAN SUPPORT\nThe KSZ8873MML supports 16 active VLANs out of the 4096 possible VLANs specified in the IEEE 802.1Q specifica-\ntion. KSZ8873MML provides a 16-entries VLAN table that converts  the 12-bits VLAN ID (VID) to the 4-bits Filter ID (FID)\nfor address lookup. If a non-tagged or nul l-VID-tagged packet is received, the ingr ess port default VID is used for lookup.\nIn VLAN mode, the lookup process starts with VLAN table l ookup to determine whether the VID is valid. If the VID is not\nvalid, the packet is dropped and its address is not learned. If the VID is valid, th e FID is retrieved for further lookup. The\nFID + Destination Address (FID +DA) are used to determine the destinatio n port. The FID + Source Address (FID+SA)\nare used for address learning.\nAdvanced VLAN features, such as “Ingress VLAN filterin g” and “Discard Non PVID packets” are also supported by the\nKSZ8873MML. These features can be set on a per port basis, and are defined in registers 18, 34, and 50 for ports 1, 2\nand 3, respectively.TABLE 3-6: FID+DA LOOKUP IN VLAN MODE\nDA Found in \nStatic MAC \nTable?Use FID \nFlag?FID Match?FID+DA Found in \nDynamic MAC \nTable?Action\nNo Don’t care Don’t care NoBroadcast to the membership ports \ndefined in the VLAN Table bits [18:16]\nNo Don’t care Don’t care YesSend to the destination port defined in \nthe Dynamic MAC Address Table bits \n[53:52] \nYes 0 Don’t care Don’t careSend to the destination port(s) defined \nin the Static MAC Address Table bits \n[50:48]\nYes 1 No NoBroadcast to the membership ports \ndefined in the VLAN Table bits [18:16]\nYes 1 No YesSend to the destination port defined in \nthe Dynamic MAC Address Table bits \n[53:52] \nYes 1 Yes Don’t careSend to the destination port(s) defined \nin the Static MAC Address Table bits \n[50:48]\nTABLE 3-7: FID+SA LOOKUP IN VLAN MODE\nFID+SA Found in Dynamic MAC Table? Action\nNo Learn and add FID+SA to the Dynamic MAC Address Table\nYes Update time stamp\nKSZ8873MML\nDS00002776A-page 24  \uf0e3 2018 Microchip Technology Inc.3.4.3 QOS PRIORITY SUPPORT\nThe KSZ8873MML provides Qualit y of Service (QoS) for applications such as VoIP and video conferencing. Offering\nfour priority queues per port, the per-port transmit queue ca n be split into four priority queues: Queue 3 is the highest\npriority queue and Queue 0 is the lowest priority queue. Bit [0 ] of registers 16, 32, and 48 is  used to enable split transmit\nqueues for ports 1, 2, and 3, respectively. If a port\'s transmit queue is not split, high priority and low priority packets hav e\nequal priority in the transmit queue. \nThere is an additional option to either always deliver high pr iority packets first or use weighted fair queuing for the four\npriority queues. This global option is set and explained in bit [3] of register 5.\n3.4.4 PORT-BASED PRIORITY\nWith port-based priority, each ingress port is individually clas sified as a high priority receiving port. All packets received\nat the high priority receiving port are marked as high priority  and are sent to the high-priority transmit queue if the cor-\nresponding transmit queue is split. Bits [4:3] of registers 16, 32, and 48 are used  to enable port-based priority for ports\n1, 2, and 3, respectively.\n3.4.5 802.1P-BASED PRIORITY\nFor 802.1p-based priority, the KSZ8873MML examines the ingr ess (incoming) packets to determine whether they are\ntagged. If tagged, the 3-bit priority field in the VLAN tag is  retrieved and compared against the “priority mapping” value,\nas specified by the registers 12 and 13. Th e “priority mapping” value is programmable.\nFigure 3-6  illustrates how the 802.1p priority field is embedded in the 802.1Q VLAN tag.\n802.1p-based priority is enabled by bit [5] of register s 16, 32, and 48 for ports 1, 2, and 3, respectively.\nThe KSZ8873MML provides the option to insert or remove the priority tagged frame\'s header at each individual egress\nport. This header, consisting of the 2 bytes VLAN Protocol ID (VPID) and the 2-byte Tag Control Information field (TCI),\nis also referred to as the IEEE 802.1Q VLAN tag.\nTag Insertion is enabled by bit [2] of t he port registers control 0 and the register  194 to select which source port (ingress\nport) PVID can be inserted on the egress port for ports 1, 2,  and 3, respectively. At the egress port, untagged packets\nare tagged with the ingress port’s default tag. The default ta gs are programmed in register sets {19,20}, {35,36}, and\n{51,52} for ports 1, 2, and 3,  respectively, and the source port VID has to be  inserted at selected egress ports by bit[5:0]\nof register 194. The KSZ8873MML will not add tags to already tagged packets.\nTag Removal is enabled by bit [1] of registers 16, 32, and 48 fo r ports 1, 2, and 3, respectively. At the egress port, tagged\npackets will have their 802.1Q VLAN Tags remove d. The KSZ8873MML will not modify untagged packets.\nThe CRC is recalculated for both tag insertion and tag removal.FIGURE 3-6: 802.1P PRIORITY FIELD FORMAT\nPreamble DA TCI86 6 2\nlength LLC Data FCS2 46-1500 4\n1\nTagged Packet Type\n(8100 for Ethernet)802.1p\nCFIVLAN IDBytes\nBits 16 3 12\n802.1q VLAN Tag2\nSA VPID\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 25KSZ8873MML\n802.1p Priority Field Re-mapping is a Qo S feature that allows the KSZ8873MML to set the “User Priority Ceiling” at any\ningress port. If the ingress packet’s priority field has a higher priority value than the default tag’s priority field of the\ningress port, the packet’s priority field is replaced with the default tag’s priority field.\n3.4.6 DIFFSERV-BASED PRIORITY\nDiffServ-based priority uses the ToS registers (registers 96 to  111) in the Advanced Contro l Registers section. The ToS\npriority control registers implement a fully decoded, 64-bit Differentiated Services Code Point (DSCP) register to deter-\nmine packet priority from the 6-bit ToS field in the IP header.  When the most significant 6 bits of the ToS field are fully\ndecoded, the resultant of the 64 possibilities is compared with the correspondi ng bits in the DSCP register to determine\npriority.\n3.5 Spanning Tree Support\nTo support spanning tree, port 3 is designated as the processor port.\nThe other ports (port 1 and port 2) can be configured in one of  the five spanning tree states via “transmit enable”, “receive\nenable”, and “learning disable” register settings in registers 18 and 34 for ports 1 and 2, respectively. The following table\nshows the port setting and software actions taken for each of the five spanning tree states.\nTABLE 3-8: SPANNING TREE STATES\nState Setting Action\nDisable State Port Setting Software Action\nThe port should not forward or \nreceive any packets. Learn-\ning is disabled.“transmit enable = 0, \nreceive enable = 0, \nlearning disable =1”The processor should not send any packets to the port. The \nswitch may still send specif ic packets to the processor \n(packets that match some entries in the “static MAC table” with “overriding bit” set) and the processor should discard \nthose packets. Address learning is disabled on the port in \nthis state.\nBlocking State Port Setting Software Action\nOnly packets to the processor \nare forwarded. Learning is \ndisabled.“transmit enable = 0, \nreceive enable = 0, \nlearning disable =1”The processor should not send any packets to the port(s) in \nthis state. The processor should program the “Static MAC \ntable” with the entrie s that it needs to re ceive (for example, \nBPDU packets). The “overriding” bit should also be set so \nthat the switch will forward those specific packets to the pro-\ncessor. Address learning is disabled on the port in this state.\nListening State Port Setting Software Action\nOnly packets to and from the \nprocessor are forwarded. \nLearning is disabled.“transmit enable = 0, \nreceive enable = 0, \nlearning disable =1”The processor should program the “Static MAC table” with \nthe entries that it needs to  receive (for example, BPDU \npackets). The “overriding” bit should be set so that the switch will forward those specific packets to the processor. \nThe processor may send packets to the port(s) in this state. \nSee Section 3.7 “Tail Tagging Mode”  for details. Address \nlearning is disabled on the port in this state.\nLearning State Port Setting Software Action\nOnly packets to and from the \nprocessor are forwarded. \nLearning is enabled.“transmit enable = 0, \nreceive enable = 0, \nlearning disable = 0”The processor should program the “Static MAC table” with \nthe entries that it needs to  receive (for example, BPDU \npackets). The “overriding” bit should be set so that the \nswitch will forward those specific packets to the processor. \nThe processor may send packets to the port(s) in this state. \nSee Section 3.7 “Tail Tagging Mode”  for details. Address \nlearning is enabled on the port in this state.\nKSZ8873MML\nDS00002776A-page 26  \uf0e3 2018 Microchip Technology Inc.3.6 Rapid Spanning Tree Support\nThere are three operational st ates of the Discarding, Learning, and Forwarding assigned to each port for RSTP: \nDiscarding ports do not participate in the acti ve topology and do not learn MAC addresses. \nDiscarding state: The state includes three states  of the disable, blocking and listening of STP.\nPort setting: "transmit enable = 0, rece ive enable = 0, learning disable = 1."\nSoftware action: the processor should not send any packets to the port. The switch may still send specific packets to\nthe processor (packets that match some entries in the static table with “overridi ng bit” set) and the processor should\ndiscard those packets. When disable the port’s learning capabi lity (learning disable=’1’), set the register 2 bit 5 and bit\n4 will flush rapidly the port related entries in  the dynamic MAC table and static MAC table.\nNote: Processor is connected to port 3 via MII interface. Address learning is disabled on the port in this state.\nPorts in Learning states learn MAC addre sses, but do not forward user traffic. \nLearning state: Only packets to and from t he processor are forwarded. Learning is enabled.\nPort setting: “transmit enable = 0, receive enable = 0, learning disable = 0.”Software action: The processor should progr am the static MAC table wi th the entries that it needs to receive (e.g., BPDU\npackets). The “overriding” bit should be set so that the switch  will forward those specific packets to the processor. The\nprocessor may send packets to the port(s) in this state, see Section 3.7 “Tail Tagging Mode”  for details. Address learn-\ning is enabled on the port in this state.\nPorts in Forwarding states fully participate in both data forwarding and MAC learning.Forwarding state: Packets are forwarded and  received normally. Learning is enabled.\nPort setting: “transmit enable = 1, receive enable = 1, learning disable = 0.”Software action: The processor should progr am the static MAC table wi th the entries that it needs to receive (e.g., BPDU\npackets). The “overriding” bit should be set so that the switch  will forward those specific packets to the processor. The\nprocessor may send packets to the port(s) in this state, see Section 3.7 “Tail Tagging Mode”  for details. Address learn-\ning is enabled on the port in this state.\nRSTP uses only one type of BPDU called RSTP BPDUs. They are similar to STP Configuration BPDUs with the excep-\ntion of a type field set to “version 2” for RSTP and “version 0” for STP, and a flag field carrying additional information.\n3.7 Tail Tagging Mode\nThe Tail Tag is only seen and used by the port 3 interface, wh ich should be connected to a processor. It is an effective\nway to retrieve the ingress port information for spanning tree protocol IGMP snooping and other applications. The Bit 1\nand bit 0 in the one byte tail tagging is used to indicate the source/destination port in port 3. Bit 3 and bit 2 are used for\nthe priority setting of the ingress frame in port 3. Other bits  are not used. The Tail Tag feat ure is enable by setting registe r\n3 bit 6.Forwarding State Port Setting Software Action\nPackets are forwarded and \nreceived normally. Learning is enabled.“transmit enable = 1, \nreceive   enable = 1, learning disable = 0”The processor programs the “Static MAC table” with the \nentries that it needs to rece ive (for example, BPDU pack-\nets). The “overriding” bit is set so that the switch forwards \nthose specific packets to the processor. The processor can send packets to the port(s) in this state. See Section 3.7 \n“Tail Tagging Mode”  for details. Address learning is \nenabled on the port in this state.TABLE 3-8: SPANNING TREE STATES\nState Setting Action\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 27KSZ8873MML\n3.8 IGMP Support\nFor Internet Group Management Protocol  (IGMP) support in layer 2, the KSZ 8873MML provides two components: IGMP\nsnooping and IGMP send-back to the subscribed port.\n3.8.1 IGMP SNOOPING\nThe KSZ8873MML traps IGMP packets and forwards them only to the processor (port 3). The IGMP packets are iden-\ntified as IP packets (either Ethernet IP packets, or IEEE 8 02.3 SNAP IP packets) with IP version = 0x4 and protocol\nversion number = 0x2.\n3.8.2 IGMP SEND-BACK TO THE SUBSCRIBED PORT\nOnce the host responds the received IGMP packet, the host  should know the original IGMP ingress port and send back\nthe IGMP packet to this port only, otherwise this IGMP pack et will be broadcasted to all ports to downgrade the perfor-\nmance.\nEnable the tail tag mode, the host will know the IGMP packe t received port from tail tag bits [0] and can send back the\nresponse IGMP packet to this subscribed port by setting the bits [1,0] in the tail tag. Enable tail tag mode by setting Reg-\nister 3 bit 6. The tail tag will be remov ed automatically when the IGMP packet is  sent out from the subscribed port.FIGURE 3-7: TAIL TAG FRAME FORMAT\nTABLE 3-9: TAIL TAG RULES\nIngress to Port 3 (Host to KSZ8873)\nBit [1,0] Destination Port\n0,0 Normal (address lookup)\n0,1 Port 11,0 Port 2\n1,1 Port 1 and 2\nBit [3,2] Frame Priority\n0,0 Priority 0\n0,1 Priority 1\n1,0 Priority 21,1 Priority 3\nEgress from Port 3 (KSZ8873 to Host)\nBit [0] Source Port\n0P o r t  1\n1P o r t  2 \nPreamble DA TCI86 6 2\nlength LLC Data Tail Tag2 46-1500 1\nFCS4 Bytes 2\nSA VPID\nKSZ8873MML\nDS00002776A-page 28  \uf0e3 2018 Microchip Technology Inc.3.9 Port Mirroring Support\nKSZ8873MML supports “Port Mirroring” comprehensively as:\n• “Receive only” mirror on a port \n- All the packets received on the port are mirrored on the sniffer port. For example, port 1 is programmed to be \n“receive sniff” and port 3 is programmed to be the “sniff er port”. A packet received on port 1 is destined to port \n2 after the internal lookup. The KSZ8873MML forwar ds the packet to both port 2 and port 3. The \nKSZ8873MML can optionally even forward “bad” received packets to the “sniffer port”.\n• “Transmit only” mirror on a port\n- All the packets transmitted on the port are mirrored on t he sniffer port. For example, port 1 is programmed to \nbe “transmit sniff” and port 3 is programmed to be the “s niffer port”. A packet received on port 2 is destined to \nport 1 after the internal lookup. The KSZ8873MML forwards the packet to both port 1 and port 3.\n• “Receive and transmit” mirror on two ports\n- All the packets received on port A and transmitted on por t B are mirrored on the sniffer port. To turn on the \n“AND” feature, set register 5 bit [0] to ‘1’. For exampl e, port 1 is programmed to be “receive sniff”, port 2 is \nprogrammed to be “transmit sniff”, and port 3 is programm ed to be the “sniffer port”. A packet received on port \n1 is destined to port 2 after the internal lookup. The KSZ8873MML forwards the packet to both port 2 and port \n3.\nMultiple ports can be selected as “receive sniff” or “transmit sniff”. In addition, any port can be selected as the “sniffer\nport”. All these per port features can be selected through registers 17, 33, and 49 for ports 1, 2, and 3, respectively.\n3.10 Rate Limiting Support\nThe KSZ8873MML provides a fine resolution hardware rate limiting from 64 kbps to 99 Mbps. The rate step is 64 kbps\nwhen the rate range is from 64 kbps to 960 kbps and 1 Mbps for 1 Mbps to 100 Mbps (100BT) or to 10 Mbps (10BT)\n(refer to Data Rate Limit Table). The rate limit is independ ently on the “receive side” and on the “transmit side” on a per\nport basis. For 10BASE-T, a rate setting above 10 Mbps means the rate is not limited. On  the receive side, the data\nreceive rate for each priority at each port can be limited by  setting up Ingress Rate Contro l Registers. On the transmit\nside, the data transmit rate for each priority queue at eac h port can be limited by setting up Egress Rate Control Reg-\nisters. The size of each frame has options to include minimu m IFG (Inter Frame Gap) or Preamble byte, in addition to\nthe data field (from packet DA to FCS).\nFor ingress rate limiting, KSZ8873MML provides options to se lectively choose frames from all types, multicast, broad-\ncast, and flooded unicast frames. The KSZ8873MML counts the data rate from those select ed type of frames. Packets\nare dropped at the ingress port when the da ta rate exceeds the specified rate limit.\nFor egress rate limiting, the Leaky Bucket algorithm is applied to each output prio rity queue for shaping output traffic.\nInter frame gap is stretched on a per frame base to genera te smooth, non-burst egress tr affic. The throughput of each\noutput priority queue is limited by the egress rate specified.\nIf any egress queue receives more traffi c than the specified egress rate throughput, packets may be accumulated in the\noutput queue and packet memory. After the memory of the queue or  the port is used up, packet dropping or flow control\nwill be triggered. As a result of congestion, the actual egre ss rate may be dominated by flow control/dropping at the\ningress end, and may be therefore slight ly less than the specified egress rate. \nTo reduce congestion, it is a good practice to make sure the egress bandwidth exceeds the ingress bandwidth.\n3.11 Unicast MAC Address Filtering\nThe unicast MAC address filtering function works in conjunction with the static MAC address ta ble. First, the static MAC\naddress table is used to assign a dedicated MAC address to  a specific port. If a unicast MAC address is not recorded\nin the static table, it is also not learned in the dynami c MAC table. The KSZ8873MML is then configured with the option\nto either filter or forward unicast packets for an unknown MA C address. This option is enabled and configured in register\n14.\nThis function is useful in preventing th e broadcast of unicast packets that could degrade the quality of the port in appli-\ncations such as voice over Internet Protocol (VoIP).\n3.12 Configuration Interface\nThe KSZ8873MML can operate as both a managed switch and an unmanaged switch.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 29KSZ8873MML\nIn unmanaged mode, the KSZ8873MML is typically progra mmed using an EEPROM. If no EEPROM is present, the\nKSZ8873MLL/FLL/RLL is configured using its default register settings. Some default settings are configured via strap-\nin pin options. The strap-in pins are indicated in the “Pin Description and I/O Assignment” table.\n3.12.1 I2C MASTER SERIAL BUS CONFIGURATION\nWith an additional I2C (“2-wire”) EEPROM, the KSZ8873MML can perform more advanced switch features like “broad-\ncast storm protection” and “rate control” without the need of an external processor.\nFor KSZ8873MML I2C Master configuration, the EEPROM  stores the configuration data fo r register 0 to register 120 (as\ndefined in the KSZ8873MML register map) wi th the exception of the “Read Only” st atus registers. After the de-assertion\nof reset, the KSZ8873MML sequent ially reads in the configuration data for all control registers, star ting from register 0.\nThe following is a sample proc edure for programming the KSZ8873M ML with a pre-configured EEPROM:\n1. Connect the KSZ8873MML to the EEPROM by joining th e SCL and SDA signals of the respective devices. \n2. Enable I2C master mode by setting the KSZ8873MML strap-in pins, P2LED[1:0] to “00”.\n3. Check to ensure that the KSZ8873MML reset signal inpu t, RSTN, is properly connected to the external reset\nsource at the board level.\n4. Program the desired confi guration data into the EEPROM.\n5. Place the EEPROM on the board and power up the board.6. Assert an active-low reset to the RSTN pin of t he KSZ8873MML. After reset is de-asserted, the KSZ8873MML\nbegins reading the configur ation data from the EEPROM . The KSZ8873MML checks that  the first byte read from\nthe EEPROM is “88”. If this value is  correct, EEPROM configuration conti nues. If not, EEPROM configuration\naccess is denied and all other data sent from  the EEPROM is ignored by the KSZ8873MML.\nFor proper operation, ensure that t he KSZ8873MML PWRDN input signal is not  asserted during the reset operation.\nThe PWRDN input is active-low.\n3.12.2 I2C SLAVE SERIAL BUS CONFIGURATION\nIn managed mode, the KSZ8873MML  can be configured as an I2C slave device. In this mode, an I2C master device\n(external controller/CPU) has complete programming acce ss to the KSZ8873MML’s 198 registers. Programming access\nincludes the Global Registers, Port R egisters, Advanced Control Registers, a nd indirect access to the “Static MAC\nTable”, “VLAN Table”, “Dynamic MAC Table,” and “MIB Counte rs.” The tables and counters are indirectly accessed via\nregisters 121 to 131.\nIn I2C slave mode, the KSZ8873MML  operates like other I2C slave devices. Addressing the KSZ8873MML’s 8-bit reg-\nisters is similar to addressing the Microchip AT24C02 EEPROM’s memory locations. Details of I2C read/write operations\nand related timing information can be found in the AT24C02 data sheet.\nTwo fixed 8-bit device addresses are used to address the KSZ8873MML in I2C slave mode. One is for read; the other\nis for write. The addresses are as follows:\n• 1011_1111   <read>FIGURE 3-8: EEPROM CONFIG URATION TIMING DIAGRAM\n........\n....RST_N\nSCL\nSDA\ntprgm<15 ms\nKSZ8873MML\nDS00002776A-page 30  \uf0e3 2018 Microchip Technology Inc.• 1011_1110   <write>\nThe following is a sample procedure for programming the KSZ8873MML using the I2C slave serial bus:\n1. Enable I2C slave mode by setting the KSZ8873MML strap-in pins P2LED[1:0] to “01”.\n2. Power up the board and assert reset to the KSZ8873MML. \n3. Configure the desired register sett ings in the KSZ8873MML, using the I2C write operation.\n4. Read back and verify the register settings in the KSZ8873MML, using the I2C read operation.\nSome of the configuration settings, such as “Aging Enab le”, “Auto Negotiation Enable”, “Force Speed”, and “Power\ndown” can be programmed after the switch has been started.\n3.12.3 SPI SLAVE SERIA L BUS CONFIGURATION\nIn managed mode, the KSZ8873MML can be c onfigured as a SPI slave device. In th is mode, a SPI master device (exter-\nnal controller/CPU) has complete programming access to  the KSZ8873MML’s 198 registers. Programming access\nincludes the Global Registers, Port Registers, Advanced  Control Registers and indirect access to the “Static MAC\nTable”, “VLAN Table”, “Dynamic MAC Table” and “MIB Counters ”. The tables and counters are indirectly accessed via\nregisters 121 to 131.\nThe KSZ8873MML supports two standard SPI commands: ‘0000_0011’ for data read and ‘0000_0010’ for data write.\nSPI multiple read and multiple write are also supported by the KSZ8873MML to expedite register read back and register\nconfiguration, respectively.\nSPI multiple read is initiated when the master device c ontinues to drive the KSZ8873MM L SPISN input pin (SPI Slave\nSelect signal) low after a byte (a register) is read. The KSZ8873MML internal address counter increments automatically\nto the next byte (next register) after the read. The next by te at the next register ad dress is shifted out onto the\nKSZ8873MML SPIQ output pin. SPI multiple read continues un til the SPI master device te rminates it by de-asserting\nthe SPISN signal to the KSZ8873MML.\nSimilarly, SPI multiple write is init iated when the master device continues to  drive the KSZ8873MML SPISN input pin\nlow after a byte (a register) is written. The KSZ8873MML in ternal address counter increments automatically to the next\nbyte (next register) after the write. Th e next byte that is sent from the mast er device to the KSZ8873MML SDA input pin\nis written to the next register address. SPI multiple write continues until the SPI master device terminates it by de-assert-\ning the SPISN signal to the KSZ8873MML.\nFor both SPI multiple read and multiple write, the KSZ8873MML internal address c ounter wraps back to register address\nzero once the highest register address is reached. This f eature allows all 198 KSZ8873MML registers to be read, or\nwritten with a single SPI command fr om any initial register address.\nThe KSZ8873MML is capable of supporting a SPI bus.The following is a sample procedure for programming the KSZ8873MML using the SPI bus:1. At the board level, connect the KSZ8873MML pins as follows:\n2. Enable SPI slave mode by setting the KSZ8 873MML strap-in pins P2LED[1:0] to “10”.\n3. Power up the board and assert reset to the KSZ8873MML. \n4. Configure the desired register sett ings in the KSZ8873MML, using the SPI write or multiple write command.\n5. Read back and verify the register settings in the KSZ8873MML, using the SPI read or multiple read command. \nSome of the configuration settings, such as “Aging Enab le,” “Auto Negotiation Enable, ” “Force Speed,” and “Power\nDown” can be programmed after the switch has been started.TABLE 3-10: SPI CONNECTIONS\nPin Number Signal NameExternal Processor Signal \nDescription\n39 SPISN SPI Slave Select\n41 SCL (SPIC) SPI Clock\n42 SDA (SPID) SPI Data\n(Master output; Slave input)\n38 SPIQ SPI Data\n(Master input; Slave output)\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 31KSZ8873MML\nThe following four figures illustrate the SPI  data cycles for “Write,” “Read,” “Multi ple Write,” and “Multiple Read.” The\nread data is registered out of SPIQ on  the falling edge of SPIC, and the data inpu t on SPID is registered on the rising\nedge of SPIC.\nFIGURE 3-9: SPI WRITE DATA CYCLE\nFIGURE 3-10: SPI READ DATA CYCLESPIQSPIC\nSPIDSPIS_N\n00000010 X A7 A6 A5 A4 A3 A2 A1 A0\nWRITE COMMAND WRITE ADDRESS WRITE DATAD2 D0 D1 D3 D4 D5 D6 D7\nSPIQSPIC\nSPIDSPIS_N\n00000010 X A7 A6 A5 A4 A3 A2 A1 A0\nREAD COMMAND READ ADDRESS READ DATAD2 D0 D1 D3 D4 D5 D6 D7\nKSZ8873MML\nDS00002776A-page 32  \uf0e3 2018 Microchip Technology Inc.FIGURE 3-11: SPI MULTIPLE WRITE\nFIGURE 3-12: SPI MULTIPLE READ \nSPIQSPIC\nSPIDSPIS_N\n00000010 X A7 A6 A5 A4 A3 A2 A1 A0\nWRITE COMMAND WRITE ADDRESS Byte 1D2 D0 D1 D3 D4 D5 D6 D7\nSPIQSPIC\nSPIDSPIS_N\nD7 D6 D5 D4 D4 D2 D1 D0 D7 D6 D5 D4 D3 D2 D1 D0\nByte 2 Byte 3 ... Byte ND2 D0 D1 D3 D4 D5 D6 D7\nSPIQSPIC\nSPIDSPIS_N\n00000011 X A7 A6 A5 A4 A3 A2 A1 A0\nD7 D6 D5 D4 D3 D2 D1 D0\nREAD COMMAND READ ADDRESS Byte 1\nXXXXXXXX XXXXXXX X\nByte 2 Byte 3 Byte NX X X X X X X X\nXXXXXXXX\nD7 D6 D5 D4 D3 D2 D1 D0 D7 D6 D5 D4 D3 D2 D1 D0 D7 D6 D5 D4 D3 D2 D1 D0 SPIQSPIC\nSPIDSPIS_N\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 33KSZ8873MML\n3.13 Loopback Support\nThe KSZ8873MML provides loopback support for remote diagnostic  of failure. In loopback mode, the speed at both PHY\nports needs to be set to 100BASE-TX. The KSZ8 873MML only supports Near-End (Remote) Loopback.\n3.13.1 NEAR-END (R EMOTE) LOOPBACK\nNear-End (Remote) loopback is conduc ted at PHY port 2 of the KSZ8873MML. The loopback path starts at the PHY\nport’s receive inputs (RXPx/RXMx), wraps around at the same PHY port’s PMD/PM A, and ends at the PHY port’s trans-\nmit outputs (TXPx/TXMx).\nBit [1] of registers 42 is used to enable near-end loopback fo r ports 2. Alternatively, the MII Management register 31, bit\n[1] can be used to enable near-end loopback.\nThe near-end loopback paths are illustrated in Figure 3-13 .\nFIGURE 3-13: NEAR-END (REMOTE) LOOPBACK PATH\nTXP1/\nTXM1RXP1/\nRXM1\nRXP2/RXM2TXP2/\nTXM2PHY \nPort  1\nPHY\nPort 2 PMD/PMAPCSMACSwitchMAC\n PCSPMD/PMA\nKSZ8873MML\nDS00002776A-page 34  \uf0e3 2018 Microchip Technology Inc.4.0 REGISTER DESCRIPTIONS\n4.1 MII Management (MIIM) Registers\nThe MIIM interface is used to access the MII PH Y registers defined in this section. The SPI, I2C, and SMI interfaces can\nalso be used to access some of these registers. The latter three interfaces use a different mapping mechanism than the\nMIIM interface.\nThe “PHYADs” by defaults are assigned “0x1” for PHY1 as reserved in KSZ8873MML and “0x2” for PHY2 (port 2). Addi-\ntionally, these “PHYADs” can be programmed to the PHY addresse s specified in bits[7:3] of Register 15 (0x0F): Global\nControl 13.\nThe “REGAD” supported are 0x0-0x5, 0x1D, and 0x1F.\nTABLE 4-1: MIIM REGISTERS FOR KSZ8873MLL/FLL/RLL\nRegister Number Description\nPHYAD = 0x2, REGAD = 0x0 PHY2 Basic Control Register\nPHYAD = 0x2, REGAD = 0x1 PHY2 Basic Status Register\nPHYAD = 0x2, REGAD = 0x2 PHY2 Physical Identifier I \nPHYAD = 0x2, REGAD = 0x3 PHY2 Physical Identifier II PHYAD = 0x2, REGAD = 0x4 PHY2 Auto-N egotiation Advertisement Register \nPHYAD = 0x2, REGAD = 0x5 PHY2 Auto-Negoti ation Link Partner Ability Register \nPHYAD = 0x2, 0x6 – 0x1C PHY2 Not supported \nPHYAD = 0x2, 0x1D PHY2 LinkMD Control/Status\nPHYAD = 0x2, 0x1E PHY2 Not supported \nPHYAD = 0x2, 0x1F PHY2 Special Control/Status\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 35KSZ8873MML\n4.2 Register Descriptions\nTABLE 4-2: REGISTER DESCRIPTIONS\nBit Name R/W Description Default Reference\nPHY1 Register 0 (PHYAD = 0x1, REGAD = 0x0): Reserved\nPHY2 Register 0 (PHYAD = 0x2, REGAD = 0x0): MII Basic Control\n15 Soft Reset RO Not Supported 0 —\n14 Loopback R/W1 = Perform loopback, as indicated:\nPort 1 Loopback (reg. 29, bit 0 = ‘1’)\nStart: RXP2/RXM2 (port 2)Loopback: PMD/PMA of port 1’s PHY\nEnd: TXP2/TXM2 (port 2)\nPort 2 Loopback (reg. 45, bit 0 = ‘1’)Start: RXP1/RXM1 (port 1)\nLoopback: PMD/PMA of port 2’s PHY\nEnd: TXP1/TXM1 (port 1)0 = Normal operation0Reg. 29, bit 0\nReg. 45, bit 0\n13 Force 100 R/W1 = 100 Mbps\n0 = 10 Mbps0Reg. 28, bit 6\nReg. 44, bit 6\n12 AN Enable R/W1 = Auto-negotiation enabled\n0 = Auto-negotiation disabled1Reg. 28, bit 7\nReg. 44, bit 7\n11 Power Down R/W1 = Power down\n0 = Normal operation0Reg. 29, bit 3\nReg. 45, bit 3\n10 Isolate RO Not Supported 0 —\n9R e s t a r t  A N R / W1 = Restart auto-negotiation\n0 = Normal operation0Reg. 29, bit 5\nReg. 45, bit 5\n8Force Full-\nDuplexR/W1 = Full-duplex\n0 = Half-duplex0Reg. 28, bit 5\nReg. 44, bit 5\n7 Collision Test RO Not Supported 0 —\n6 Reserved RO — 0 —\n5 Hp_mdix R/W1 = HP Auto MDI/MDI-X mode\n0 = Microchip Auto MDI/MDI-X mode1Reg. 31, bit 7\nReg. 47, bit 7\n4F o r c e  M D I R / W1 = Force MDI (transmit on RXP/RXM pins)\n0 = Normal operation (transmit on TXP/TXM pins)0Reg. 29, bit 1\nReg. 45, bit 1\n3Disable \nMDIXR/W1 = Disable auto MDI-X\n0 = Enable auto MDI-X0Reg. 29, bit 2\nReg. 45, bit 2\n2Disable Far-\nEnd FaultR/W1 = Disable far-end fault detection\n0 = Normal operation0 Reg. 29, bit 4\n1Disable \nTransmitR/W1 = Disable transmit\n0 = Normal operation0Reg. 29, bit 6\nReg. 45, bit 6\n0 Disable LED R/W1 = Disable LED\n0 = Normal operation0Reg. 29, bit 7 \nReg. 45, bit 7\nPHY1 Register 1 (PHYAD = 0x1, REGAD = 0x1): Reserved\nPHY2 Register 1 (PHYAD = 0x2, REGAD = 0x1): MII Basic Status\n15 T4 Capable RO 0 = No t 100BASE-T4 capable 0 —\n14100 Full \nCapable\nRO1 = 100BASE-TX full-duplex capable\n0 = Not capable of 100BASE-TX full-duplex1 Always 1\n13100 Half \nCapableRO1 = 100BASE-TX half -duplex capable\n0 = Not 100BASE-TX half-duplex capable1 Always 1\n1210 Full \nCapableRO1 = 10BASE-T full-duplex capable\n0 = Not 10BASE-T full-duplex capable1 Always 1\nKSZ8873MML\nDS00002776A-page 36  \uf0e3 2018 Microchip Technology Inc.1110 Half \nCapableRO1 = 10BASE-T half-duplex capable\n0 = Not 10BASE-T half-duplex capable1 Always 1\n10-7 Reserved RO — 0000 —\n6Preamble \nSuppressedRO Not Supported 0 —\n5 AN Complete RO1 = Auto-negotiation complete\n0 = Auto-negotiation not completed0Reg. 30, bit 6\nReg. 46, bit 6\n4Far-End \nFaultRO1 = Far-end fault detected\n0 = No far-end fault detected0 Reg. 31, bit 0\n3 AN Capable RO1 = Auto-negotiation capable\n0 = Not auto-negotiation capable1Reg. 28, bit 7\nReg. 44, bit 7\n2 Link Status RO1 = Link is up\n0 = Link is down0Reg. 30, bit 5\nReg. 46, bit 5\n1 Jabber Test RO Not Supported 0 —\n0Extended \nCapableRO 0 = Not extended register capable 0 —\nPHY1 Register 2 (PHYAD = 0x1, REGAD = 0x2): Reserved\nPHY2 Register 2 (PHYAD = 0x2, REGAD = 0x2): PHYID High\n15-0 PHYID High RO High order PHYID bits 0x0022 —\nPHY1 Register 3 (PHYAD = 0x1, REGAD = 0x3): Reserved\nPHY2 Register 3 (PHYAD = 0x2, REGAD = 0x3): PHYID Low\n15-0 PHYID Low RO Low order PHYID bits 0x1430 —\nPHY1 Register 4 (PHYAD = 0x1, REGAD = 0x4): Reserved\nPHY2 Register 4 (PHYAD = 0x2, REGAD = 0x4): Auto-Negotiation Advertisement Ability\n15 Next Page RO Not Supported 0 —14 Reserved RO — 0 —\n13 Remote Fault RO Not Supported 0 —\n12-11 Reserved RO — 00 —\n10 Pause R/W1 = Advertise pause ability\n0 = Do not advertise pause ability1Reg. 28, bit 4\nReg. 44, bit 4\n9 Reserved R/W — 0 —\n8 Adv 100 Full R/W1 = Advertise 100 full-duplex ability\n0 = Do not advertise 100 full-duplex ability1Reg. 28, bit 3\nReg. 44, bit 3\n7 Adv 100 Half R/W1 = Advertise 100 half-duplex ability\n0 = Do not advertise 100 half-duplex ability1Reg. 28, bit 2\nReg. 44, bit 2\n6 Adv 10 Full R/W1 = Advertise 10 full-duplex ability\n0 = Do not advertise 10 full-duplex ability1Reg. 28, bit 1\nReg. 44, bit 1\n5 Adv 10 Half R/W1 = Advertise 10 half-duplex ability\n0 = Do not advertise 10 half-duplex ability1Reg. 28, bit 0\nReg. 44, bit 0\n4-0Selector \nFieldRO 802.3 00001 —\nPHY1 Register 5 (PHYAD = 0x1, REGAD = 0x5): Reserved\nPHY2 Register 5 (PHYAD = 0x2, REGAD = 0x5): Auto-Negotiation Link Partner Ability\n15 Next Page RO Not Supported 0 —\n14 LP ACK RO Not Supported 0 —13 Remote Fault RO Not Supported 0 —\n12-11 Reserved RO — 00 —TABLE 4-2: REGISTER DESC RIPTIONS (CONTINUED)\nBit Name R/W Description Default Reference\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 37KSZ8873MML\n10 Pause RO Link partner pause capability 0Reg. 30, bit 4\nReg. 46, bit 4\n9 Reserved RO — 0 —\n8 Adv 100 Full RO Link partner 100 full-duplex capability 0Reg. 30, bit 3\nReg. 46, bit 3\n7 Adv 100 Half RO Link partner 100 half-duplex capability 0Reg. 30, bit 2\nReg. 46, bit 2\n6 Adv 10 Full RO Link partner 10 full-duplex capability 0Reg. 30, bit 1\nReg. 46, bit 1\n5 Adv 10 Half RO Link partner 10 half-duplex capability 0Reg. 30, bit 0\nReg. 46, bit 0\n4-0 Reserved RO — 00000 —\nPHY1 Register 29 (PHYAD = 0x1, REGAD = 0x1D): Reserved\nPHY2 Register 29 (PHYAD = 0x2, RE GAD = 0x1D): LinkMD Control/Status\n15 Vct_enableR/W\n(SC)1 = Enable cable diagnostic. After VCT test \nhas completed, this bit will be self-cleared.0 = Indicate cable diagnostic test (if enabled) \nhas completed and the status information is \nvalid for read.0 Reg. 42, bit 4\n14-13 Vct_result RO00 = Normal condition\n01 = Open condition detected in cable\n10 = Short condition detected in cable11 = Cable diagnostic test has failed00 Reg 42, bit[6:5]\n12Vct 10M \nShortRO 1 = Less than 10 meter short 0 Reg. 42, bit 7\n11-9 Reserved RO Reserved 000 —\n8-0Vct_-\nfault_countRODistance to the fault.\nIt’s approximately 0.4m*vct_fault_count[8:0]{0, (0x00)}{(Reg. 42, bit 0), \n(Reg. 43, bit[7:0])}\nPHY1 Register 31 (PHYAD = 0x1, REGAD = 0x1F): Reserved\nPHY2 Register 31 (PHYAD = 0x2, REG AD = 0x1F): PHY Special Control/Status\n15-6 Reserved RO Reserved {(0x00),00} —\n5P o l r v s R O1 = Polarity is reversed\n0 = Polarity is not reversed0Reg. 31, bit 5\nReg. 47, bit 5Note: This bit is\nonly valid for \n10BT\n4 MDI-X status RO1 = MDI \n0 = MDI-X0Reg. 30, bit 7\nReg. 46, bit 7\n3 Force_lnk R/W1 = Force link pass\n0 = Normal Operation0Reg. 26, bit 3\nReg. 42, bit 3\n2 Pwrsave R/W0 = Enable power saving\n1 = Disable power saving1Reg. 26, bit 2\nReg. 42, bit 2TABLE 4-2: REGISTER DESCRIPTIONS (CONTINUED)\nBit Name R/W Description Default Reference\nKSZ8873MML\nDS00002776A-page 38  \uf0e3 2018 Microchip Technology Inc.4.3 Memory Map (8-Bit Registers)1Remote \nLoopbackR/W1 = Perform Remote loopback, as follows: \nPort 1 (reg. 26, bit 1 = ‘1’)Start: RXP1/RXM1 (port 1)\nLoopback: PMD/PMA of port 1’s PHY\nEnd: TXP1/TXM1 (port 1)\nPort 2 (reg. 42, bit 1 = ‘1’)\nStart: RXP2/RXM2 (port 2)Loopback: PMD/PMA of port 2’s PHY\nEnd: TXP2/TXM2 (port 2)\n0 = Normal Operation0Reg. 26, bit 1\nReg. 42, bit 1\n0 Reserved R/WReserved\nDo not change the default value.0—\nTABLE 4-3: GLOBAL REGISTERS\nRegister (Decimal) Register (Hex) Description\n0-1 0x00-0x01 Chip ID Register\n2-15 0x02-0x0F Global Control Register\nTABLE 4-4: PORT REGISTERS\nRegister (Decimal) Register (Hex) Description\n16-29 0x10-0x1D Port 1 Control Registers, including MII PHY Registers\n30-31 0x1E-0x1F Port 1 Status Regist ers, including MII PHY Registers\n32-45 0x20-0x2D Port 2 Control Registers, including MII PHY Registers46-47 0x2E-0x2F Port 2 Status Regist ers, including MII PHY Registers\n48-57 0x30-0x39 Port 3 Control Registers\n58-62 0x3A-0x3E Reserved\n63 0x3F Port 3 Status Register\n64-95 0x40-0x5F Reserved \nTABLE 4-5: ADVANCED CONTROL REGISTERS\nRegister (Decimal) Register (Hex) Description\n96-111 0x60-0x6F TOS Priority Control Registers\n112-117 0x70-0x75 Switch Engine’s MAC Address Registers\n118-120 0x76-0x78 User Defined Registers\n121-122 0x79-0x7A Indirect Access Control Registers123-131 0x7B-0x83 Indirect Data Registers\n142-153 0x8E-0x99 Station Address\n154-165 0x9A-0xA5 Egress Data Rate Limit\n166 0xA6 Device Mode Indicator\n167-170 0xA7-0xAA High Priority Packet Buffer Reserved\n171-174 0xAB-0xAE PM Usage Flow Control Select Mode\n175-186 0xAF-0xBA TXQ Split\n187-188 0xBB-0xBC Link Change Interrupt Register\n189 0xBD Force Pause Off Iteration Limit EnableTABLE 4-2: REGISTER DESC RIPTIONS (CONTINUED)\nBit Name R/W Description Default Reference\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 39KSZ8873MML\n4.4 Register Descriptions192 0xC0 Fiber Signal Threshold\n194 0xC2 Insert SRC PVID195 0xC3 Power Management and LED Mode\n196 0xC4 Sleep Mode\n198 0xC6 Forward Invalid VID Frame and Host Mode\nTABLE 4-6: GLOBAL REGISTERS (0-15)\nBit Name R/W Description Default\nRegister 0 (0x00): Chip ID0\n7-0 Family ID RO Chip family 0x88\nRegister 1 (0x01): Chip ID1/Start Switch\n7-4 Chip ID RO 0x3 is assigned to M series. (73M) 0x3\n3-1 Revision ID RO Revision ID —\n0 Start Switch R/W1 = Start the s witch (default)\n0 = Stop the switch1\nRegister 2 (0x02): Global Control 0\n7New Back-Off \nEnableR/WNew back-off algorithm designed for UNH\n1 = Enable\n0 = Disable0\n6 Reserved RO Reserved 05Flush Dynamic MAC \nTableR/W1 = Enable flush dynamic MAC table for spanning tree \napplication\n0 = Disable0\n4Flush Static MAC \nTableR/W1 = Enable flush static MAC table for spanning tree \napplication\n0 = Disable0\n3Pass Flow Control \nPacketR/W1 = Switch will pass 802.1x flow control packets\n0 = Switch will drop 802.1x flow control packets0\n2 Reserved R/WReserved\nDo not change the default value.0\n1 Reserved R/WReserved\nDo not change the default value.0\n0 Reserved RO Reserved 0\nRegister 3 (0x03): Global Control 1\n7 Pass All Frames R/W1 = Switch all packets including bad ones. Used solely \nfor debugging purposes. Works in conjunction with \nsniffer mode only.0\n6Port 3 Tail Tag Mode \nEnableR/W1 = Enable port 3 tail tag mode.\n0 = Disable.0\n5IEEE 802.3x \nTransmit Direction Flow Control EnableR/W1 = Will enable transmit direction flow control feature.\n0 = Will not enable transmit direction flow control fea-\nture. Switch will not generate any flow control \n(PAUSE) frame.1TABLE 4-5: ADVANCED CONTROL REGISTERS (CONTINUED)\nRegister (Decimal) Register (Hex) Description\nKSZ8873MML\nDS00002776A-page 40  \uf0e3 2018 Microchip Technology Inc.4IEEE 802.3x \nReceive Direction \nFlow Control EnableR/W1 = Will enable receive direction flow control feature.\n0 = Will not enable receive direction flow control fea-ture. Switch will not react to any flow control (PAUSE) \nframe it receives.1\n3Frame Length Field \nCheckR/W1 = Will check frame length field in the IEEE packets. \nIf the actual length does not match, the packet will be \ndropped (for Length/Type field < 1500).0 = Will not check0\n2 Aging Enable R/W1 = Enable age function in the chip\n0 = Disable age function in the chip1\n1 Fast Age Enable R/W 1 = Turn on fast age (800 µs) 0\n0Aggressive Back-Off \nEnableR/W1 = Enable more aggressive back off algorithm in half-\nduplex mode to enhance performance. This is not an IEEE standard.0\nRegister 4 (0x04): Global Control 2\n7Unicast Port-VLAN \nMismatch DiscardR/WThis feature is used with port-VLAN (described in reg. \n17, reg. 33, etc.)\n1 = All packets cannot cross VLAN boundary\n0 = Unicast packets (excluding unkown/multicast/ broadcast) can cross VLAN boundary\nNote: Port mirroring is not supported if this bit is set to \n“0”.1\n6Multicast Storm \nProtection DisableR/W1 = Broadcast Storm Protection does not include \nmulticast packets. Only DA = FF-FF-FF-FF-FF-FF \npackets will be regulated.0 = Broadcast Storm Protection includes DA = FF-FF-\nFF-FF-FF-FF and DA[40] = 1 packets.1\n5 Back Pressure Mode R/W1 = Carrier sense based back pressure is selected\n0 = Collision based back pressure is selected1\n4Flow Control and \nBack Pressure Fair \nModeR/W1 = Fair mode is selected. In this mode, if a flow con-\ntrol port and a non-flow control port talk to the same destination port, packets from the non-flow control \nport may be dropped. This is to prevent the flow con-\ntrol port from being flow controlled for an extended period of time.\n0 = In this mode, if a flow control port and a non-flow \ncontrol port talk to the same destination port, the flow control port will be flow controlled. This may not be \n“fair” to the flow control port.1\n3No Excessive \nCollision DropR/W1 = The switch will not drop packets when 16 or more \ncollisions occur.\n0 = The switch will drop packets when 16 or more col-\nlisions occur.0\n2Huge Packet \nSupportR/W1 = Will accept packet sizes up to 1916 bytes (inclu-\nsive). This bit setting will override setting from bit 1 of \nthis register.\n0 = The max packet size will be determined by bit 1 of \nthis register.0\n1Legal Maximum \nPacket Size Check EnableR/W0 = Will accept packet sizes up to 1536 bytes (inclu-\nsive).\n1 = 1522 bytes for tagged packets, 1518 bytes for untagged packets. Any packets larger than the speci-\nfied value will be dropped.0TABLE 4-6: GLOBAL REGIST ERS (0-15) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 41KSZ8873MML\n0 Reserved R/WReserved\nDo not change the default value.0\nRegister 5 (0x05): Global Control 3\n7802.1Q VLAN \nEnableR/W1 = 802.1Q VLAN mode is turned on. VLAN table \nneeds to set up before the operation.\n0 = 802.1Q VLAN is disabled.0\n6IGMP Snoop Enable \non Switch MII \nInterfaceR/W1 = IGMP snoop is enabled. All IGMP packets will be \nforwarded to the Switch MII port.\n0 = IGMP snoop is disabled.0\n5 Reserved ROReserved\nDo not change the default values.0\n4 Reserved ROReserved\nDo not change the default values.0\n3Weighted Fair \nQueue EnableR/W0 = Priority method set by the registers 175-186 \nbit [7] = 0 for port 1, port 2, and port 3.\n1 = Weighted Fair Queuing enabled. When all four queues have packets waiting to transmit, the band-\nwidth allocation is q3:q2:q1:q0 = 8:4:2:1.\nIf any queues are empty, the highest non-empty queue gets one more weighting. For example, if q2 is \nempty, q3:q2:q1:q0 becomes (8+1):0:2:1.0\n2 Reserved ROReserved\nDo not change the default values.0\n1 Reserved ROReserved\nDo not change the default values.0\n0 Sniff Mode Select R/W1 = Will do RX AND TX sniff (both source port and \ndestination port need to match)\n0 = Will do RX OR TX sniff (either source port or des-tination port needs to match). This is the mode used \nto implement RX only sniff.0\nRegister 6 (0x06): Global Control 4\n7 Reserved ROReserved\nDo not change the default values.0\n6Switch MII Half-\nDuplex ModeR/W1 = Enable Port 3 MII to half-duplex mode.\n0 = Enable Port 3 MII to full-duplex mode.\nDefaults:\nPort 3: Pin P1LED0 strap option.\nPull-up(1): Half -duplex mode\nPull-down(0): Full-duplex modeNote: P1LED0 has internal pull-down.\nPort 1: Pin SMRXD11 strap option.\nPull-up(1): Full -duplex modePull-down(0): Half-duplex mode\nNote: SMRXD11 has internal pull-up.0TABLE 4-6: GLOBAL REGIST ERS (0-15) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 42  \uf0e3 2018 Microchip Technology Inc.5Switch MII Flow \nControl EnableR/W1 = Enable full-duplex flow control on Switch port 3 \nMII interface.0 = Disable full-duplex flow control on Switch port 3 \nMII interface.\nDefaults:\nPort 3: Pin P1LED1 strap option.Pull- up(1): Enab le flow control\nPull-down(0): Disable flow control \nNote: P1LED1 has internal pull-up.Port 1: Pin SMRXD10 \nPull- up(1): Enab le flow control\nPull-down(0): Disable flow control Note: SMRXD10 has internal pull-up.1\n4 Switch MII 10BT R/W1 = The Port 3 MII switch interface is in 10 Mbps \nmode0 = The Port 3 MII switch interface is in 100 Mbps \nmode\nDefaults:\nPort 3: Pin SMRXDV1 (P3SPD) strap option.\nPull-up(1): Enable 10 MbpsPull-down(0): Enable 100 Mbps\nNote: SMRXDV1 (P3SPD) has internal pull-down.\nPort 1: Pin SMRXD12 (P1SPD) strap option.Pull-up(1): Enable 100 Mbps\nPull-down(0): enable 10 Mbps\nNote: SMRXD12 has internal pull-up.0\n3Null VID \nReplacementR/W1 = Will replace NULL VID with port VID (12 bits)\n0 = No replacement for NULL VID0\n2-0Broadcast Storm \nProtection Rate\nBit [10:8]R/WThis register along with the next register determines \nhow many “64 byte blocks” of packet data are allowed \non an input port in a preset period. The period is \n67 ms for 100BT or 500 ms for 10BT. The default is 1%.000\nRegister 7 (0x07): Global Control 5\n7-0Broadcast Storm \nProtection RateBit [7:0]R/WThis register along with the previous register deter-\nmines how many “6 4 byte blocks” of packet data are \nallowed on an input port in a preset period. The period \nis 67 ms for 100BT or 500 ms for 10BT. The default is 1%.\nNote: 100BT Rate: 148,800 frames/sec * 67 ms/inter-\nval * 1% = 99 frames/interval (approx.) = 0x630x63\nRegister 8 (0x08): Global Control 6\n7-0 Factory Testing ROReserved\nDo not change the default values.0x00\nRegister 9 (0x09): Global Control 7\n7-0 Factory Testing ROReserved\nDo not change the default values.0x24\nRegister 10 (0x0A): Global Control 8\n7-0 Factory Testing ROReserved\nDo not change the default values.0x35TABLE 4-6: GLOBAL REGIST ERS (0-15) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 43KSZ8873MML\nRegister 11 (0x0B): Global Control 9\n7-6CPU Interface Clock \nSelectionR/W00 = 31.25 MHz supports SPI speed below 6 MHz\n01 = 62.5 MHz supports SPI speed between 6 MHz to \n12.5 MHz\n10 = 125 MHz supports SPI speed above 12.5 MHz\nNote: Lower clock speed will save more power; It is \nbetter set to 31.25 MHz if SPI doesn’t request a high \nspeed.10\n5-4 Reserved RO N/A Don’t Change 00\n3-2 Reserved RO N/A Don’t Change 10\n1 Reserved RO N/A Don’t Change 0\n0 Reserved RO N/A Don’t Change 0\nRegister 12 (0x0C): Global Control 10\n7-6 Tag_0x3 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x3.01\n5-4 Tag_0x2 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x2.01\n3-2 Tag_0x1 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x1.00\n1-0 Tag_0x0 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x0.00\nRegister 13 (0x0D): Global Control 11\n7-6 Tag_0x7 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x7.11\n5-4 Tag_0x6 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x6.11\n3-2 Tag_0x5 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x5.10\n1-0 Tag_0x4 R/WIEEE 802.1p mapping. The value in this field is used \nas the frame’s priority wh en its IEEE 802.1 p tag has a \nvalue of 0x4.10\nRegister 14 (0x0E): Global Control 12\n7Unknown Packet \nDefault Port EnableR/WSend packets with unknown destination MAC \naddresses to specified port(s) in bits [2:0] of this regis-\nter.\n0 = Disable1 = Enable0\n6Drive Strength of I/O \nPadR/W1 = 16 mA\n0 = 8 mA1\n5 Reserved ROReserved\nDo not change the default values.0\n4 Reserved ROReserved\nDo not change the default values.0TABLE 4-6: GLOBAL REGIST ERS (0-15) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 44  \uf0e3 2018 Microchip Technology Inc.3 Reserved ROReserved\nDo not change the default values.0\n2-0Unknown Packet \nDefault PortR/WSpecify which port(s) to send packets with unknown \ndestination MAC addresses. This feature is enabled \nby bit [7] of this register.\nBit 2 stands for port 3.\nBit 1 stands for port 2.Bit 0 stands for port 1.\nA ‘1’ includes a port.\nA ‘0’ excludes a port.111\nRegister 15 (0x0F): Global Control 13\n7-3 PHY Address R/W00000: N/A\n00001: Port 1 PHY address is 0x1\n00010: Port 1 PHY address is 0x2\n…11101: Port 1 PHY address is 0x29\n11110: N/A\n11111: N/A\nNote:\nPort 2 PHY address = (Port 1 PHY address) + 100001\n2-0 Reserved ROReserved\nDo not change the default values.000TABLE 4-6: GLOBAL REGIST ERS (0-15) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 45KSZ8873MML\nThe following registers are used to enable features that ar e assigned on a per port basis. The register bit assignments\nare the same for all ports, but the address for each port is different, as indicated.\nTABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95)\nBit Name R/W Description Default\nRegister 16 (0x10): Port 1 Control 0\nRegister 32 (0x20): Port 2 Control 0\nRegister 48 (0x30): Port 3 Control 0\n7Broadcast Storm \nProtection EnableR/W1 = Enable broadcast storm protection for ingress \npackets on port\n0 = Disable broadcast storm protection0\n6DiffServ Priority \nClassification EnableR/W1 = Enable DiffServ priority classification for ingress \npackets (IPv4) on port\n0 = Disable DiffServ function0\n5802.1p Priority Clas-\nsification EnableR/W1 = Enable 802.1p priority classification for ingress \npackets on port\n0 = Disable 802.1p0\n4-3Port-based Priority \nClassificationR/W00 = Ingress packets on port will be\nclassified as priority 0 queue if “Diffserv” or “802.1p” \nclassification is not enabled or fails to classify.\n01 = Ingress packets on port will be classified as priority 1 queue if “Diffserv” or “802.1p” \nclassification is not enabled or fails to classify.\n10 = Ingress packets on port will beclassified as priority 2 queue if “Diffserv” or “802.1p” \nclassification is not enabled or fails to classify.\n11 = Ingress packets on port will be classified as priority 3 queue if “Diffserv” or “802.1p” \nclassification is not enabled or fails to classify.\nNote: “DiffServ,” “802.1p,” and port priority can be enabled at the same time. The OR’ed result of 802.1p \nand DSCP overwrites the port priority.00\n2 Tag Insertion R/W1 = When packets are output on the port, the switch \nwill add 802.1p/q tags to packets without 802.1p/q \ntags when received. The s witch will not add tags to \npackets already tagged. The tag inserted is the ingress port’s “port VID”.\n0 = Disable tag insertion\nNote: For the tag insertion available, the register 194 bits [5:0] have to be set first.0\n1 Tag Removal R/W1 = When packets are output on the port, the switch \nwill remove 802.1p/q tags from packets with 802.1p/q tags when received. The switch will not modify pack-\nets received without tags.\n0 = Disable tag removal0\n0 TXQ Split Enable R/W1 = Split TXQ to 4 queue configuration. It cannot be \nenable at the same time with split 2 queue at register \n18, 34, 50 bit 7.0 = No split, treated as 1 queue configuration0\nRegister 17 (0x11): Port 1 Control 1\nRegister 33 (0x21): Port 2 Control 1\nRegister 49 (0x31): Port 3 Control 1\n7 Sniffer Port R/W1 = Port is designated as sniffer port and will transmit \npackets that are monitored.\n0 = Port is a normal port0\nKSZ8873MML\nDS00002776A-page 46  \uf0e3 2018 Microchip Technology Inc.6 Receive Sniff R/W1 = All packets received on the port will be marked as \n“monitored packets” and forwarded to the designated “sniffer port”\n0 = No receive monitoring0\n5 Transmit Sniff R/W1 = All packets transmitted on the port will be marked \nas “monitored packets” and forwarded to the desig-\nnated “sniffer port”0 = No transmit monitoring0\n4 Double Tag R/W1 = All packets will be tagged with port default tag of \ningress port regardless of the original packets are tagged or not\n0 = Do not double tagged on all packets0\n3 User Priority Ceiling R/W1 = If the packet’s “user priori ty field” is greater than \nthe “user priority field” in the port default tag register, \nreplace the packet’s “user priority field” with the “user \npriority field” in the port default tag register.0 = Do not compare and replace the packet’s ‘user \npriority field”0\n2-0Port VLAN \nMembershipR/WDefine the port’s egress port VLAN membership. The \nport can only communicate within the membership. Bit \n2 stands for port 3, bit 1 stands for port 2, bit 0 stands \nfor port 1.A ‘1’ includes a port in the membership.\nA ‘0’ excludes a port from membership.111\nRegister 18 (0x12): Port 1 Control 2\nRegister 34 (0x22): Port 2 Control 2\nRegister 50 (0x32): Port 3 Control 2\n7Enable 2 Queue Split \nof Tx QueueR/W1 = Enable\nIt cannot be enable at the same time with split 4 \nqueue at register 16, 32, and 48 bit 0.\n0 = Disable0\n6Ingress VLAN \nFilteringR/W1 = The switch will discard packets whose VID port \nmembership in VLAN table bits [18:16] does not \ninclude the ingress port.0 = No ingress VLAN filtering.0\n5Discard non-PVID \nPacketsR/W1 = The switch will discard packets whose VID does \nnot match ingress port default VID.0 = No packets will be discarded0\n4 Force Flow Control R/W1 = Will always enable full-duplex flow control on the \nport, regardless of AN result.\n0 = Full-duplex flow control is enabled based on AN result.Pin value during \nreset:\nFor port 1, \nP1FFC pin \nFor port 2, \nSMRXD30 pin \nFor port 3, this \nbit has no \nmeaning. Flow \ncontrol is set by \nReg. 6 bit 5.\n3Back Pressure \nEnableR/W1 = Enable port’s half-duplex back pressure\n0 = Disable port’s half-duplex back pressure0TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 47KSZ8873MML\n2 Transmit Enable R/W1 = Enable packet transmission on the port\n0 = Disable packet transmission on the portNote: This bit is used for spanning tree support.1\n1 Receive Enable R/W1 = Enable packet reception on the port\n0 = Disable packet reception on the port\nNote: This bit is used for spanning tree support.1\n0 Learning Disable R/W1 = Disable switch address learning capability\n0 = Enable switch address learning\nNote: This bit is used for spanning tree support.0\nRegister 19 (0x13): Port 1 Control 3\nRegister 35 (0x23): Port 2 Control 3\nRegister 51 (0x33): Port 3 Control 3\n7-0 Default Tag [15:8] R/WPort’s default tag, containing\n7-5 = User priority bits\n4 = CFI bit\n3-0 = VID[11:8]0x00\nRegister 20 (0x14): Port 1 Control 4\nRegister 36 (0x24): Port 2 Control 4\nRegister 52 (0x34): Port 3 Control 4\n7-0 Default Tag [7:0] R/W Port’s default  tag, containing 7-0: VID[7:0] 0x01\nNote: Registers 19 and 20 (and those corresp onding to other ports) serve two purposes:\nAssociated with the ingress untagged packets, and used for egress tagging.Default VID for the ingress untagged or null- VID-tagged packets, and used for address lookup.\nRegister 21 (0x15): Port 1 Control 5\nRegister 37 (0x25): Port 2 Control 5Register 53 (0x35): Port 3 Control 5\n7Port 1 or Port 3 MII \nMode SelectionR/W1 = Port 3 MII MAC mode\n0 = Port 3 MII PHY mode\nNote: Bit 7 is reserved in the port 2.0\nInversion of \npower strapped \nvalue of \nSMRXD13 \n(Port 1) and\nSMRXDV3 \n(Port 3).\n6Self-Address Filter-\ning Enable MACA1\n(not for 0x35)R/W1 = Enable port 1 self -address filtering MACA1\n0 = Disable\nNote: Port 1 MII connect to an external PHY for KSZ8873MML.0\n5Self-Address Filter-\ning Enable MACA2(not for 0x35)R/W1 = Enable port 2 self -address filtering MACA2\n0 = Disable0\n4Drop Ingress Tagged \nFrameR/W1 = Enable\n0 = Disable0\n3-2 Limit Mode R/WIngress Limit Mode\nThese bits determine what ki nds of frames are limited \nand counted against ingress rate limiting.\n00 = Limit and count all frames\n01 = Limit and count Broadcast, Multicast, and flooded unicast frames\n10 = Limit and count Broadcast and Multicast frames \nonly11 = Limit and count Broadcast frames only00TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 48  \uf0e3 2018 Microchip Technology Inc.1 Count IFG R/WCount IFG bytes\n1 = Each frame’s minimum inter frame gap(IFG) bytes (12 per frame) are included in Ingress and \nEgress rate limiti ng calculations.\n0 = IFG bytes are not counted.0\n0 Count Pre R/WCount Preamble bytes\n1 = Each frame’s preamble bytes (8 per frame) are included in Ingress and Egress rate limiting calcula-\ntions.\n0 = Preamble bytes are not counted.0\nRegister 22 [6:0] (0x16): Port 1 Q0 Ingress Data Rate Limit\nRegister 38 [6:0] (0x26): Port 2 Q0 Ingress Data Rate Limit\nRegister 54 [6:0] (0x36): Port 3 Q0 Ingress Data Rate Limit\n7 Reserved RO Reserved 0\n6-0Q0 Ingress Data \nRate Limit R/WIngress data rate limit for priority 0 frames\nIngress traffic from this priority queue is shaped according to the ingress Data Rate Selected Table.0\nRegister 23 [6:0] (0x17): Port 1 Q1 Ingress Data Rate Limit\nRegister 39 [6:0] (0x27): Port 2 Q1 Ingress Data Rate LimitRegister 55 [6:0] (0x37): Port 3 Q1 Ingress Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q1 Ingress Data \nRate Limit R/WIngress data rate limit for priority 1 frames\nIngress traffic from this priority queue is shaped \naccording to the ingress Data Rate Selected Table.0\nRegister 24 [6:0] (0x18): Port 1 Q2 Ingress Data Rate Limit\nRegister 40 [6:0] (0x28): Port 2 Q2 Ingress Data Rate Limit\nRegister 56 [6:0] (0x38): Port 3 Q2 Ingress Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q2 Ingress Data \nRate Limit R/WIngress data rate limit for priority 2 frames\nIngress traffic from this priority queue is shaped \naccording to ingress Data Rate Selection Table.0\nRegister 25 [6:0] (0x19): Port 1 Q3 Ingress Data Rate Limit\nRegister 41 [6:0] (0x29): Port 2 Q3 Ingress Data Rate Limit\nRegister 57 [6:0] (0x39): Port 3 Q3 Ingress Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q3 Ingress Data \nRate Limit R/WIngress data rate limit for priority 3 frames\nIngress traffic from this priority queue is shaped according to ingress Data Rate Selection Table.0\nNote: Most of the contents in registers 26-31 and regi sters 42-47 for ports 1 and 2, respectively, can also be \naccessed with the MIIM PHY registers.\nRegister 26 (0x1A): Port 1, Not Supported\nRegister 42 (0x2A): Port 2 PHY Special Control/Status\nRegister 58 (0x3A): Reserved, Not Applicable to Port 3\n7 Vct 10M Short RO 1 = Less than 10 meter short 0\n6-5 Vct_result RO00 = Normal condition\n01 = Open condition detected in cable\n10 = Short condition detected in cable\n11 = Cable diagnostic test has failed00TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 49KSZ8873MML\n4 Vct_enR/W\n(SC)1 = Enable cable diagnostic test. After VCT test has \ncompleted, this bit will be self-cleared.0 = Indicate cable diagnostic test (if enabled) has \ncompleted and the status information is valid for read.0\n3 Force_lnk R/W1 = Force link pass\n0 = Normal Operation0\n2 Reserved ROReserved\nDo not change the default value.1\n1 Remote Loopback R/W1 = Perform Remote loopback, as follows:\nPort 2 (reg. 42, bit 1 = ‘1’)Start: RXP2/RXM2 (port 2)\nLoopback: PMD/PMA of port 2’s PHY\nEnd: TXP2/TXM2 (port 2)0 = Normal Operation0\n0 Vct_fault_count[8] ROBit[8] of VCT fault count\nDistance to the fault. It’s approximately 0.4m*vct_fault_count[8:0]0\nRegister 27 (0x1B): Port 1, Not Supported\nRegister 43 (0x2B): Port 2 LinkMD ResultRegister 59 (0x3B): Reserved, Not Applicable to Port 3\n7-0 Vct_fault_count[7:0] ROBits[7:0] of VCT fault count\nDistance to the fault.It’s approximately 0.4m*Vct_fault_count[8:0]0x00\nRegister 28 (0x1C): Port 1, Not Supported\nRegister 44 (0x2C): Port 2 Control 12Register 60 (0x3C): Reserved, Not Applicable to Port 3\n7Auto Negotiation \nEnableR/W1 = Auto negotiation is on\n0 = Disable auto negotiation; speed and duplex are determined by bits 6 and 5 of this register.1\nFor port 1, \nP1ANEN pin \nvalue during \nreset.\nFor port 2, \nSMRXD33 pin \nvalue during \nreset\n6 Force Speed R/W1 = Forced 100BT if AN is disabled (bit 7)\n0 = Forced 10BT if AN is disabled (bit 7)1\nFor port 1, \nP1SPD pin \nvalue during \nreset.\nFor port 2, \nSMRXD32 pin \nvalue during \nreset.\n5 Force Duplex R/W1 = Forced full-duplex if (1) AN is disabled or (2) AN is \nenabled, but failed.\n0 = Forced half-duplex if (1) AN is disabled or (2) AN is enabled, but failed.\nNote: This bit or strap pin sh ould be set to ‘0’ for the \ncorrect duplex mode indication of LED and register status when the link-up is AN to force mode.1\nFor port 1, \nP1DPX pin \nvalue during \nreset.\nFor port 2, \nSMRXD31 pin \nvalue during \nreset.TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 50  \uf0e3 2018 Microchip Technology Inc.4Advertise Flow \nControl CapabilityR/W1 = Advertise flow control (pause) capability\n0 = Suppress flow control (pause) capability from transmission to link partner1\n3Advertise 100BT \nFull-Duplex \nCapabilityR/W1 = Advertise 100BT full-duplex capability\n0 = Suppress 100BT full-duplex capability from trans-\nmission to link partner1\n2Advertise 100BT \nHalf-Duplex \nCapabilityR/W1 = Advertise 100BT half-duplex capability\n0 = Suppress 100BT half-duplex capability from trans-\nmission to link partner1\n1Advertise 10BT Full-\nDuplex CapabilityR/W1 = Advertise 10BT full-duplex capability\n0 = Suppress 10BT full-duplex capability from trans-\nmission to link partner1\n0Advertise 10BT Half-\nDuplex CapabilityR/W1 = Advertise 10BT half-duplex capability\n0 = Suppress 10BT half-duplex capability from trans-\nmission to link partner1\nRegister 29 (0x1D): Port 1, Not Supported\nRegister 45 (0x2D): Port 2 Control 13\nRegister 61 (0x3D): Reserved, Not Applicable to Port 3\n7 LED Off R/W1 = Turn off all port’s LE Ds (LEDx_1, LEDx_0, where \n“x” is the port number). These pins will be driven high \nif this bit is set to ‘1’.\n0 = Normal operation0\n6 Txdis R/W1 = Disable the port’s transmitter\n0 = Normal operation0\n5R e s t a r t  A N R / W1 = Restart auto-negotiation\n0 = Normal operation0\n4Disable Far-End \nFaultR/W1 = Disable far-end fault detection and pattern trans-\nmission.0 = Enable far-end fault detection and pattern trans-\nmission0\n3 Power Down R/W1 = Power down\n0 = Normal operation0\n2Disable Auto MDI/\nMDI-XR/W1 = Disable auto MDI/MDI-X function\n0 = Enable auto MDI/MDI-X function0\n1F o r c e  M D I R / W If auto MDI/MDI-X is disabled,\n1 = Force PHY into MDI mo de (transmit on RXP/RXM \npins)0 = Force PHY into MDI-X mode (transmit on TXP/\nTXM pins)0\n0 Loopback R/W1 = Perform loopback, as indicated:\nPort 2 Loopback (reg. 45, bit 0 = ‘1’)\nStart: RXP1/RXM1 (port 1)\nLoopback: PMD/PMA of port 2’s PHYEnd: TXP1/TXM1 (port 1)\n0 = Normal operation0\nRegister 30 (0x1E): Port 1, Not Supported\nRegister 46 (0x2E): Port 2 Status 0\nRegister 62 (0x3E): Reserved, Not Applicable to Port 3\n7 MDI-X Status RO1 = MDI\n0 = MDI-X0\n6 AN Done RO1 = Auto-negotiation completed\n0 = Auto-negotiation not completed0TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 51KSZ8873MML\n5 Link Good RO1 = Link good\n0 = Link not good0\n4Partner Flow Con-\ntrol CapabilityRO1 = Link partner flow control (pause) capable\n0 = Link partner not flow control (pause) capable0\n3Partner 100BT Full-\nDuplex CapabilityRO1 = Link partner 100BT full-duplex capable\n0 = Link partner not 100BT full-duplex capable0\n2Partner 100BT Half-\nDuplex CapabilityRO1 = Link partner 100BT half-duplex capable\n0 = Link partner not 100BT half-duplex capable0\n1Partner 10BT Full-\nDuplex CapabilityRO1 = Link partner 10BT full-duplex capable\n0 = Link partner not 10BT full-duplex capable0\n0Partner 10BT Half-\nDuplex CapabilityRO1 = Link partner 10BT half-duplex capable\n0 = Link partner not 10BT half-duplex capable0\nRegister 31 (0x1F): Port 1 Status 1 for SPD/DPX\nRegister 47 (0x2F): Port 2 Status 1\nRegister 63 (0x3F): Port 3 Status 1 for SPD/DPX\n7 Hp_mdix R/W1 = HP Auto MDI/MDI-X mode\n0 = Microchip Auto MDI/MDI-X mode1\nNote: Only port  \n2 is a PHY port.\nThis bit is not \napplicable to \nport 1 and port 3 \n(MII).\n6 Reserved ROReserved\nDo not change the default value.0\n5P o l r v s R O1 = Polarity is reversed\n0 = Polarity is not reversed0\nNote: This bit is \nnot applicable to \nport 1 and port 3 \n(MII).\nThis bit is only \nvalid for 10BT\n4Transmit Flow \nControl EnableRO1 = Transmit flow control feature is active\n0 = Transmit flow control feature is inactive0\n3Receive Flow \nControl EnableRO1 = Receive flow control feature is active\n0 = Receive flow control feature is inactive0\n2 Operation Speed RO1 = Link speed is 100 Mbps\n0 = Link speed is 10 Mbps0\n1 Operation Duplex RO1 = Link duplex is full\n0 = Link duplex is half0\n0 Far-End Fault RO1 = Far-end fault status detected\n0 = No far-end fault status detected0\nNote: This bit is \napplicable to \nport 2 only.\nRegister 67 (0x43): Reset\n7-5 Reserved RO Reserved 111\n4 Software Reset R/W1 = Software reset\n0 = Clear\nNote: Software reset will reset all registers to the initial \nvalues of the power-on reset or warm reset (keep the \nstrap values).0\n3-1 Reserved RO Reserved 000TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 52  \uf0e3 2018 Microchip Technology Inc.0P C S  R e s e t R / W1 = PCS reset is used when is doing software reset \nfor a complete reset0 = Clear\nNote: PCS reset will reset the state machine and \nclock domain in PHY’s PCS layer.0\nTABLE 4-8: DATA RATE LIMIT\nData Rate Limit for \nIngress or Egress100BT\nRegister Bit[6:0], Q = 0...310BT\nRegister Bit[6:0], Q = 0...3\n—1 to 0x63 for 1 Mbps to 99 Mbps Rate 1 to 0x09 for 1 Mbps to 9 Mbps Rate\n0 or 0x64 for 100 Mbps Rate 0 or 0x0A for 10 Mbps Rate\n64 kbps 0x65\n128 kbps 0x66\n192 kbps 0x67256 kbps 0x68\n320 kbps 0x69\n384 kbps 0x6A448 kbps 0x6B\n512 kbps 0x6C\n576 kbps Data 0x6D640 kbps 0x6E\n704 kbps 0x6F\n768 kbps 0x70832 kbps 0x71\n896 kbps 0x72\n960 kbps 0x73TABLE 4-7: PORT REGISTERS (REGISTERS 16 - 95) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 53KSZ8873MML\n4.5 Advanced Control Registers (Registers 96-198)\nThe IPv4/IPv6 Type of Service (TOS) Pr iority Control Registers implement a fu lly decoded, 128-bit Differentiated Ser-\nvices Code Point (DSCP) register set that is used to determine priority from the TOS field in the IP header. The most\nsignificant 6 bits of the TOS field are fully decoded into 64 possibilities, and the singular code that results is compared\nagainst the corresponding bits in the DS CP register to determine the priority.\nTABLE 4-9: ADVANCED CONTROL REGISTERS (REGISTERS 96-198)\nBit Name R/W Description Default\nRegister 96 (0x60): TOS Priority Control Register 0\n7-6 DSCP[7:6] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x03.00\n5-4 DSCP[5:4] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x02.00\n3-2 DSCP[3:2] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x01.00\n1-0 DSCP[1:0] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x00.00\nRegister 97 (0x61): TOS Priority Control Register 1\n7-6 DSCP[15:14] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x07.00\n5-4 DSCP[13:12] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x06.00\n3-2 DSCP[11:10] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x05.00\n1-0 DSCP[9:8] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x04.00\nRegister 98 (0x62): TOS Priority Control Register 2\n7-6 DSCP[23:22] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x0B.00\n5-4 DSCP[21:20] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x0A.00\n3-2 DSCP[19:18] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x09.00\n1-0 DSCP[17:16] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x08.00\nRegister 99 (0x63): TOS Priority Control Register 3\n7-6 DSCP[31:30] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x0F.00\nKSZ8873MML\nDS00002776A-page 54  \uf0e3 2018 Microchip Technology Inc.5-4 DSCP[29:28] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x0E.00\n3-2 DSCP[27:26] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x0D.00\n1-0 DSCP[25:24] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x0C.00\nRegister 100 (0x64): TOS Priority Control Register 4\n7-6 DSCP[39:38] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x13.00\n5-4 DSCP[37:36] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x12.00\n3-2 DSCP[35:34] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x11.00\n1-0 DSCP[33:32] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x10.00\nRegister 101 (0x65): TOS Priority Control Register 5\n7-6 DSCP[47:46] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x17.00\n5-4 DSCP[45:44] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x16.00\n3-2 DSCP[43:42] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x15.00\n1-0 DSCP[41:40] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x14.00\nRegister 102 (0x66): TOS Priority Control Register 6\n7-6 DSCP[55:54] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1B.00\n5-4 DSCP[53:52] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1A.00\n3-2 DSCP[51:50] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x19.00\n1-0 DSCP[49:48] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x18.00TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 55KSZ8873MML\nRegister 103 (0x67): TOS Priority Control Register 7\n7-6 DSCP[63:62] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1F.00\n5-4 DSCP[61:60] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1E.00\n3-2 DSCP[59:58] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1D.00\n1-0 DSCP[57:56] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x1C.00\nRegister 104 (0x68): TOS Priority Control Register 8\n7-6 DSCP[71:70] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x23.00\n5-4 DSCP[69:68] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x22.00\n3-2 DSCP[67:66] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x21.00\n1-0 DSCP[65:64] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x20.00\nRegister 105 (0x69): TOS Priority Control Register 9\n7-6 DSCP[79:78] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x27.00\n5-4 DSCP[77:76] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x26.00\n3-2 DSCP[75:74] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x25.00\n1-0 DSCP[73:72] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x24.00\nRegister 106 (0x6A): TOS Priority Control Register 10\n7-6 DSCP[87:86] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2B.00\n5-4 DSCP[85:84] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2A.00\n3-2 DSCP[83:82] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x29.00TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 56  \uf0e3 2018 Microchip Technology Inc.1-0 DSCP[81:80] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x28.00\nRegister 107 (0x6B): TOS Pr iority Control Register 11\n7-6 DSCP[95:94] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2F.00\n5-4 DSCP[93:92] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2E.00\n3-2 DSCP[91:90] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2D.00\n1-0 DSCP[89:88] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x2C.00\nRegister 108 (0x6C): TOS Priority Control Register 12\n7-6 DSCP[103:102] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x33.00\n5-4 DSCP[101:100] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x32.00\n3-2 DSCP[99:98] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x31.00\n1-0 DSCP[97:96] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x30.00\nRegister 109 (0x6D): TOS Priority Control Register 13\n7-6 DSCP[111:110] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x37.00\n5-4 DSCP[109:108] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x36.00\n3-2 DSCP[107:106] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x35.00\n1-0 DSCP[105:104] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x34.00\nRegister 110 (0x6E): TOS Priority Control Register 14\n7-6 DSCP[119:118] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x3B.00\n5-4 DSCP[117:116] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x3A.00TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 57KSZ8873MML\n3-2 DSCP[115:114] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic Class value is 0x39.00\n1-0 DSCP[113:112] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x38.00\nRegister 111 (0x6F): TOS Priority Control Register 15\n7-6 DSCP[127:126] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x3F.00\n5-4 DSCP[125:124] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x3E.00\n3-2 DSCP[123:122] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x3D.00\n1-0 DSCP[121:120] R/WThe value in this field is used as the frame’s priority \nwhen bits [7:2] of the frame’s IP TOS/DiffServ/Traffic \nClass value is 0x3C.00\nRegisters 112 to 117 contain the switch engine’s MAC addre ss. This 48-bit address is used as the Source Address \nfor the MAC’s full duplex flow control (PAUSE) frame.\nRegister 112 (0x70): MAC Address Register 0\n7-0 MACA[47:40] R/W — 0x00\nRegister 113 (0x71): MAC Address Register 1\n7-0 MACA[39:32] R/W — 0x10\nRegister 114 (0x72): MAC Address Register 2\n7-0 MACA[31:24] R/W — 0xA1\nRegister 115 (0x73): MAC Address Register 3\n7-0 MACA[23:16] R/W — 0xFF\nRegister 116 (0x74): MAC Address Register 4\n7-0 MACA[15:8] R/W — 0xFF\nRegister 117 (0x75): MAC Address Register 5\n7-0 MACA[7:0] R/W — 0xFF\nRegisters 118 to 120 are User Defined Registers (UDRs). T hese are general purpose read/write registers that can be \nused to pass user defined control and status informati on between the KSZ8873 and the external processor.\nRegister 118 (0x76): User Defined Register 1\n7-0 UDR1 R/W — 0x00\nRegister 119 (0x77): User Defined Register 2\n7-0 UDR2 R/W — 0x00\nRegister 120 (0x78): User Defined Register 3\n7-0 UDR3 R/W — 0x00\nRegisters 121 to 131 provide read and write access to th e static MAC address table,  VLAN table, dynamic MAC \naddress table, and MIB counters.\nRegister 121 (0x79): Indirect Access Control 0\n7-5 Reserved R/WReserved\nDo not change the default values.000\n4Read High/Write \nLowR/W1 = Read cycle\n0 = Write cycle0TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 58  \uf0e3 2018 Microchip Technology Inc.3-2 Table Select R/W00 = Static MAC address table selected\n01 = VLAN table selected10 = Dynamic MAC address table selected\n11 = MIB counter selected00\n1-0Indirect Address \nHighR/W Bits [9:8] of indirect address 00\nRegister 122 (0x7A): Indirect Access Control 1\n7-0 Indirect Address Low R/WBits [7:0] of indirect addre ss. Note: A write to register \n122 triggers the read/write command. Read or write \naccess is determined by register 121 bit 4.0000_0000\nRegister 123 (0x7B): Indirect Data Register 8\n7 CPU Read Status ROThis bit is applicable only for dynamic MAC address \ntable and MIB counter reads.1 = Read is still in progress\n0 = Read has completed0\n6-3 Reserved RO Reserved 0000\n2-0 Indirect Data [66:64] RO Bits [66:64] of indirect data 000\nRegister 124 (0x7C): Indirect Data Register 7\n7-0 Indirect Data [63:56] R/W Bits [ 63:56] of indirect data 0000_0000\nRegister 125 (0x7D): Indirect Data Register 6\n7-0 Indirect Data [55:48] R/W Bits [ 55:48] of indirect data 0000_0000\nRegister 126 (0x7E): Indirect Data Register 5\n7-0 Indirect Data [47:40] R/W Bits [ 47:40] of indirect data 0000_0000\nRegister 127 (0x7F): Indirect Data Register 4\n7-0 Indirect Data [39:32] R/W Bits [ 39:32] of indirect data 0000_0000\nRegister 128 (0x80): Indirect Data Register 3\n7-0 Indirect Data [31:24] R/W Bits [ 31:24] of indirect data 0000_0000\nRegister 129 (0x81): Indirect Data Register 2\n7-0 Indirect Data [23:16] R/W Bits [ 23:16] of indirect data 0000_0000\nRegister 130 (0x82): Indirect Data Register 1\n7-0 Indirect Data [15:8] R/W Bits [15:8] of indi rect data 0000_0000\nRegister 131 (0x83): Indirect Data Register 0\n7-0 Indirect Data [7:0] R/W Bits [7:0] of indirect data 0000_0000\nRegister 147~142 (0x93~0x8E): Station Address 1 MACA1\nRegister 153~148 (0x99~0x94): Station Address 2 MACA2\n47-0 Station Address R/W48-bit Station address MACA1 and MACA2.\nNote: The station address is used for self MAC \naddress filtering, see the port register control 5 bits \n[6,5] for detail.48’h0\nNote: the MSB \nbits[47-40] of \nthe MAC is the \nregister 147 and \n153. The LSB \nbits[7-0] of MAC \nis the register \n142 and 148.\nRegister 154[6:0] (0x9A): Port 1 Q0 Egress Data Rate Limit\nRegister 158[6:0] (0x9E): Port 2 Q0 Egress Data Rate Limit\nRegister 162[6:0] (0xA 2): Port 3 Q0 Egress  Data Rate Limit\n7Egress Rate Limit \nFlow Control EnableR/W1 = Enable egress rate limit flow control. \n0 = Disable0TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 59KSZ8873MML\n6-0Q0 Egress Data \nRate Limit R/WEgress data rate limit for priority 0 frames\nEgress traffic from this priority queue is shaped according to Table 4-8 .0\nRegister 155[6:0] (0x9B): Port 1 Q1 Egress Data Rate Limit\nRegister 159[6:0] (0x9F): Port 2 Q1 Egress Data Rate Limit\nRegister 163[6:0] (0xA 3): Port 3 Q1 Egress  Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q1 Egress Data \nRate Limit R/WEgress data rate limit for priority 1 frames\nEgress traffic from this priority queue is shaped according to Table 4-8 .0\nRegister 156[6:0] (0x9C): Port 1 Q2 Egress Data Rate Limit\nRegister 160[6:0] (0xA 0): Port 2 Q2 Egress  Data Rate Limit\nRegister 164[6:0] (0xA 4): Port 3 Q2 Egress  Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q2 Egress Data \nRate Limit R/WEgress data rate limit for priority 2 frames\nEgress traffic from this priority queue is shaped \naccording to Table 4-8 .0\nRegister 157[6:0] (0x9D): Port 1 Q3 Egress Data Rate Limit\nRegister 161[6:0] (0xA 1): Port 2 Q3 Egress  Data Rate Limit\nRegister 165[6:0] (0xA 5): Port 3 Q3 Egress  Data Rate Limit\n7 Reserved R/WReserved\nDo not change the default values.0\n6-0Q3 Egress Data \nRate Limit R/WEgress data rate limit for priority 3 frames\nEgress traffic from this priority queue is shaped \naccording to Table 4-8 .0\nRegister 166 (0xA6): KSZ8873 Family Mode Indicator\n7-0KSZ8873 Mode \nIndicator RObit7: 1 = 2 MII mode\nbit6: 1 = 48P pkg of 2 PHY mode \nbit5: 1 = Port 1 RMII           0 = Port 1 MIIbit4: 1 = Port 3 RMII           0 = Port 3 MII\nbit3: 1 = Port 1 MAC MII     0 = Port 1 PHY MII\nbit2: 1 = Port 3 MAC MII     0 = Port 3 PHY MIIbit1: 1 = Port 1 Copper       0 = Port 1 Fiber\nbit0: 1 = Port 2 Copper       0 = Port 2 Fiber 0x83\nRegister 167 (0xA7): High Priority Packet Buffer Reserved for Q3\n7-0 Reserved ROReserved\nDo not change the default values.0x45\nRegister 168 (0xA8): High Priority Packet Buffer Reserved for Q2\n7-0 Reserved ROReserved\nDo not change the default values.0x35\nRegister 169 (0xA9): High Priority Packet Buffer Reserved for Q1\n7-0 Reserved ROReserved\nDo not change the default values.0x25\nRegister 170 (0xAA): High Priority Packet Buffer Reserved for Q0\n7-0 Reserved RO\nReserved\nDo not change the default values.0x15\nRegister 171 (0xAB): PM Usage Flow Control Select Mode 1\n7 Reserved ROReserved\nDo not change the default values.1TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 60  \uf0e3 2018 Microchip Technology Inc.6 Reserved ROReserved\nDo not change the default values.0\n5-0 Reserved ROReserved\nDo not change the default values.0x18\nRegister 172 (0xAC): PM Usage Flow Control Select Mode 2\n7-6 Reserved ROReserved\nDo not change the default values.0\n5-0 Reserved ROReserved\nDo not change the default values.0x10\nRegister 173 (0xAD): PM Usage Flow Control Select Mode 3\n7-6 Reserved ROReserved\nDo not change the default values.00\n5-0 Reserved ROReserved\nDo not change the default values.0x08\nRegister 174 (0xAE): PM Usage Flow Control Select Mode 4\n7-4 Reserved ROReserved\nDo not change the default values.0\n3-0 Reserved ROReserved\nDo not change the default values.0x05\nRegister 175 (0xAF): TXQ Split for Q3 in Port 1\n7 Priority Select R/W0 = Enable straight priority with Reg 176/177/178 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 176/177/178 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.8\nRegister 176 (0xB0): TXQ Split for Q2 in Port 1\n7 Priority Select R/W0 = Enable straight priority with Reg 175/177/178 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 175/177/178 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.4\nRegister 177 (0xB1): TXQ Split for Q1 in Port 1\n7 Priority Select R/W0 = Enable straight priority with Reg 175/176/178 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 queues with Reg 175/176/178 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.2\nRegister 178 (0xB2): TXQ Split for Q0 in Port 1\n7 Priority Select R/W0 = Enable straight priority with Reg 175/176/177 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 175/176/177 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.1TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 61KSZ8873MML\nRegister 179 (0xB3): TXQ Split for Q3 in Port 2\n7 Priority Select R/W0 = Enable straight priority with Reg 180/181/182 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 180/181/182 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.8\nRegister 180 (0xB4): TXQ Split for Q2 in Port 2\n7 Priority Select R/W0 = Enable straight priority with Reg 179/181/182 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 179/181/182 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.4\nRegister 181 (0xB5): TXQ Split for Q1 in Port 2\n7 Priority Select R/W0 = Enable straight priority with Reg 179/180/182 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 179/180/182 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.2\nRegister 182 (0xB6): TXQ Split for Q0 in Port 2\n7 Priority Select R/W0 = Enable straight priority with Reg 179/180/181 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 queues with Reg 179/180/181 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.1\nRegister 183 (0xB7): TX Q Split for Q3 Port 3\n7 Priority Select R/W0 = Enable straight priority with Reg 184/185/186 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 184/185/186 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.8\nRegister 184 (0xB8): TX Q Split for Q2 Port 3\n7 Priority Select R/W0 = Enable straight priority with Reg 183/185/186 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 183/185/186 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.4\nRegister 185 (0xB9): TXQ Split for Q1 in Port 3\n7 Priority Select R/W0 = Enable straight priority with Reg 183/184/186 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 183/184/186 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.2TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 62  \uf0e3 2018 Microchip Technology Inc.Register 186 (0xBA): TXQ Split for Q0 in Port 3\n7 Priority Select R/W0 = Enable straight priority with Reg 183/184/185 \nbits[7]=0 and Reg 5 bit[3]=0 for higher priority first\n1 = Priority ratio is 8:4:2:1 for 4 queues and 2:1 for 2 \nqueues with Reg 183/184/185 bits[7]=1.1\n6-0 Reserved ROReserved\nDo not change the default values.1\nRegister 187 (0xBB): Interrupt Enable Register\n7-0Interrupt Enable \nRegister R/WInterrupt enable register corresponding to bits in \nRegister 188Note: Set register 187 first and then set register 188 \n(W1C= Write ‘1’ Clear) to wait the interrupt at pin 35 \nINTRN for the link to be changed.0x00\nRegister 188 (0xBC): Link Change Interrupt\n7P1 or P2 Link \nChange (LC) Interrupt R/WSet to 1 when P1 or P2 link changes in analog inter-\nface (W1C).0\n6-3 Reserved R/WReserved\nDo not change the default values.0\n2P3 Link Change (LC) \nInterruptR/W Set to 1 when P3 link changes in MII interface (W1C). 0\n1P2 Link Change (LC) \nInterruptR/WSet to 1 when P2 link changes in analog interface \n(W1C).0\n0P1 MII Link Change \n(LC) InterruptR/WSet to 1 when P1 link changes in analog interface or \nMII interface (W1C).0\nRegister 189 (0xBD): Force Pa use Off Iteration Limit Enable\n7-0Force Pause Off Iter-\nation Limit EnableR/W1 = Enable. It is 160 ms before requesting to \ninvalidate flow control.0 = Disable0\nRegister 192 (0xC0): Reserved\n7-0 Reserved ROReserved\nDo not change the default value.0x03\nRegister 193 (0xC1): Internal 1.8V LDO Control\n7 Reserved ROReserved\nDo not change the default value.0\n6Internal 1.8V LDO \nDisableR/W1 = Disable internal 1.8V LDO\n0 = Enable internal 1.8V LDO0\n5-0 Reserved ROReserved\nDo not change the default value.0\nRegister 194 (0xC2): Insert SRC PVID\n7-6 Reserved ROReserved\nDo not change the default value.00\n5Insert SRC Port 1 \nPVID at Port 2R/W1= Insert SRC port 1 PVI D for untagged frame at \negress port 2 0\n4Insert SRC Port 1 \nPVID at Port 3R/W1= Insert SRC port 1 PVI D for untagged frame at \negress port 30\n3Insert SRC Port 2 \nPVID at Port 1R/W1= Insert SRC port 2 PVI D for untagged frame at \negress port 10\n2Insert SRC Port 2 \nPVID at Port 3R/W1= Insert SRC port 2 PVI D for untagged frame at \negress port 30TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 63KSZ8873MML\n1Insert SRC Port 3 \nPVID at Port 1R/W1= Insert SRC port 3 PVI D for untagged frame at \negress port 10\n0Insert SRC Port 3 \nPVID at Port 2R/W1= Insert SRC port 3 PVI D for untagged frame at \negress port 20\nRegister 195 (0xC3): Power Management and LED Mode\n7CPU Interface Power \nDownR/WCPU interface clock tree power down enable.\n1 = Enable0 = Disable\nNote: Power save a little bit when MII interface is used \nand the traffic is stopped in the power management with normal mode.0\n6 Switch Power Down R/WSwitch clock tree power down enable.\n1 = Enable0 = Disable\nNote: Power save a little bit when MII interface is used \nand the traffic is stopped in the power management with normal mode.0\n5-4 LED Mode Selection R/W00 = LED0: Link/ACT, LED1: Speed\n01 = LED0: Link,         LED1: ACT10 = LED0: Link/ACT, LED1: Duplex\n11 = LED0: Link,         LED1: Duplex00\n3 LED Output Mode R/W1 = The internal stretched energy signal from the ana-\nlog module will be negated and output to LED1 and \nthe internal device ready signal will be negated and \noutput to LED0.0 = The LED1/LED0 pins will indicate the regular LED \noutputs.\nNote. This is for debugging purposes.0\n2 PLL Off Enable R/W1 = PLL power down enable\n0 = Disable\nNote: This bit is used in Energy Detect mode with pin 27 MII_LINK_3 pull-up in bypass mode for saving \npower0\n1-0Power Management \nModeR/WPower management mode\n00 = Normal Mode \n01 = Energy Detection Mode \n10 = Software Power Down Mode 11 = Power Saving Mode 00\nRegister 196 (0xC4): Sleep Mode\n7-0 Sleep Mode R/WThis value is used to c ontrol the minimum period the \nno energy event has to be detected consecutively \nbefore the device enters th e low power state when the \nED mode is on.The unit is 20 ms. The default go_sleep time is 1.6 \nseconds.0x50\nRegister 198 (0xC6): Forward Invalid VID Frame and Host Mode\n7 Reserved ROReserved\nDo not change the default value.0\n6-4Forward Invid VID \nFrameR/W Forwarding ports for frame with invalid VID 3b’0\n3 Reserved ROReserved\nDo not change the default value.0TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\nKSZ8873MML\nDS00002776A-page 64  \uf0e3 2018 Microchip Technology Inc.4.6 Static MAC Address Table\nThe KSZ8873 supports both a static and a dynamic MAC address table. In respons e to a Destination Address (DA) look\nup, the KSZ8873 searches both tables to make a packet forw arding decision. In response to a Source Address (SA)\nlook up, only the dynamic table is searched for aging, migration and learning purposes.\nThe static DA look up result takes precedence over the dynamic DA look up result. If there is a DA match in both tables,\nthe result from the static table is used. The entries in the static table will not  be aged out by the KSZ8873.\nThe static table is accessed by an exte rnal processor via the SMI, SPI, or I2C interfaces. The external processor per-\nforms all addition, modification and del etion of static MAC table entries.2 Reserved ROReserved\nDo not change the default value.0\n1-0 Host Interface Mode R/W00 = I2C master mode\n01 = I2C slave mode\n10 = SPI slave mode\n11 = SMI modeStrapped value \nof P2LED1, \nP2LED0.\nTABLE 4-10: FORMAT OF STATIC MAC TABLE (8 ENTRIES)\nBit Name R/W Description Default\n57-54 FID R/W Filter VLAN ID – identifies one of the 16 active VLANs 0000\n53 Use FID R/W1 = Use (FID+MAC) for static table look ups\n0 = Use MAC only for static table look ups0\n52 Override R/W1 = Override port setting “transmit enable=0” or \n“receive enable=0” setting\n0 = No override0\n51 Valid R/W1 = This entry is valid, the lookup result will be used\n0 = This entry is not valid0\n50-48 Forwarding Ports R/WThese 3 bits control the forwarding port(s):\n001 = Forward to port 1010 = Forward to port 2\n100 = Forward to port 3\n011 = Forward to port 1 and port 2110 = Forward to port 2 and port 3\n101 = Forward to port 1 and port 3\n111 = Broadcasting (excluding the ingress port)000\n47-0 MAC Address R/W 48-bit MAC Address0x0000_0000\n_0000TABLE 4-9: ADVANCED CONTROL REGISTER S (REGISTERS 96-198) (CONTINUED)\nBit Name R/W Description Default\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 65KSZ8873MML\nExamples:\n1. Static Address Table Read (Read the 2nd Entry)Write to reg. 121 (0x79) with 0x10  // Read static table selected\nWrite to reg. 122 (0x7A) with 0x01  // Trigger the read operation\nThen,Read reg. 124 (0x7C), st atic table bits [57:56]\nRead reg. 125 (0x7D), st atic table bits [55:48]\nRead reg. 126 (0x7E), static table bits [47:40]Read reg. 127 (0x7F), static table bits [39:32]Read reg. 128 (0x80), st atic table bits [31:24]\nRead reg. 129 (0x81), st atic table bits [23:16]\nRead reg. 130 (0x82), st atic table bits [15:8]\nRead reg. 131 (0x83), static table bits [7:0]2. Static Address Table Write (Write the 8th Entry)Write to reg. 124 (0x7C), static table bits [57:56]Write to reg. 125 (0x7D), static table bits [55:48]Write to reg. 126 (0x7E), static table bits [47:40]\nWrite to reg. 127 (0x7F), static table bits [39:32]Write to reg. 128 (0x80), static table bits [31:24]Write to reg. 129 (0x81), static table bits [23:16]Write to reg. 130 (0x82), static table bits [15:8]Write to reg. 131 (0x83), static table bits [7:0]Write to reg. 121 (0x79) with 0x00  // Write static table selected\nWrite to reg. 122 (0x7A) with 0x 07 // Trigger the write operation\n4.7 VLAN Table\nThe KSZ8873 uses the VLAN table to perform look ups. If 802 .1Q VLAN mode is enabled (register 5, bit 7 = 1), this\ntable will be used to retrieve the VLAN information that is  associated with the ingress packet. This information includes\nFID (filter ID), VID (VLA N ID), and VLAN membership as described in Table 4-11 .\nIf 802.1Q VLAN mode is enabled, KSZ8873 will assign a VID to  every ingress packet. If the packet is untagged or tagged\nwith a null VID, the packet is assigned with the default port VI D of the ingress port. If the packet is tagged with non-null\nVID, the VID in the tag will be used. The look up process will start from the VLAN table look  up. If the VID is not valid,\nthe packet will be dropped and no address learning will take pl ace. If the VID is valid, the FID is retrieved. The FID+DATABLE 4-11: FORMAT OF STATIC  VLAN TABLE (16 ENTRIES)\nBit Name R/W Description Default\n19 Valid R/W1 = Entry is valid\n0 = Entry is invalid1\n18-16 Membership R/WSpecify which ports are members of the VLAN. If a DA \nlookup fails (no match in both static and dynamic \ntables), the packet associated with this VLAN will be \nforwarded to ports specified in  this field. For example, \n101 means port 3 and 1 are in this VLAN.111\n15-12 FID R/WFilter ID. KSZ8873 supports 16 active VLANs repre-\nsented by these four bit fields. FID is the mapped ID. If 802.1Q VLAN is enabled, the look up will be based \non FID+DA and FID+SA.0x0\n11-0 VID R/W IEEE 802.1Q 12 bits VLAN ID 0x001\nKSZ8873MML\nDS00002776A-page 66  \uf0e3 2018 Microchip Technology Inc.and FID+SA lookups are performed. The FID+DA look up de termines the forwarding ports. If FID+DA fails, the packet\nwill be broadcast to all the members (excluding the ingress po rt) of the VLAN. If FID+SA fails, the FID+SA will be\nlearned.\nExamples:1. VLAN Table Read (read the 3rd entry)Write to reg. 121 (0x79) with 0x14 // Read VLAN table selected\nWrite to reg. 122 (0x7A) with 0x02  // Trigger the read operation\nThen,Read reg. 129 (0x81), VLAN table bits [19:16]Read reg. 130 (0x82), VLAN table bits [15:8]Read reg. 131 (0x83), VLAN table bits [7:0]2. VLAN Table Write (write the 7th entry)Write to reg. 129 (0x81), VLAN table bits [19:16]Write to reg. 130 (0x82), VLAN table bits [15:8]Write to reg. 131 (0x83), VLAN table bits [7:0]Write to reg. 121 (0x79) with 0x04 // Write VLAN table selectedWrite to reg. 122 (0x7A) with 0x 06 // Trigger the write operation\n4.8 Dynamic MAC Address Table\nThe KSZ8873 maintains the dynamic MAC address table. Only read access is allowed.\nExample:\nDynamic MAC Address Table Read (read the 1s t entry and retrieve the MAC table size)\nWrite to reg. 121 (0x79) with 0x18 // Read dynamic table selectedWrite to reg. 122 (0x7A) with 0x00  // Trigger the read operation\nThen,Read reg. 123 (0x7B), bit [7]         // if bit 7 = 1, restart (reread) from this regist er dynamic tabl e bits [66:64]TABLE 4-12: FORMAT OF DYNAMIC MAC ADDRESS TABLE (1K ENTRIES)\nBit Name R/W Description Default\n71 Data Not Ready RO1 = Entry is not ready, continue retrying until this bit is \nset to 0\n0 = Entry is ready—\n70-67 Reserved RO Reserved —\n66 MAC Empty RO1 = There is no valid entry in the table\n0 = There are valid entries in the table1\n65-56Number of Valid \nEntriesROIndicates how many valid entries in the table\n0x3ff means 1k entries\n0x001 means 2 entries0x000 and bit 66 = 0 means 1 entry\n0x000 and bit 66 = 1 means 0 entry00_0000_0000\n55-54 Time Stamp RO 2 bits counter for internal aging —\n53-52 Source Port ROThe source port where FID+MAC is learned\n00 = Port 1\n01 = Port 210 = Port 3 00\n51-48 FID RO Filter ID 0x0\n47-0 MAC Address RO 48-bit MAC Address0x0000_0000\n_0000\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 67KSZ8873MML\nRead reg. 124 (0x7C), dynamic table bits [63:56]\nRead reg. 125 (0x7D), dynamic table bits [55:48]Read reg. 126 (0x7E), dynamic table bits [47:40]Read reg. 127 (0x7F), dy namic table bits [39:32]\nRead reg. 128 (0x80), dy namic table bits [31:24]\nRead reg. 129 (0x81), dy namic table bits [23:16]\nRead reg. 130 (0x82), dy namic table bits [15:8]\nRead reg. 131 (0x83), dynamic table bits [7:0]\n4.9 Management Information Base (MIB) Counters\nThe KSZ8873 provides 34 MIB counters per port. These counters  are used to monitor the port activity for network man-\nagement. The MIB counters have two format groups: “Per Port” and “All Port Dropped Packet.”\n“Per Port” MIB counters are read usin g indirect memory access. The base address offsets and address ranges for all\nthree ports are:\n• Port 1, base is 0x00 and range is (0x00-0x1f)\n• Port 2, base is 0x20 and range is (0x20-0x3f)• Port 3, base is 0x40 and range is (0x40-0x5f)\nPort 1 MIB counters are read usin g the indirect memory offsets in Table 4-14 .TABLE 4-13: FORMAT OF “PER PORT” MIB COUNTERS\nBit Name R/W Description Default\n31 Overflow RO1 = Counter overflow\n0 = No counter overflow0\n30 Count Valid RO1 = Counter value is valid\n0 = Counter value is not valid0\n29-0 Counter Values RO Counter value 0\nTABLE 4-14: PORT 1’S “PER PORT” MIB COUNTERS INDIRECT MEMORY OFFSETS\nOffset Counter Na me Description\n0x0 RxLoPriorityByte Rx lo-priority (def ault) octet count including bad packets\n0x1 RxHiPriorityByte Rx hi-priority octet count including bad packets\n0x2 RxUndersizePkt Rx undersize packets w/ good CRC0x3 RxFragments Rx fragment packets w/ bad  CRC, symbol errors or alignment errors\n0x4 RxOversize Rx oversize packets w/ good CRC (max: 1536 or 1522 bytes)\n0x5 RxJabbersRx packets longer than 1522 bytes w/ either CRC errors, alignment \nerrors, or symbol errors (depends on max packet size setting)\n0x6 RxSymbolError Rx packets w/ invalid  data symbol and legal packet size.\n0x7 RxCRCErrorRx packets within (64,1522) bytes w/  an integral number of bytes and a \nbad CRC (upper limit depends on max packet size setting)\n0x8 RxAlignmentErrorRx packets within (64,1522) bytes w/ a non-integral number of bytes \nand a bad CRC (upper limit depends on max packet size setting)\n0x9 RxControl8808PktsNumber of MAC control frames received  by a port with 88-08h in Ether-\nType field\n0xA RxPausePktsNumber of PAUSE frames received by  a port. PAUSE frame is qualified \nwith EtherType (88-08h), DA, control opcode (00-01), data length (64B \nmin), and a valid CRC\n0xB RxBroadcastRx good broadcast packets (not including error broadcast packets or \nvalid multicast packets)\nKSZ8873MML\nDS00002776A-page 68  \uf0e3 2018 Microchip Technology Inc.“All Port Dropped Packet” MIB counters are read using indire ct memory access. The address offsets for these counters\nare shown in Table 4-16 .0xC RxMulticastRx good multicast packets (not in cluding MAC control frames, error \nmulticast packets or valid broadcast packets)\n0xD RxUnicast Rx good unicast packets\n0xE Rx64Octets Total Rx packets (bad packets included) that were 64 octets in length\n0xF Rx65to127OctetsTotal Rx packets (bad packets included) that are between 65 and 127 \noctets in length\n0x10 Rx128to255OctetsTotal Rx packets (bad packets included) that are between 128 and 255 \noctets in length\n0x11 Rx256to511OctetsTotal Rx packets (bad packets incl uded) that are between 256 and 511 \noctets in length\n0x12 Rx512to1023OctetsTotal Rx packets (bad packets included) that are between 512 and \n1023 octets in length\n0x13 Rx1024to1522OctetsTotal Rx packets (bad packets included) that are between 1024 and \n1522 octets in length (upper limit depends on max packet size setting)\n0x14 TxLoPriorityByte Tx lo-priority good octet count, including PAUSE packets\n0x15 TxHiPriorityByte Tx hi-priority good octet count, including PAUSE packets\n0x16 TxLateCollisionThe number of times a collision is detected later than 512 bit-times into \nthe Tx of a packet\n0x17 TxPausePkts Number of PAUSE frames transmitted by a port\n0x18 TxBroadcastPktsTx good broadcast packets (not including error broadcast or valid multi-\ncast packets)\n0x19 TxMulticastPktsTx good multicast packets (not including error multicast packets or valid \nbroadcast packets)\n0x1A TxUnicastPkts Tx good unicast packets\n0x1B TxDeferredTx packets by a port for which the 1s t Tx attempt is delayed due to the \nbusy medium\n0x1C TxTotalCollision Tx total collision, half duplex only\n0x1D TxExcessiveCollision A count of frames for which Tx fails due to excessive collisions\n0x1E TxSingleCollisionSuccessfully Tx frames on a port for which Tx is inhibited by exactly \none collision\n0x1F TxMultipleCollisionSuccessfully Tx frames on a port for wh ich Tx is inhibited by more than \none collision\nTABLE 4-15: FORMAT OF “ALL PORT  DROPPED PACKET” MIB COUNTERS\nBit Name R/W Description Default\n30-16 Reserved N/A Reserved N/A\n15-0 Counter Value RO Counter Value 0\nTABLE 4-16: “ALL PORT DROPPED PACKET” MI B COUNTERS INDIRECT MEMORY OFFSETS\nOffset Counter Name Description\n0x100 Port 1 TX Drop Packets TX packets dropped due to lack of resources\n0x101 Port 2 TX Drop Packets TX packets dropped due to lack of resources\n0x102 Port 3 TX Drop Packets TX packets dropped due to lack of resources0x103 Port 1 RX Drop Packets RX packets dropped due to lack of resources\n0x104 Port 2 RX Drop Packets RX packets dropped due to lack of resources\n0x105 Port 3 RX Drop Packets RX packets dropped due to lack of resourcesTABLE 4-14: PORT 1’S “PER PORT” MIB COUNTERS INDIRECT MEMORY OFFSETS \nOffset Counter Na me Description\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 69KSZ8873MML\nExamples:\n1. MIB Counter Read (Read port 1 “Rx64Octets” Counter)Write to reg. 121 (0x79) with 0x1c // Read MIB counters selectedWrite to reg. 122 (0x7A) with 0x0e  // Trigger the read operation\nThenRead reg. 128 (0x80), overflow bit [31] //  If bit 31 = 1, there was a counter overflow\n                                    valid bit [30]       // If bit 30 = 0, restart (rere ad) from this register counter bits [29 :24]\nRead reg. 129 (0x81), counter bits [23:16]Read reg. 130 (0x82), counter bits [15:8]Read reg. 131 (0x83), counter bits [7:0]2. MIB Counter Read (Read port 2 “Rx64Octets” Counter)Write to reg. 121 (0x79) with 0x1c // Read MIB counter selectedWrite to reg. 122 (0x7A) with 0x2e  // Trigger the read operation\nThen,Read reg. 128 (0x80), overflow bit [31] //  If bit 31 = 1, there was a counter overflow\n                                    valid bit [30]       // If bit 30 = 0, restart (rere ad) from this register counter bits [29 :24]\nRead reg. 129 (0x81), counter bits [23:16]Read reg. 130 (0x82), counter bits [15:8]Read reg. 131 (0x83), counter bits [7:0] 3. MIB Counter Read (Read “Port1  TX Drop Packets” Counter)\nWrite to reg. 121 (0x79) with 0x1d // Read MIB counter selectedWrite to reg. 122 (0x7A) with 0x00  // Trigger the read operation\nThenRead reg. 130 (0x82), counter bits [15:8]Read reg. 131 (0x83), counter bits [7:0]\n4.9.1 ADDITIONAL MIB COUNTER INFORMATION\n“Per Port” MIB counters are designed as “read clear.” These counters will be cleared after they are read.\n“All Port Dropped Packet” MIB counters ar e not cleared after they are accessed and  do not indicate overflow or validity;\ntherefore, the application must keep track of overflow and valid conditions.\nTo read out all the counters, the best performance over the SPI bus is (160+3) x 8 x 200 = 260 ms, where there are 160\nregisters, 3 overheads, 8 clocks per access,  at 5 MHz. In the heaviest condition, the counters will over flow in 2 minutes.\nIt is recommended that the software read al l the counters at least every 30 seconds. \nA high performance SPI master is also re commended to prevent counters overflow.\nKSZ8873MML\nDS00002776A-page 70  \uf0e3 2018 Microchip Technology Inc.5.0 OPERATIONAL CHARACTERISTICS\n5.1 Absolute Maximum Ratings*\nSupply Voltage\n(VDDA_1.8 , VDDC) .............................................................................................................................. ......... –0.5V to +2.4V\n(VDDA_3.3 , VDDIO) .............................................................................................................................. ........ –0.5V to +4.0V\nInput Voltage .................................................................................................................. ........................... –0.5V to +4.0V\nOutput Voltage ................................................................................................................. ......................... –0.5V to +4.0V\nLead Temperature (soldering, 10s) .............................................................................................. .........................+260°C\nStorage Temperature (TS) ................ .............. .............. .............. .............. .............. .............. .............. ....–55°C to  +150°C\nHBM ESD Rating................................................................................................................. .....................................±3 kV\n*Exceeding the absolute maximum rating may damage the device. Stresses greater than the absolute maximum rating\nmay cause permanent damage to the device. Operation of the device at these or any other  conditions above those spec-\nified in the operating sections of this specification is not  implied. Maximum conditions for extended periods may affect\nreliability.\n5.2 Operating Ratings**\nSupply Voltage ( Note 5-1 )\n(VDDA_1.8 , VDDC) .............................................................................................................................. . +1.690V to +1.890V\n(VDDA_3.3 ).............................................................................................................................. ................ +2.5V to +3.465V\n(VDDIO) .............................................................................................................................. .................. +1.71V to +3.465V\nAmbient Temperature (TA)\n(Commercial).................................................. ................................................................. .............................0°C to +70°C\n(Industrial) ................................................................................................................... .............................–40°C to +85°C\nJunction Temperature (TJ).............................................................................................................................. .......+125°C\nThermal Resistance LQFP ( Note 5-2 ) (ΘJA) ................................................................................................. +47.24°C/W\nThermal Resistance LQFP ( Note 5-2 ) (ΘJC) ................................................................................................. +19.37°C/W\n**The device is not guaranteed to function outside its operating ratings.\nNote 5-1 The device also supports a single 2.5V supply.\nNote 5-2 No heat spreader (HS) in this package.\nNote: Do not drive input signals without  power supplied to the device.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 71KSZ8873MML\n6.0 ELECTRICAL CHARACTERISTICS\nTA = 25°C. Specification is for packaged product only. Current consumption is for the single 3. 3V supply device only and\nincludes the 1.8V supply voltages (VDDA, VDDC) that are provided via power output pin 56 (VDDCO ).\nEach PHY port’s transformer consumes  an additional 45 mA at 3.3V for 1 00BASE-TX and 70 mA at 3.3V for 10BASE-\nT at full traffic.\nTABLE 6-1: ELECTRICAL CHARACTERISTICS\nParameters Symbol Min. Typ. Max. Units Note\n100BASE-TX Operation (All Ports @ 100% Utilization)\n100BASE-TX \n(analog core + digital core \n+ transceiver + digital I/O)IDDXIO —1 0 5—m AVDDA_3.3 , VDDIO = 3.3V\nCore power is provided from the \ninternal 1.8V LDO with input voltage \nVDDIO\n10BASE-T Operation (All Ports @ 100% Utilization)\n10BASE-T \n(analog core + digital core \n+ transceiver + digital I/O)IDDXIO —8 6— m AVDDA_3.3 , VDDIO = 3.3V\nCore power is provided from the \ninternal 1.8V LDO with input voltage \nVDDIO\nPower Management Mode (with MII/RMII in Defa ult PHY Mode)\nPower Saving Mode IDD3 —8 0— m AVDDA_3.3 , VDDIO = 3.3V\nUnplug Port 1 and Port 2\nSet Register 195 bit[1,0] = [1,1]\nSoft Power Down Mode IDD4 —5— m AVDDA_3.3 , VDDIO = 3.3V\nSet Register 195 bit[1,0] = [1,0]\nEnergy Detect Mode IDD5 —1 5— m AVDDA_3.3 , VDDIO = 3.3V\nUnplug Port 1 and Port 2\nSet Register 195 bi t[7,0] = 0x05 with \nport 3 PHY mode and bypass mode.\nCMOS Inputs (VDDIO = 3.3V/2.5V/1.8V)\nInput High Voltage VIH2.0/2.0/\n1.3—— V —\nInput Low Voltage VIL ——0.8/0.6/\n0.3V—\nInput Current IIN –10 — 10 µA VIN = GND ~ VDDIO\nCMOS Outputs (VDDIO = 3.3V/2.5V/1.8V)\nOutput High Voltage VOH2.4/1.9/\n1.5—— V IOH = –8 mA\nOutput Low Voltage VOL ——0.4/0.4/\n0.2VIOL = 8 mA\nOutput Tri-State Leakage |IOZ|— — 1 0 µ A —\n100BASE-TX Transmit (measured differentially after 1:1 transformer)\nPeak Differential Output \nVoltageVO 0.95 — 1.05 V100Ω termination across differential \noutput\nOutput Voltage Imbalance VIMB —— 2 %100Ω termination across differential \noutput\nRise/Fall Time tr/tf 3—5n s —\nRise/Fall Time Imbalance — 0 — 0.5 ns —\nDuty Cycle Distortion — — — ±0.5 ns —\nOvershoot — — — 5 % —\nOutput Jitter — — 0.7 1.4 ns Peak-to-peak\nKSZ8873MML\nDS00002776A-page 72  \uf0e3 2018 Microchip Technology Inc.10BASE-T Receive\nSquelch Threshold VSQ — 400 — mV 5 MHz square wave\n10BASE-T Transmit (measured differentially after 1:1 transformer)\nPeak Differential Output \nVoltageVP —2 . 4— V100Ω termination across differential \noutput\nOutput Jitter — — 1.4 11 ns Peak-to-peakTABLE 6-1: ELECTRICAL CHARACTERISTICS (CONTINUED)\nParameters Symbol Min. Typ. Max. Units Note\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 73KSZ8873MML\n7.0 TIMING SPECIFICATIONS\n7.1 EEPROM Timing\nFIGURE 7-1: EEPROM INTERFACE  INPUT TIMING DIAGRAM\nFIGURE 7-2: EEPROM INTERFACE  OUTPUT TIMING DIAGRAM\nTABLE 7-1: EEPROM TIMING PARAMETERS\nSymbol Parameter Min. Typ. Max. Units\ntcyc1 Clock cycle — 16384 — ns\nts1 Setup time 20 — — ns\nth1 Hold time 20 — — ns\ntov1 Output valid 4096 4112 4128 nsSCL\nSDAtcyc1 ts1 th1\nReceive Timing\nSCL\nSDAtcyc1\nTransmit Timing\ntov1\nKSZ8873MML\nDS00002776A-page 74  \uf0e3 2018 Microchip Technology Inc.7.2 MAC Mode MII Timing\nFIGURE 7-3: MAC MODE MII TIMING  - DATA RECEIVED FROM MII\nFIGURE 7-4: MAC MODE MII TIMING - DATA TRANSMITTED TO MII\nTABLE 7-2: MAC MODE MII TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntcyc3 Clock cycle — 400/40 — ns\nts3 Setup time 4 — — ns\nth3 Hold time 2 — — ns\ntov3 Output valid 7 11 16 ns\n\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 75KSZ8873MML\n7.3 PHY Mode MII Timing\nFIGURE 7-5: PHY MODE MII TIMING  - DATA RECEIVED FROM MII\nFIGURE 7-6: PHY MODE MII TIMI NG - DATA TRANSMITTED TO MII\nTABLE 7-3: PHY MODE MII TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntcyc4 Clock cycle — 400/40 — ns\nts4 Setup time 10 — — ns\nth4 Hold time 0 — — ns\ntov4 Output valid 18 — 19 ns\n\nKSZ8873MML\nDS00002776A-page 76  \uf0e3 2018 Microchip Technology Inc.7.4 I2C Slave Mode Timing\nFIGURE 7-7: I2C INPUT TIMING\nFIGURE 7-8: I2C START BIT TIMING\nFIGURE 7-9: I2C STOP BIT TIMING\nFIGURE 7-10: I2C OUTPUT TIMING\n\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 77KSZ8873MML\nNote that data is only allowed to change durin g SCL low-time, except the start and stop bits.TABLE 7-4: I2C TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntcyc Clock cycle 400 — — ns\nts Setup time 33 — Half-\nCyclens\nth Hold time 0 — — ns\nttbs Start bit setup time 33 — — ns\nttbh Start bit hold time 33 — — ns\ntsbs Stop bit setup time 2 — — ns\ntsbh Stop bit hold time 33 — — ns\ntov Output valid 64 — 96 ns\nKSZ8873MML\nDS00002776A-page 78  \uf0e3 2018 Microchip Technology Inc.7.5 SPI Timing\nFIGURE 7-11: SPI INPUT TIMING\nFIGURE 7-12: SPI OUTPUT TIMING\nTABLE 7-5: SPI TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\nfSCLK SPI_SCLK Clock Frequency — — 25 MHz\nt1 SPI_CSN active setup time 16 — — ns\nt2 SDA (SPID) data input setup time 5 — — ns\nt3 SDA (SPID) data input hold time 6 — — ns\nt4 SPI_CSN active hold time 16 — — ns\nt5 SPI_CSN disable high time 16 — — ns\nt6 SPI_SCLK falling edge to SPIQ (SDO) data output valid 4 — 15 ns\nt7 SPI_CSN inactive to SPIQ (SDO) data output invalid 2 — — nsSPI_SCLK\nSPIQ (SDO)SDA (SPID)SPI_CSN\nMSB BIT LSB BITt2t5\nt31/fSCLK t4 t1\nHIGH IMPEDANCE\nSPI_SCLK\nSPIQ (SDO)\nSDA (SPID)SPI_CSN\nLSB IN DON’T CAREMSB BIT LSB BITt6 t71/fSCLK t5\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 79KSZ8873MML\n7.6 Auto-Negotiation Timing\nFIGURE 7-13: AUTO-NEGOTIATION TIMING\nTABLE 7-6: AUTO-NEGOTIATION TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntBTB FLP burst to FLP burst 8 16 24 ms\ntFLPW FLP burst width — 2 — ms\ntPW Clock/Data pulse width — 100 — ns\ntCTD Clock pulse to data pulse 55.5 64 69.5 µs\ntCTC Clock pulse to clock pulse 111 128 139 µs\n— Number of clock/data pulses per burst 17 — 33 —Auto-Negotiation  -  Fast Link Pulse Timing\ntPWTX+/TX-Clock\nPulseDataPulseClock\nPulse\ntPW\ntCTD\ntCTCtFLPW\ntBTBTX+/TX-\nData\nPulseFLP \nBurstFLP \nBurst\nKSZ8873MML\nDS00002776A-page 80  \uf0e3 2018 Microchip Technology Inc.7.7 MDC/MDIO Timing\nFIGURE 7-14: MDC/MDIO TIMING\nTABLE 7-7: MDC/MDIO TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntP MDC period — 400 — ns\ntMD1 MDIO (PHY Input) setup to rising edge of MDC 10 — — ns\ntMD2 MDIO (PHY Input) hold fr om rising edge of MDC 4 — — ns\ntMD3 MDIO (PHY Output) delay from rising edge of MDC — 222 — ns\n\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 81KSZ8873MML\n7.8 Reset Timing\nThe KSZ8873MML reset timing requirement is summarized in Figure 7-15  and Table 7-8 .\nAfter the deassertion of reset, wait a minimum of 100 µ s before starting programming on the managed interface (I2C\nslave, SPI slave, SMI, MIIM).FIGURE 7-15: RESET TIMING\nTABLE 7-8: RESET TIMING PARAMETERS\nParameter Description Min. Typ. Max. Units\ntSR Stable supply voltage s to reset high 10 — — ms\ntCS Configuration setup time 50 — — ns\ntCH Configuration hold time 50 — — ns\ntRC Reset to strap-in pin output 50 — — ns\ntVR 3.3V rise time 100 — — µsSUPPLY\nVOLTAGES\nRST#\nSTRAP-IN\nVALUE\nSTRAP-IN /\nOUTPUT  PINtVRtSR\ntCStCH\ntRC\nKSZ8873MML\nDS00002776A-page 82  \uf0e3 2018 Microchip Technology Inc.8.0 RESET CIRCUIT\nFigure 8-1  shows a reset circuit recommended for powering up the KSZ8873MML if reset is triggered only by the power\nsupply.\nFigure 8-2  shows a reset circuit recommended for applications w here reset is driven by another device (for example,\nthe CPU or an FPGA). At power-on-reset, R, C, and D1 pr ovide the necessary ramp rise  time to reset the KSZ8873MML\ndevice. The RST_OUT_N from the CPU/FPGA provides the warm reset after power-up.FIGURE 8-1: RECOMMENDED RESET CIRCUIT\nFIGURE 8-2: RECOMMENDED RESET CIR CUIT FOR CPU/FPGA RESET OUTPUTVCC\nR\n10k\nC\n10μFD1\nKS8873\nRSTD1: 1N4148\nVCC\nR\n10k\nD2C\n10μFD1\nCPU/FPGA\nRST_OUT_nKS8873\nRST\nD1, D2: 1N4148\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 83KSZ8873MML\n9.0 SELECTION OF ISOLATION TRANSFORMERS\nA 1:1 isolation transformer is required at the line interfac e. Use one with integrated co mmon-mode chokes for designs\nexceeding FCC requirements. \nTable 9-1  lists recommended transformer characteristics.\nTABLE 9-1: TRANSFORMER SELECTION CRITERIA\nParameter Value Test Conditions\nTurns Ratio 1 CT : 1 CT —\nOpen-Circuit Inductance (mi n.) 350 µH 100 mV, 100 kHz, 8 mA\nLeakage Inductance (max.) 0.4 µH 1 MHz (min.)\nInterwinding Capacitance (max.) 12 pF —\nD.C. Resistance (max.) 0.9 Ω —\nInsertion Loss (max.) –1.0 dB 0 MHz to 65 MHz\nHIPOT (min.) 1500 VRMS —\nTABLE 9-2: QUALIFIED SINGLE-PORT MAGNETICS\nManufacturer Part Number Auto MDI-X\nBel Fuse S558-5999-U7 Yes\nBel Fuse (MagJack) SI-46001 Yes\nBel Fuse (MagJack) SI-50170 Yes\nDelta LF8505 Yes\nLanKom LF-H41S Yes\nPulse H1102 Yes\nPulse (Low Cost) H1260 Yes\nDatatronic NT79075 Yes\nTranspower HB726 Yes\nYCL LF-H41S Yes\nTDK (MagJack) TLA-6T718 Yes\nTABLE 9-3: TYPICAL REFERENCE CRYSTAL CHARACTERISTICS\nCharacteristic Value\nFrequency 25.00000 MHz\nFrequency Tolerance (max.) ±50 ppm\nLoad Capacitance (max.) 20 pF\nSeries Resistance 40 Ω\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 85KSZ8873MML\n10.0 PACKAGE OUTLINE\n10.1 Package Marking Information\n64-Lead LQFP* Example\nXXXXXX\nXXXXXXXXXX\nYYWWXX\nMXXYYWWNNN\nMYYWWXXMICREL\nKSZ8873MML\n1826A2\nM001826943\n7182600\nLegend: XX...X Product code or cust omer-specific information\nY Year code (last digit of calendar year)\nYY Year code (last 2 digits of calendar year)WW Week code (week of January 1 is week ‘01’)\nNNN Alphanumeric traceability code\n  Pb-free JEDEC\n® designator for Matte Tin (Sn)\n* This package is Pb-free. The Pb-free JEDEC designator (     )\ncan be found on the outer packaging for this package.\n●, ▲, ▼Pin one index is identified by a dot,  delta up, or delta down (triangle\nmark).\nNote : In the event the full Microchip part numbe r cannot be marked on one line, it will\nbe carried over to the next line, t hus limiting the number of available\ncharacters for customer-specific informa tion. Package may or may not include\nthe corporate logo.\nUnderbar (_) and/or Overbar ( ⎯) symbol may not be to scale.3e\n3e\nKSZ8873MML\nDS00002776A-page 86  \uf0e3 2018 Microchip Technology Inc.FIGURE 10-1: 64-LEAD LQFP 10 MM X 10 MM PACKAGE\n  Note:  For the most current package drawings, please see the Microchip Packaging Specification located at\n http://www.microchip.com/packaging.\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 87KSZ8873MML\nAPPENDIX A: DATA SHEET REVISION HISTORY\nTABLE A-1: REVISION HISTORY\nRevision Section/Figure/Entry Correction\nDS00002776A (8-14-18) —Converted Micrel data sheet KSZ8873MML to Micro-\nchip DS00002776A. Minor text changes throughout.\nKSZ8873MML\nDS00002776A-page 88  \uf0e3 2018 Microchip Technology Inc.THE MICROCHIP WEB SITE\nMicrochip provides online support via our WWW site at www.microchip.com . This web site is used as a means to make\nfiles and information easily available to customers. Accessible by using your favorite Internet browser, the web site con-\ntains the following information:\n•Product Support  – Data sheets and errata, application notes and sample programs, design resources, user’s \nguides and hardware support documents, la test software releases and archived software\n•General Technical Support  – Frequently Asked Questions (FAQ), technical support requests, online discussion \ngroups, Microchip consultant program member listing\n•Business of Microchip  – Product selector and ordering guides, latest  Microchip press releases, listing of semi-\nnars and events, listings of Microchip sales offi ces, distributors and factory representatives\nCUSTOMER CHANGE NOTIFICATION SERVICE\nMicrochip’s customer notification service helps keep cust omers current on Microchip products. Subscribers will receive\ne-mail notification whenever there are changes, updates, revi sions or errata related to a specified product family or\ndevelopment tool of interest.\nTo register, access the Microchip web site at www.microchip.com . Under “Support”, click on “Customer Change Notifi-\ncation” and follow the registration instructions.\nCUSTOMER SUPPORT\nUsers of Microchip products can receive assistance through several channels:\n• Distributor or Representative\n• Local Sales Office• Field Application Engineer (FAE)\n• Technical Support\nCustomers should contact their distributor , representative or field application engi neer (FAE) for support. Local sales\noffices are also available to help customers. A listing of sa les offices and locations is included in the back of this docu-\nment.\nTechnical support is available through the web site at: http://microchip.com/support\n\uf0e3 2018 Microchip Technology Inc.  DS00002776A-page 89KSZ8873MML\nPRODUCT IDENTIFICATION SYSTEM\nTo order or obtain information, e.g., on pricing or delivery, refer to the factory or the listed sales office .\n   \nDevice: KSZ8873\nInterface: M = MII\nPackage: M = 64-lead 10 mm x 10 mm LQFP\nSupply Voltage: L = Single 3.3V Supply\nTemperature: blank = 0 \uf0b0C to +70 \uf0b0C (Commercial)\nI = –40\uf0b0C to +85 \uf0b0C (Industrial)\nMedia Type: blank = 160/TrayExamples:\na) KSZ8873MLL\nMII Interface\n64-lead 10 mm x 10 mm LQFP\nSingle 3.3V SupplyCommercial Temperature Range\n160/Tray\nb) KSZ8873MLLI\nMII Interface64-lead 10 mm x 10 mm LQFP\nSingle 3.3V Supply\nIndustrial Temperature Range160/TrayPART NO. X X\nPackage Interface DeviceX\nTemperatureX\nSupply\nVoltageXX\nMedia\nType\nKSZ8873MML\nDS00002776A-page 90  \uf0e3 2018 Microchip Technology Inc.\n\uf0e3 2018 Microchip Technology Inc. DS00002776A-page 91Information contained in this publication regarding device applications and the like is  provided only for your convenience and may be\nsuperseded by updates. It is your responsibility to ensure that  your application meets with your specifications. MICROCHIP MAKE S NO\nREPRESENTATIONS OR WARRANTIES OF ANY KIND WHETHER EX PRESS OR IMPLIED, WRITTEN OR ORAL, STATUTORY OR\nOTHERWISE, RELATED TO THE INFORMATION, INCLUDING BUT NOT LIMITED TO ITS CONDITION, QUALITY, PERFORMANCE,\nMERCHANTABILITY OR FITNESS FOR PURPOSE . Microchip disclaims all liabilit y arising from this informat ion and its use. Use of Micro-\nchip devices in life support and/or safety  applications is entirely at the buyer’s risk, and the buyer agrees to defend, indemn ify and hold\nharmless Microchip from any and all damages, cl aims, suits, or expenses resulting from such use. No licenses are conveyed, impl icitly or\notherwise, under any Microchip intellectual property rights unless otherwise stated.\nTrademarks\nThe Microchip name and logo, the Microchip logo, AnyRate, AVR, AVR logo, AVR Freaks, BitCloud, chipKIT, chipKIT logo, CryptoMem ory, \nCryptoRF, dsPIC, FlashFlex, flexPWR, Heldo, JukeBlox, KeeLoq, Kleer, LANCheck, LINK MD, maXStylus, maXTouch, MediaLB, megaAVR, \nMOST, MOST logo, MPLAB, OptoLyzer, PIC, picoPower, PICSTART, PIC32 logo, Prochip Designer, QTouch, SAM-BA, SpyNIC, SST, SST Logo, SuperFlash, tinyAVR, UNI/O, and XMEGA are registered trademarks of Microchip Technology Incorporated in the U.S.A. and ot her \ncountries.\nClockWorks, The Embedded Control Solutions Company, EtherSynch, Hyper Speed Control, HyperLight Load, IntelliMOS, mTouch, Preci sion \nEdge, and Quiet-Wire are registered trademarks of Microchip Technology Incorporated in the U.S.A.\nAdjacent Key Suppression, AKS, Analog-for-the-Digital Age, Any Ca pacitor, AnyIn, AnyOut, BodyCom, CodeGuard, CryptoAuthenticati on, \nCryptoAutomotive, CryptoCompanion, CryptoController, dsPICDEM, dsPICDEM.net, Dynamic Average Matching, DAM, ECAN, EtherGREEN, \nIn-Circuit Serial Programming, ICSP, INICnet, Inter-Chip Connectivity, JitterBlocker, KleerNet, KleerNet logo, memBrain, Mindi,  MiWi, \nmotorBench, MPASM, MPF, MPLAB Certified logo, MPLIB, MPLINK, MultiTRAK, NetDetach, Omniscient Code Generation, PICDEM, \nPICDEM.net, PICkit, PICtail, PowerSmart, PureSilicon, QMatrix, REAL ICE, Ripple Blocker, SAM-ICE, Serial Quad I/O, SMART-I.S., SQI, \nSuperSwitcher, SuperSwitcher II, Total Endurance, TSHARC, USBCheck, VariSense, ViewSpan, WiperLock, Wireless DNA, and ZENA are \ntrademarks of Microchip Technology Incorporated in the U.S.A. and other countries.\nSQTP is a service mark of Microchip Technology Incorporated in the U.S.A.\nSilicon Storage Technology is a registered trademark of Microchip Technology Inc. in other countries.GestIC is a registered trademark of Microchip Technology Germany II GmbH & Co. KG, a subsidiary of Microchip Technology Inc., i n other \ncountries. \nAll other trademarks mentioned herein are property of their respective companies.\n© 2018, Microchip Technology Incorporated, All Rights Reserved.\nISBN: 978-1-5224-3417-7Note the following details of the code protection feature on Microchip devices:\n• Microchip products meet the specification cont ained in their particular Microchip Data Sheet.\n• Microchip believes that its family of pr oducts is one of the most secure families of its kind on the market today, when used i n the \nintended manner and under normal conditions.\n• There are dishonest and possibly illegal meth ods used to breach the code protection feature. All of these methods, to our \nknowledge, require using the Microchip pr oducts in a manner outside the operating specif ications contained in Microchip’s Data \nSheets. Most likely, the person doing so is engaged in theft of intellectual property.\n• Microchip is willing to work with the customer  who is concerned about the integrity of their code.\n• Neither Microchip nor any other semiconduc tor manufacturer can guarantee the security of their code. Code protection does not \nmean that we are guaranteeing the product as “unbreakable.”\nCode protection is constantly evolving. We at Microchip are committed to  continuously improving t he code protection features of  our\nproducts. Attempts to break Microchip’s c ode protection feature may be a violation of  the Digital Millennium Copyright Act. If such acts\nallow unauthorized access to your softwar e or other copyrighted work, you may have a right to sue for relief under that Act.\nMicrochip received ISO/TS-16949:2009 certification for its worldwide \nheadquarters, design and wafer fabrication facilities in Chandler and Tempe, Arizona; Gresham, Oregon and design centers in California and India. The Company’s quality system processes and procedures are for its PIC\n® MCUs and dsPIC® DSCs, K EELOQ® code hopping \ndevices, Serial EEPROMs, microper ipherals, nonvolatile memory and \nanalog products. In addition, Microchip’s quality system for the design and manufacture of development syst ems is ISO 9001:2000 certified.QUALITY \tMANAGEMENT \t\tSYSTEM\t\nCERTIFIED \tBY\tDNV\t\n== ISO/TS\t16949 \t==\t\nDS00002776A-page 92 \uf0e3 2018 Microchip Technology Inc.\nAMERICAS\nCorporate Office\n2355 West Chandler Blvd.\nChandler, AZ 85224-6199Tel: 480-792-7200 \nFax: 480-792-7277\nTechnical Support: http://www.microchip.com/\nsupport\nWeb Address: www.microchip.com\nAtlanta\nDuluth, GA \nTel: 678-957-9614 Fax: 678-957-1455\nAustin, TX\nTel: 512-257-3370 \nBoston\nWestborough, MA \nTel: 774-760-0087 \nFax: 774-760-0088\nChicago\nItasca, IL \nTel: 630-285-0071 \nFax: 630-285-0075\nDallas\nAddison, TX \nTel: 972-818-7423 \nFax: 972-818-2924\nDetroit\nNovi, MI \nTel: 248-848-4000\nHouston, TX \nTel: 281-894-5983\nIndianapolis\nNoblesville, IN \nTel: 317-773-8323\nFax: 317-773-5453\nTel: 317-536-2380\nLos Angeles\nMission Viejo, CA \nTel: 949-462-9523\nFax: 949-462-9608\nTel: 951-273-7800 \nRaleigh, NC \nTel: 919-844-7510\nNew York, NY \nTel: 631-435-6000\nSan Jose, CA \nTel: 408-735-9110\nTel: 408-436-4270\nCanada - Toronto\nTel: 905-695-1980 \nFax: 905-695-2078ASIA/PACIFIC\nAustralia - Sydney\nTel: 61-2-9868-6733\nChina - Beijing\nTel: 86-10-8569-7000 \nChina - Chengdu\nTel: 86-28-8665-5511\nChina - Chongqing\nTel: 86-23-8980-9588\nChina - Dongguan\nTel: 86-769-8702-9880 \nChina - Guangzhou\nTel: 86-20-8755-8029 \nChina - Hangzhou\nTel: 86-571-8792-8115 \nChina - Hong Kong SAR\nTel: 852-2943-5100 \nChina - Nanjing\nTel: 86-25-8473-2460\nChina - Qingdao\nTel: 86-532-8502-7355\nChina - Shanghai\nTel: 86-21-3326-8000 \nChina - Shenyang\nTel: 86-24-2334-2829\nChina - Shenzhen\nTel: 86-755-8864-2200 \nChina - Suzhou\nTel: 86-186-6233-1526 \nChina - Wuhan\nTel: 86-27-5980-5300\nChina - Xian\nTel: 86-29-8833-7252\nChina - Xiamen\nTel: 86-592-2388138 \nChina - Zhuhai\nTel: 86-756-3210040 ASIA/PACIFIC\nIndia - BangaloreTel: 91-80-3090-4444 \nIndia - New Delhi\nTel: 91-11-4160-8631\nIndia - Pune\nTel: 91-20-4121-0141\nJapan - Osaka\nTel: 81-6-6152-7160 \nJapan - Tokyo\nTel: 81-3-6880- 3770 \nKorea - Daegu\nTel: 82-53-744-4301\nKorea - Seoul\nTel: 82-2-554-7200\nMalaysia - Kuala Lumpur\nTel: 60-3-7651-7906\nMalaysia - Penang\nTel: 60-4-227-8870\nPhilippines - Manila\nTel: 63-2-634-9065\nSingapore\nTel: 65-6334-8870\nTaiwan - Hsin Chu\nTel: 886-3-577-8366\nTaiwan - Kaohsiung\nTel: 886-7-213-7830\nTaiwan - Taipei\nTel: 886-2-2508-8600 \nThailand - Bangkok\nTel: 66-2-694-1351\nVietnam - Ho Chi Minh\nTel: 84-28-5448-2100EUROPE\nAustria - WelsTel: 43-7242-2244-39\nFax: 43-7242-2244-393\nDenmark - Copenhagen\nTel: 45-4450-2828 \nFax: 45-4485-2829\nFinland - Espoo\nTel: 358-9-4520-820\nFrance - Paris\nTel: 33-1-69-53-63-20 \nFax: 33-1-69-30-90-79 \nGermany - Garching\nTel: 49-8931-9700\nGermany - Haan\nTel: 49-2129-3766400\nGermany - Heilbronn\nTel: 49-7131-67-3636\nGermany - Karlsruhe\nTel: 49-721-625370\nGermany - Munich\nTel: 49-89-627-144-0 \nFax: 49-89-627-144-44\nGermany - Rosenheim\nTel: 49-8031-354-560\nIsrael - Ra’anana \nTel: 972-9-744-7705\nItaly - Milan \nTel: 39-0331-742611 \nFax: 39-0331-466781\nItaly - Padova\nTel: 39-049-7625286 \nNetherlands - Drunen\nTel: 31-416-690399 \nFax: 31-416-690340\nNorway - Trondheim\nTel: 47-7289-7561\nPoland - Warsaw\nTel: 48-22-3325737 \nRomania - Bucharest\nTel: 40-21-407-87-50\nSpain - Madrid\nTel: 34-91-708-08-90\nFax: 34-91-708-08-91\nSweden - Gothenberg\nTel: 46-31-704-60-40\nSweden - Stockholm\nTel: 46-8-5090-4654\nUK - Wokingham\nTel: 44-118-921-5800\nFax: 44-118-921-5820Worldwide Sales and Service\n10/25/17\nMouser Electronics\n  \nAuthorized Distributor\n \n  \nClick to View Pricing, Inventory, Delivery & Lifecycle Information:\n \n \n \n Microchip:   \n\xa0 KSZ8873MML\xa0 KSZ8873MMLI\n'}]
!==============================================================================!
### Component Summary: KSZ8873MML

**Manufacturer:** Microchip Technology Inc.  
**Product Code:** KSZ8873MML  
**Description:** Integrated 3-Port 10/100 Managed Ethernet Switch with PHY

#### Key Specifications:
- **Voltage Ratings:**
  - Supply Voltage: 3.3V (VDDA_3.3), 1.8V (VDDA_1.8, VDDC)
  - VDDIO: 1.8V, 2.5V, or 3.3V
- **Current Ratings:**
  - Power consumption during 100BASE-TX operation: 10 mA (typical)
  - Power consumption during 10BASE-T operation: 8 mA (typical)
- **Power Consumption:**
  - Low power dissipation with various power management modes (Energy Detect Mode can save up to 87% power).
- **Operating Temperature Range:**
  - Industrial: -40°C to +85°C
  - Commercial: 0°C to +70°C
- **Package Type:**
  - 64-Pin LQFP (Lead-Free)
- **Special Features:**
  - Supports IEEE 802.1Q VLAN for up to 16 groups.
  - Advanced QoS features including 802.1p/q tagging, rate limiting, and IGMP snooping.
  - Bypass feature for power saving when the CPU goes into sleep mode.
  - LinkMD® cable diagnostics for identifying faulty cabling.
  - Comprehensive configuration register access via SMI, MIIM, SPI, and I2C interfaces.
- **Moisture Sensitive Level (MSL):** MSL 3 per JEDEC J-STD-020E.

#### Description:
The KSZ8873MML is a highly integrated 3-port Ethernet switch designed for low-port-count, cost-sensitive, and power-efficient applications. It features advanced switching capabilities, including VLAN support, QoS, and power management features, making it suitable for various applications such as VoIP phones, set-top boxes, automotive Ethernet, and industrial control systems.

#### Typical Applications:
- **VoIP Phones:** Provides reliable network connectivity for voice over IP applications.
- **Set-Top/Game Boxes:** Facilitates high-speed internet access for streaming and gaming.
- **Automotive Ethernet:** Supports in-vehicle networking for various automotive applications.
- **Industrial Control:** Used in automation systems for efficient data communication.
- **IPTV POF:** Enables high-quality video streaming over Ethernet.
- **SOHO Residential Gateways:** Acts as a network switch in small office/home office environments.
- **Broadband Gateway/Firewall/VPN:** Integrates with broadband services for secure internet access.
- **Wireless LAN Access Points:** Enhances connectivity in wireless networks.
- **Standalone 10/100 Switch:** Functions as a basic Ethernet switch for various networking needs.

This summary encapsulates the essential characteristics and applications of the KSZ8873MML, providing a clear understanding of its capabilities and use cases in modern networking environments.