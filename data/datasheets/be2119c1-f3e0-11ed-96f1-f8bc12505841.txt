[{'role': 'system', 'content': 'You are a technical specialist with expertise in electronics. Your task is to analyze datasheets for electronic components and provide a concise summary of the product’s key characteristics and specifications. In addition, you need to gather textual information about the component, including its description and typical applications.Instructions:    Identify the correct component in the datasheet using the provided product code.    Summarize key parameters, including:        Voltage ratings        Current ratings        Power consumption        Operating temperature range        Package type        Special features or notes (if applicable)        Moisture Sensetive Level JEDEC J-STD-020E    Provide a short description of the component, including what it is (e.g., transistor, microcontroller, sensor) and its primary function.    Explain typical applications for the component (e.g., power management, signal processing, data storage, etc.).    Be thorough and accurate: Ensure the information corresponds specifically to the product code, as some datasheets cover multiple variants.Your goal is to create a clear and accurate technical summary that includes both key specifications and a description of what the component is used for.'}, {'role': 'user', 'content': 'Give me information about the component of PNI-13104 production of POWEREXINC from the text: \n \n   \n User Manual  \n RM3 100 & RM2 100 \n Geoma gnetic Sensor  \n \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 1 of 41 Table of Contents  \n1 COPYRIGHT & WARRANTY  INFORMATION  ................................ ............................  3 \n2 INTRODUCTION  ................................ ................................ ................................ ..........  4 \n3 SPECIFICATIONS  ................................ ................................ ................................ ....... 5 \n3.1 GEOMAGNETIC SENSOR C HARACTERISTICS  ................................ ..........  5 \n3.2 SEN-XY-F AND SEN -Z-F CHARACTERISTICS  ................................ .............  6 \n3.3 MAGI2C CHARACTERISTI CS ................................ ................................ ........  7 \n3.4 DIMENSIONS, PACKAGIN G, AND PAD & MASK LA YOUT  ..........................  8 \n3.4.1  Sen-XY-f ................................ ................................ .............................  8 \n3.4.2  Sen-Z-f ................................ ................................ ..............................  10 \n3.4.3  MagI2C  ................................ ................................ .............................  12 \n3.5 SOLDERING  ................................ ................................ ................................ . 13 \n4 GEOMAGNETIC SENSOR O VERVIEW & SET -UP ................................ ..................  15 \n4.1 OVERVIEW  ................................ ................................ ................................ ... 15 \n4.2 LAYOUT  ................................ ................................ ................................ ........  17 \n4.2.1  Sensor Coil Orientation  ................................ ................................ .... 17 \n4.2.2  Local Magnetic Field Considerations  ................................ ...............  18 \n4.2.3  Other Layout Considerations  ................................ ............................  19 \n4.3 MAGI2C PIN -OUT  ................................ ................................ .........................  19 \n4.3.1  General Pins  ................................ ................................ .....................  19 \n4.3.2  SPI Pins  ................................ ................................ ............................  21 \n4.3.3  I2C Pins  ................................ ................................ .............................  22 \n4.4 SPI TIMING REQUIREME NTS ................................ ................................ ..... 23 \n4.5 I2C REQUIREMENTS  ................................ ................................ ....................  25 \n4.5.1  I2C Register Write  ................................ ................................ .............  25 \n4.5.2  I2C Register Read  ................................ ................................ .............  26 \n5 MAGI2C  OPERATION  ................................ ................................ ...............................  27 \n5.1 SET THE CYCLE COUNT REGISTERS (0X04 – 0X09)  ..............................  27 \n5.2 INITIATE CONTINUOUS MEASUREMENT MODE (0X 01) ..........................  28 \n5.2.1  Setting the CMM Update Rate with TMRC (0x0B)  ...........................  30 \n5.3 INITIATE A SINGLE ME ASUREMENT (0X00)  ................................ .............  31 \n5.4 CONFIRM NEW DATA REA DY ................................ ................................ .... 32 \n5.4.1  STATUS Register (0x34)  ................................ ................................ .. 32 \n5.5 READ THE MEASUREMENT  RESULTS  ................................ ......................  32 \n5.6 TROUBLESHOOTING AND GENERAL INFORMATION  .............................  33 \n5.6.1  Built-In Self Test Register (0x33)  ................................ .....................  33 \n5.6.2  HSHAKE Register (0x35)  ................................ ................................ . 34 \n5.6.3 REVID Register (0x36)  ................................ ................................ ..... 35 \n5.7 EXAMPLES USING THE S PI INTERFACE  ................................ ..................  35 \n5.7.1  Set the Cycle Count Registers  ................................ .........................  35 \n5.7.2  Making and Reading Measurements  ................................ ................  36 \n5.8 EXAMPLES USING THE I2C INTERFACE  ................................ ...................  38 \n5.8.1  Set the Cycle Count Registers  ................................ .........................  38 \n5.8.2  Initiate a Single Measurement  ................................ ..........................  39 \n5.8.3  Initiate Continuous Measurement Mode  ................................ ...........  39 \n5.8.4  Read the Measurement Results  ................................ .......................  39 \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 2 of 41 List of Figures  \nFigure 3 -1:  Sen -XY-f Sensor Dimensions  ................................ ................................ ................  8 \nFigure 3 -2:  Sen -XY-f Tape and Reel Dimensions  ................................ ................................ .... 9 \nFigure 3 -3:  Sen -XY-f Recommended Solder Pad, Paste, & Mask Layout  ...............................  9 \nFigure 3 -4:  Sen -Z-f Sensor Dimensions  ................................ ................................ .................  10 \nFigure 3 -5:  Sen -Z-f Tape and Reel Dimensions  ................................ ................................ ..... 11 \nFigure 3 -6:  Sen -Z-f Recommended Solder Pad, Paste, & Mask Layout  ................................  11 \nFigure 3 -7:  MagI2C MLF Mechanical Drawing  ................................ ................................ ....... 12 \nFigure 3 -8:  MagI2C MLF Tape Dimensions  ................................ ................................ ...........  13 \nFigure 3 -9:  Recommended Solder Reflow Profile  ................................ ................................ .. 14 \nFigure 4 -1:  RM3100 reference schematic – SPI Configuration  ................................ ..............  15 \nFigure 4 -2:  RM3100 reference schemati c – I2C Configuration ................................ ...............  16 \nFigure 4 -3:  LR Oscillator Circuit Biasing Diagram  ................................ ................................ .. 17 \nFigure 4 -4:  RM3100 North -East-Down (NED) Sensor Layout  ................................ ...............  18 \nFigure 4 -5:  SPI Timing Diagram, CPOL = CPHA = 0  ................................ .............................  24 \nFigure 4 -6:  SPI Timing Diagram, CPOL = CPHA = 1  ................................ .............................  24 \nFigure 5 -1:  SPI Activity Sequence Diagram  ................................ ................................ ...........  36 \n \n \nList of Tables  \nTable 3 -1:  Geomagnetic Sensor Performance1 ................................ ................................ ....... 5 \nTable 3 -2:  Sen -XY-f and Sen -Z-f Absolute Maximum Ratings  ................................ .................  6 \nTable 3 -3:  Sen -XY-f and Sen -Z-f Characteristics  ................................ ................................ ..... 6 \nTable 3 -4:  MagI2C Absolute Maximum Ratings  ................................ ................................ ....... 7 \nTable 3 -5:  MagI2C Recommended Operating Conditions  ................................ .......................  7 \nTable 3 -6:  Recommended Solder Processing Parameters1 ................................ ...................  14 \nTable 4 -1:  MagI2C Pin Assignments  ................................ ................................ ......................  20 \nTable 4 -2:  SPI Timing Specifications  ................................ ................................ .....................  25 \nTable 5 -1:  MagI2C Register Map  ................................ ................................ ...........................  27 \nTable 5 -2:  Cycle Count Registers  ................................ ................................ ...........................  28 \nTable 5 -3:  Continuous  Mode DRDY Options  ................................ ................................ .........  29 \nTable 5 -4:  CMM Update Rates  ................................ ................................ ...............................  31 \nTable 5 -5:  Measurement Results Registers  ................................ ................................ ...........  33 \nTable 5 -6:  BIST Timeout Period  ................................ ................................ .............................  34 \nTable 5 -7:  BIST LR Periods  ................................ ................................ ................................ .... 34 \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 3 of 41 1 Copyright & Warranty Information  \n© Copyright   PNI Sensor Corporation  2013  \nAll Rights Reserved. Reproduction, adaptation, or translation with out prior written permission is prohibited, except as allowed \nunder copyright laws.  \nRevised  March 2014 : for the most recent version visit our website at www.pnicorp.com   \n \nPNI Sensor Corporation   \n2331 Circadian Way  \nSanta Rosa, CA 95407 , USA  \nTel: (707) 566 -2260  \nFax: (707) 566 -2261  \n \nWarranty and Limitation of Liability.  PNI Sensor Corporation ("PNI") manufactures its Products from parts and components \nthat are new or equivalent to new in performance. PNI warrants that each Product to be delivered hereunder, if properly used,  \nwill, fo r ninety (90) days following the date of shipment unless a different warranty time period for such Product is specified: (i) \nin PNI‟s Price List in effect at time of order acceptance; or (ii) on PNI‟s web site (www.pnicorp.com) at time of order \nacceptance,  be free from defects in material and workman ship and will operate in accordance  with PNI‟s published specifica tions \nand documentation for the Product in effect at time of order. PNI will  make no changes to the specifi cations or manufacturing \nprocesses tha t affect form, fit, or function of the Product without written notice to the Customer , however, PNI may at any time, \nwithout such notice, make minor changes to spec ifications or manufacturing pro cesses that do not affect the form, fit, or function \nof the P roduct. This warranty will be void if the Products‟ serial number, or other identification marks have been defaced, \ndamaged, or removed. This warranty does not cover wear and tear due to normal use, or damage to the Product as the result of \nimproper usage,  neglect of care, alteration, accident, or unauthorized repair.  \nTHE ABOVE WARRANTY IS IN LIEU OF ANY OTHER WARRANTY, WHETHER EXPRESS, IMPLIED, \nOR STATUTORY, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTY OF MERCHANTABILITY, \nFITNESS FOR ANY PARTICULAR PURPOSE,  OR ANY WARRANTY OTHERWISE ARISING OUT OF \nANY PROPOSAL, SPECIFICATION, OR SAMPLE. PNI NEITHER ASSUMES NOR AUTHORIZES ANY \nPERSON TO ASSUME FOR IT ANY OTHER LIABILITY.  \nIf any Product furnished hereunder fails to conform to the above warranty, Customer ‟s sole  and exclusive remedy and PNI‟s sole \nand exclusive liability will be, at PNI‟s option, to repair, replace, or credit Customer ‟s account with an amount equal to the price \npaid for any such Product which fails during the applicable warranty period provided t hat (i) Customer  promptly notifies PNI in \nwriting that such Product is defective and furnishes an explanation of the deficiency; (ii) such Product is returned to PNI‟s  service \nfacility at Customer ‟s risk and expense; and (iii) PNI is satisfied that claimed  deficiencies exist and were not caused by accident, \nmisuse, neglect, alteration, repair, improper installation, or improper testing. If a Product is defective, transportation ch arges for \nthe return of the Product to Customer  within the United States and C anada will be paid by PNI. For all other locations, the \nwarranty excludes all costs of shipping, cus toms clearance, and other related charges. PNI will have a reason able time to make \nrepairs or to replace the Product or to credit Customer ‟s account. PNI warrants any such repaired or replacement Product to be \nfree from defects in material and workmanship on the same terms as the Product originally purchased.  \nExcept for the breach of warranty remedies set forth herein, or for personal injury, PNI shall have  no liability for any indirect or \nspeculative damages (including, but not limited to, consequential, incidental, punitive and special damages) relating to the use of \nor inability to use this Product, whether arising out of contract, negligence, tort, or un der any warranty theory, or for infringement \nof any other party‟s intellectual property rights, irrespective of whether PNI had advance notice of the possibility of any s uch \ndamages, including, but not limited to, loss of use, revenue or profit. In no even t shall PNI‟s total liability for all claims regarding \na Product exceed the price paid for the Product. PNI neither assumes nor authorizes any person to assume for it any other \nliabilities.  \nSome states and provinces do not allow limitations on how long an implied warranty lasts or the exclusion or limitation of \nincidental or consequential damages, so the above limitations or exclusions may not apply to you. This warranty gives you \nspecific legal rights and you may have other rights that vary by state or pro vince.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 4 of 41 2 Introduction  \nThank you for purchasing PNI Sensor Corporation‟s RM2100  or RM3100  Geomagnetic Sensor, \npn 90052  or pn 90053, respectively .  The RM2100  is comprised of two Sen-XY-f sensor  coils, \npn 13104 , and a MagI2C  ASIC  controller , pn 13156 , which  forms the basis for a 2 -axis digital \ncompass .  The RM3100  is the same as the RM2100  but adds a Sen-Z-f sensor  coil, pn 13101, \nsuch that compassing measurements are not const ricted to the horizontal plane.  \nPNI‟s geomagnetic sensor technology provides high resolution, low power consumption, large \nsignal noise immunity, a large dynamic range , and high sampling rates.  Measurements are stable \nover temperature and inherently free from offset drift.   The RM3100‟s MagI2C ASIC features \nboth continuous measurement mode and single measurement polling , software -configurable \nresolution and  sample rate, and the ability to operate one, two, or three PNI sensor coils.   And it \nincorporates both I2C and  SPI interface s for system design flexibility.  \nWhen implementing an RM3100  or RM2100  Geomagnetic Sensor, each sensor  coil serves as the \ninductive element in a simple LR relaxation oscillation circuit, where the coil‟s effective \ninductance is proportional to the magnetic field parallel to the sensor axis.  The LR circuit  is \ndriven by  the MagI2C ASIC , and the  MagI2C‟s internal clock is used to measure the circuit‟s  \noscillation frequency, and hence the mag netic field .  Since  PNI‟s  Geomagnetic Sensor works in \nthe frequency domain, resolution and noise are established cleanly by the number of MagI2C \ninternal clock  counts  (cycle counts) .  In comparison, fluxgate and MR technologies require \nexpensive and comple x signal processing to obtain similar resolution and noise, and in many \nrespects  the geomagnetic sensor ‟s performance  simply cannot be matched.   Also, t he output from \nthe MagI2C  is inherently digital and can be fed directly into a microprocessor, eliminati ng the \nneed for signal conditioning or an analog/digital interface between the sensor and a \nmicroprocessor.  The simplicity of PNI‟s  geomagnetic sensor combined with the lack of signal \nconditioning makes it easier and less expensive to implement than alter native fluxgate or \nmagneto -resistive (MR) technologies.  \nFor more information on PNI‟s magneto -inductive sensor technology, see PNI‟s whitepaper \n“Magneto -Inductive Technology Overview” at http://www.pnicorp.com/technology/papers . \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 5 of 41 3 Specifications  \n3.1 Geomagnetic Sensor  Characteristics  \nTable 3-1:  Geomagnetic Sensor  Performance1 \nParameter  Cycle Counts2 Units  50 100 200 \nField Measurement R ange3 -800 to +800 \uf06dT \nGain 20 38 75 LSB/\uf06dT \nSensitivity  50 26 13 nT \nNoise  30 20 15 nT \nNoise Density  @ Max. Single -Axis Sample Rate  1.2 nT/\uf0d6Hz \nRepeatability  over \uf0b1200 \uf06dT 15 8 8 nT \nHysteresis  over \uf0b1200 \uf06dT 15 nT \nLinearity over \uf0b1200 \uf06dT 0.5 % \nMaximum Single -Axis Sample Rate  \n   (divide by 3 for max. 3 -axis sample rate)  1600 850 440 Hz \nSingle-Axis Average Current @ 24 Hz Sample \nRate (equivalent  to 3-axis @ 8 Hz)  70 135 260 µA \nBias Resistor, Rb 121 \uf057 \nExternal Timing Resistor for Clock, REXT 33 k\uf057 \nCircuit Oscillation Frequency  180 kHz \nOperating Temperature  -40 to +85 C \n \nFootn otes:  \n1. Performance values  are typical .  Performance specifications established with a  supply  voltage of \n3.0 V, a bias resistor  of 121 Ω, an external timing resistor  of 33 kΩ, and with measurements taken \nat room temperature .  Other bias resistors, external timing resistors and operating voltages may \nbe used, but performance will differ from the values listed.   Contact PNI for additional information.  \n2. The cycle count setting  (eg. 50 ,100, and 200) is user-configurable and set in the Cycle Count \nRegisters .  See Section 4.1 for a discussion on how the RM3100 works, and Section 5.1 for how \nto set the Cycle Count R egisters.  \n3. Field measurement range is defined as the monotonic  region of the output characteristic curve.   \nField measurement range can be extended u sing different bias resistors.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 6 of 41 3.2 Sen-XY-f and Sen-Z-f Characteristics  \nTable 3-2:  Sen-XY-f and Sen-Z-f Absolute Maximum Ratings  \nParameter  Minimum  Maximum  Units  \nInput Pin Current  @ 25 C   50 mA \nVoltage Across Coil   2.0 VDC  \nStorage Temperature  -40 +85 C \nCAUTION:  \nStresses beyond those listed above may cause permanent damage to the device . These \nare stress ratings only.  Assuming operation with the MagI2C  per the guidelines in this \nmanual, these maximum ratings will not be violated . \nTable 3-3:  Sen-XY-f and Sen-Z-f Characteristics  \nParameter  Min Typical  Max Units  \nInductance1  500-600  \uf06dH \nDC resistance  @ 25C \uf0b115C 30  45 \uf057 \nResistance versus \ntemperature   0.4  %/C \nWeight  Sen-XY-f  0.06 [0.002]   gm [oz] \nSen-Z-f  0.09 [0.003]   gm [oz] \nOperating Temperature  -40  +85 C \nFootn ote: \n1. 1 V peak -to-peak across the coil @ 100 kHz sinewave .  No DC bias  resistance .  \nMeasured o rthogonal to Earth’s magnetic field . \n  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 7 of 41 3.3 MagI2C  Characteristics  \nTable  3-4:  MagI2C  Absolute Maximum Ratings  \nParameter  Minimum  Maximum  Units  \nAnalog/Digital DC Supply Voltage , AVDD & DV DD -0.3 +3.7 VDC  \nInput Pin Voltage  -0.3 AVDD or DV DD VDC  \nInput Pin Current @ 25C  -10.0 +10.0  mA \nStorage Temperature  -40° +125°  C \nCAUTION:  \nStresses beyond those listed above may cause permanent damage to the device . These \nare stress ratings only.  Operation of the device at these or other conditions beyond those \nindicated in the operational sections of the  specifications is not implied . \nTable  3-5:  MagI2C  Recommended  Operating Conditions  \nParameter  Symbol  Min Typ Max Units \nAnalog/Digital DC Supply Voltage1 AVDD, \nDV DD 2.0 3.0 3.6 VDC \nSupply Voltage \nDifference  \n(DVDD-AVDD) During Operation  ∆VDD_OP  -0.1 0 +0.1 VDC  \nAnalog Unpowered  ∆VDD_O FF DV DD-0.1 DV DD DV DD+0.1 VDC  \nVoltage Ripple on AVDD or DV DD VDD_ripple   0.05 VPP \nHigh level input voltage  VIH 0.7*D VDD  DVDD VDC  \nLow level input voltage  VIL 0  0.3*DVDD VDC  \nHigh level output current  IOH   -1 mA \nLow level output current  IOL 1   mA \nIdle Mode Current     1 µA \nLeakage Current @ DV DD pin \n(AV DD=AV SS=DV SS=0V, DV DD=3.6V )    100 nA \nOperating Temperature  TOP -40  +85 C \nFootn ote: \n1. Please contact PNI if operation at <2.0 V is required.  \n  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 8 of 41  \n3.4 Dime nsions, Packaging , and Pad & Mask Layout  \n3.4.1  Sen-XY-f \n \nFigure 3-1:  Sen-XY-f Sensor Dimensions  \n \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 9 of 41  \nDimensions in mm  \nFull reel is 50 00 pcs.  Smaller quantities on cut tape.  \nTape & reel meets ANSI/ EIA standard EIA -418-B \n \nFigure 3-2:  Sen-XY-f Tape and Reel Dimensions  \n \n \n \nNote:   PNI recommends a 5 mil stencil.  The solder paste area is much smaller than the pad \nto reduce sensor tilt and misalignment.  The above layout allows for rework:  for minimal \nfootprint, contact PNI.  \nFigure 3-3:  Sen-XY-f Recommended Solder Pad, Paste, & Mask Layout  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 10 of 41 3.4.2  Sen-Z-f \n \nFigure 3-4:  Sen-Z-f Sensor Dimensions  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 11 of 41  \nDimensions in mm  \nFull reel is 1200 pcs.  Smaller quantities on cut tape.  \nTape & reel meets ANSI/ EIA standard EIA -418-B \n \nFigure 3-5:  Sen-Z-f Tape and Reel Dimensions  \n \n \nNote:   PNI recommends a 5 mil stencil .  The solder paste area is much smaller than the pad \nto reduce sensor tilt and misalignment.  The abo ve layout allows for rework:  for minimal \nfootprint, contact PNI.  \nFigure 3-6:  Sen-Z-f Recommended Solder Pad, Paste, & Mask Layout  \n \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 12 of 41 3.4.3  MagI2C  \n \nFigure 3-7:  MagI2C  MLF Mechanical Drawing  \nNote :  PNI recommends not soldering to the exposed die pad  in the center of the ASIC  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 13 of 41  \n \nDimensions:  mm  \nFull reel is 5000 pcs.  Smaller quantities on cut -tape.  \nTape & Reel meets ANSI/EIA standard EIA -418 \nFigure 3-8:  MagI2C  MLF Tape Dimensions  \n3.5 Soldering  \nFigure 3-9 and Table 3-6 provide the recommended solder reflow profile and processing \nparameters for RM3100  components.  After soldering PNI components to a board, it is \npossible to wave solder the opposite side of t he PCB.  \nIMPORTANT:  PNI sensor  coils require the use of halide -free solder pastes and processes for \nreflow and cleaning.  Contact PNI if you would like recommendations.  \n \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 14 of 41  \nFigure 3-9:  Recommended Solder Reflow Profile  \n \nTable 3-6:  Recommended Solder Processing Parameters1 \nParameter  Symbol  Value  \nPreheat Temperature , Minimum  TSmin 150°C \nPreheat Temperature , Maximum  TSmax 200°C \nPreheat Time  (TSmin to TSmax)  60 – 180 seconds  \nSolder Melt Temperature  TL >218 °C \nRamp -Up Rate  (TSmax to T L)  3°C/second maximum  \nPeak Temperature  TP <260°C  \nTime from 25°C to Peak  (TP)  6 minutes ma ximum  \nTime above T L tL 60 – 120 seconds  \nSoak Time (within 5 °C of TP) tP 10 – 20 seconds  \nRampdown Rate   4°C/second maximum  \nFootn ote: \n1. Meets IPC/JEDEC J -STD-020 profile recommendations.  Sen-XY-f and Sen-\nZ-f classified as moisture sensitivity level 1.  MagI2C  MLF classified as \nmoisture sensitivity level 3.  \nPB  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 15 of 41 4 Geomagnetic Sensor  Overview  & Set -Up \n4.1 Overview  \nFigure 4-1 and Figure 4-2 provide  basic schematic s for implementing the RM3100  Sensor \nSuite when using the SPI interface and I2C interface, respectively .  The MagI2C  is at the \ncenter of the schematic, as it t ies the user‟s host controller, on the left,  to the th ree sensor  \ncoils, on the right .  Unused sensor conne ctions should remain floating.  \nNote:   RM3100  and RM21 00 Geomagnetic Sensors typically are used in compassing applications, \nwhere each channel represents a Cartesian coordinate  axis, X, Y, or Z .  For this reason, the term \n“axis”  generally  is used  instead of “channel” . \n \nFigure 4-1:  RM3100  reference schematic – SPI Configuration  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 16 of 41  \nFigure 4-2:  RM3100 reference schematic – I2C Configuration  \nA Sen-XY-f or Sen-Z-f sensor  coil serve s as the inductive element in a simple LR relaxation \noscillation circuit  which is  composed of an external bias resistor along with digital gates and \na comparator internal to the MagI2C .  The coil‟s  inductance is a function of  the magnetic \nfield strength .  As such, the frequency of oscillation  of the circuit  varies with the strength of \nthe total magnetic field parallel to the  sensor .  To make a measurement, one side of the coil is \ngrounded while the other side is alternately driven with positive and negative current through \nthe oscillator.  The circuit is driven for a set number of circuit oscillations , and the time to \ncomplete the oscillations  is measured  using the MagI2C ‟s internal high -speed clock.  The \nMagI2C  next switches the bias connection to the coil and makes another measurement.  The \nside that was previously grounded is now charged and discharged while the other is now \ngrounded . \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 17 of 41 Because:  \n\uf0b7 the total magnetic field represents the sum of the local  field and the circuit -induced \nfield, and  \n\uf0b7 the circuit -induced magnetic field has the same magnitude but opposite direction for \nthe two bias polarities,  \nthe local  magnetic field is proportional to the difference in the time to complete the \nmeasurement for each bias .  The difference in the number of clock oscill ations between the \nforward and reverse bias directions is output from the MagI2C , and this number is directly \nproportional to the strength of the local magnetic field in the direction of the sensor.  \nFigure 4-3 provides a detail of the biasing circuit .  For more  on PNI‟s magneto -inductive \ntechnology, refer to the “Magneto -Inductive Technology Overview” white paper found on \nPNI‟s website.  \n \n \nFigure 4-3:  LR Oscillator Circuit Biasing Diagram  \nSince PNI‟s  Geomagnetic Sensor Suite  works in the frequency domain, resolution is cleanly  \nestablished by the number of circuit oscillations .  Also, t he output from th e MagI2C  is \ninherently digital and can be fed directly into a microprocessor, which eliminates the need for \nsignal conditioning or an analog/digital interface between th e sensor and host processor.  \n4.2 Layout  \n4.2.1  Sensor Coil Orientation  \nFigure 4-4 indicates how the three sensor  coils in a RM3100  Geomagnetic Sensor should \nbe oriented  for a system referenced as north -east-down  (NED) .  The  arrow represents the \ndirection of travel or pointing.   The Sen -XY-f is insensitive to the location of the polarity \nindicator, while the location of the polarity indicator is critical for the Sen -Z-f. \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 18 of 41  \nFigure 4-4:  RM3100  North -East-Down (NED) Sensor Layout  \nIf the Sen-Z-f sensor  coil is flipped to the bottom of the board such that the polarity \nindicator still points back or the curved portion of the sensor still points forward , then to \nretain NED the  Sen-Z-f‟s ZDRVN and ZDRVP pads should be as shown above, except \non the bottom of the board .  As the pads on the Sen-Z-f have switched positions, the \nconnections to the Sen-Z-f sensor will be  reversed.  \n4.2.2  Local Magnetic Field Considerations  \nBecause  the RM3100 sensor  measure magnetic field, it is important to consider what \nitems in the vicinity of the sensors can affect the sensor readings.  Note that magnetic \nfield drops off as (1/distance )3.  Specific issues to consider include : \n\uf0b7 The sensors have a specified linear r egime of \uf0b1200 \uf06dT.  (Earth‟s field is ~50 \uf06dT.)  \nTo ensure the sensors operate in their linear regime, do not place the sensors close \nto large electric currents, large masses of ferrous material, or devices \nincorporating permanent magnets, such as speakers a nd electric motors.  \n\uf0b7 Locate the sensor  coils away from changing magnetic fields.  If this is not \npossible, but the local magnetic field is known to have multiple states , try to take \nreadings only when the field is in a known state.  For instance, if a motor  runs part \nof the time, take readings only whe n the motor is in a known state.  \n\uf0b7 If you are uncertain about the effect a specific component may have on the \nsystem, the RM3100  Evaluation Board can be used to help ascertain this.  Place  \nthe RM3100  Evaluation Board on a firm surface and gradually bring the \ncomponent in question close to the board, then  note when the magnetic field starts \nto change.  If the component cannot be moved, then gradually move the RM3100  \nEvaluati on Board towards the compone nt, carefully ensuring  the orientation of the \nboard rema ins constant while doing this.  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 19 of 41 \uf0b7 If an RM3100  Evaluation Board is not available, gradually bring the component \nin question closer to one of the sensor  coils and observe when the sensor reading \nfrom the MagI2C starts to change.  \n4.2.3  Other Layout Considerations  \nOther design considerations include:  \n\uf0b7 To minimize the effect of gradients in the magnetic field , position the sensor coils  \nas close to each other as possible.  \n\uf0b7 To reduce coupling to and from other signals,  keep the two traces from the \nMagI2C  to each sensor coil as clo se as possible to each other.  PNI recommends \nlocating the  MagI2C  within 10  cm from the sensor  coils. \n\uf0b7 Keep capacitors, especially tantalum capacitors,  far away from the sensor  coils. \n4.3 MagI2C  Pin-Out \nThe MagI2C ‟s pin-out is summarized  on the following page  in Table  4-1.  Pin numbers run \ncounterclockwise, when looking from the top , starting at the Pin 1 designator as shown in  \nFigure 3-7. \n4.3.1  General Pins  \nAVDD and DVDD ( pins 4, 14, & 26)  \nAVDD and DVDD should be tied to the analog and digital supply voltages, \nrespectively.  The recommend voltages are defined in Table  3-5, and the maximum \nvoltages are given in Table  3-4.  DVDD must be on whenever AVDD is on, so \nDVDD should either be brought up first or at precisely the same time as AVDD.  \nAVDD can be turned off when not making a measurement to conserve power , since \nall other operations are supported with DVDD.  Under this condition, register values  \nwill be retained as long as DVDD is powered.  Also, AVDD must be within 0.1 V of \nDVDD when AVDD is on.  \nAVSS and DVSS ( pins 5 & 19 ) \nAVSS and DVSS should be tied to  the analog and digital ground, respectively.  \nAssuming the ground plane is clean, they may share a common ground.  \nAlternatively, t hey may have their own ground planes if this is more convenient.  \nDVSS and AVSS should be within 0.1  V of each other.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 20 of 41 Table  4-1:  MagI2C Pin Assignments  \nPin#  Pin Name  Description  \n1 MOSI /  \nSDA SPI interface (MOSI) – Master Output, Slave Input Serial Data  \nI2C interface (SDA) – Serial Data Line  \n2 RES Reserved – connect to ground  \n3 SSN /  \nSA0 SPI interface – Active low to select port  \nI2C interface – Bit 0 of MagI2C’s slave address  \n4 AVDD Supply voltage for analog section of ASIC  \n5 AVSS Ground pin for analog section of ASIC  \n6 ZDRV P Z sensor drive output  \n7 ZINP Z sensor measurement input  \n8 ZINN Z sensor measurement input  \n9 ZDRV N Z sensor drive output  \n10 YDRV P Y sensor drive output  \n11 YINP Y sensor measurement input  \n12 YINN Y sensor measurement input  \n13 YDRV N Y sensor drive output  \n14 DV DD Supply voltage for digital section of ASIC . \n15 XDRVP X sensor drive output  \n16 XINP X sensor measurement input  \n17 XINN X sensor measurement input  \n18 XDRV N X sensor drive output  \n19 DV SS Ground pin for digital section of ASIC  \n20 RES Reserved – connect to ground  \n21 NC Do not connect  \n22 I2CEN I2C enable  pin (HIGH = I2C, LOW = SPI)  \n23 DRDY  Status line  \n24 NC Do not connect  \n25 REXT External timing resistor for high speed clock.  \n26 DV DD Supply voltage for digital section of ASIC . \n27 SCLK /  \nSCL SPI interface (SCLK) – Serial clock input  \nI2C interface (SCL) – Serial clock line  \n28 MISO /  \nSA1 SPI interface (MISO) – Master Input, Slave Output  \nI2C interface – Bit 1 of MagI2C’s slave address  \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 21 of 41 Sensor Drive and Measurement Pins  (pins 6 – 13 & 15 – 18) \nThe various sensor drive and measurement pins should be connected to the sensor  \ncoils.  For a north -east-down (NED) reference frame, the connections should be as \ndefined in Figure 4-4. \nI2CEN (pin 22 ) \nThis pin should be pulled LOW when using the SPI interface or pulled HIGH when \nusing the I2C interface.  \nDRDY ( pin 23 ) \nDRDY is used to ensure data is read from the MagI2C only when it is available.  The \nDRDY pin will go HIGH when the measurement is complete.  This signals the host \nthat data is ready to be read.  The DRDY pin automatically is set LOW when the \nMeasurement Result registers are read or a write operation is performed.  \nIt is not mandatory to  use the DRDY pin, as alternative methods exist to determine if \ndata is available.  Specifically, the STATUS r egister provides this information.  And, \nif using the SPI interface  where CPHA=CPOL=1 , the MISO line also  indicates if data \nis available when SSN is LOW.  \nREXT (pin 25 ) \nREXT ties to the external timing resistor for the high -speed clock.  The recommended \nvalue for the resistor and associated clock speed are defined in Table 3-1. \n4.3.2  SPI Pins  \nMOSI ( pin 1) \nMOSI is an SPI input that provides  data from the master  device  to the MagI2C .  Data \nis transferred mos t significant bit first.  D ata m ust be presented at least 50 ns  before \nthe rising edge of SCLK, and remain valid for 50 ns  after the edge.  New  data \ntypically is presented to the MO SI pin on the falling edge of S CLK.  \nSSN ( pin 3) \nThis signal sets the MagI2C as the operating slave device on the SPI bus.  The SSN \npin must be LOW prior to data transfer in ei ther direction, and must stay LOW during \nthe entire transfer.  \nThe SSN pin must transition from HIGH to LOW prior to reading from or writing to \nthe registers .  It must stay LOW for the remainder of the operation.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 22 of 41 After communication between the MagI2C and m aster device is finished, the SPI bus \ncan be freed up (SSN pin set HIGH) to communicate with other slave devices while \nthe MagI2C takes a measurement or is idle.  \nSCLK ( pin 27 ) \nSCLK is a SPI input u sed to synchronize the data sent in and out throu gh the MIS O \nand MOSI pins.  SCL K is generated by the customer -supplied  master device  and \nshould be 1 MHz or less.  One byte of data is exch anged over eight clock cycles.  \nData is captured by the master device on the rising edge of SCLK.  Data is shifted out \nand pres ented to the MagI2C on the MOSI pin on the falling edge of SCLK, except \nfor the first bit (MSB) which must be present before the first rising edge of SCLK.  \nMISO ( pin 28) \nMISO is an SPI output that sends d ata from the MagI2C  to the master  device .  Data is \ntransferr ed most significant bit first and is captured by the master device on the rising \nedge of SCLK.  The MISO pin is placed in a high impedance state if the MagI2C is \nnot selected (i.e. if SSN=1).  \n4.3.3  I2C Pins  \nSDA  (pin 1) \nThe SDA line is a bi -directional li ne used to send commands to the MagI2C and used \nto transmit data from the MagI2C.  Data is transferred most significant bit first.  All \ncommunication between the host and the MagI2C occurs on this line when \nimplementing the I2C interface.  \nSA1 (pin 3) \nSA1 represents the second -least significant bit in the MagI2C‟s slave address.  \nPulling this HIGH represents a „1‟ and pulling it low represents a „0‟.  Along with pin \n28 (bit 0) and the higher 5 bits (0b01000) , which are pre -defined in hardware, SA1 \nestab lishes the 7 -bit slave address of the MagI2C on the I2C bus.  \nSCL ( pin 27) \nSCL is u sed to synchronize the data sent in and out throu gh the SDA pin.  SCL  is \ngenerated by the customer -supplied  master device  and should be 1 MHz or less.  Data \nis captured by th e master device on the rising edge of SCL.  Data is shifted out and \npresented to the MagI2C on the SDA pin on the falling edge of SCL, except for the \nfirst bit which must be present before the first rising edge of SCL.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 23 of 41 SA0 (pin 28) \nSA0 represents the least  significant bit in the MagI2C‟s slave address.  Pulling this \nHIGH represents a „1‟ and pulling it low represents a „0‟.  Along with pin 3 (bit 1) \nand the higher 5 bits (0b01000), which are pre -defined in hardware, SA0 establishes \nthe 7 -bit slave address o f the MagI2C on the I2C bus.  \n4.4 SPI Timing Requirements  \nThe MagI2C can act as a slave device on a SPI bus.  The  SPI interface consists of four \nsignals, as carried on SCLK, MOSI, MISO, and SSN.   The SPI clock, SCLK,  should run at \n1 MHz or less.  Data sent out on MOSI  is considered valid while  SCLK is HIGH, and  data is \nin transition  when SCLK is LOW.    The first byte sent to the MagI2C contains  the \nRead/Write bit (Write=0) followed by the 7 -bit register address.  When the register address \nbyte is rece ived the MagI2C returns the STATUS register contents.  Assuming SSN stays \nlow and SCLK continues, multiple registers can be written to or read from as the MagI2C \nwill automatically increment to the next register address.   The clock polarity when the bus is  \nidle can either be LOW (CPOL=CPHA=0) or HIGH (CPOL=CPHA=1).  \nAs long as SSN is LOW data can transfer to or from the MagI2C.  Generally it is a good idea \nto pull SSN to HIGH after a read or write operation has completed such that the SPI bus can \nbe freed up for other devices.  The MagI2C can perform measurements whil e the SSN line is \nHIGH, as this does not involve communication with the master.  Pulling the SSN to HIGH \nduring a data read or write will terminate the transaction.  \nThe timing parameters, defined in Figure 4-5 or Figure 4-6 and specified in Table  4-2, must  \nbe met  to ensure reliable communication.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 24 of 41  \nFigure 4-5:  SPI Timing Diagram , CPOL = CPHA = 0  \n \nFigure 4-6:  SPI Timing Diagram, CPOL = CPHA = 1  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 25 of 41 Table  4-2:  SPI Timing Specifications  \nSymbol  Description  Min Max Units  \ntSHZD SSN LOW to data output   100 ns \ntSSDV SSN LOW to Command Byte  100  ns \ntDBSH Setup data before  active edge  50  ns \ntDASH Hold data after  active edge  50  ns \ntDRDV Clock falling edge to valid data   10 ns \ntSSH Final clock cycle falling edge to SSN HIGH  100  ns \ntSHDZ SSN HIGH to output data tri -state   100 ns \ntSSW SSN HIGH to LOW (time between transactions)  100   \n \n4.5 I2C Requirements  \nThe MagI2C can operate as a slave device on an I2C bus.  It is identified by a 7 -bit slave \naddress.  The higher  5 bits of the slave address are pre -defined in hardware and the same for \nall MagI2C devices.  PNI has registered these first 5 bits as 0b01000.  The lower 2 bits of the \nslave address are user -configurable, using pin s 3 and 28.  As such, 4 different slave addresses \nare possible .  For example, setting pin 3 HIGH and pin 28 LOW results in an address of \n0b0100001.  \nThe MagI2C‟s I2C interface complies with NXP‟s UM10204 specification and user manual, \nrevision 03.  Standard, fast, fast plus, and high speed modes of the I2C protocol are \nsupported.  Below is a link to this document.  \nhttp://www.nxp.com/documents/user_manual/UM10204.pdf  \n4.5.1  I2C Register Write  \nA generic Write transaction is given below.  \nSTART  MagI2C  ADDRESS  RW ACK MagI2C  REG. ADDRESS (N)  ACK DATA TO REGISTER (N)  ACK DATA TO REGISTER (N+1)  ACK STOP  \nS A6 A5 A4 A3 A2 A1 A0 0 0 A7 A6 A5 A4 A3 A2 A1 A0 0 A7 A6 A5 A4 A3 A2 A1 A0 0 A7 A6 A5 A4 A3 A2 A1 A0 0 P \n                                      \n  From Host to MagI2C    \n ------------   Data Transferred (n bytes + acknowledge)  ------------   \n  From MagI2C to Host     \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 26 of 41 All communication is on the SDA line.  The transaction is initiated by the host, or master , \nsending the Start condition followed by the MagI2C‟s slave address, and then the RW bit \nis set to „0‟, indicating a Write operation.  The slave address is acknowledged by the \nMagI2C by setting SDA to LOW.  This is followed by the desired 7 -bit register address \nand then the register data.  The register value automatically increments after every \nreceived data byte.  The transaction is terminated by the host sending the Stop condition.  \nThe MagI2C will always acknowledge the start of an I2C Write transaction by sending a \n„0‟ (i.e. the ACK signal).  But if the Write command cannot be executed for some  reason \nthe MagI2C will send a „1‟ instead (i.e. the NACK signal).  The reasons a NACK signal \nmight be sent are established by the HSHAKE register, and include writing to an \nundefined register or writing to the POLL register while CMM is in progress, or vi ce \nversa.  See Section 5.6.2  for more information.  \n4.5.2  I2C Register Read  \nTo perform a Read transaction, it is first necessary for the master to  Write the desired \nregist er address, and then to Read the register data.  A generic transaction is given below.  \nSTART  SLAVE ADDRESS  RW ACK REGISTER ADDRESS (N)  ACK STOP  \nS A6 A5 A4 A3 A2 A1 A0 0 0 A7 A6 A5 A4 A3 A2 A1 A0 0 P \n                    \n  From Host to MagI2C              \n  From MagI2C to Host              \n \nSTART  SLAVE ADDRESS  RW ACK DATA FROM REG. (N)  ACK DATA FROM REG. (N+1)  NACK  STOP  \nS A6 A5 A4 A3 A2 A1 A0 1 0 A7 A6 A5 A4 A3 A2 A1 A0 0 A7 A6 A5 A4 A3 A2 A1 A0 1 P \n                             \n     \n--------------   Data Transferred (n bytes + acknowledge)  --------------   \n      \n \nThe Write sequence is described in the prior section,  except for this case there is no data \nto send.  For the Read sequence the host again sends the MagI2C‟s slave address, but this \ntime sets the RW bit is set to „1‟.  The MagI2C acknowledges that it is has been \naddressed and then sends data from the registe r address that was previously sent.  The \nhost acknowledges receipt of the data, and then the MagI2C increments the register \naddress and sends data from this register.  This continues until the host sends the NACK \ncommand followed by the Stop command, which  terminates the transaction.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 27 of 41 5 MagI2C  Operation  \nThe primary functions of the MagI2C  are: \n\uf0b7 Set the Cycle Count Registers if the default is not desired.  \n\uf0b7 Initiate either a Single Measurement or Continuous Measurement.  \n\uf0b7 Confirm New Data Ready.  \n\uf0b7 Read the Measurement  Results Registers.  \nEach of these steps is discussed in detail in the following sections.  \nNote:   The MagI2C  incorporates an Idle Mode to reduce power consumption .  The device  automatically \nidles when not exchanging data or taking a measurement.  The MagI2C  starts in Idle Mode at power -up. \nThe MagI2C‟s register map is given in Table  5-1.  Register address es are 7 bits.  To Write to a \nregister, a „0‟ followed by the 7-bit register number  should be sent, followed by the register \nvalue .  To Read from a register, a ‘1’ followed by the 7 -bit register number  should be  sent, \neffectively adding 0x80 to the register number . \nTable  5-1:  MagI2C Register Map  \nName  Register  # \n(Hex)  R/W Default  \n(Hex)  Payload \nFormat  Description  \nPOLL  00 RW 00 [7:0] Polls for a Single Measurement  \nCMM  01 RW 00 [7:0] Initiates Continuous Measurement Mode  \nCCX  04 – 05 RW 00C8  UInt16  Cycle Count Register – X Axis \nCCY  06 – 07 RW 00C8  UInt16  Cycle Count Register – Y Axis  \nCCZ 08 – 09 RW 00C8  Uint16  Cycle Count Register – Z Axis  \nTMRC  0B RW 96 [7:0] Sets Continuous Measurement Mode Data Rate  \nMX 24 – 26 R 000000  Uint24 Measurement Results – X Axis \nMY 27 – 29 R 000000  Uint24 Measurement Results – Y Axis \nMZ 2A – 2C R 000000  Uint24 Measurement Results – Z Axis \nBIST  33 RW 00 [7:0] Built-In Self Test  \nSTATUS  34 R 00 [7:0] Status of DRDY  \nHSHAKE  35 RW 1B [7:0] Handshake Register  \nREVID  36 R -- Unit8  MagI2C Revision Identification  \n5.1 Set the Cycle Count Register s (0x04 – 0x09)  \nThe Cycle Count Registers  establish the number of sensor oscillation cycles (cycle counts) \nthat will be counted for each sensor in both the forward and reverse bias directions during a \nmeasurement sequence.  Each sensor has its own cycle count value, and each can be \ndifferent.  Increasing the cycle count value increases measurement gain and resolution.  \nLowering the cycle count value reduces acquisition time, which increases maximum \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 28 of 41 achievable sample rate or, with a fixed sample rate, decreases power consumption.  The \nCycle Count read and write addresses, plus their default values, are given in Table  5-2 \nTable  5-2:  Cycle Count Registers  \nRegister Description  Default \nValue (Hex)  Write  Address \n(Hex)  Read  Address \n(Hex)  \nX Axis Cycle Count Value - MSB  0x00  04 84 \nX Axis Cycle Count Value - LSB 0xC8  05 85 \nY Axis Cycle Count Value - MSB  0x00  06 86 \nY Axis Cycle Count Value - LSB 0xC8  07 87 \nZ Axis Cycle Count Value - MSB  0x00  08 88 \nZ Axis Cycle Count Value - LSB 0xC8  09 89 \n \nSince the registers are adjacent, it is not necessary to send multiple register addresses, as the \nMagI2C automatically will read/write to the next adjacent register.  \nThe default value s for the Cycle Count Registers are 0xC8 in the LSB and 0x0 in the MSB, \nor 200 D.  This default value provides a good trade -off between acquisition time and \nresolution, but favors  resolution.  If the user is more interested in low power consumption or \nrunning at high data rates, a lower cycle  count value of (ex. 50D or 100 D) would be more \nappropriate.  To estimate the appropriate cycle cou nt value for your application review the \nspecifications given at 50, 100, and 200 cycle counts in Table 3-1.  Note that these 3 cycle \ncounts by no means represent all the cycle count options, as the minimum value is „0‟ and the \nmaximum is 65,536.  Having said this, quantization issues generally dictate working above a \ncycle count value of ~30, while noise limits the useful upper range to ~400 cycle counts.  \nAssuming  a non -default  cycle count value  is desired , then p rior to sending a command to \ntake a sensor measurement it is necessary  to Write values to the Cycle Count R egisters.  \nOnce the  Cycle Count R egisters are set, they do not need to be repopulated unless the user \nwants to change the values  or the system is powered down, in which case the default value  \nrepopulate s the regist er fields when powered up again . \n5.2 Initiate  Continuous Measurement Mode  (0x01)  \nThe MagI2C can either take measurements automatically on a regular frequency (Continuous \nMeasurement Mode) or by polling for  single measurement .  This section discusses \nContinuous Measurement Mode .  See Section 5.3 for polling a single measurement . \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 29 of 41 To initiate Continuous Measurement M ode, write  to the CMM  register  address , 0x01 , \nfollowed by the CMM register contents .  To set the rate of data acquisition  in Continuous \nMeasurement Mode, see Section 5.2.1 .  Below are the contents of the CMM register.  \nBit # 7 6 5 4 3 2 1 0 \nValue  Reserved  \nSet to 0  CMZ CMY CMX 0 DRD M Reserved  \nSet to 0  START  \n \nWhere:  \n\uf0b7 START – A “1” in this bit position initiates Continuous Measurement Mode.   To turn \noff Continuous Measurement Mode it is necessary to write  a “0” to this bit position.  \nNote that writing to POLL  (i.e. initiating a single measurement c ommand ) while \noperating in Continuous Measurement Mode results in the single measurement \ncommand  being ignored.  \n\uf0b7 DRDM – These two bits establish the required condition to trigger the DRDY pin to \nHIGH.  There are 4 pos sible conditions, as set out in Table  5-3. \n \nTable  5-3:  Continuous Mode DRDY  Options  \nDRDY Requirements  DRDM  \nDRDY to HIGH after a full measurement \nsequence is completed, as established by \nCMX, CMY, and CMZ.  0 \nDRDY to HIGH after the completion of a \nmeasurement on any axis.  1 \n \n\uf0b7 CMX, CMY, CMZ  – A “1” in either of these three bit positions indicates a \nmeasurement will be taken on that sensor axis when operating in Continuous \nMeasurement Mode.  For instance, to take measurements on all three axis, CMX = \nCMY = CMZ = 1.  \n \nTo read from the CMM regis ter, send 0x81.  The return byte will provide the same \ninformation  as above . \nNote:   Certain commands, such as r eading from the CMM register  or writing to the TMRC register,  \nwill terminate  Continuous Measurement Mode.  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 30 of 41 5.2.1  Setting the CMM Update  Rate with TMRC (0x0B)  \nThe time between measurements in Continuous Measurement Mode is established with \nthe TMRC register.  The TMRC register is defined below.  \nBit # 7 6 5 4 3 2 1 0 \nValue  1 0 0 1 TMRC3  TMRC2  TMRC1  TMRC0  \n \nThe LSB is used set the CMM updatee  rate.  The MSB should be 0x9, as indicated above.  \nThe larger the TMRC value, the longer the interval between measurements.  Available \ndata rates are given in Table  5-4.  Note that the update rates are approximate, and  have  a \none standard deviation tolerance of about ~7%.  The default value for TMRC is 0x96, \nestablishing a data update rate of ~37 Hz.  \nTo set the TMRC register, send the register address, 0x0B, followed b y the desired \nTMRC register value.  To read the TMRC register, send 0x8B.  \nNote:   The Cycle Count Registers establish the maximum data rate of the sensors.  For instance, \nif the cycle count is set to 200 D, then the maximum 3 -axis update rate is ~430 Hz.  If  TMRC is set \nto 0x92 , indicating an update rate of ~6 00 Hz, the rate established by the cycle count will override \nthe TMRC request, and the actual update rate will be ~430 Hz.  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 31 of 41 Table  5-4:  CMM  Update  Rates  \nTMRC  Value  \n(Hex)  Time Between \nReadings  Update  \nRate  \n92 ~1.7 ms ~600 Hz  \n93 ~3 ms ~300 Hz \n94 ~7 ms ~150 Hz \n95 ~13 ms ~75 Hz \n96 ~27 ms ~37 Hz \n97 ~55 ms ~18 Hz \n98 ~110  ms ~9 Hz \n99 ~220 ms ~4.5 Hz \n9A ~440 ms ~2.3 Hz \n9B ~0.8 s ~1.2 Hz \n9C ~1.6 s ~0.6 Hz \n9D ~3.3 s ~0.3 Hz \n9E ~6.7 s ~0.01 5 Hz \n9F ~13 s ~0.075 Hz \n \n5.3 Initiate  a Single  Measurement (0x00)  \nThe MagI2C can operate in either a continuous measurement mode or a polling mode.  This \nsection discusses the Single Measurement Command used in a polling mode.  See Section 5.2 \nfor operation in continuous measurement mode.  \nTo make a single measurement it is necessary to write  the POLL address register, 0x00, and \nfollow this by the POLL  register byte which establishes which axes are to be measured.  It is \ndefined as  shown below , where a “1” for PMX, PMY, and/or PMZ indicates the X, Y, and/or \nZ axis, respectively, is to be measured.   Note that the DRDY line will go HIGH after all \nmeasurements requested in the Single Measurement Command byte have been completed.  \n \nBit # 7 6 5 4 3 2 1 0 \nValue  0 PMZ PMY PMX 0 0 0 0 \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 32 of 41 5.4 Confirm New Data Ready  \nThere are several ways to determine if a measurement has been completed and data is \navailable in the Measurement Results Register s.  One method is monitoring the DRDY line \nfor it to go HIGH.  Recall that for continuous measurement mode, the DRDM bits of the \nContinuous Measurement Command byte establish the conditions for DRDY to go HIGH.  \nAnother option when using the SPI interface i s monitoring the MISO pin for it to go HIGH.  \n(The MISO pin is unavailable when using the I2C interface, as it is used to set the slave \naddress of the device.)  Another option is to read from the STATUS  register , as discussed \nbelow . Only one method need be  used.  \n5.4.1  STATUS Register (0x34)  \nTo read the Stat us Register, first send a read command to the STATUS register, 0xB4.  \nThe return byte provides the contents of the Status Register:  \nBit # 7 6 5 4 3 2 1 0 \nValue  DRDY  - - - - - - - \n \nBit 7 will be HIGH if data is  available and LOW if it is unavailable.  Bits 0 – 6 are \nindeterminate and should be ignored.  \n5.5 Read the Measurement Results  \nEach sensor reading consists of 3 bytes of data which are stored in 2‟s complement format \n(range: -8388608  to 8388607) in the Results  Registers within the MagI2C  and this number is \ndirectly proportional to the strength of the local magnetic field in the direction of the \nspecified axis .  Note that the greater the Period Select value, the higher the resolution of the \nmeasurement and the l onger the sample time. These registers are read by sending the Read \nResults byte, as defined below, where the values of A, B, C, and D establish the register to be \naddressed, as given in Table  5-5. \nBit # 7 6 5 4 3 2 1 0 \nValue  1 0 1 0 A B C D \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 33 of 41 Table  5-5:  Measurement Results Registers  \nRegister Description  Write Address \n(Hex)  Read  Address \n(Hex)  \nX Axis Measurement (2) 24 A4 \nX Axis Measurement (1) 25 A5 \nX Axis Measurement (0) 26 A6 \nY Axis Measurement (2)  27 A7 \nY Axis Measurement (1)  28 A8 \nY Axis Measurement (0)  29 A9 \nZ Axis Measurement (2)  2A AA \nZ Axis Measurement (1)  2B AB \nZ Axis Measurement (0)  2C AC \n \nNormally it is only necessary to send “A4 H”, since the register value automatically \nincrements on the clock cycles such that after sending “A4 H” all 3 bytes for the X axis \nmeasurement would be clocked out, then the 3 bytes for the Y  axis measurement, then the 3 \nbytes for the Z axis measurement.  After these 9 bytes have been clocked out, the subsequent \noutput data has no relevance.  \n5.6 Troubleshooting and General Information  \nThe MagI2C incorporates several registers that can be used to h elp troubleshoot the system \nor device.  These include the Built -In Self Test (BIST) register, the Handshake register, and \nthe RevID register.  \n5.6.1  Built -In Self Test  Register (0x33)  \nThe Built -In Self Test ( BIST ) register checks the status of the internal LR circuit \noscillator .  Write to the BIST register by sending 0x33 followed by the BIST register  \nvalues , and request a read from the BIST register by sending 0xB3.  The register contents \nare defined below.   \nBit # 7 6 5 4 3 2 1 0 \nValue  STE ZOK YOK  XOK  BW1  BW0  BP1 BP0 \n` \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 34 of 41 Where:  \n\uf0b7 STE – Setting this to „1‟ commands the MagI2C to run the built -in self test when \nthe POLL register is written to.  The end of the built -in self test sequence will be \nindicated by DRDY going HIGH.  \n\uf0b7 ZOK, YOK, and XOK – These read -only bits indicate whether or not the X, Y, \nand Z LR oscillator s functioned correctly during the built -in self test.  A „1‟ \nindicates a properly function oscillator.   Note that STE also should be HIGH \nwhen this is read,  or the reading is invalid.  \n\uf0b7 BW – These two bits define the timeout period for the LR oscillator periods, as \ngiven in Table  5-6. \nTable  5-6:  BIST Timeout Period  \nBIST Wait Time  BW1  BW0  \nUnused  0 0 \n1 Sleep Oscillation Cycle (30 µs) 0 1 \n2 Sleep Oscillation Cycles (60 µs) 1 0 \n4 Sleep Oscillation Cycles (120 µs) 1 1 \n \n\uf0b7 BP – These two bits define the number of LR periods for measurement during the \nbuilt-in self test, as given in Table  5-7. \nTable  5-7:  BIST LR Periods  \nBIST LR Periods  BW1  BW0  \nUnused  0 0 \n1 LR Period  0 1 \n2 LR Periods  1 0 \n4 LR Periods  1 1 \n \n5.6.2  HSHAKE  Register (0x35)  \nThe HSHAKE register is used to set conditions for clearing the DRDY pin and for \ndetermining why a register command was not fulfilled.  Write to the HSHAKE  register \nby sending 0x3 5 followed by the BIST register values, and request a read from the \nHSHAKE  register by sending 0 xB5.  The register contents are  defined below.   \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 35 of 41 Bit # 7 6 5 4 3 2 1 0 \nValue  0 NACK2  NACK1  NACK0  1 0 DRC1  DRC0  \n \nWhere:  \n\uf0b7 DRC0 – Setting this to „1‟ means DRDY is cleared by any device register write .  \nClearing occurs during reception of the register address byte for the write \ntransaction on either the SPI or I2C interface.  This is the default setting.  \n\uf0b7 DRC1 – Setting this to „1‟ means DRDY is cleared by reading the Measurement \nResults registers.  Clea ring occurs when the MagI2C sends back the first byte of \ndata.  This is the default setting.  \n\uf0b7 NACK0 – This read-only bit is set to „1‟ when writing to an undefined register.  \n\uf0b7 NACK1 – This read-only bit is set to „1‟ when writing into POLL when CMM is \nin prog ress or when writing to CMM when POLL is in progress.  \n\uf0b7 NACK2 – This read -only bit is set to „1‟ when a read for the Measurement \nResults registers is requested but data is not ready (DRDY = 0).  \n5.6.3  REVID Register (0x36)  \nThe REVID register provides revision identification of the MagI2C.  This is a single byte, \nread-only register.  To read the REVID register, send 0xB6.  \n5.7 Examples  using the SPI Interface  \n5.7.1  Set the Cycle Count Registers  \nA sample command sequence is provided below which sets the cycle count value to  100 D \n(64 H) for all 3 axes.  This is purely for illustrative purposes and the value could be \ndifferent and/or the number of axes to be addressed could be different.  \n\uf0b7 Start with SSN set HIGH, then set SSN to LOW.  \n\uf0b7 Send 04 H (this is the Write Command Byte to a ddress the MSB for the X axis)  \n\uf0b7 Send 0 (value for the MSB for the X axis)  \n\uf0b7 Send 64 H (value for the LSB for the X axis - pointer automatically increments)  \n\uf0b7 Send 0 (value for the MSB for the Y axis - pointer automatically increments)  \n\uf0b7 Send 64 H (value for the LSB  for the Y axis - pointer automatically increments)  \n\uf0b7 Send 0 (value for the MSB for the Z axis - pointer automatically increments)  \n\uf0b7 Send 64 H (value for the LSB for the Z axis - pointer automatically increments)  \n\uf0b7 Set SSN to HIGH  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 36 of 41 5.7.2  Making and Reading Measurement s \nFigure 5-1 gives the SPI activity sequence for initiating a single measurement and \nreading the results.  The MagI2C works  for either CPOL =CPHA=0 or CPOL=CPHA=1, \nso both cases are given.  The assumption in the diagram is that the DRDY pin or the \nMISO line is used to establish when data is  ready, but a query of the Status Register \ncould be used instead.  SPI timing requirements are discussed in Section  4.4. \n \nFigure 5-1:  SPI Activity Sequence Diagram  \n\n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 37 of 41 The steps to make measurements in Continuous Measurement Mode are given below.  \n\uf0b7 Start with SSN set HIGH,  then s et SSN to LOW.  \n\uf0b7 Initiate Continuous Measurement Mode by writing to the CMM register address, \n0x01, followed by the CMM register value.  This value defines which axes are to \nbe measured, how the DRDY line will be set HIGH.  Assuming all 3 axes are to \nbe measured, DRDY goes HIGH after completing measurements on all axes, the \nCMM value would be 0x79.  \n\uf0b7 The RM3100 Evaluation Board will now initiate Continuous Measurement Mode . \n\uf0b7 Return SSN to HIGH.  This will not affect the measurement process, but will free \nup the host to communicate with other devices and ensure the next write \ncommand sent to the module is interpreted properly.  \n\uf0b7 Once the measurement sequence is completed on all axes the MISO pin goes low \nand the D RDY pin is set HIGH , assuming 0x79 is the CMM register value.  The \nmodule will be placed in Idle Mode until it is time to take another measurement, \nas defined by the TMRC register.  \n\uf0b7 When the host is ready to read the measured values, s et SSN to  LOW.  If SSN \nalready is LOW, then toggle SSN from LOW to H IGH to LOW.  \n\uf0b7 Assuming the X axis was one of the axes to be measured, send the MX2 Read \naddress, 0xA4, to begin reading the Measurement Results registers.  The \nmeasurement readings will now clock out, with the 3 bytes of X -axis data \npresented first, then Y -axis data, then Z -axis data.  The first nine (9) bytes \nrepresent a complete 3 -axis measurement.  This will clear the DRDY line.  \n\uf0b7 Return SSN to HIGH to free up the host to communicate with other devices and \nto ensure the next Command Byte sent to the module i s interpreted properly.  \nThe steps to make  a single measurement are given as follows . \n\uf0b7 Start with SSN set HIGH, then s et SSN to LOW.  \n\uf0b7 Initiate a single measurement by writing to  the POLL register address, 0x 00, \nfollow ed the register address with either the PO LL register value.  This define s \nwhich axes are to be measured , and should be 0x70 if measurements on all three \naxes are desired.  \n\uf0b7 The MagI2C will now take the prescribed measurements . \n\uf0b7 Return SSN to HIGH.  This will not affect the measurement process, but w ill free \nup the host to communicate with other devices and ensure the next write \ncommand sent to the MagI2C is interpreted properly.  \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 38 of 41 \uf0b7 Once the measurement  sequence  is completed  on all desired axes , the D RDY pin \nis set HIGH  and the MISO pin goes low , indicat ing data is read.  The  MagI2C is \nplaced in Idle Mode.  \n\uf0b7 When the host is ready to read the measured values, s et SSN to  LOW.  If SSN \nalready is LOW, then toggle SSN from LOW to HIGH to LOW.  \n\uf0b7 Assuming the X axis was one of the axes to be measured, send the MX2 Read \naddress, 0x A4, to begin reading the Measurement R esults registers.  The \nmeasurement readings will now clock out, with the 3 bytes of X -axis data \npresented first, then Y -axis data, then Z -axis data.  The first nine (9) bytes \nrepresent a complete 3 -axis measurement.  \n\uf0b7 Return SSN to HIGH to free up the host to communicate with other devices and \nto ensure the next Command Byte sent to the MagI2C is interpreted properly.  \n \n5.8 Examples  using the I2C Interface  \n5.8.1  Set the Cycle Count Registers  \nA sample command sequence  is provided below which sets the cycle count value to 100 D \n(64 H) for all 3 axes.  This is for illustrative purposes and the value could be different \nand/or the number of axes to be addressed could be different.  Note only the initial Cycle \nCount register address needs to be sent , as the MagI2C automatically increment s to the \nnext register . \nSTART  MagI2C  ADDRESS  RW ACK CCX1 REG. ADDRESS (N)  ACK DATA TO CCX1 REG (N)  ACK DATA TO CCX0 REG (N+1)  ACK \nS 0 1 0 0 0 X X 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 \n                                     \n  From Host to MagI2C    \n    From MagI2C to Host    \n \nDATA TO CCY 1 REG (N +2) ACK DATA TO CCY 0 REG (N+ 3) ACK DATA TO CCZ 1 REG (N +4) ACK DATA TO CCZ0 REG (N+5 ) ACK STOP  \n0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1 0 0 0 P \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 39 of 41 5.8.2  Initiate  a Single Measurement  \nThe I2C transactions  to initiate a single measurement on all  3 axes are given below.  \nSTART  MagI2C  ADDRESS  RW ACK POLL REG. ADDRESS (N)  ACK DATA TO POLL REG (N)  ACK STOP  \nS 0 1 0 0 0 X X 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 P \n                             \n  From Host to MagI2C  \n  From MagI2C to Host  \n \nAfter this transaction sequence the MagI2C will initiate a measurement sequence, and \nthis can run in  the background.  At the end of the measurement  sequence  the D RDY pin \nis set HIGH  and the Status Register will have a “1” in bit 7 , indicating data is ready .  The \nMagI2C will be  placed in Idle Mode.  \n5.8.3  Initiate Continuous Measurement Mode  \nA sample  I2C transaction  to initiate continuous  measurement mode is given be low. \nSTART  MagI2C  ADDRESS  RW ACK CMM REG. ADDRESS (N)  ACK DATA TO CMM REG (N)  ACK STOP  \nS 0 1 0 0 0 X X 0 0 0 0 0 0 0 0 0 1 0 0 1 1 1 1 0 0 1 0 P \n                             \n  From Host to MagI2C  \n  From MagI2C to Host  \n \nIn this example, the CMM register is set to initiate measurements on all 3 axes, and to set \nDRDY to HIGH after all three measurements are made.  \n5.8.4  Read the Measurement Results  \nWhen the host is ready to read the Measurement Results registers , the following \ntransactio ns should occur.  Note only the initial Measurement Results register address  \nneeds to be sent, as the MagI2C automatically increments to the subse quent register s. \nSTART  MagI2C  ADDRESS  RW ACK MX2 ADDRESS (N)  ACK STOP  \nS 0 1 0 0 0 X X 0 0 0 0 1 0 0 1 0 0 0 P \n                    \n  From Host to MagI2C              \n  From MagI2C to Host              \n \n \n \nPNI Sensor Corporation  Doc 1017252  r06 \nRM3100 & RM2100 Sensor Suite  User Manual  Page 40 of 41 START  MagI2C  ADDRESS  RW ACK DATA FROM MX2 (N)  ACK DATA FROM MX1 (N+1)  ACK \nS 0 1 0 0 0 X X 1 0 X X X X X X X X 0 X X X X X X X X 0 \n \nDATA FROM MX0 REG (N+2)  ACK DATA FROM MY2 REG (N+3)  ACK DATA FROM MY1 REG (N+4)  ACK DATA FROM MY0 REG (N+5)  ACK \nX X X X X X X X 0 X X X X X X X X 0 X X X X X X X X 0 X X X X X X X X 0 \n \nDATA FROM MZ2 REG (N+6)  ACK DATA FROM MZ1 REG (N+7)  ACK DATA FROM MZ0 REG (N+8)  NACK  STOP  \nX X X X X X X X 0 X X X X X X X X 0 X X X X X X X X 0 P \n \nThe final NACK is optional, as communication will stop by simply implementing the \nStop condition.  \n \n'}]
!==============================================================================!
### Component Summary: PNI-13104 (Sen-XY-f Sensor Coil)

#### Key Specifications:
- **Voltage Ratings**: Maximum voltage across coil is 2.0 VDC.
- **Current Ratings**: Input pin current at 25°C is up to 50 mA.
- **Power Consumption**: Average current at a 24 Hz sample rate is approximately 70 µA.
- **Operating Temperature Range**: -40°C to +85°C.
- **Package Type**: Surface mount (specific dimensions not provided in the excerpt).
- **Special Features**: 
  - High resolution and low power consumption.
  - Large signal noise immunity and dynamic range.
  - Digital output directly compatible with microprocessors.
- **Moisture Sensitive Level (JEDEC J-STD-020E)**: Classified as moisture sensitivity level 1.

#### Description:
The PNI-13104 is a geomagnetic sensor coil, specifically the Sen-XY-f variant, used in conjunction with the MagI2C ASIC controller to form a 2-axis digital compass. This sensor operates based on magneto-inductive technology, measuring the local magnetic field by detecting changes in inductance caused by magnetic field variations. The output is inherently digital, allowing for direct interfacing with microcontrollers without the need for additional signal conditioning.

#### Typical Applications:
- **Navigation Systems**: Used in compassing applications to determine orientation relative to the Earth's magnetic field.
- **Robotics**: Assists in navigation and positioning for autonomous vehicles.
- **Smartphones and Tablets**: Integrated into devices for orientation detection and augmented reality applications.
- **Geophysical Surveys**: Utilized in geological studies to measure magnetic fields for mineral exploration.
- **Wearable Technology**: Employed in fitness trackers and smartwatches for activity tracking and navigation.

This sensor is particularly advantageous in applications requiring high precision and low power consumption, making it suitable for battery-operated devices.