[{'role': 'system', 'content': 'You are a technical specialist with expertise in electronics. Your task is to analyze datasheets for electronic components and provide a concise summary of the product’s key characteristics and specifications. In addition, you need to gather textual information about the component, including its description and typical applications.Instructions:    Identify the correct component in the datasheet using the provided product code.    Summarize key parameters, including:        Voltage ratings        Current ratings        Power consumption        Operating temperature range        Package type        Special features or notes (if applicable)        Moisture Sensetive Level JEDEC J-STD-020E    Provide a short description of the component, including what it is (e.g., transistor, microcontroller, sensor) and its primary function.    Explain typical applications for the component (e.g., power management, signal processing, data storage, etc.).    Be thorough and accurate: Ensure the information corresponds specifically to the product code, as some datasheets cover multiple variants.Your goal is to create a clear and accurate technical summary that includes both key specifications and a description of what the component is used for.'}, {'role': 'user', 'content': 'Give me information about the component of KSZ9896CTXI-TR production of MICROCHIP TECHNOLOGY from the text:\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 1\nHighlights\n• One port with 10/100/1000 Ethernet MAC \nand configurable GMII/RGMII/MII/RMII interface\n• IEEE 802.1X access control support \n• Five ports with integrated 10/100/1000BASE-T PHY \ntransceivers\n• Non-blocking wire-speed Ethernet switching fabric• Full-featured forwarding and filtering control, includ-\ning Access Control List (ACL) filtering\n• Full VLAN and QoS support\n• EtherGreen™ power management features, \nincluding low power standby\n• Flexible management interface options: SPI, I\n2C, \nMIIM, and in-band management via any port\n• Commercial/Industrial temperature range support\n• 128-pin TQFP-EP (14 x 14mm) RoHS compliant pkg\nTarget Applications\n• Stand-alone 10/100/1000Mbps Ethernet switches• VoIP infrastructure switches• Broadband gateways/firewalls\n• Wi-Fi access points\n• Integrated DSL/cable modems• Security/surveillance systems\n• Industrial control/automation switches\n• Networked measurement and control systems\nFeatures\n• Switch Management Capabilities\n- 10/100/1000Mbps Ethernet switch basic functions: \nframe buffer management, address look-up table, \nqueue management, MIB counters\n- Non-blocking store-and-forward switch fabric assures \nfast packet delivery by utilizing 4096 entry forwarding \ntable with 256kByte frame buffer\n- Jumbo packet support up to 9000 bytes- Port mirroring/monitoring/sniffing: \ningress and/or egress traffic to any port\n- MIB counters for fully-compliant statistics gathering    \n34 counters per port \n- Tail tagging mode (one byte added before FCS) sup-\nport at host port to inform the processor which ingress \nport receives the packet and its priority \n- Loopback modes for remote failure diagnostics - Rapid spanning tree protocol (RSTP) support for topol-\nogy management and ring/linear recovery\n- Multiple spanning tree protocol (MSTP) support• One Ext. MAC Port with GMII/RGMII/MII/RMII\n- RGMII v2.0, RMII v1.2 with 50MHz reference clock \ninput/output option, MII in PHY/MAC mode\n• Five Integrated PHY Ports\n- 1000BASE-T/100BASE-TX/10BASE-Te IEEE 802.3 \n- Fast Link-up option significantly reduces link-up time- Auto-negotiation and Auto-MDI/MDI-X support- On-chip termination resistors and internal biasing for \ndifferential pairs to reduce power\n- LinkMD® cable diagnostic capabilities for determining \ncable opens, shorts, and length\n• Advanced Switch Capabilities\n- IEEE 802.1Q VLAN support for 128 active VLAN \ngroups and the full range of 4096 VLAN IDs\n- IEEE 802.1p/Q tag insertion/removal on per port basis- VLAN ID on per port or VLAN basis- IEEE 802.3x full-duplex flow control and half-duplex \nback pressure collision control\n- IEEE 802.1X access control \n(Port-based and MAC address based)\n- IGMP v1/v2/v3 snooping for multicast packet filtering- IPv6 multicast listener discovery (MLD) snooping- IPv4/IPv6 QoS support, QoS/CoS packet prioritization- 802.1p QoS packet classification with 4 priority queues- Programmable rate limiting at ingress/egress ports- Broadcast storm protection - Four priority queues with dynamic packet mapping for \nIEEE 802.1p, IPv4 DIFFSERV, IPv6 Traffic Class \n- MAC filtering function to filter or forward unknown uni-\ncast, multicast and VLAN packets \n- Self-address filtering for implementing ring topologies \n• Comprehensive Configur ation Registers Access\n- High-speed 4-wire SPI (up to 50MHz), I2C interfaces \nprovide access to all internal registers\n- MII Management (MIIM, M DC/MDIO 2-wire) Interface \nprovides access to all PHY registers\n- In-band management via any of the data ports- I/O pin strapping facility to set certain register bits from \nI/O pins at reset time\n- On-the-fly configurable control registers \n• Power Management\n- Energy detect power-down mode on cable disconnect- Dynamic clock tree control \n- Unused ports can be individually powered down\n- Full-chip software power-down- Wake-on-LAN (WoL) standby power mode with PME \ninterrupt output for system wake upon triggered eventsKSZ9896C\n6-Port Gigabit Ethernet Switch\nwith GMII/RGMII/MII/RMII Interface\nKSZ9896C\nDS00002390A-page 2 \uf0e3 2017 Microchip Technology Inc.TO OUR VALUED CUSTOMERS\nIt is our intention to provide our valued customers with the bes t documentation possible to ensure successful use of your Micro chip\nproducts. To this end, we will continue to improve our publications to better suit  your needs. Our publications will be refined  and\nenhanced as new volumes and updates are introduced. \nIf you have any questions or comments regarding this publication, please contact the Marketing Co mmunications Department via\nE-mail at docerrors@microchip.com . We welcome your feedback.\nMost Current Documentation\nTo obtain the most up-to-date version of this document ation, please register at our Worldwide Web site at:\nhttp://www.microchip.com\nYou can determine the version of a data s heet by examining its literature number found on the bottom outside corner of any page . \nThe last character of the literature number is the versi on number, (e.g., DS30000000A is version A of document DS30000000).\nErrata\nAn errata sheet, describing minor operati onal differences from the data sheet and recommended workarounds, may exist for cur-\nrent devices. As device/doc umentation issues become known to us, we will publish an errata s heet. The errata will specify the\nrevision of silicon and revision of  document to which it applies.\nTo determine if an errata sheet exis ts for a particular device, please  check with one of the following:\n• Microchip’s Worldwide Web site; http://www.microchip.com\n• Your local Microchip sales office (see last page)\nWhen contacting a sales office, please spec ify which device, revision of silicon and data sheet (include -literature number) yo u are\nusing.\nCustomer Notification System\nRegister on our web site at www.microchip.com  to receive the most current information on all of our products.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 3KSZ9896C\nTable of Contents\n1.0 Preface ................................................................................................................... ......................................................................... 4\n2.0 Introduction .............................................................................................................. ....................................................................... 8\n3.0 Pin Descriptions and Configuration ........................................................................................ ......................................................... 9\n4.0 Functional Description .................................................................................................... .............................................................. 20\n5.0 Device Registers .......................................................................................................... ................................................................. 64\n6.0 Operational Charac teristics ............................................................................................... .......................................................... 169\n7.0 Design Guidelines ......................................................................................................... .............................................................. 185\n8.0 Package Information ....................................................................................................... ............................................................ 188\nAppendix A: Data Sheet Revision History ....................................................................................... .................................................. 190\nThe Microchip Web Site ........................................................................................................ ............................................................ 191\nCustomer Change Notification Service .......................................................................................... ................................................... 191\nCustomer Support .............................................................................................................. ............................................................... 191\nProduct Identification System ................................................................................................. .......................................................... 192\nKSZ9896C\nDS00002390A-page 4 \uf0e3 2017 Microchip Technology Inc.1.0 PREFACE\n1.1 Glossary of Terms\nTABLE 1-1: GENERAL TERMS\nTerm Description\n10BASE-Te 10 Mbps Ethernet, 2.5V sign aling, IEEE 8 02.3 compliant\n100BASE-TX 100 Mbps Fast Ethernet, IEEE 802.3u compliant\n1000BASE-T 1000 Mbps Gigabit Ethernet, IEEE 802.3ab compliant\nADC Analog-to-Digital Converter\nAN Auto-Negotiation\nBLW Baseline Wander\nBPDU Bridge Protocol Data Unit. Messages which carry the Spanning Tree Protocol informa-\ntion.\nByte 8 bits\nCRC Cyclic Redundancy Check. A common technique for detection data transmission \nerrors. CRC for Ethernet is 32 bits long.\nCSR Control and Status Registers\nDA Destination Address\nDWORD 32 bits\nFCS Frame Check Sequence . The extra checksum characte rs added to the end of an \nEthernet frame, used for error detection and correction.\nFID Frame or Filter ID. Specifies the frame identifier. Alternatel y is the filter identifier. \nFIFO First In First Out buffer\nFSM Finite State Machine\nGPIO General Purpose I/O\nHost External system (Includes proce ssor, application software, etc.)\nIGMP Internet Group Management Protocol. De fined by RFC 1112, RFC 2236, and RFC \n4604 to establish multicast group membership in IPv4 networks.\nIPG Inter-Packet Gap. A time delay between successive data packets mandated by the \nnetwork standard for protocol reasons. \nJumbo Packet A packet larger than the standard Ethernet packet (1518 bytes). Large packet sizes \nallow for more efficient use of bandwidth, lower overhead, less processing, etc.\nlsb Least Significant Bit\nLSB Least Significant Byte\nMAC Media Access Controller. A functional block responsible for implementing the media \naccess control layer, which is a sublayer of the data link layer. \nMDI Medium Dependent Interface. An Ethernet port  connection that allows network hubs or \nswitches to connect to other hubs or swit ches without a null-mo dem, or crossover, \ncable.\nMDIX Media Independent Interface with Crossover. An  Ethernet port con nection that allows \nnetworked end stations (i.e., PCs or wor kstations) to connect to each other using a \nnull-modem, or crossover, cable.\nMIB Management Information Base. The MIB co mprises the management portion of net-\nwork devices. This can include monitoring traf fic levels and faults (statistical), and can \nalso change operating parameters in network nodes (static forwarding addresses).\nMII Media Independent Interface. The MII access es PHY registers as defined in the IEEE \n802.3 specification. \nMIIM Media Independent Interface Management\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 5KSZ9896C\nMLD Multicast Listening Discovery. This protoc ol is defined by RFC 3810 and RFC 4604 to \nestablish multicast group memb ership in IPv6 networks. \nMLT-3 Multi-Level Transmission Encoding (3-Levels). A tri-level encoding method where a \nchange in the logic level represents a code bi t “1” and the logic output remaining at the \nsame level represent s a code bit “0”.\nmsb Most Significant Bit\nMSB Most Significant Byte\nNRZ Non Return to Zero. A type of signal data encoding whereby the signal does not return \nto a zero state in between bits. \nNRZI Non Return to Zero Inverted. This encoding method inverts the signal for a “1” and \nleaves the signal unchanged for a “0”\nN/A Not Applicable\nNC No Connect\nOUI Organizationally Unique Identifier\nPHY A device or function block which performs the physical layer interface function in a net-\nwork. \nPLL Phase Locked Loop. A electronic circuit that co ntrols an oscillator so that it maintains a \nconstant phase angle (i.e., lock) on the frequency of an input, or reference, signal. \nRESERVED Refers to a reserved bit field or address.  Unless otherwise noted,  reserved bits must \nalways be zero for write operations. Unle ss otherwise noted, va lues are not guaran-\nteed when reading reserved bits. Unless other wise noted, do not  read or write to \nreserved addresses.\nRTC Real-Time Clock\nSA Source Address\nSFD Start of Frame Delimiter. The 8-bit value i ndicating the end of the preamble of an \nEthernet frame.\nSQE Signal Quality Error (also known as “heartbeat”)\nSSD Start of Stream Delimiter\nTCP Transmission Control Protocol\nUDP User Datagram Protocol - A connectionl ess protocol run on top of IP networks\nUTP Unshielded Twisted Pair. Commonly a cable containing 4 twisted pairs of wire. \nUUID Universally Unique IDentifier\nVLAN Virtual Local Area Network\nWORD 16 bitsTABLE 1-1: GENERAL TERMS (CONTINUED)\nTerm Description\nKSZ9896C\nDS00002390A-page 6 \uf0e3 2017 Microchip Technology Inc.1.2 Buffer Types\nTABLE 1-2: BUFFER TYPES\nBuffer Type Description\nI Input\nIPU Input with internal pull-up (58 k \uf057 ±30%)\nIPU/O Input with internal pull-up (58 k \uf057 ±30%) during power-up/reset; \noutput pin during normal operation\nIPD Input with internal pull-down (58 k \uf057 ±30%)\nIPD/O Input with internal pull-down (58 k \uf057 ±30%) during power-up/reset;\noutput pin during normal operation\nO8 Output with 8 mA sink and 8 mA source\nO24 Output with 24 mA sink and 24 mA source\nOPU Output (8mA) with internal pull-up (58 k \uf057 ±30%)\nOPD Output (8mA) with internal pull-down (58 k \uf057 ±30%)\nAIO Analog bidirectional\nICLK Crystal oscillator input pin\nOCLK Crystal oscillator output pin\nP Power\nGND Ground\nNote: Refer to Section 6.3, "Electrical C haracteristics," on page 170  for the electrical characteristics of the vari-\nous buffers.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 7KSZ9896C\n1.3 Register Nomenclature\n1.4 References\n• NXP I2C-Bus Specification (UM10204, April 4, 2014): www.nxp.com/d ocuments/user_manual/UM10204.pdfTABLE 1-3: REGISTER NOMENCLATURE\nRegister Bit Type Notation Register Bit Description\nR Read:  A register or bit with this attribute can be read.\nW Write:  A register or bit with this attribute can be written.\nRO Read only:  Read only. Writes have no effect.\nRC Read to Clear:  Contents is cleared after the read. Writes have no effect.\nWO Write only:  If a register or bit is write-on ly, reads will return unspecified data.\nWC Write One to Clear: Writing a one clears the value. Writing a zero has no effect.\nLL Latch Low: Applies to certain RO status bits. If a status condition causes this bit to go \nlow, it will maintain the low state until read, even if the status co ndition changes. A read \nclears the latch, allowing the bit to go hi gh if dictated by the status condition.\nLH Latch High: Applies to certain RO status bits. If a status condition causes this bit to go \nhigh, it will maintain the high state until read , even if the status condition changes. A \nread clears the latch, allowing the bit to go low if dictated by the status condition.\nSC Self-Clearing:  Contents are self-cleared after the being set. Writes of zero have no \neffect. Contents can be read.\nRESERVED Reserved Field:  Reserved fields must be written with zeros, unless otherwise indi-\ncated, to ensure future compatibility. The va lue of reserved bits is not guaranteed on a \nread.\nKSZ9896C\nDS00002390A-page 8 \uf0e3 2017 Microchip Technology Inc.2.0 INTRODUCTION\n2.1 General Description\nThe KSZ9896C is a highly-integrated, I EEE 802.3 compliant networking device that incorporates a layer-2 managed\nGigabit Ethernet switch, five 10BASE-Te/100BASE-TX/1000BASE -T physical layer transceivers (PHYs) and associated\nMAC units, and one configurable GMII/RGM II/MII/RMII MAC port for direct conn ection to a host processor/controller,\nanother Ethernet switch, or an Ethernet PHY transceiver. \nThe KSZ9896C is built upon industry-leading Ethernet techno logy, with features designed to offload host processing\nand streamline the overall design: \n• Non-blocking wire-speed Ethernet switch fabric\n• Full-featured forwarding and filtering control, in cluding port-based Access Control List (ACL) filtering\n• Full VLAN and QoS support\n• Traffic prioritization with per-port ingress/egress queues and by traffic classification\n• Spanning Tree support• IEEE 802.1X access control support\nA host processor can access all KSZ9896C registers for contro l over all PHY, MAC, and swit ch functions. Full register\naccess is available via the integrated SPI or I\n2C interfaces, and by in-band manageme nt via any one of the data ports.\nPHY register access is provided by a MIIM interface. Flexible  digital I/O voltage allows the MAC port to interface directly\nwith a 1.8/2.5/3.3V host processor/controller/FPGA.\nAdditionally, a robust assortment of  power-management features including Wake-on-LAN (WoL) for low power standby\noperation, have been designed to satisfy energy-efficient system requirements.\nThe KSZ9896C is available in commercial (0°C to +70°C) and industrial (-40°C to +85°C) temperature ranges. An inter-\nnal block diagram of the KSZ9896C is shown in Figure 2-1 .\nFIGURE 2-1: INTERNAL BLOCK DIAGRAM\nKSZ9896CPort\xa01 10/100/1000\nPHY\xa01\n10/100/1000\nPHY\xa02\n10/100/1000\nPHY\xa03\n10/100/1000\nPHY\xa04\n10/100/1000\nPHY\xa05Port\xa02\nPort\xa03\nPort\xa04\nPort\xa05GMAC\xa01\nGMAC\xa02\nGMAC\xa03\nGMAC\xa04\nGMAC\xa05\nSwitch\xa0Engine\nQueue\xa0Management, \xa0QOS,\xa0Etc.\nControl\nRegistersGMAC\xa06GMII/RGMII/\nMII/RMII\nAddress\nLookup\nMIB\nCounters\nFrame\nBuffers\nQueueMgmt.\nSPI/I2C/MIIM\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 9KSZ9896C\n3.0 PIN DESCRIPTIONS AND CONFIGURATION\n3.1 Pin Assignments\nThe device pin diagram for the KSZ9896C can be seen in Figure 3-1 . Table 3-1  provides a KSZ9896C pin assignment\ntable. Pin descriptions are provided in Section 3.2, "Pin Descriptions" .\nFIGURE 3-1: PIN ASSIGNMENTS (TOP VIEW)\nNote: When an “ _N” is used at the end of the sign al name, it indicates that the signal is active low. For example,\nRESET_N  indicates that the reset signal is active low.\nThe buffer type for each signal is indicated in the “B uffer Type” column of the pin description tables in Sec-\ntion 3.2, "Pin Descriptions" . A description of the buffer types is provided in Section 1.2, "Buffer Types" . KSZ9896C\n128-TQFP-EP\n(Top View)TXRX1P_A\nTXRX1M_A\nTXRX1P_B\nTXRX1M_B\nTXRX1P_C\nTXRX1M_C\nTXRX1P_D\nTXRX1M_D\nTXRX2P_A\nTXRX2M_A\nAVDDL\nTXRX2P_B\nTXRX2M_B\nTXRX2P_C\nTXRX2M_C\nTXRX2P_D\nTXRX2M_D\nTXRX3P_A\nTXRX3M_A\nTXRX3P_B\nTXRX3M_B\nTXRX3P_C\nTXRX3M_C\nTXRX3P_D\nTXRX3M_DSDO\nRESET_N\nCLKO_25_125\nNC\nINTRP_N\nPME_N\nLED2_1\nLED2_0\nNC\nLED3_1\nLED3_0\nLED4_1\nLED4_0\nGND\nRXD6_0\nRXD6_1\nRXD6_2\nCRS6\nRX_ER6/RX_CLK6\nRX_DV6/CRS_DV6/RX_CTL6\nRX_CLK6/REFCLKO6\nDVDDL\nTXD6_0\nTXD6_1TXD6_2\nTXD6_3\nCOL6\nTX_ER6\nISETXIXOGNDTXRX5M_DTXRX5P_DAVDDLTXRX5M_CTXRX5P_CTXRX5M_BTXRX5P_BTXRX5M_ATXRX5P_ANCLED1_1LED1_0LED5_1LED5_0GNDSCL/MDCVDDIOSDI/SDA/MDIO\nTXRX4P_ATXRX4M_ATXRX4P_BTXRX4M_BTXRX4P_CTXRX4M_CTXRX4P_DTXRX4M_DDVDDLVDDIOGNDGNDTXD6_7TXD6_6TXD6_5TXD6_4VDDIORXD6_7RXD6_6RXD6_5RXD6_4TX_CLK6/REFCLKI6TX_EN6/TX_CTL6\n3334353637383940414243444546474849505152535455565758596061626364\n128127126125124123122121120119118117116115114113112111110109108107106105104103102101100999897\n96\n95\n94\n93\n92\n91\n90\n89\n88\n87\n86\n85\n84\n83\n82\n81\n80\n79\n78\n77\n76\n75\n74\n73\n72\n71\n70\n6968\n67\n66\n651\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n2829\n30\n31\n32AVDDL\nAVDDL\nAVDDLAVDDHAVDDHAVDDLAVDDLAVDDHAVDDHAVDDHAVDDLAVDDHAVDDH\nAVDDLDVDDLDVDDL\nNC\nVDDIO\nDVDDL\nDVDDLGNDGND\nDVDDL\nNCGNDNCDVDDLDVDDLSCS_N\nRXD6_3\n(Connect exposed pad to ground with a via field)GND\nKSZ9896C\nDS00002390A-page 10 \uf0e3 2017 Microchip Technology Inc.Note 3-1 This pin provides configurati on strap functions during hardware/software resets. Refer to Section\n3.2.1, "Configuration Straps"  for additional information.TABLE 3-1: PIN ASSIGNMENTS\nPin Pin Name Pin Pin Name Pin Pin Name Pin Pin Name\n1 TXRX1P_A 33 A VDDH 65 TX_ER6 97 SDI/SDA/MDIO\n2 TXRX1M_A 34 TXRX4P_A 66 COL6 98 VDDIO\n3 A VDDL 35 TXRX4M_A 67 TXD6_3 99 SCS_N\n4 TXRX1P_B 36 AV D D L 68 TXD6_2 100 SCL/MDC\n5 TXRX1M_B 37 TXRX4P_B 69 TXD6_1 101 GND\n6 TXRX1P_C 38 TXRX4M_B 70 TXD6_0 102 LED5_0\n7 TXRX1M_C 39 TXRX4P_C 71 DVDDL 103 LED5_1 (Note 3-1 )\n8 TXRX1P_D 40 TXRX4M_C 72 RX_CLK6/REFCLKO6 104 DVDDL\n9 TXRX1M_D 41 AV D D L 73 RX_DV6/CRS_DV6/\nRX_CTL6 (Note 3-1 )105 LED1_0\n10 AV D D H 42 TXRX4P_D 74 VDDIO 106 LED1_1 (Note 3-1 )\n11 DVDDL 43 TXRX4M_D 75 RX_ER6/RX_CLK6 \n(Note 3-1 )107 GND\n12 TXRX2P_A 44 A VDDH 76 CRS6 108 NC\n13 TXRX2M_A 45 DVDDL 77 RXD6_3 (Note 3-1 ) 109 GND\n14 A VDDL 46 NC 78 RXD6_2 (Note 3-1 ) 110 DVDDL\n15 TXRX2P_B 47 GND 79 RXD6_1 (Note 3-1 ) 111 A VDDH\n16 TXRX2M_B 48 DVDDL 80 RXD6_0 (Note 3-1 ) 112 TXRX5P_A\n17 TXRX2P_C 49 VDDIO 81 GND 113 TXRX5M_A\n18 TXRX2M_C 50 GND 82 LED4_0 (Note 3-1 ) 114 A VDDL\n19 A VDDL 51 GND 83 LED4_1 (Note 3-1 ) 115 TXRX5P_B\n20 TXRX2P_D 52 TXD6_7 84 DVDDL 116 TXRX5M_B\n21 TXRX2M_D 53 TXD6_6 85 LED3_0 117 TXRX5P_C\n22 AV D D H 54 TXD6_5 86 LED3_1 (Note 3-1 ) 118 TXRX5M_C\n23 DVDDL 55 TXD6_4 87 NC 119 A VDDL\n24 TXRX3P_A 56 DVDDL 88 NC 120 TXRX5P_D\n25 TXRX3M_A 57 VDDIO 89 LED2_0 (Note 3-1 ) 121 TXRX5M_D\n26 TXRX3P_B 58 RXD6_7 90 LED2_1 (Note 3-1 ) 122 A VDDH\n27 TXRX3M_B 59 RXD6_6 91 PME_N 123 GND\n28 TXRX3P_C 60 RXD6_5 92 INTRP_N 124 A VDDL\n29 TXRX3M_C 61 NC 93 NC 125 XO\n30 A VDDL 62 RXD6_4 94 CLKO_25_125 126 XI\n31 TXRX3P_D 63 TX_CLK6/REFCLKI6 95 RESET_N 127 ISET\n32 TXRX3M_D 64 TX_EN6/TX_CTL6 96 SDO 128 A VDDH\nExposed Pad Must be Connected to GND\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 11KSZ9896C\n3.2 Pin Descriptions\nThis sections details the functi ons of the various device signals. \nTABLE 3-2: PIN DESCRIPTIONS\nName SymbolBuffer \nTypeDescription\nPorts 5-1 Gigabit Ethernet Pins\nPort 5-1 \nEthernet TX/RX \nPair A +TXRX[5:1]P_A AIO Port 5-1 1000BASE-T Differential Data Pair A (+)\nNote: 100BASE-TX and 10BASE-Te are also sup-\nported on the A and B pairs.\nPort 5-1 \nEthernet TX/RX \nPair A -TXRX[5:1]M_A AIO Port 5-1 1000BASE-T Differential Data Pair A (-)\nNote: 100BASE-TX and 10BASE-Te are also sup-\nported on the A and B pairs.\nPort 5-1 \nEthernet TX/RX \nPair B +TXRX[5:1]P_B AIO Port 5-1 1000BASE-T Differential Data Pair B (+)\nNote: 100BASE-TX and 10BASE-Te are also sup-\nported on the A and B pairs.\nPort 5-1 \nEthernet TX/RX \nPair B -TXRX[5:1]M_B AIO Port 5-1 1000BASE-T Differential Data Pair B (-)\nNote: 100BASE-TX and 10BASE-Te are also sup-\nported on the A and B pairs.\nPort 5-1 \nEthernet TX/RX \nPair C +TXRX[5:1]P_C AIO Port 5-1 1000BASE-T Differential Data Pair C (+)\nPort 5-1 \nEthernet TX/RX \nPair C -TXRX[5:1]M_C AIO Port 5-1 1000BASE-T Differential Data Pair C (-)\nPort 5-1 \nEthernet TX/RX \nPair D +TXRX[5:1]P_D AIO Port 5-1 1000BASE-T Differential Data Pair D (+)\nPort 5-1 \nEthernet TX/RX \nPair D -TXRX[5:1]M_D AIO Port 5-1 1000BASE-T Differential Data Pair D (-)\nPort 6 GMII/RGMII/MII/RMII Pins\nPort 6\nTransmit/\nReference \nClockTX_CLK6/\nREFCLKI6I/O8 MII Mode:  TX_CLK6  is the Port 6 25/2.5MHz Transmit \nClock. In PHY mode this pin is an output, in MAC mode it is \nan input.\nRMII Mode:  REFCLKI6  is the Port 6 50MHz Reference \nClock input when in RMII Normal mode. This pin is unused \nwhen in RMII Clock mode.\nGMII Mode:  GTX_CLK6  is the Port 6 125MHz Transmit \nClock input.\nRGMII Mode:  TX_CLK6  is the Port 6 125/25/2.5MHz \nTransmit Clock input.\nPort 6\nTransmit \nEnable/ControlTX_EN6/\nTX_CTL6IPD MII/RMII/GMII Modes:  TX_EN6  is the Port 6 Transmit \nEnable.\nRGMII Mode:  TX_CTL6  is the Port 6 Transmit Control. \nKSZ9896C\nDS00002390A-page 12 \uf0e3 2017 Microchip Technology Inc.Port 6\nTransmit ErrorTX_ER6 IPD MII/GMII Mode:  Port 6 Transmit Error input.\nRMII/RGMII Modes:  Not used. Do not connect this pin in \nthese modes of operation.\nPort 6\nCollision DetectCOL6 IPD/O8 MII/GMII Mode:  Port 6 Collision Detect. In PHY mode this \npin is an output, in MA C mode it is an input. \nRMII/RGMII Modes:  Not used. Do not connect this pin in \nthese modes of operation.\nPort 6\nTransmit Data 7TXD6_7 IPD GMII Mode:  Port 6 Transmit Data bus bit 7.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nTransmit Data 6TXD6_6 IPD GMII Mode:  Port 6 Transmit Data bus bit 6.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nTransmit Data 5TXD6_5 IPD GMII Mode:  Port 6 Transmit Data bus bit 5.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nTransmit Data 4TXD6_4 IPD GMII Mode:  Port 6 Transmit Data bus bit 4.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nTransmit Data 3TXD6_3 IPD MII/GMII/RGMII Modes:  Port 6 Transmit Data bus bit 3.\nRMII Mode:  Not used. Do not connect this pin in this mode \nof operation.\nPort 6\nTransmit Data 2TXD6_2 IPD MII/GMII/RGMII Modes:  Port 6 Transmit Data bus bit 2.\nRMII Mode:  Not used. Do not connect this pin in this mode \nof operation.\nPort 6\nTransmit Data 1TXD6_1 IPD MII/RMII/GMII/RGMII Modes:  Port 6 Transmit Data bus bit \n1.\nPort 6\nTransmit Data 0TXD6_0 IPD MII/RMII/GMII/RGMII Modes:  Port 6 Transmit Data bus bit \n0.TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 13KSZ9896C\nPort 6\nReceive/\nReference \nClockRX_CLK6/\nREFCLKO6I/O24 MII Mode:  RX_CLK6  is the Port 6 25/2.5MHz Receive \nClock. In PHY mode this pin is an output, in MAC mode it is \nan input.\nGMII/MII 2-Wire Mode:  Receive Clock. GRX_CLK6  is the \nPort 6 125MHz Receive Clock output for GMII (1000Mbps), and the Port 6 RX_CLK6  input for MII (10/100Mbps).\nGMII/MII 3-Wire Mode:  Receive Clock. GRX_CLK6  is the \nPort 6 125MHz Receive Clock output for GMII (1000Mbps). \nRefer to the RX_ER6/RX_CLK6  pin for the MII Receive \nClock in this mode.\nRMII Mode:  REFCLKO6  is the Port 6 50MHz Reference \nClock output when in RMII Clock mode. This pin is unused when in RMII Normal mode.\nRGMII Mode:  RX_CLK6  is the Port 6 125/25/2.5MHz \nReceive Clock output.\nPort 6\nReceive Data \nValid / Carrier \nSense / ControlRX_DV6/\nCRS_DV6/\nRX_CTL6IPD/O24 MII/GMII Mode:  RX_DV6  is the Port 6 Received Data Valid \noutput. \nRMII Mode:  CRS_DV6  is the Carrier Sense / Receive Data \nValid output.\nRGMII Mode:  RX_CTL6  is the Receive Control output.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 6\nReceive ErrorRX_ER6/RX_CLK6 IPD/O24 MII Mode:  Port 6 Receive Error output.\nGMII/MII 2-Wire Mode:  RX_ER6  Port 6 Receive Error out-\nput.\nGMII/MII 3-Wire Mode:  RX_CLK6  Port 6 25/2.5MHz \nReceive Clock input for MII (in MAC Mode).\nRMII/RGMII Modes:  Not used. Do not connect this pin in \nthese modes of operation.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 6\nCarrier SenseCRS6 IPD/O8 MII/GMII Mode:  Port 6 Carrier Sense. In PHY mode this pin \nis an output, in MAC mode it is an input.\nRMII/RGMII Modes:  Not used. Do not connect this pin in \nthese modes of operation.TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\nKSZ9896C\nDS00002390A-page 14 \uf0e3 2017 Microchip Technology Inc.Port 6\nReceive Data 7RXD6_7 IPD/O24 GMII Mode:  Port 6 Receive Data bus bit 7.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nReceive Data 6RXD6_6 IPD/O24 GMII Mode:  Port 6 Receive Data bus bit 6.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nReceive Data 5RXD6_5 IPD/O24 GMII Mode:  Port 6 Receive Data bus bit 5.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nReceive Data 4RXD6_4 IPD/O24 GMII Mode:  Port 6 Receive Data bus bit 4.\nMII/RMII/RGMII Modes:  Not used. Do not connect this pin \nin this mode of operation.\nPort 6\nReceive Data 3RXD6_3 IPD/O24 MII/GMII/RGMII Modes:  Port 6 Receive Data bus bit 3.\nRMII Mode:  Not used. Do not connect this pin in this mode \nof operation.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 6\nReceive Data 2RXD6_2 IPD/O24 MII/GMII/RGMII Modes:  Port 6 Receive Data bus bit 2.\nRMII Mode:  Not used. Do not connect this pin in this mode \nof operation.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 6\nReceive Data 1RXD6_1 IPD/O24 MII/RMII//GMIIRGMII Modes:  Port 6 Receive Data bus bit \n1.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 6\nReceive Data 0RXD6_0 IPD/O24 MII/RMII//GMIIRGMII Modes:  Port 6 Receive Data bus bit \n0.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nSPI/I\n2C/MIIM Interface Pins\nSPI/I2C/MIIM \nSerial ClockSCL/MDC IPU SPI/I2C Modes: SCL serial clock.\nMIIM Mode:  MDC  serial clock.\nSPI Data Out SDO O8 SPI Mode: Data out (also known as MISO).\nI2C/MIIM Modes:  Not used.TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 15KSZ9896C\nSPI Data In / \nI2C/MIIM Data \nIn/OutSDI/SDA/MDIO IPU/O8 SPI Mode: SDI Data In (also known as MOSI).\nI2C Mode: SDA Data In/Out.\nMIIM Mode:  MDIO  Data In/Out.\nSDI and MDIO  are open-drain signals when in the output \nstate. An external pull-up resistor to VDDIO  (1.0kΩ to \n4.7kΩ) is required.\nSPI Chip Select SCS_N IPU SPI Mode: Chip Select (active low).\nI2C/MIIM Modes:  Not used.\nLED Pins\nPort 1\nLED Indicator 0LED1_0 IPU/O8 Port 1 LED Indicator 0.\nActive low output sinks current  to light an external LED.\nPort 1\nLED Indicator 1LED1_1 IPU/O8 Port 1 LED Indicator 1.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 2\nLED Indicator 0LED2_0 IPU/O8 Port 2 LED Indicator 0.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 2\nLED Indicator 1LED2_1 IPU/O8 Port 2 LED Indicator 1.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 3\nLED Indicator 0LED3_0 IPU/O8 Port 3 LED Indicator 0.\nActive low output sinks current  to light an external LED.\nPort 3\nLED Indicator 1LED3_1 IPU/O8 Port 3 LED Indicator 1.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 4\nLED Indicator 0LED4_0 IPU/O8 Port 4 LED Indicator 0.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer toSection 3.2.1, "Configuration Straps"  for addi-\ntional information. TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\nKSZ9896C\nDS00002390A-page 16 \uf0e3 2017 Microchip Technology Inc.Port 4\nLED Indicator 1LED4_1 IPU/O8 Port 4 LED Indicator 1.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nPort 5\nLED Indicator 0LED5_0 IPU/O8 Port 5 LED Indicator 0.\nActive low output sinks current  to light an external LED.\nPort 5\nLED Indicator 1LED5_1 IPU/O8 Port 5 LED Indicator 1.\nActive low output sinks current  to light an external LED.\nNote: This pin also provides configuration strap func-\ntions during hardware/software resets. Refer to\nSection 3.2.1, "Configuration Straps"  for addi-\ntional information. \nMiscellaneous Pins\nInterrupt INTRP_N OPU Active low, open-drain interrupt.\nNote: This pin requires an external pull-up resistor. \nPower\nManagement\nEventPME_N O8 Power Management Event.\nThis output signal indicates th at an energy detect event has \noccurred. It is intended to wake up the system from a low \npower mode. \nNote: The assertion polarity is programmable (default\nactive low). An external pull-up resistor is\nrequired for active-low operation; an external\npull-down resistor is required for active-highoperation. \nSystem Reset RESET_N IPU Active low system reset. \nThe device must be reset either during or after power-on. An RC circuit is suggested for power-on reset. \nCrystal Clock / \nOscillator InputXI ICLK Crystal clock / oscillator input. \nWhen using a 25MHz crystal, this input is connected to one lead of the crystal. When using an oscillator, this pin is the \ninput from the oscillator. The crystal oscillator should have a \ntolerance of ±50ppm. \nCrystal Clock \nOutputXO OCLK Crystal clock / oscillator output. \nWhen using a 25MHz crystal, this output is connected to \none lead of the crystal. When using an oscillator, this pin is left unconnected. \n25/125MHz \nReference \nClock OutputCLKO_25_125 IPU/O24 25/125MHz reference clock output, derived from the crystal \ninput. \nTransmit \nOutput Current \nSet ResistorISET A Transmit output current set resistor.\nThis pin configures the physical transmit output current. It must be connected to GND  through a 6.04k Ω 1% resistor.\nNo Connect NC - No Connect. For proper operation, this pin must be left \nunconnected.TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 17KSZ9896C\n3.2.1 CONFIGURATION STRAPS\nThe KSZ9896C utilizes configuration strap pins to  configure the device for different modes. While RESET_N  is low,\nthese pins are hi-Z. Pull-up/down resistors are used to create high or low states on these pins, which are internally sam-\npled at the rising edge of RESET_N . All of these pins have a weak internal pull-up or pull-down resistor which provides\na default level for strapping. To strap an LED pin low, use a 750 Ω to 1kΩ external pull-down resistor. To strap a non-LED\npin high, use an external 1k Ω to 10kΩ pull-up resistor to VDDIO . Once RESET_N  is high, all of these pins become driven\noutputs.\nBecause the internal pull-up/down resistors are not strong, co nsideration must be given to any other pull-up/down resis-\ntors which may reside on the board or insi de a device connected to these pins.\nWhen an LED pin is directly driving an LED, the effect of the LED and LED load resistor on the strapping level must be\nconsidered. This is the reason for using a small value resist or to pull an LED pin low. This is especially true when an\nLED is powered from a voltage that is higher than VDDIO .\nThe configuration strap pins and thei r associated functions are detailed in Table 3-3 .Power/Ground Pins\n+3.3/2.5/1.8V\nI/O PowerVDDIO P +3.3V / +2.5V / +1.8V I/O Power\n+2.5V\nAnalog PowerA VDDH P +2.5V Analog Power \n+1.2V\nAnalog PowerAV D D L P +1.2V Analog Power\n+1.2V\nDigital PowerDVDDL P +1.2V Digital Power\nGround GND GND Ground (pins and pad)\nTABLE 3-3: CONFIGURATION STRAP DESCRIPTIONS\nConfiguration\nStrap PinDescription\nLED1_1 Flow Control (All Ports)\n0: Flow control disabled \n1: Flow control enabled (Default)\nLED2_1 Link-up Mode (All PHYs)\n0: Fast Link-up: Auto-negotiati on and auto MDI/MDI-X are disabled\n1: Normal Link-up: Auto-negotiation and auto MDI/MDI-X are enabled (Default) \nNote: Since Fast Link-up disables auto-negotiation  and auto-crossover, it is suitable only\nfor specialized applications.TABLE 3-2: PIN DESCRI PTIONS (CONTINUED)\nName SymbolBuffer \nTypeDescription\nKSZ9896C\nDS00002390A-page 18 \uf0e3 2017 Microchip Technology Inc.LED2_0, LED4_0 When LED2_1  = 1 at strap-in (Normal Link-up):\n[LED2_0, LED4_0 ]: Auto-Negotiation Enable (All PHYs) / NAND Tree Test Mode\n00: Reserved\n01: Auto-negotiation disabled\n10: NAND Tree test mode\n11: Auto-negotiation enabled (Default)\nWhen LED2_1  = 0 at strap-in (Fast Link-up; All PHYs Full-Duplex):\nLED2_0 : 1000BASE-T Master/Slave Mode, 10/100B ASE-T MDI/MDI-X Mo de (All PHYs)\n0: 1000BASE-T: Slave Mode\n    10/100BASE-T: MDI-X\n1: 1000BASE-T: Mast er Mode (Default)\n    10/100BASE-T: MDI (Default)\nLED4_0 : PHY Speed Select (All PHYs)\n0: 1000BASE-T\n1: 100BASE-TX (Default)\nLED4_1, LED3_1 [LED4_1, LED3_1 ]: Management Interface Mode\n00: MIIM (MDIO)01: I\n2C\n1x: SPI (Default)\nLED5_1 Switch Enable at Startup \n0: Start Switch is disabled. The switch will not forward packets until the Start Switch bit is set \nin the Switch Operation Register . \n1: Start Switch is enabled. The switch will fo rward packets immediately after reset. (Default)\nRXD6_3, RXD6_2 [RXD6_3, RXD6_2 ]: Port 6 Mode\n00: RGMII (Default)\n01: RMII10: GMII/MII\n11: MII\nRXD6_1 Port 6 MII/RMII/GMII Mode\n0: MII: PHY Mode (Default)\nRMII: Clock Mode. RMII 50MHz re ference clock is output on REFCLKO6 . (Default)\nGMII: PHY ModeRGMII: No effect\n1: MII: MAC Mode\nRMII: Normal Mode. RMII 50MHz reference clock is input on REFCLKI6 .\nGMII: MAC Mode\nRGMII: No effect\nRXD6_0 Port 6 Speed Select\n0: 1000Mbps Mode (Default)\n1: 10/100Mbps Mode \nNote: If Port 6 is configured for MII or RMII, set the speed to 100Mbps.\nRX_DV6/CRS_DV6/\nRX_CTL6In-Band Management\n0: Disable In-Band Management (Default)\n1: Enable In-Band ManagementTABLE 3-3: CONFIGURATION STRAP DESCRIPTIONS (CONTINUED)\nConfiguration\nStrap PinDescription\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 19KSZ9896C\nRX_ER6/RX_CLK6 GMII/MII Clock Mode\n0: 2-Wire Clock Mode (Default)\n1: 3-Wire Clock Mode \nThese modes affect the GMII and MII clocks for out going data on the Port  6 RX signals. The \nstrapped value is readable on bit 0 of the Port 6 XMII Port Control 0 Register  and may be \noverwritten.\nIn 2-Wire mode, pin 72 ( RX_CLK6/REFCLKO6 ) is used for either the GMII output clock or \nthe MII clock.\nIn 3-Wire mode, pin 72 ( RX_CLK6/REFCLKO6 ) is used for the GMII output clock, and pin 75 \n(RX_ER6/RX_CLK6 ) is used for the MII input clock when in MAC mode. 3-Wire mode is \nintended as an option, when in MAC mode, fo r connection to a 1000/100/10Mbps PHY which \nhas separate pins for the GMII (1000Mbps) GTX_CLK clock and the MII (100/10Mbps) TX_-\nCLK clock.\nWhen the MAC interface does not need to be s witchable between GMII and MII, or when in \nPHY mode, do not select 3-Wire mode.TABLE 3-3: CONFIGURATION STRAP DESCRIPTIONS (CONTINUED)\nConfiguration\nStrap PinDescription\nKSZ9896C\nDS00002390A-page 20 \uf0e3 2017 Microchip Technology Inc.4.0 FUNCTIONAL DESCRIPTION\nThis section provides functional descriptions for the following:\n•Physical Layer Transceiver (PHY)\n•LEDs\n•Media Access Controller (MAC)\n•Switch\n•NAND Tree Support\n•Clocking\n•Power\n•Power Management\n•Management Interface\n•In-Band Management\n•MAC Interface (Port 6)\n4.1 Physical Layer Transceiver (PHY)\nPorts 1 through 5 include completely integrated trip le-speed (10BASE-Te, 100BASE-TX, 1000BASE-T) Ethernet phys-\nical layer transceivers for transmission and reception of data over standard four-pair unshielded twisted pair (UTP), CAT-\n5 or better Ethernet cable.\nThe device reduces board cost and simplifies board layout by using on-chip termination resistors for the differential\npairs, eliminating the need for external termination resistors.  The internal chip termination and biasing provides signifi-\ncant power savings when compared with using external biasing and termination resistors.\nThe device can automatically de tect and correct for differential pair misplacements and polarity reversals, and correct\nfor propagation delay differen ces between the four differen tial pairs, as specified in  the IEEE 802.3 standard for\n1000BASE-T operation.\n4.1.1 1000BASE-T TRANSCEIVER\nThe 1000BASE-T transceiver is based on a mixed-signal/digit al signal processing (DSP) architecture, which includes\nthe analog front-end, digital channel equa lizers, trellis encoders/dec oders, echo cancelers, cro ss-talk cancelers, a pre-\ncision clock recovery scheme, and power-efficient line drivers.\n4.1.1.1 Analog Echo Cancellation Circuit\nIn 1000BASE-T mode, the analog echo cancellation circuit helps to reduce the near-end echo. This analog hybrid circuit\nrelieves the burden of the ADC and the adaptive equalizer. This circuit is disabled in 10BASE-Te/100BASE-TX mode.\n4.1.1.2 Automatic Gain Control (AGC)\nIn 1000BASE-T mode, the automatic  gain control circuit provides initial gain adj ustment to boost up the signal level. This\npre-conditioning circuit is used to improve the signal-to-noise ratio of the receive signal.\n4.1.1.3 Analog-to-Digital Converter (ADC)\nIn 1000BASE-T mode, the analog-to-digital converter digitizes the incoming signal. ADC perfo rmance is essential to the\noverall performance of th e transceiver. This circuit is di sabled in 10BASE-Te/100BASE-TX mode.\n4.1.1.4 Timing Re covery Circuit\nIn 1000BASE-T mode, the mixed signal clock recovery circui t, together with the digital phase locked loop (PLL), is used\nto recover and track the incoming timing information from the received data. The digital PLL has very low long-term jitterto maximize the signal-to-noise ratio of the receive signal.\nThe 1000BASE-T slave PHY must transmit the exact receiv e clock frequency recovered from the received data back to\nthe 1000BASE-T master PHY. Otherwise, the master and slav e will not be synchronized after long transmission. This\nalso helps to facilitate echo cancellation and NEXT removal.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 21KSZ9896C\n4.1.1.5 Adaptive Equalizer\nIn 1000BASE-T mode, the ad aptive equalizer provides  the following functions:\n• Detection for partial response signaling\n• Removal of NEXT and ECHO noise• Channel equalization\nSignal quality is degraded by residual echo that is not re moved by the analog hybrid because of impedance mismatch.\nThe device uses a digital echo canceler to further reduce echo components on the receive signal.\nIn 1000BASE-T mode, data transmission and reception occurs si multaneously on all four pairs of wires (four channels).\nThis results in high-frequency cross-talk coming from adjac ent wires. The device uses three NEXT cancelers on each\nreceive channel to minimize the cross-talk induced by the other three channels.\nIn 10BASE-Te/100BASE-TX mode, the adaptive equalizer need s only to remove the inter-symbol interference and\nrecover the channel loss from the incoming data.\n4.1.1.6 Trellis Encoder and Decoder\nIn 1000BASE-T mode, the transmitted 8-bit data is scrambled into 9- bit symbols and further encoded into 4D-PAM5\nsymbols. On the receiving side, the idle stream is examined first. The scrambler seed, pair skew, pair order and polarity\nmust be resolved through the logic. The incoming 4D-PAM5 data is then converted into 9-bit symbols and de-scrambled\ninto 8-bit data.\n4.1.2 100BASE-TX TRANSCEIVER\n4.1.2.1 100BASE-TX Transmit\nThe 100BASE-TX transmit function perfo rms parallel-to-serial conversion, 4B/5 B coding, scrambling, NRZ-to-NRZI con-\nversion, and MLT3 encoding and transmission.\nThe circuitry starts with a parallel-to-serial conversion, wh ich converts the MII data from the MAC into a 125MHz serial\nbit stream. The data and control stream is then converted into 4B/5B coding, followed by a scrambler. The serialized\ndata is further converted from NRZ-to-NRZI format, and then transmitted in ML T3 current output. An external ISET resis-\ntor sets the output current for the 1:1 transformer ratio.\nThe output signal has a typical rise/fall time of 4ns and co mplies with the ANSI TP-PMD standard regarding amplitude\nbalance, overshoot, and timing  jitter. The wave-shaped 10BASE-Te  output driver is also in corporated into the 100BASE-\nTX driver.\n4.1.2.2 100BASE- TX Receive\nThe 100BASE-TX receiver function performs  adaptive equalization, DC  restoration, MLT3-to-NRZ I conversion, data and\nclock recovery, NRZI-to-NRZ conversi on, de-scrambling, 4B/5B decoding, and serial-to-parallel conversion.\nThe receiving side starts with the equalization filter to com pensate for inter-symbol interfer ence (ISI) over the twisted\npair cable. Since the amplitude loss and phase distortion is a function of the cable length, the equalizer has to adjust its\ncharacteristics to optimize performance. In this design, t he variable equalizer makes an initial estimation based on com-\nparisons of incoming signal strength against some known c able characteristics, and then tunes itself for optimization.\nThis is an ongoing process and self-adjusts against environmental changes such as temperature variations.\nNext, the equalized signal goes through a DC restoration and data conversion block. The DC restoration circuit is used\nto compensate for the effect of baseline wander and to improve the dynamic range. Th e differential data conversion\ncircuit converts the MLT3 format back to NRZI . The slicing threshold is also adaptive.\nThe clock recovery circuit extracts the 125MHz clock from the edges of the NRZI signal. This recovered clock is then\nused to convert the NRZI signal into the NRZ format. This si gnal is sent through the de-scrambler followed by the 4B/\n5B decoder. Finally, the NRZ serial data is converted to an MII format and provided as the input data to the MAC.\n4.1.2.3 Scrambler/De-Scrambler\nThe purpose of the scrambler is to spr ead the power spectrum of the signal to reduce electromagnetic interference (EMI)\nand baseline wander. The scrambler is used only for 100BASE-TX.\nTransmitted data is scrambled through the use of an 11-bit  wide linear feedback shift register (LFSR). The scrambler\ngenerates a 2047-bit non-repet itive sequence. Then the rece iver de-scrambles the incoming data stream using the\nsame sequence as at the transmitter.\nKSZ9896C\nDS00002390A-page 22 \uf0e3 2017 Microchip Technology Inc.4.1.3 10BASE-Te TRANSCEIVER\n10BASE-Te is an energy-efficient version of 10BASE-T which is  powered from a 2.5V supply.  It has a reduced transmit\nsignal amplitude and requires Cat5 cable. It is inter-operabl e to 100m with 10BASE-T when  Cat5 cable is used.\n4.1.3.1 10BASE-Te Transmit\nThe 10BASE-Te driver is incorporated with the 100BASE-TX dr iver to allow for transmission using the same magnetics.\nThey are internally wave-shaped and pre-emphasized into out puts with typical 1.75V amplitude (compared to the typical\ntransmit amplitude of 2.5V for 10BASE-T). The harmonic c ontents are at least 27dB be low the fundamental frequency\nwhen driven by an all-ones Manchester-encoded signal.\n4.1.3.2 10BASE-Te Receive\nOn the receive side, input buffers and level detecting squelch circuits are employed. A differential input receiver circuit\nand a phase-locked loop (PLL) perform the decoding function.\nThe Manchester-encoded data stream is separated into clock signal and NRZ data. A squelch circuit rejects signals with\nlevels less than 400mV or with short pulse widths to prevent noise at the RXP1 or RXM1 input from falsely triggering\nthe decoder. When the input exceeds the squelch limit, the PLL locks onto the incoming signal and the device decodes\na data frame. The receiver clock is maintained active during idle periods in between data reception.\n4.1.4 AUTO MDI/MDI-X\nThe automatic MDI/MDI-X featur e, also known as auto crossover, eliminates the need to determine whether to use a\nstraight cable or a crossover cable between the device and its link partner. The auto-sense function detects the MDI/\nMDI-X pair mapping from the link partner, and assigns the MDI/MDI-X pair mapping of the device accordingly. Table 4-\n1 shows the device’s 10/100 Mbps pin configurati on assignments for MDI and MDI-X pin mapping. \nAuto MDI/MDI-X is enabled by default. It can be disabled throug h the port control registers. If Auto MDI/MDI-X is dis-\nabled, the port control register can also be us ed to select between MDI and MDI-X settings.\nAn isolation transformer with symmetrical transmit and rece ive data paths is recommended to support Auto MDI/MDI-X.\n4.1.5 PAIR-SWAP, ALIGNMEN T, AND POLARITY CHECK\nIn 1000BASE-T mode, the device:\n• Detects incorrect channel order and automatically restores the pair order for the A, B, C, D pairs (four channels).\n• Supports 50±10ns difference in propagation delay betw een pairs of channels in accordance with the IEEE 802.3 \nstandard, and automatically corrects the data skew so t he corrected four pairs of data symbols are synchronized.\nIncorrect pair polarities of the differential si gnals are automatically corrected for all speeds.\n4.1.6 WAVE SHAPING, SLEW-RATE CO NTROL, AND PARTIAL RESPONSE\nIn communication systems, signal transmission encoding methods are used to provide the noise-shaping feature and\nto minimize distortion and error in the transmission channel.\n• For 1000BASE-T, a special partial-response signaling me thod is used to provide the bandwidth-limiting feature for \nthe transmission path.\n• For 100BASE-TX, a simple slew-rate cont rol method is used to minimize EMI.\n• For 10BASE-Te, pre-emphasis is used to extend the signal quality through the cable.TABLE 4-1: MDI/MDI-X PIN DEFINITIONS\nPin (RJ45 pair)MDI MDI-X\n1000BASE-T 100BASE-TX 10BASE-Te 1000BASE-T 100BASE-TX 10BASE-Te\nTXRX xP/M_A  ( 1 , 2 ) A + / -T X + / - T X + / -B + / -R X + / - R X + / -\nTXRX xP/M_B  (3,6) B+/- RX+/- RX+/- A+/- TX+/- TX+/-\nTXRX xP/M_C  (4,5) C+/- Not used Not used D+/- Not used Not used\nTXRX xP/M_D  (7,8) D+/- Not used Not used C+/- Not used Not used\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 23KSZ9896C\n4.1.7 AUTO-NEGOTIATION\nThe device conforms to the auto-negotiat ion protocol as described by IEEE 802 .3. Auto-negotiation allows each port to\noperate at either 10 BASE-Te 100BASE-TX or 1000BASE-T by allowing lin k partners to select the best common mode\nof operation. During auto-negotiation, the link partners advertise capabilities ac ross the link to each other and then com-\npare their own capabilities with those they  received from their link partners. Th e highest speed and duplex setting that\nis common to the two link partners is  selected as the mode of operation. \nThe following list shows the speed and duplex opera tion mode from highest to lowest priority.\n• Priority 1: 1000BASE-T, full-duplex\n• Priority 2: 1000BASE-T, half-duplex\n• Priority 3: 100BASE-TX, full-duplex\n• Priority 4: 100BASE-TX, half-duplex• Priority 5: 10BASE-Te, full-duplex\n• Priority 6: 10BASE-Te, half-duplex\nIf the KSZ9896C link partner doesn’t support auto-negotiation or is forced to bypass auto-negotiation for 10BASE-Te\nand 100BASE-TX modes, the KSZ9896C port sets its operating mode by observing the signal at its receiver. This is\nknown as parallel detection, and allows the KSZ9896C to esta blish a link by listening for a fixed signal protocol in the\nabsence of the auto-negotiation advertisement protocol.\nThe auto-negotiation link-up process is shown in Figure 4-1 . \nFor 1000BASE-T mode, auto- negotiation is always require d to establish a link. Duri ng 1000BASE-T au to-negotiation,\nthe master and slave configuration is first resolved between link partners. Then t he link is established with the highest\ncommon capabilities between link partners.FIGURE 4-1: AUTO-NEGOTIATIO N AND PARALLEL OPERATION\n\nKSZ9896C\nDS00002390A-page 24 \uf0e3 2017 Microchip Technology Inc.Auto-negotiation is enabled by default after power-up or ha rdware reset. Afterwards, auto-negotiation can be enabled\nor disabled via bit 12 of the PHY Basic Control Register . If auto-negotiation is disabled, the speed is set by bits 6 and\n13 of the PHY Basic Control Register , and the duplex is set by bit 8. \nIf the speed is changed on the fly, the link goes down and eith er auto-negotiation or parallel  detection initiate until a\ncommon speed between the KSZ9896C and its link partner is re-established for a link.\nIf link is already established and there is no change of speed on the fly, the changes (for example, duplex and pause\ncapabilities) will not take effect unless either auto-negotiation is restarte d through bit 9 of the PHY Basic Control Regis-\nter, or a link-down to link-up transition occurs (i.e. disconnecting and reconnecting the cable).\nAfter auto-negotiation is completed, the link status is updated in the PHY Basic Status Register , and the link partner\ncapabilities are updated in the PHY Auto-Negotiation Link  Partner Ability Register , PHY Auto-Negotiation Expansion\nStatus Register , and PHY 1000BASE-T Status Register . \n4.1.8 FAST LINK-UP\nLink up time is normally determined by the time it takes to complete auto-negotiation. Additional time may be added by\nthe auto MDI/MDI-X featur e. The total link up time from power-up or cable connect is typically a second or more.\nFast Link-up mode significantly reduces 100BASE-TX link- up time by disabling both  auto-negotiation and auto MDI/\nMDI-X, and fixing the TX and RX channels. Th is mode is enabled or disabled by the LED2_1  strapping option. It is not\nset by registers, so fast link-up is available immediately upon power-up. Fast Link-up is available at power-up only for\n100BASE-TX link speed, which is selected by strapping the LED4_0  pin high. Fast Link-up is  also available for 10BASE-\nTe, but this link speed must first be selected via a register write.\nFast Link-up is intended for specialized applications where both link partners are known in advance. The link must also\nbe known so that the fixed transmit channel of one device conne cts to the fixed receive channel of the other device, and\nvice versa. The TX and RX channel assignments ar e determined by the MDI/MDI-X strapping option on LED2_0 .\nIf a device in Fast Link-up mode is connected to a normal device (auto-negotiate and aut o-MDI/MDI-X), there will be no\nproblems linking, but the speed advantage of Fast Link-up will not be realized.\nFor more information on configuration straps, refer to Section 3.2.1, "Configuration Straps," on page 17 .\n4.1.9 LinkMD® C ABLE DIAGNOSTICS\nThe LinkMD® function utilizes Time Domain Reflectometry (TDR) to analyze the cabling for common cabling problems,\nsuch as open circuits, short circuits and impedance mismatches.\nLinkMD® works by sending a pulse of known amplitude a nd duration down the MDI or MDI-X pair, and then analyzing\nthe shape of the reflected signal to determine the type of faul t. The time duration for the reflected signal to return pro-\nvides the approximate distance to the cabling fault. The Li nkMD® function processes this TDR information and presents\nit as a numerical value that can be translated to a cable distance.\n4.1.10 REMOTE PHY LOOPBACK\nThis loopback mode checks the line (differential pairs, tran sformer, RJ-45 connector, Et hernet cable) transmit and\nreceive data paths between the KSZ9896C and its Ethernet PHY link partner, and is supported for 10/100/1000 Mbps\nat full-duplex.\nThe loopback data path is shown in Figure 4-2  and functions as follows:\n• The Ethernet PHY link partner tran smits data to the KSZ9896C PHY port.\n• Data received at the external pins of the PHY port is looped back without passing through the MAC and internal \nswitch fabric. \n• The same KSZ9896C PHY port transmits data back to the Ethernet PHY link partner.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 25KSZ9896C\nThe following programming steps and register settings  are for remote PHY loopback mode for 1000BASE-T Master\nMode, 1000BASE-T Slave Mode, 100BASE-TX Mode, and 10BASE-T Mode. \n• 1000BASE-T Master Mode\n- Set Port N (1-5), PHY 1000BASE-T Control Register  = 0x1F00\n- Set Port N (1-5), PHY Remote Loopback Register  = 0x01F0\n- Set Port N (1-5), PHY Basic Control Register  = 0x1340\n• 1000BASE-T Slave Mode \n- Set Port N (1-5), PHY 1000BASE-T Control Register  = 0x1300\n- Set Port N (1-5), PHY Remote Loopback Register  = 0x01F0\n- Set Port N (1-5), PHY Basic Control Register  = 0x1340\n• 100BASE-TX Mode\n- Set Port N (1-5), PHY Auto-Negotiation Advertisement Register  = 0x0181\n- Set Port N (1-5), PHY 1000BASE-T Control Register  = 0x0C00\n- Set Port N (1-5), PHY Remote Loopback Register  = 0x01F0\n- Set Port N (1-5), PHY Basic Control Register  = 0x3300\n• 10BASE-T Mode\n- Set Port N (1-5), PHY Auto-Negotiation Advertisement Register  = 0x0061\n- Set Port N (1-5), PHY 1000BASE-T Control Register  = 0x0C00\n- Set Port N (1-5), PHY Remote Loopback Register  = 0x01F0\n- Set Port N (1-5), PHY Basic Control Register  = 0x3300FIGURE 4-2: REMOTE PHY LOOPBACK\nRJ-45Switch\nFabricMAC10/100/1000\nPHYDevice PHY Port N (1-5)\nCAT-5 \n(UTP)\nRJ-45Ethernet PHY\nLink Partner\nKSZ9896C\nDS00002390A-page 26 \uf0e3 2017 Microchip Technology Inc.4.2 LEDs\nEach PHY port has two programmable LED output pins, LED x_0 and LED x_1, to indicate the PHY link and activity sta-\ntus. Two different LED modes are available. The LED mode  can be changed individually for each PHY port by writing\nto the PHY Mode bit in the PHY indirect register: MMD 2, address 0, bit 4:\n•1  =  Single-LED Mode\n•0  =  Tri-Color Dual-LED Mode  (Default)\nEach LED output pin can directly drive an LED with a series resistor (typically 220 Ω to 470Ω). LED outputs are active-\nlow.\n4.2.1 SINGLE-LED MODE\nIn single-LED mode, the LED x_1 pin indicates the link status while the LED x_0 pin indicates the activity status, as shown\nin Figure 4-2 .\n4.2.2 TRI-COLOR DUAL-LED MODE\nIn tri-color dual-LED mode, the link and activity status are indicated by the LED x_1 pin for 1000BASE-T; by the LED x_0\npin for 100BASE-TX; and by both LED x_1 and LED x_0 pins, working in conjunction,  for 10BASE-T. This behavior is\nsummarized in Figure 4-3 .\n4.3 Media Access Controller (MAC)\n4.3.1 MAC OPERATION\nThe device strictly abides by IEEE 802.3 standards to maxi mize compatibility. Additionally, there is an added MAC fil-\ntering function to filter unicast packets. The MAC filtering functi on is useful in applications, such as VoIP, where restrict-\ning certain packets reduces congest ion and thus improves performance.\nThe transmit MAC takes data from the egress buffer and crea tes full Ethernet frames by adding the preamble and the\nstart-of-frame delimiter ahead of the da ta, and generates the FCS that is appended to the end of the frame. It also sends\nflow control packets as needed.TABLE 4-2: SINGLE-LED MODE PIN DEFINITION\nLED Pin Pin State Pin LED Definition Link/Activity\nLED x_1HO F F L i n k  O f f\nL ON Link On (any speed)\nLED x_0H OFF No Activity\nToggle Blinking Activity (RX,TX)\nTABLE 4-3: TRI-COLOR DUAL-LED MODE PIN DEFINITION\nLED Pin (State) LED Pin (Definition) Link/Activity\nLED x_1 LED x_0 LED x_1 LED x_0\nH H OFF OFF Link off\nL H ON OFF 1000Mbps Link / No Activity\nToggle H Blinking OFF 1000Mbps Link / Activity (RX,TX)\nH L OFF ON 100Mbps Link / No Activity\nH Toggle OFF Blinking 100Mbps Link / Activity (RX,TX)\nL L ON ON 10Mbps Link  / No Activity\nToggle Toggle Blinking Blinking 10Mbps Link / Activity (RX,TX)\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 27KSZ9896C\nThe receive MAC accepts data via the integrated PHY or via the GMII/MII/RMII/RGMII inte rface. It decodes the data\nbytes, strips off the preamble and SFD of each frame.  The destination and source addresses and VLAN tag are\nextracted for use in filtering and addre ss/ID lookup, and the MAC also calculates  the CRC of the received frame, which\nis compared to the FCS field. The MAC can discard frames that are the wrong size, that have an FCS error, or when\nthe source MAC address matches the Switch MAC address.\nThe receive MAC also implements the Wa ke on LAN (WoL) feature. This system  power saving feature is described in\ndetail in the Section 4.8, "Power Management" .\nMIB statistics are collected in both receive and transmit directions.\n4.3.2 INTER-PAC KET GAP (IPG)\nIf a frame is successfully transmitted, then the minimum 96-bit time for IPG is specified as being between two consec-\nutive packets. If the current packet is experiencing collisions, the minimum 96-bit time for IPG is specified as being from\ncarrier sense (CRS) to the next transmit packet.\n4.3.3 BACK-OFF ALGORITHM\nThe device implements the IEEE standard 802.3 binary expone ntial back-off algorithm in half-duplex mode. After 16\ncollisions, the packet is dropped.\n4.3.4 LATE COLLISION\nIf a transmit packet experiences collisions after 512 bit times of the transmission, the packet is dropped.\n4.3.5 LEGAL PACKET SIZE\nOn all ports, the device discards received packets smaller than 64 bytes (excluding VLAN tag, including FCS) or larger\nthan the maximum size. The default maximu m size is the IEEE standa rd of 1518 bytes, but c an be programmed to 2000\nbytes. Ports operating at 1000Mbps may be programmed to acce pt jumbo packets up to 9000 bytes, but for performance\nreasons it is recommended that no more than two ports be enabled simultaneously for jumbo packets.\n4.3.6 FLOW CONTROL\nThe device supports standard MAC Control PAUSE (802.3x flow  control) frames in both the transmit and receive direc-\ntions for full-duplex connections.\nIn the receive direction, if a PAUSE control frame is rece ived on any port, the device will not transmit the next normal\nframe on that port until the timer, spec ified in the PAUSE control frame, expires. If another PAUSE frame is received\nbefore the current timer expires, the ti mer will then update with the new value in the second PAUSE frame. During this\nperiod (while it is flow controlled), only flow  control packets from the device are transmitted.\nIn the transmit direction, the device has intelligent and efficient ways to determine when to invoke flow control and send\nPAUSE frames. The flow control is based on availability of the system resources,  including available buffers, available\ntransmit queues and available receive queues.\nThe device issues a PAUSE frame containing the maximum pause time defined in IEEE standard 802.3x. Once the\nresource is freed up, the device sends out another flow cont rol frame with zero pause time to turn off the flow control\n(turn on transmission to the port). A hysteresis feature is provided to prevent the flow control mechanism from being\nconstantly activated and deactivated.\n4.3.7 HALF-DUPLEX BACK PRESSURE\nA half-duplex back pressure option (non-IEEE 802.3 standard) is also provided. The activation and deactivation condi-\ntions are the same as in full-duplex mode. If back pressure  is required, the device sends preambles to defer the other\nstations\' transmission (carrier sense deference). \nTo avoid jabber and excessive deference (as defined in the 802.3 standard), after a certain time, the device discontinues\nthe carrier sense and then raises it again quickly. This shor t silent time (no carrier sense) prevents other stations from\nsending out packets thus keeping other stations in a carrier s ense deferred state. If the port has packets to send during\na back pressure situation, the carrier sense type back pre ssure is interrupted and those packets are transmitted instead.\nIf there are no additional packets to send, carrier sense type  back pressure is reactivated again until chip resources free\nup. If a collision occurs, the binary expone ntial back-off algorithm is skipped and carrier sense is generated immediately,\nthus reducing the chance of further collision and carrier sense is maintained to prevent packet reception.\nKSZ9896C\nDS00002390A-page 28 \uf0e3 2017 Microchip Technology Inc.To ensure no packet loss in 10BASE-Te or 100BASE-TX half- duplex modes, the user must enable the following:\n• No excessive collision drop ( Switch MAC Control 1 Register )\n• Back pressure ( Port MAC Control 1 Register )\n4.3.8 FLOW CONTROL AND BACK PRESSURE REGISTERS\nTable 4-4  provides a list of flow contro l and back pressure related registers.\n4.3.9 BROADCAST STORM PROTECTION\nThe device has an intelligent option to protect the switch syst em from receiving too many broadcast packets. As the\nbroadcast packets are forwarded to all ports except the sour ce port, an excessive number of switch resources (band-\nwidth and available space in transmit queues) may be utilized. The device has the option to include “multicast packets”\nfor storm control. The broadcast storm rate parameters are programmed globally, and can be enabled or disabled on aper port basis. The rate is based on a 5ms interval fo r 1000BASE-T, a 50ms interval for 100BASE-TX and a 500ms\ninterval for 10BASE-Te. At the beginning of each interval, th e counter is cleared to zero  and the rate limit mechanism\nstarts to count the number of bytes during the interval. The ra te definition is described in control registers. The default\nsetting equates to a rate of 1%.\n4.3.10 SELF-ADDRESS FILTERING\nReceived packets can be filtered (dropped) if their source address matches the device\'s MAC address. This feature is\nuseful for automatically terminating packe ts once they have traversed a ring network and returned to their source. It can\nbe enabled on a per-port basis via the Switch Lookup Engine Control 1 Register  and Port Control 2 Register .\n4.4 Switch\n4.4.1 SWITCHING ENGINE\nA high-performance switching engine is used to move data to  and from the MAC\'s packet buff ers. It operates in store\nand forward mode, while an efficient switching mechanism reduces overall latency. The switching engine has a256KByte internal frame buffer that is shared between all the ports.\nFor the majority of switch functions, all of the data ports are treated equally. However, a few functions such as IGMP\nsnooping, 802.1X, forwarding invalid VLAN packets, etc., give  special recognition to the host port. Any port (but most\ncommonly port 6) may be assigned as the host port by enabling tail tagging mode for that port. Only one port may be a\nhost port.TABLE 4-4: FLOW CONTROL AND BACK PRESSURE REGISTERS\nRegisters Description\nLED Configuration Strap Register LED configuration strap settings. \n(LED1_1  enables flow control and back pressure)\nSwitch MAC Address 0 Register\nthrough\nSwitch MAC Address 5 RegisterSwitch\'s MAC address, used as source address of PAUSE control \nframes\nSwitch MAC Control 0 Register “Aggressive back-off” enable\nSwitch MAC Control 1 Register BP mode, “Fair mode” enable, “no excessive collision drop” enable\nSwitch MAC Control 4 Register Pass PAUSE control frames\nPort Status Register Flow control enable (per port)\nPHY Auto-Negotiation Advertisement Register PHY - flow control adve rtisement (per port)\nPort MAC Control 1 Register Half-duplex back pressure enable (per port)\nPort Ingress Rate Limit Control Register Ingress rate limit flow control enable (per port)\nPort Control 0 Register Drop mode (per port)\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 29KSZ9896C\nWhen a switch receives a non-error pa cket, it checks the packet\'s destination MAC address. If the address is known,\nthe packet is forwarded to the output port that is associ ated with the destination MAC ad dress. The following paragraphs\ndescribe the key functions of destination address lookup an d source address learning. These processes may be com-\nbined with VLAN support and other features, whic h are described in the subsequent sub-sections.\n4.4.2 ADDRESS LOOKUP\nDestination address lookup is performed in three separate internal address tables in the device:\n1.Address Lookup (ALU) Table : 4K dynamic + static entries\n2.Static Address Table : 16 static entries\n3.Reserved Multicast Address Table : 8 pre-configured static entries\n4.4.2.1 Address Lookup (ALU) Table\nThe Address Lookup (ALU) Table stores MAC addresses and their associated information. This table holds both\ndynamic and static entries. Dynamic entries are cr eated automatically in ha rdware, as described in Section 4.4.2.4,\n"Learning" . Static entries are created by management software.\nThis table is a 4-way associative memory, with 1K buckets, for a total of 4K entries. A hash function translates the\nreceived packet\'s MAC address (and optionally the FID) into a 10-bit index for accessing the table. At each bucket are\nfour fully-associative address entries. All four entries ar e simultaneously compared to the MAC address (plus optional\nFID) for a possible match.\nThree options are available for th e hashing function, as described in Table 4-5 . If VLAN is enabled (802.1Q VLAN\nEnable bit in the Switch Lookup Engine Control 0 Register ), the VLAN group (FID) is included in the hashing function\nalong with the MAC address. If VLAN is not enabled the has hing function is applied to MAC address and the FID in the\ndefault VLAN (VID=1) which is 0.\n4.4.2.2 Static Address Table\nThe 16-entry Static Address Table is typically used to hold mu lticast addresses, but is not lim ited to this. As with static\nentries in the ALU table, entries in th e Static Address Table are created by ma nagement software. It serves the same\nfunction as static entries that are created in the ALU table, so its use is optional.\n4.4.2.3 Reserved Multicast Address Table\nThe Reserved Multicast Address Table holds 8 pre-configured address entries, as defined in Table 4-6 . This table is an\noptional feature that is disabled at power-on. If desired, the forwarding ports may be modified. TABLE 4-5: ADDRESS LOOKUP TABLE HASHING OPTIONS\nHASH_OPTION\n(Switch Lookup Engine \nControl 0 Register )Description\n01b (Default) A hash algorithm based on the CRC of the MAC address plus FID.  The hash algorithm uses \nthe CRC-CCITT polynomial. The input to the hash  is reduced to a 16-bit CRC hash value. \nBits [9:0] of the hash value plus (binary addition) 7-bit FID (zero extended on the left) are used as an index to the table.  The CRC-CCITT polynomial is: X\n16+X12+X5+1.\n10b An XOR algorithm based on 16 bits of the XOR of the triple-folded MAC address. Bits [9:0] \nof the XOR value plus 7-bit FID (left- extended) are used to index the table.\n00b or 11b A direct algorithm. The 10 least significa nt bits of the MAC address plus 7 bit FID are used \nto index the table.\nKSZ9896C\nDS00002390A-page 30 \uf0e3 2017 Microchip Technology Inc.If a match is found in one of the tables, th en the destination port is read from that table entry. If a match is found in more\nthan one table, static entries will ta ke priority over dynamic entries.\n4.4.2.4 Learning\nThe internal lookup engine updates the ALU table with a new dynamic entry if the following conditions are met:\n• The received packet\'s source address (SA) does not exist in the lookup table.\n• The received packet has no errors, and the packet size is of legal length.• The received packet has a unicast SA. \n• If VLAN is enabled, the received packet must belong to the indicated VLAN domain (FID).\nThe lookup engine inserts the qualified SA into the table, along with the port number and time stamp. If all four table\nentries are valid, the oldest of the (up to four) dynamic en tries may be deleted to make room for the new entry. Static\nentries are never deleted by the learning pr ocess. If all four entries are static entries, the ad dress is not learned but an\ninterrupt is generated and the table index number is  made available to the interrupt service routine.\n4.4.2.5 Migration\nThe internal lookup engine also monitors whether a station ha s moved. If a station has moved, it updates the ALU table\naccordingly. Migration happens when the following conditions are met:\n• The received packet\'s SA is in the table but the associated source port information is different.\n• The received packet has no receiving errors , and the packet size is of legal length.\nThe lookup engine updates the existing record in  the table with the new source port information.\n4.4.2.6 Aging\nThe lookup engine updates the time stamp information of a dynamic record in the ALU table whenever the correspond-\ning SA appears. The time stamp is used in the aging process.  If a record is not updated for a period of time, the lookup\nengine removes the record from the table. The lookup e ngine constantly performs the aging process and continuously\nremoves aging records. The aging period is about 300 seconds (±75 seconds) and can be configured longer or shorter\n(1 second to 30 minutes). This feature can be enabled or disabled. Static entries are exempt from the aging process.TABLE 4-6: RESERVED MULT ICAST ADDRESS TABLE\nGroup AddressMAC Group \nAddress FunctionDefault PORT FORWARD \nValue \n(defines forwarding port: P6...P1)Default Forwarding Action\n0 (01-80-C2-00)-00-00 Bridge Group Data 00_0000 Forward only to the highest \nnumbered port \n(default host port)\n1 (01-80-C2-00)-00-01 MAC Control Frame \n(typically flow control)00_0000 Drop MAC flow control\n2 (01-80-C2-00)-00-03 802.1X Access \nControl00_0000 Forward to highest num-\nbered port\n3 (01-80-C2-00)-00-10 Bridge Management 11_1111 Flood to all ports\n4 (01-80-C2-00)-00-20 GMRP 11_1111 Flood to all ports except high-\nest numbered port\n5 (01-80-C2-00)-00-21 GVRP 11_1111 Flood to all ports except high-\nest numbered port\n6 (01-80-C2-00)-00-02, \n(01-80-C2-00)-00-04 –\n(01-80-C2-00)-00-0F00_0000 Forward to highest num-\nbered port\n7 (01-80-C2-00)-00-11 - \n(01-80-C2-00)-00-1F, \n(01-80-C2-00)-00-22 - (01-80-C2-00)-00-2F11_1111 Flood to all ports except high-\nest numbered port\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 31KSZ9896C\n4.4.2.7 Forwarding\nThe device forwards packets using the algorithm that is depicted in Figure 4-3 . Figure 4-3  shows stage one of the for-\nwarding algorithm where the search engine looks up the VLAN  ID, static table, and dynamic table for the destination\naddress, and comes up with “port to forward 1" (PTF1). PTF1  is then further modified by spanning tree, IGMP snooping,\nport mirroring, and port VLAN processes.\nThe ACL process works in parallel with the flow outlined above. The authentication and AC L processes have the highest\npriority in the forwarding process, and the ACL result may override the result of the above flow. The output of the ACL\nprocess is the final “port-to-forwa rd 2" (PTF2) destination port(s).\nThe device will not forward the following packets:• Error packets: These include framing errors, frame c heck sequence (FCS) errors, alignment errors, and illegal \nsize packet errors.\n• MAC Control PAUSE frames: The device intercepts these packets and performs full duplex flow control accord-\ningly.\n• “Local” packets: Based on destination address (DA) lookup. If the destination port from  the lookup table matches \nthe port from which the packet originat ed, the packet is defined as “local”.\n• In-Band Management packets.\nFIGURE 4-3: PACKET FORWARDING PROCESS FLOWCHART\nStart\nPTF1=NULL VLAN ID Valid?no\nGet PTF1 from \nStatic ArraySearch\nStatic\nArrayfound\nGet PTF1 from Address TableSearch \nAddress \nLook-up\nTablefound\nGet PTF1 from \nVLAN Table\nPTF1yes\nnot found\nnot found- Search VLAN table\n- Ingress VLAN filtering\n-Discard NPVID check\nSearch based on \nDA or DA+FID\nSearch based on \nDA+FIDPTF1\nSpanning Tree \nProcess\nPort Mirror \nProcessIGMP / MLD \nProcess\nPTF2- Check receiving port’s receive enable bit- Check destination port’s transmit enable bit\n- Check whether packets are special (BPDU)\n- IGMP / MLD packets are forwarded \n   to Host port- Process does not apply to packets \n   received at Host port\n- RX Mirror\n- TX Mirror\n- RX or TX Mirror\n- RX and TX Mirror\nPort \nAuthentication\n& ACL\nKSZ9896C\nDS00002390A-page 32 \uf0e3 2017 Microchip Technology Inc.4.4.2.8 Lookup Engine Registers\nTable 4-7  provides a list of lookup engine related registers.\n4.4.3 IEEE 802.1Q VLAN\nVirtual LAN is a means of segregating a physical network into  multiple virtual networks whereby traffic may be confined\nto specific subsets of the gr eater network. IEEE 802.1Q defines a VLAN protocol using a 4-byte tag that is added to the\nEthernet frame header. The device supports port-based a nd tag-based VLANs, including tagging, un-tagging, forward-\ning and filtering.\n4.4.3.1 Non-Tag Port-Based VLAN\nThe simplest VLAN method establishes forwarding restrictio ns on a port-by-port basis wit hout using VLAN tags. There\nis a register for each ingress port that is used to specify the allowed forwarding ports. An incoming packet is restricted\nfrom being forwarded to any egress port that is disallow ed for that ingress port. The settings are made in the Port Control\n1 Register . This function is always enabled; it is not enabled and disabled by the 802.1Q VLAN Enable bit in the Switch\nLookup Engine Control 0 Register . The default setting is to allow all ingress-to-egress port paths.\n4.4.3.2 Tag-Based VLAN\nWhen 802.1Q VLAN is enabled, an internal VLAN Table with 4k entries is used to a store port membership list, VLAN\ngroup ID (FID) and additional information relating to each VL AN. This table must be set up by an administrator prior to\nenabling 802.1Q VLAN. Enabling is done by se tting the 802.1Q VLAN Enable bit in the Switch Lookup Engine Control\n0 Register . \nIn 802.1Q VLAN mode, the lookup process starts with VLAN Table lookup, using th e tag\'s VID as the address. The first\nstep is to determine whether the VID is valid. If the VID is not valid, the packet is dropped and its address is not learned.\nAlternatively, unknown VID packets may be forwarded to pre-defi ned ports or to the host port. If the VID is valid, the FID\nis retrieved for further lookup. The FI D + Destination Address (hashed(DA) + FI D) are used to determine the destination\nport. The FID + Source Address (hashed(SA) + FID) are used for address learning (see Table 4-9  and Table 4-10 ).TABLE 4-7: LOOKUP ENGINE REGISTERS\nRegisters Description\nGlobal Interrupt Status Register , \nGlobal Interrupt Mask RegisterTop level LUE interrupt\nSwitch Lookup Engine Control 0 Register ,\nSwitch Lookup Engine Control 1 Register ,\nSwitch Lookup Engine Control 2 Register ,\nSwitch Lookup Engine Control 3 RegisterMisc.\nAddress Lookup Table Interrupt Register ,\nAddress Lookup Table Mask RegisterLow level LUE interrupts\nAddress Lookup Table Entry Index 0 Register ,\nAddress Lookup Table Entry Index 1 Register  Access failure address/index\nALU Table Index 0 Register , \nALU Table Index 1 Register , \nALU Table Access Control Register , \nStatic Address and Reserved Multicast Table \nControl Register , \nALU / Static Address Table Entry 1 Register ,\nALU / Static Address / Reserved Multicast \nTable Entry 2 Register ,\nALU / Static Address Table Entry 3 Register ,\nALU / Static Address Table Entry 4 RegisterAddress table access registers\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 33KSZ9896C\nThe hashed(DA) + FID are hashed and used for forwarding l ookup in the Address Lookup and Static Address Tables.\nFor a successful address table lookup, the FID fields must also  match. If the match fails, the packet is broadcast to all\nthe VLAN port members defined in the VLAN Table entry. If there is a match and egress VLAN filtering is enabled, the\npacket is forwarded to those ports that are in both the a ddress table port forwarding list and the VLAN table port mem-\nbership list.\nA similar address table lookup is performed using the hashed( SA) + FID. If the lookup fails, the FID and SA are learned.\nIf a non-tagged or null-VID-tagged packet is received, the ingress port default VID ( Port Default Tag 0 Register  and Port\nDefault Tag 1 Register ) is used for lookup. \nTable 4-8  details the forwarding and discarding actions that are taken for the variou s VLAN scenarios. The first entry in\nthe table is explained by the fact that VLAN Table lookup is enabled even when 802.1Q VL AN is not enabled. Notice\nthat in the Port Default Tag 0 Register  and Port Default Tag 1 Register , the port default VID is 1 for each port. Corre-\nspondingly, the VLAN port membership list in the VLAN Tabl e entry for VID=1 is pre-configured at power-on to all ones.\nThis provides the standard Ethernet swit ch behavior of broadcasting all packets with unknown destination address. If\nthe VLAN table entry # 1 is changed, or if the port default VID is changed, this  may affect the forwarding action for\n“unknown packets” even when VLAN is not enabled.\nIt should also be noted that the default values of the Egress VLAN Filtering bits are zero. These bits are zero only for\nbackwards compatibility with previous “KSZ” switches. The re sulting switch behavior, in the event of a successful VLAN\nand ALU lookups, is to forward the packet to the ports in  the address table port forwarding list, without regard to the\nVLAN port membership list. It is suggest ed that the Egress VLAN Filtering bits be set to one so that the VLAN port mem-\nbership list from the VLAN Table will be used to qualif y the forwarding determined from the address lookup.\nTABLE 4-8: VLAN FORWARDING\nVLAN \nEnable \n(Note 4-1 )VLAN \nMatch/\nValid \n(Note 4-2 )Forward \nOption\n(Note 4-3 )Egress \nVLAN \nFiltering\n(Note 4-4 )Unknown \nVID \nForward\n(Note 4-5 )Drop \nInvalid \nVID\n(Note 4-6 )ALU \nMatch/\nValid\n(Note 4-7 )Action\n0 X X X X X No Forward to port membership list \nof default VID in LAN table\n0 X X X X X Yes Forward to Address Lookup \nport forwarding list\n1 No X X 0 0 X Forward to host port1 No X X 0 (def) 1 (def) X Discard\n1 No X X 1 X X Forward to Unknown VID \npacket forward port list\n1Y e s0 X X XN o Broadcast:  Forward to VLAN \ntable port membership list \n(PORT FORWARD)Multicast:  Forward to \nUnknown Multicast ports if UM \nis enabled. Else, forward to VLAN table port  membership \nlist.\nUnicast:  Forward to Unknown \nUnicast ports if UU is enabled. \nElse forward to VLAN table port \nmembership list. \n1 Yes 0 0 (def) X X Yes Forward to address table \nlookup port forwarding list\n1 Yes 0 1 X X Yes Forward to address table \nlookup port forwarding list & \nVLAN table port  membership \nlist (bitwise AND)\n1 Yes 1 X X X Yes Forward to VLAN table port \nmembership list\nKSZ9896C\nDS00002390A-page 34 \uf0e3 2017 Microchip Technology Inc.Note 4-1 VLAN Enable  is bit 7 in the Switch Lookup Engine Control 0 Register\nNote 4-2 VLAN Match/Valid  indicates when the VLAN Table entry is valid\nNote 4-3 Forward Option  is a bit in the VLAN Table Entry 0 Register\nNote 4-4 Egress VLAN Filtering  are bits 5 and 4 in the Switch Lookup Engine Control 2 Register\nNote 4-5 Unknown VID Forwarding  is in the Unknown VLAN ID Control Register\nNote 4-6 Drop Invalid VID  is bit 6 in the Switch Lookup Engine Control 0 Register\nNote 4-7 ALU Match/Valid  indicates when the Address Lookup is a success\nTable 4-9  describes in more detail the address lookup process that follows the VLAN Table lookup. Lookup occurs in\nboth the Address Lookup Table and the Static Address Tabl e simultaneously, and the resulting action depends on the\nresults of the two lookups.\nA source address (SA) lookup is also performed in the Addr ess Lookup Table. SA lookup al so performs SA filtering and\nMAC priority when the address is hit. Table 4-10  describes how learning is performed in the Address Lookup Table when\na successful VLAN table lookup has been done and the no ma tching static entry is found in the Address Lookup Table\nor the Static Address Table.Note: “(def)” indicates the def ault power-up value. \nTABLE 4-9: HASHED(DA) + FID LOOKUP IN VLAN MODE\nDA Found \nin Static \nMAC Table?Use FID Flag? \n(Static MAC Table)FID Match?DA+FID Found in \nALU Table?Action\nNo Don’t Care Don’t Care No Lookup has failed. Broadcast to \nthe membership ports defined in the VLAN Table\nNo Don’t Care Don’t Care Yes Send to the destination port \ndefined in the Address Lookup (ALU) Table\nYes 0 Don’t Care Don’t Care Send to the destination port(s) \ndefined in the Static Address Table\nYes 1 No No Lookup has failed. Broadcast to \nthe membership ports defined in \nthe VLAN Table.\nYes 1 No Yes Send to the destination port \ndefined in the Address Lookup \n(ALU) Table \nYes 1 Yes Don’t Care Send to the destination port(s) \ndefined in the Static Address Table\nTABLE 4-10: HASHED(SA) + FID LOOKUP IN VLAN MODE\nFID + SA Found in Address Lookup (ALU) Table? Action\nNo Learn and add FID + SA to the Address Lookup (ALU) Table\nYes Update time stamp\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 35KSZ9896C\n4.4.3.2.1 Tag Insertion and Removal\nTag insertion is enabled on all ports when the VLAN feature is enabled. At the ingress port, untagged packets are tagged\nwith the ingress port\'s default tag. The default tag is separately programmable  for each port. The switch does not add\ntags to already tagged packets unless double tagging is enabled.\nAt the egress port, tagged packets will have their 802.1Q VLAN tags removed if un-tagging is enabled in the VLAN table\nentry. This feature is controlled on a per-port basis. Unt agged packets will not be modified if 802.1Q is enabled.\n4.4.3.2.2 Double Tagging\nThe switch supports double tagging, also known as Q-in-Q or  VLAN stacking. This feature can be used for service pro-\nviders to append a second VLAN tag in addition to a first VLAN tag applied by the customer. VLAN support can beenabled either with or without double tagging. When double tagg ing is enabled, the outer tag is recognized and is used\nfor VLAN and address lookup instead of the inner tag. The ou ter tag precedes the inner tag in the frame header: the\nouter tag is located immediately after the source address, and contains a different Tag Protocol Identifier (TPID) value\nthan the inner tag. \nAdditional controls are available for full control of the VL AN function. Some of these features can be enabled on a per-\nport basis, while others are global:\n•Ingress VLAN Filtering:  Discard packet if VID port membership in VLAN table does not include the ingress port.\n•Discard non PVID Packet:  Discard packet if VID does not ma tch the ingress port default VID.\n•Discard un-tagged Packet:  Discard any received packet without a tag.\n•Drop tag:  Drops the packet if it is VLAN tagged.\n•Unknown VID Forward:  Forward to a fixed set of ports if VLAN lookup fails.\n•Drop unknown VID:  Additional options for unknown VID packets: discard or forward to the host port.\n•Null VID Replacement:  Replace a null VID with the ingress port default VID.\n•PVID Replacement:  Replace a non-null VID with th e ingress port default VID.\n•Double Tag Mcast Trap:  In double tag mode, trap all reserved multicast packets and forward to the host port.\n4.4.3.3 VLAN Registers\nTable 4-11  provides a list of VLAN related registers.\nTABLE 4-11: VLAN REGISTERS\nRegisters Description\nSwitch Operation Register Double tag enable\nSwitch Lookup Engine Control 0 Register VLAN enable; Drop invalid VID frames\nSwitch Lookup Engine Control 2 Register Trap double tagged MC frames; \nDynamic & status egress VLAN filtering\nUnknown VLAN ID Control Register Forward unknown VID\nSwitch MAC Control 2 Register Null VID replacement with PVID at egress\nVLAN Table Entry 0 Register ,\nVLAN Table Entry 1 Register ,\nVLAN Table Entry 2 Register ,\nVLAN Table Index Register ,\nVLAN Table Access Control RegisterRead/write access to the VLAN table\nPort Default Tag 0 Register ,\nPort Default Tag 1 RegisterPort default tag\nPort Ingress MAC Control Register Drop non-VLAN frames; Tag drop\nPort Transmit Queue PVID Register PVID replacement at egress\nPort Control 2 Register VLAN table lookup for VID=0; \nIngress VLAN filtering; PVID mismatch discard\nKSZ9896C\nDS00002390A-page 36 \uf0e3 2017 Microchip Technology Inc.4.4.4 QUALITY-OF-SERVICE  (QOS) PRIORITY SUPPORT\nThe device provides quality-of-service  (QoS) for applications such as VoIP. There are multiple methods for assigning\npriority to ingress packets. Depending on the packet prioriti zation method, the packet priority levels are mapped to the\negress queues for each port. Each port can be configured for 1, 2, and 4 egress queues, which are prioritized. Thedefault is 1 queue per port.\nWhen configured for 4 priority queues, Q ueue 3 is the highest priority queue and Queue 0 is the lowest priority. Likewise,\nfor a 2-queue configuration, Queue 1 is th e highest priority queue. If a port is not configured as 2 or 4 queues, then high\npriority and low priority packets have equal priority in the single transmit queue.\nThere is an additional option for every port  to select either to always deliver packets from the highest priority queue first,\nor use weighted round robin queuing amongst the multiple queues. This is described later in Section 4.4.13, "Scheduling\nand Rate Limiting" .\n4.4.4.1 Port-Based Priority\nWith port-based priority, each ingress port is individually clas sified as a specific priority le vel. All packets received at th e\nhigh-priority receiving port are marked as high priority and are sent to the high-priority transmit queue if the correspond-\ning transmit queue is split into 2 or 4 queues.\n4.4.4.2 IEEE 802.1p -Based Priority\nFor IEEE 802.1p-based prio rity, the device examines the ingress packets to determine whether they are tagged. If\ntagged, the 3-bit PCP priority field in the VLAN tag is retrie ved and used to look up the “priority mapping” value. The\n“priority mapping” value is programmable.\nFigure 4-4  illustrates how the 802.1p priority field is embedded in the 802.1Q VLAN tag.\n4.4.4.3 IEEE 802.1p Prio rity Field Re-Mapping\nThis is a QoS feature that a llows the device to set the “User Priority Ceilin g” at any ingress port. If the ingress packet\'s\npriority field has a higher priority valu e than the default tag\'s priority field of the ingress port, the packet\'s priority fie ld is\nreplaced with the default tag\'s priority field.\n4.4.4.4 DiffServ (DSCP) Priority (IP)\nDiffServ-based priority from the DSCP field in the IP header  can be used to determine packet priority. The 6-bit DSCP\nvalue is used as an index to a set of registers which translate  the 6-bit DSCP value to a 2- bit value that specifies one of\nthe 4 (or 2) queues. These r egisters are fully programmable.\n4.4.4.5 ACL Priority\nThe Access Control List (ACL) Filtering feature can also be us ed to assign priority to received packets. This is discussed\nin Section 4.4.16, "Access Cont rol List (ACL) Filtering" .FIGURE 4-4: 802.P PRIORITY FIELD FORMAT\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 37KSZ9896C\n4.4.5 TRAFFIC CONDIT IONING & POLICING\n4.4.5.1 Two Rate Three Color Marker\nThe Two Rate Three Color Marker meters an IP packet stre am and marks its packets green, yellow, or red. A packet is\nmarked red if it exceeds the Peak Information Rate (PIR). Otherwise, it is marked either yellow or green depending on\nwhether it exceeds or doesn\'t exceed the Committed Information Rate (CIR). \nThe Meter operates in one of two modes. In the Color-Blind mode, the Meter assumes that the packet stream is uncol-\nored. In the Color-Aware mode, the Meter assumes that some preceding entity has pre-colored the incoming packet\nstream so that each packet is green, yellow, or red. The Ma rker (re)colors an IP packet according to the results of the\nMeter.\n4.4.5.2 Weighted Random Early Detection (WRED)\nThe WRED feature monitors t he average queue size of packet memory and ingress queue size of each traffic class,\nand drops packets based on memory and queue utilization. If the buffers are almost empty, all incoming traffic is\naccepted. As the buffer utilization increases, the pr obability for dropping an incoming packet also increases.\nWRED is intended to avoid the problem of global synchronization. Global synchronization can occur when a switch\nbecomes congested and begins dropping incoming packets all at once. For TCP streams, packet drops invoke the TCP\ncongestion control mechanism, which redu ce the transmission rate until there ar e no more packet drops. If there are\nmany TCP streams and their congestion c ontrol mechanisms act in unison, this can cause an undesirable oscillation in\ntraffic rates. By selectively dropping some packets early rather  than waiting until the buffer is full, WRED avoids dropping\nlarge numbers of packets at once and minimizes the chances of global synchronization.\nThe packet drop probability is based on the minimum thres hold, maximum threshold, and a probability multiplier. When\nthe average queue depth is above the minimum threshold, packets start getting dropped. The rate of packet drop\nincreases linearly as the average queue size increases until the average queue size reaches the maximum threshold.\nThe probability multiplier is the fraction of packets dropped w hen the average queue depth is at the maximum threshold.\nWhen the average queue size is above the maximum threshold, all packets are dropped. \n4.4.6 SPANNING TREE SUPPORT\nTo support spanning tree, one port is the designated port fo r the host processor, which is defined as the port for which\ntail tagging is enabled. Each of the other ports can be configur ed in one of the five spanning tree states via “transmit\nenable”, “receive enable” and “learning disable” register bits. Table 4-12  shows the setting and software actions taken\nfor each of the five spanning tree states.\nTABLE 4-12: SPANNING TREE STATES\nDisable State Port Setting Software Action\nThe port should not forward or \nreceive any packets.\nLearning is disabled.transmit enable = 0\nreceive enable = 0\nlearning disable = 1The processor should not send any packets to the port. \nThe switch may still send sp ecific packets to the pro-\ncessor (packets that match so me entries in the “Static \nMAC Table” with “overriding bit” set) and the processor should discard those packets. Address learning is dis-\nabled on the port in this state.\nBlocking State Port Se tting Software Action\nOnly packets to the processor \nare forwarded.\nLearning is disabled.transmit enable = 0\nreceive enable = 0\nlearning disable = 1The processor should not send any packets to the \nport(s) in this state. The processor should program the \n“Static MAC Table” with the entries that it needs to receive (for example, BPDU packets). The “overriding” \nbit should also be set so that the switch will forward \nthose specific packets to the processor. Address learn-\ning is disabled on the port in this state.\nKSZ9896C\nDS00002390A-page 38 \uf0e3 2017 Microchip Technology Inc.4.4.7 RAPID SPANNING TREE SUPPORT\nThere are three operational states assigned to each  port for the Rapid Spanning Tree Protocol (RSTP): \n1.Discarding State\n2.Learning State\n3.Forwarding State\n4.4.7.1 Discarding State\nDiscarding ports do not participate in the ac tive topology and do not learn MAC addresses.\n• Discarding state: the state includes three states  of the disable, blocking and listening of STP.\n• Port setting: transmit enable = “0”, receive enable = “0”, learning disable = “1”.\n• Software action: The host processor should not send any packets to the port. The switch may still send specific \npackets to the processor (packets that match some entries in  the static table with “overriding bit” set) and the pro-\ncessor should discard those packets. When the port\'s learning capability (learning disable = \'1\') is disabled, port related entries in the ALU table and static MAC table can be rapidly flushed.\n4.4.7.2 Learning State\nPorts in “learning state” learn MAC addresses, but do not forward user traffic.\n• Learning State: Only packets to and from the host processor are forwarded. Learning is enabled.\n• Port setting for Learning State: transmit enable = “0”, receive enable = “0”, learning disable = “0”.• Software action: The processor should program the Static Ad dress Table with the entries that it needs to receive \n(e.g., BPDU packets). The “overriding” bi t should be set so that the switch will forward those specific packets to \nthe processor. The processor may send packets to the port(s) in this state (see Section 4.4.9, "Tail Tagging Mode"  \nfor details). Address learning is enabled on the port in this state.\n4.4.7.3 Forwarding State\nPorts in “forwarding states” fully particip ate in both data forwarding and MAC learning.\n• Forwarding state: Packets are forwarded and received normally. Learning is enabled.\n• Port setting: transmit enable = “1”, receive enable = “1”, learning disable = “0”.Listening State Port Se tting Software Action\nOnly packets to and from the \nprocessor are forwarded.\nLearning is disabled.transmit enable = 0\nreceive enable = 0\nlearning disable = 1The processor should program the “Static MAC Table” \nwith the entries that it needs  to receive (for example, \nBPDU packets). The “overridin g” bit should be set so \nthat the switch will forward those specific packets to \nthe processor. The processor may send packets to the \nport(s) in this state. Addre ss learning is disabled on the \nport in this state.\nLearning State Port Setting Software Action\nOnly packets to and from the \nprocessor are forwarded.\nLearning is enabled.transmit enable = 0\nreceive enable = 0\nlearning disable = 0The processor should program the “Static MAC Table” \nwith the entries that it needs  to receive (for example, \nBPDU packets). The “overridin g” bit should be set so \nthat the switch will forward those specific packets to the processor. The processor may send packets to the \nport(s) in this state. Address learning is enabled on the \nport in this state.\nForwarding State Port Setting Software Action\nPackets are forwarded and \nreceived normally.Learning is enabled.transmit enable = 1\nreceive enable = 1learning disable = 0The processor programs the “Static MAC Table” with \nthe entries that it needs to  receive (for example, BPDU \npackets). The “overriding” bit is set so that the switch \nforwards those specific packe ts to the processor. The \nprocessor can send packets to the port(s) in this state. Address learning is enabled on the port in this state.TABLE 4-12: SPANNING TREE STATES (CONTINUED)\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 39KSZ9896C\n• Software action: The host processor should program the Static Address Table with the entries that it needs to \nreceive (e.g., BPDU packets). The “overriding” bit should be set so that the switch will forward those specific pack-\nets to the processor. The processor may send packets to the port(s) in this state (see Section 4.4.9, "Tail Tagging \nMode"  for details). Address learning is enabled on the port in this state.\nRSTP uses only one type of BPDU called RSTP BPDUs. They are similar to STP configuration BPDUs with the excep-\ntion of a type field set to “version 2" for RSTP and “version 0" for STP, and a flag field carrying additional information.\n4.4.8 MULTIPLE SPANNING TREE SUPPORT\nMultiple Spanning Tree Protocol (MSTP) is an extension of RSTP that allows different VLANs to have different spanning\ntree configurations. The VLAN Table, Address Lookup Tabl e, Static Address Table and Reserved Multicast Address\nTable all contain a 3-bit field which can be used to specify on e of eight spanning trees. Each port contains state registers\nfor specifying unique states for each of the spanning trees.\n4.4.9 TAIL TAGGING MODE\nTail tagging is a method to communicate ingress and egress port information between the host processor and the switch.\nIt is useful for spanning tree protocol , IGMP/MLD snooping, and other applications. \nWhen the switch forwards a frame to the host port, two tail tagging bytes are added to the frame by the switch to indicate\nto the host processor the port that the frame was received on. In the other dire ction, the host processor adds the tail\ntagging bytes to a frame to indicate the intended egress de stination port to the switch. When multiple priority queues\nare enabled, the tail tag is also used to indicate the priority  queue. The tail tagging bytes are removed before the frame\negresses the switch. Tail tagging may be enabled on any one po rt, and this defines the host port. tail tagging must not\nbe enabled on multiple ports.\nTail tagging is implemented by inserting two additional bytes at the end of the packet, between the data field and the 4-\nbyte CRC / FCS, as shown in Figure 4-5 .\n4.4.10 IGMP SUPPORT\nFor Internet Group Management Protoc ol (IGMP) support in Layer 2, the device provides two components:\n•“IGMP” Snooping\n•“Multicast Address Insertion”  in the Static MAC Table\n4.4.10.1 “IGMP” Snooping\nThe device traps IGMP packets and forwards them only to  the processor (host port). The IGMP packets are identified\nas IP packets (either Ethernet IP packets, or IEEE 802.3 SN AP IP packets) with IP version = 0x4 and protocol version\nnumber = 0x2.\n4.4.10.2 “Multicast Address Insertion” in the Static MAC Table\nOnce the multicast address is programmed in the Static Ad dress Table or Address Lookup Table, the multicast session\nis trimmed to the subscribed ports, instead of broadcasting to all ports.\nSo that the host processor knows which port the IGMP packet was received on, Tail Tagging Mode  must be enabled.\n4.4.11 IPV6 MLD SNOOPING\nThe device traps IPv6 Multicast Listene r Discovery (MLD) packets and forwards them only to the processor (host port).FIGURE 4-5: TAIL TAG FRAME FORMAT\nNote: The port for which Tail Tagging Mode  is enabled is the host port.DEST \nADDRESSSOURCE \nADDRESS6 6\n802.1Q \nTAG(4)\nETYPE or \nLENGTH2\nTAIL \nTAG2\nPAYLOAD46 (42) - 1500\nFCS4 BYTES\nKSZ9896C\nDS00002390A-page 40 \uf0e3 2017 Microchip Technology Inc.4.4.12 PORT MIRRORING\nthe device supports “port mirroring” comprehensively as:\n•“Receive Only” Mirror-on-a-Port\n•“Transmit Only” Mirror-on-a-Port\n•“Receive and Transmit” Mirror-on-a-Port\n4.4.12.1 “Receive Only” Mirror-on-a-Port\nAll the packets received on the port are mirrored on the snif fer port. For example, 1 is programmed to be “receive sniff”\nand the host port is programmed to be the “sniffer”. A packet received on port 1 is destined to port 2 after the internal\nlookup. The packet is forwarded to both port 2 and the host  port. The device can optionally even forward “bad” received\npackets to the “sniffer port”.\n4.4.12.2 “Transmit Only” Mirror-on-a-Port\nAll the packets transmitted on the port are mirrored on the sn iffer port. For example, port 1 is programmed to be “transmit\nsniff” and the host port is programmed to be the “sniffer port”.  A packet received on port 2 is destined to port 1 after the\ninternal lookup. The device forwards the packet to both port 1 and the host port.\n4.4.12.3 “Receive and Transmit” Mirror-on-a-Port\nAll the packets received on port A and transmitted on port B are mirrored on the sniffer port. For example, port 1 is pro-\ngrammed to be “receive sniff”, port 2 is programmed to be “transmit sniff”, and the host port is programmed to be the\n“sniffer port”. A packet received on port 1 is destined to port 2 after the internal lookup. The device forwards the packet\nto both port 2 and the host port.\nMultiple ports can be selected as “receive sniff” or “transmit sniff”. In addition, any port can be selected as the “sniffer\nport”.\n4.4.13 SCHEDULING AND RATE LIMITING\nEach device port has two egress packet scheduling options, which can be applied when the port is configured for twoor four queues. Additionally, each port ha s ingress and egress rate limiter features.\n4.4.13.1 Strict Priority Scheduling\nWhen an egress port is configured as two or four queues, and strict priority scheduling is selected, each queue will take\nabsolute priority over all lower priority queues. If a packet  is available to transmit fr om queue 3 (the highest priority\nqueue), then it will take priority for transmission over any pa cket that will also be available in any of the other queues.\nA packet in queue 2 will be transmitted only if no packet is avai lable in queue 3. Weighted r ound robin is an alternative\nto strict priority scheduling.\n4.4.13.2 Weighted Round Robin (WRR) Scheduling\nWRR scheduling is an alternative to strict priority schedulin g for egress queues. It is referred to as fair queuing because\nit gives proportionally higher priority to the hi ghest priority queue, but not absolute priority.\n4.4.13.3 Rate Limiting\nThe device supports independent ingress and egress hardware  rate limiting on each port. Normally these two features\nare considered mutually exclusive, and users are discouraged from using both on the same port.\nFor 10BASE-Te, a rate setting above 10Mb ps means the rate is not limited. Li kewise, for 100BASE-TX, a rate setting\nabove 100Mbps means the rate is not limited. On the receiv e side, the data receive rate for each priority at each port\ncan be limited by setting up ingress rate control registers. On  the transmit side, the data transmit rate for each priority\nqueue at each port can be limited by setting up egress rate control registers. The size of each frame has options to\ninclude minimum inter-frame gap (IFG) or preamble byte, in addition to the data field (from packet DA to FCS).\nFor ingress rate limiting, the device provides options to sele ctively choose frames from all types, multicast, broadcast,\nand flooded unicast frames. The data rate from those selected  type of frames is counted. Packets are dropped at the\ningress port when the data rate exceeds the specified rate limit.\nFor egress rate limiting, the leaky bucket algorithm is applie d to each output priority queu e for shaping output traffic.\nInter-frame gap is stretched on a per frame base to gener ate smooth, non-burst egress traffic. The throughput of each\noutput priority queue is limited by the egress rate specified.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 41KSZ9896C\nIf any egress queue receives more traffic than the specified egress rate throughput, packets may be accumulated in the\noutput queue and packet memory. After the memory of the queue  or the port is used up, packet dropping or flow control\nwill be triggered. As a result of conges tion, the actual egress rate may be domin ated by flow control/dropping at the\ningress end, and may be therefore slight ly less than the specified egress rate. \nTo reduce congestion, it is a good practice to ensure that the egress bandwidth exceeds the ingress bandwidth. \n4.4.14 INGRESS MAC ADDRESS FILTERING FUNCTION\nWhen a packet is received, the destination MAC address is looked up in both the stat ic and dynamic MAC address\ntables. If the address is not found in ei ther of these tables, then  the destination MAC address is “unknown”. By default,\nan unknown packet is forwarded to all ports except the port at which it was received. An optional feature makes it pos-\nsible to specify the port or ports to which to forward unk nown packets. It is also possible to specify no ports, meaning\nthat unknown packets will be discarded. This feature is im plemented separately for unknown unicast, unknown multicast\nand unknown VID packets. \n4.4.15 802.1X ACCESS CONTROL\nIEEE 802.1X is a Port-based authenticat ion protocol. EAPOL is the protocol norm ally used by the authentication pro-\ncess as uncontrolled Port. By receivi ng and extracting special EAPOL frames, the host processor can control whether\nthe ingress and egress ports should forward packets or not. If  a user port wants service from another port (authentica-\ntor), it must get appro ved by the authentic ator. The device detects EAPOL frames by  checking the de stination address\nof the frame. The destination addresse s should be either a multicast addre ss as defined in IEEE 802.1x (01-80-C2-00-\n00-03) or an address used in the programmable reserved mu lticast address domain with offset -00-03. Once EAPOL\nframes are detected, the frames are forw arded to the host port so it can send t he frames to the authenticator server.\nEventually, the CPU determines whether th e requester is qualified or not based on its source MAC address, and frames\nare either accepted or dropped.\nWhen the device is configured as an au thenticator, the ports of the switch mu st then be configured for authorization. In\nan authenticator-initiated port au thorization, a client is powered up or plug s into the port, and the authenticator port\nsends an Extensible Authenticat ion Protocol (EAP) PDU to t he supplicant requesting the ident ification of the supplicant.\nAt this point in the process, the port on the switch is conn ected from a physical standpoint ; however, the 802.1X process\nhas not authorized the port and no frames are passed from th e port on the supplicant into the switching fabric. If the\nsupplicant attached to the switch (KSZ 9896C) did not understand the EAP PDU that  it was receiving from the switch, it\nwould not be able to send an ID and the port would remain unauthorized. In this state, the port would be blocked from\npassing any user traffic. If the supplicant is running the 802.1X EAP, it would respond to the request with its configured\nID. (This could be a user name/passw ord combination or  a certificate.)\nAfter the device receives the ID from the supplicant, it passe s the ID information to an authentication server (RADIUS\nserver) that can verify the id entification information. The RADIUS server responds to the switch with either a success\nor failure message. If the response is a success, the port  will be authorized and user traffic will be allowed to pass\nthrough the port like any switch  port connected to an access device. If th e response is a failure, the port will remain\nunauthorized and, ther efore, unused. If there is no response from the server, the port will also remain unauthorized and\nwill not pass any traffic.\nPort control can be performed via the Access Control List (ACL) Filtering  feature.\n4.4.16 ACCESS CONTROL LI ST (ACL) FILTERING\nAn Access Control List (ACL) can be created for each port to  perform filtering on incoming layer 2 MAC, layer 3 IP or\nlayer 4 TCP/UDP packets. Multicast filter ing is handled in the Static Address Table and the Reserved Multicast Address\nTable, but the ACL provides additional capabilities for filtering routed network protocols. As shown in Figure 4-3 , ACL\nfiltering may take precedence ov er other forwarding functions.\nThe ACL allows the switch to filter ingress traffic based on the following header fields:• Source or destination MAC address and/or EtherType\n• Source or destination IPv4 address with programmable mask\n• IPv4 protocol• Source or destination UDP port• Source or destination TCP port \n• TCP Flag with programmable mask\nKSZ9896C\nDS00002390A-page 42 \uf0e3 2017 Microchip Technology Inc.The ACL is implemented as an ordered list of up to 16 a ccess control rules which are programmed into the ACL Table.\nEach entry specifies certain rules (a set of matching condi tions and action rules) to control the forwarding and priority\nof packets. When a packet is received on an interface, the switch compares the fields in the packet against any applied\nACLs to verify that the packet has the permissions required to be forwarded, based on the conditions specified in the\nlists. Multiple match conditions can be either AND\'ed or OR\'ed together.\nThe ACL can also implement a count func tion that generates an in terrupt rather than a forwarding action. The counter\ncan be either a watchdog timer or an event counter. As a watchdog timer, an interrupt is generated if a packet with a\nspecific MAC address and EtherType is not  received within a specified time in terval. As an event counter, an interrupt\nis generated once a specified number of packets with a sp ecific MAC address and EtherType have been received.\nThe ACL consists of three parts: matching rules, action ru les, and processing entries. A matching rule specifies what\ncomparison test shall be performed on the incoming packet. It  can also enable a counter function. An action rule spec-\nifies the forwarding action to be taken if the matching test succeeds. Alternatively, when a count function is enabled in\na matching rule, the 11-bit count value is stored in the corre sponding action rule field and there is no forwarding action.\nIn general, the 16 matching rules are not directly linked to  the 16 action rules. For example, matching entry #0 is not\nnecessarily related to action entry #0. The exception is w hen the counter function is enabled in a matching rule, whereby\nthe matching rule and action rule fields at the same ACL table entry will function together  and are no longer independent.\nEach of the 16 processing entries is used to link any numbe r of matching rules (specified in RuleSet) to any one action\nrule (specified in FRN). When there are multiple matching rules in a RuleSet, those rules are AND\'ed together. Only if\nall of those matching results are true will the FRN action be taken.\nIt is also possible to configure the ACL table so that multiple processing entries specify the same action rule. In this way,\nthe final matching result is the OR of the matc hing results from each of the multiple RuleSets.\nThe 16 ACL rules represent an ordered list, with entry #0 having the highest priority and entry #15 having the lowest\npriority. All matching rules are evaluated. If there are multip le true match results and multiple corresponding actions, the\nhighest priority (lowest numbered) of those actions will be the one taken.\n4.4.16.1 Processing Entry Description\nThe Processing Entry consists of two parameters as described in Table 4-13 .\nTABLE 4-13: ACL PROCESSING ENTRY PARAMETERS\nParameter Description\nFRN[3:0] First Rule Number\nPointer to an Action rule entry. Possible values are 0 to 15. If all Matching rules speci-\nfied in the RuleSet are evaluated true, t hen this is the resulting Action rule.\nRuleSet[15:0] Specifies a set of one or more Matching rule entries.\nRuleSet has one bit for each of the 16 Matching rule entries. If multiple Matching rules \nare selected, then all conditions will be AND\'ed to produce a final match result.\n0 = Matching rule not selected\n1 = Matching rule selected\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 43KSZ9896C\nThe examples in Figure 4-6  are interpreted as follows:\n• Rule #0: Test the matching rule entry #0.  If true, apply action rule entry #0.\n• Rule #1: Test the matching rule entry #1.  If true, apply action rule entry #0.\n• Rule #2: Test the matching rule entry #2.  If true, apply action rule entry #1.\n• Matching rule entry #3 is configured for the counter function. Action entry #3  is used to hold the corresponding \ncount value.\n• Rule #4: Test the matching rule entries #4, 5 and 6. If all are true, apply action rule entry #4.• Rule #6: Test the matching rule entry #6.  If true, apply action rule entry #5.\n• Rule #8: Test the matching rule entries #7 and 11 . If both are true, apply action rule entry #9.\nNo more than one action can be taken for any packet. If the ma tching conditions are true for multiple RuleSets, then the\ncorresponding FRN field with the lowest value (highest priority) determines the action to be taken.\nNote that processing entries #0 and 1 produce an OR function: action #0 is taken if RuleSet #0 or RuleSet #1 is true.Notice that processing entries #4 and 6 have overlapping RuleSets, but different FRNs. This can be summarized as:\nIf match #4, 5 and 6 are all true, then apply action #4,Else if match #6 is true , then apply action #5.FIGURE 4-6: ACL STRUCTURE AND EXAMPLE RULE VALUES\nFRN\n0\n0\n1\n4\n5\n9#0\n#15#14#13#12#11#10#9#8#7#6#5#4#3#2#10\n1\n2\nnone\n4, 5, 6\nnone\n6\nnone\n7, 11\nnone\nnone\nnone\nnone\nnone\nnone\nnoneRuleSetProcessing Field\nEntry Number\nEntry #0\nEntry #1\nEntry #2\nEntry #3\nEntry #4\nEntry #5\nEntry #6\nEntry #7\nEntry #8\nEntry #9\nEntry #10\nEntry #11\nEntry #12\nEntry #13\nEntry #14\nEntry #15Entry #0\nEntry #1\nEntry #2\nEntry #3\nEntry #4\nEntry #5\nEntry #6\nEntry #7\nEntry #8\nEntry #9\nEntry #10\nEntry #11\nEntry #12\nEntry #13\nEntry #14\nEntry #15Action Rule Matching Rule\nAction FieldOR\nANDWhen counter \nfunction is enabled \nin Matching Rule.\nKSZ9896C\nDS00002390A-page 44 \uf0e3 2017 Microchip Technology Inc.Table 4-14  summarizes the available matching options. The MD and ENB fields are used to select the desired matching\noption. More configuration details are given in the following section.\n4.4.16.2 Matching Rule Description\nThe Matching Rule consists of several parameters. The first two parameters, MD[1:0] and ENB[1:0], determine the orga-\nnization of the remainder of each Matching Rule.\nWhen MD = 00, the Matching Rule is disabled.\nDetails for MD = 01, ENB = 00:\nThe 11 bits of the aggregated bit fields from PM, P, RPE, RP and MM in the Action rule entry specify a count value for\npackets matching MAC Ad dress and TYPE in the Matching Field. TABLE 4-14: MATCHING RULE OPTIONS\nMD[1:0] ENB[1:0] Matching Rule\n00 XX Matching rule disabled\n01\n(Layer 2 matching: \nMAC address, \nEtherType)00 Action field is used as count value for packets matching MAC address and \nEtherType\n01 Compare MAC address only10 Compare EtherType only\n11 Compare both MAC address and EtherType\n10\n(Layer 3 matching: \nIP address)00 Reserved\n01 Compare IPv4 source and destination address (with mask)\n10 Compare both source and destinat ion IPv4 addresses (without mask)\n11 Reserved\n11\n(Layer 4 matching: \nTCP, UDP, \nIP protocol)00 Compare IPv4 protocol\n01 Compare TCP source port or destination port\n10 Compare UDP source port or destination port\n11 Compare TCP sequence number\nTABLE 4-15: ACL MATCHING RULE PARAMETERS FOR MD = 01\nParameter Description\nMD[1:0] MODE\n00 = Matching rule is disabled\n01 = Layer 2 MAC header or counter filtering\n10 = Layer 3 IP header filtering11 = Layer 4 TCP header (and IP protocol) filtering \nENB[1:0] 00 = Count Mode. Both the MAC Addre ss and TYPE are tested. A count value (either \ntime or packet count) is also incorporated. Details are given below this table.01 = Comparison is performed only on the MAC Address value\n10 = Comparison is performed only on the TYPE value\n11 = Both the MAC Address and TYPE are tested\nS/D Source / Destination\n0 = Destination address\n1 = Source address\nEQ Equal / Not Equal\n0 = Not Equal produces true result\n1 = Equal produces true result\nMAC ADDRESS[47:0] 48-bit MAC address\nTYPE[15:0] EtherType\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 45KSZ9896C\nThe count unit is determined by the TU  bit (located in the Action rule). \n• When 0, the unit is microsecond.\n• When 1, the unit is millisecond.\nThe CA bit (located in the Action rule) determines the algor ithm used to generate an interr upt when the count terminates.\n• When 0, an 11-bit counter will be loaded with the count val ue from the list and start counting down every unit time. \nAn interrupt will be generated when the timer expires, i. e. the next qualified packet has not been received within \nthe period specified by the value.\n• When 1, the counter is incremented with every matched packet received. An interrupt is generated when the ter-\nminal count is reached. The count resets therea fter. Time units are not used in this mode.\nTABLE 4-16: ACL MATCHING RULE PARAMETERS FOR MD = 10\nParameter Description\nMD[1:0] MODE\n00 = Matching rule is disabled\n01 = Layer 2 MAC header or counter filtering\n10 = Layer 3 IP header filtering11 = Layer 4 TCP header (and IP protocol) filtering \nENB[1:0] 00 = Reserved\n01 = IPv4 source or destination address (with mask)10 = IPv4 source and destination address (without mask)\n11 = Reserved\nS/D Source / Destination\n0 = Destination address\n1 = Source address\nEQ Equal / Not Equal\n0 = Not Equal produces true result\n1 = Equal produces true result\nIP ADDRESS[31:0] IPv4 address\nSource or destination address (determined by S/D) when ENB = 01, \nSource address when ENB = 10\nIP MASK[31:0] Mask bits for the IPv4 address when ENB = 01:\n0 = This bit of the address is compared\n1 = This bit of the address is not compared\nDestination IPv4 address when ENB = 10\nTABLE 4-17: ACL MATCHING RULE PARAMETERS FOR MD = 11\nParameter Description\nMD[1:0] MODE\n00 = Matching rule is disabled\n01 = Layer 2 MAC header or counter filtering10 = Layer 3 IP header filtering\n11 = Layer 4 TCP header (and IP protocol) filtering \nENB[1:0] 00 = IP Protocol comparison is enabled\n01 = TCP source/destination port comparison is enabled\n10 = UDP source/destination port comparison is enabled\n11 = TCP sequence number is compared\nS/D Source / Destination\n0 = Destination address1 = Source address\nEQ Equal / Not Equal\n0 = Not Equal produces true result1 = Equal produces true result\nKSZ9896C\nDS00002390A-page 46 \uf0e3 2017 Microchip Technology Inc.4.4.16.3 Action Rule DescriptionMAX PORT[15:0]\nMIN PORT[15:0]Max and Min Ports for TCP/UDP\norTCP Sequence Number[31:0]\nPC[1:0] Port Comparison\n00 = Port comparison is disabled\n01 = Port matches either one of MAX or MIN\n10 = Match if port number is in the range of MIN to MIN\n11 = Match if port number is out of the range\nPRO[7:0] IPv4 protocol to be matched\nFME TCP Flag Match Enable\n0 = TCP FLAG matching disabled\n1 = TCP FLAG matching enabled\nFMASK[7:0] TCP FLAG Mask\n0 = This bit of the Flag field is compared\n1 = This bit of the Flag field is not compared\nFLAG[7:0] TCP Flag to be matched\nTABLE 4-18: ACL ACTION RULE PARAMETERS FOR NON-COUNT MODES (MD ≠ 01 OR ENB ≠ \n00)\nParameter Description\nPM[1:0] Priority Mode\n00 = ACL does not specify the packet priori ty. Priority is determined by standard QoS \nfunctions.\n01 = Change packet priority to P[2:0] if it is greater than QoS result.10 = Change packet priority to P[2:0] if it is smaller than the QoS result.\n11 = Always change packet priority to P[2:0].\nP[2:0] Priority valueRPE Remark Priority Enable\n0 = Disable priority remarking\n1 = Enable priority remarking. VLAN tag pr iority (PCP) bits are replaced by RP[2:0].\nRP[2:0] Remarked Priority value\nMM[1:0] Map Mode\n00 = No forwarding remapping01 = The forwarding map in FORWARD is OR\'ed with the forwarding map from the \nAddress Lookup Table.\n10 = The forwarding map in FORWARD is AND\'ed with the forwarding map from the \nAddress Lookup Table.\n11 = The forwarding map in FORWARD repl aces the forwarding map from the Address \nLookup Table.\nFORWARD[N-1:0] Forwarding Ports\nBit 0 corresponds to port 1\nBit 1 corresponds to port 2, etc.\n0 = Do not forward to this port\n1 = Forward to this portTABLE 4-17: ACL MATCHING RULE PARAMETERS FOR MD = 11 (CONTINUED)\nParameter Description\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 47KSZ9896C\nFigure 4-7  shows basic organization of the ACL Table. The table has 16 entries, and each entry includes a matching\nfield, action field and process field. Although these fields are st ored together in one table, it is important to note that for\na given table entry, the Matching, Action and Process fiel ds generally do not form an associated group. The one excep-\ntion is when the Matching Rule is in Count Mode (MD = 01 and ENB = 00). In that case, the Matching and Action fieldsare used in tandem. \n4.4.16.4 ACL Interrupts\nThe ACL filtering functions do not generate interrupts. Interrupts apply on ly for the Count Mode (MD = 01, ENB = 00).\nThe Matching Rule can be configured either to timeout if t he interval between packets of a specific type (MAC address\nand EtherType), or when a set number of these packets are re ceived. There is a separate interrupt for each port. Port\nspecific interrupt status and masks are located in the Port Interrupt Status Register  and Port Interrupt Mask Register .\nThe top level interrupt registers for each port are in the Global Port Interrupt Status Register  and Global Port Interrupt\nMask Register .TABLE 4-19: ACL ACTION RULE PARAMETERS FOR COUNT MODE (MD = 01 OR ENB = 00)\nParameter Description\nCOUNT[10:0] Count value\nTU Time unit for counter. \n0 = Microseconds\n1 = Milliseconds\nCA Counter Algorithm. \n0 = An 11-bit counter will be loaded with the count value from the list and start counting \ndown every unit time. An interrupt will be g enerated when the timer expires, i.e. the \nnext qualified packet has not been received within the period specified by the value.\n1 = The counter is incremented with every matched packet received. An interrupt is \ngenerated when the terminal count is reached.  The count resets thereafter. Time units \nare not used in this mode.\nFIGURE 4-7: ACL TABLE FORMAT\nF\nRNMD \n[1:0]ENB \n[1:0]S\n/\nDEQMAC ADDRESS [47:0] TYPE [15:0]\nF\nRNMD \n[1:0]ENB \n[1:0]S\n/\nDEQIP ADDRESS [31:0] IP MASK [31:0]\nF\nR\nNMD \n[1:0]ENB \n[1:0]S\n/\nDE\nQMAX \nPORT \n[15:0]MIN \nPORT \n[15:0]Resvd \n(5)PC \n[1:0]PRO \n[7:0]F\nM\nEFMSK \n[7:0]FLAG \n[7:0]PM \n[1:0]\nPM \n[1:0]\nPM \n[1:0]P \n[2:0]P \n[2:0]P \n[2:0]R\nPE\nR\nPE\nR\nP\nERP \n[2:0]\nRP \n[2:0]\nRP \n[2:0]MM \n[1:0]\nMM \n[1:0]\nMM \n[1:0]FORWARD \n[# ports]\nFORWARD \n[# ports]\nFORWARD \n[# ports]RULESET \n[15:0]\nRULESET \n[15:0]\nRULESET \n[15:0]\nMATCHING Rule ACTION Rule PROCESS \nFieldPROCESS \nFieldMD = 01ENB = 00\nMD = 10\nMD = 11F\nRNMD \n[1:0]ENB \n[1:0]S\n/\nDEQMAC ADDRESS [47:0] TYPE [15:0]COUNT[10:0] TU\nRULESET \n[15:0]MD = 01\nENB != 00CAunu\nsed\nKSZ9896C\nDS00002390A-page 48 \uf0e3 2017 Microchip Technology Inc.4.4.16.5 ACL Registers\nTable 4-20  provides a list of ACL related registers.\n4.5 NAND Tree Support\nThe KSZ9896C provides parametric NAND tree support for f ault detection between chip I/Os and board. The NAND tree\nis a chain of nested NAND gates in which each KSZ9896C digital I/O (NAND tree input) pin is an input to one NANDgate along the chain. At th e end of the chain, the INTRP_N  pin provides the output for the last NAND gate.\nThe NAND tree test process includes:• Enabling NAND tree mode\n• Pulling all NAND tree input pins high• Driving low each NAND tree input pin sequentially per the NAND tree pin order, starting with the first row of \nTable 4-21 .\n• Checking the NAND tree output to ensure there is a to ggle high-to-low or low-to-high for each NAND tree input \ndriven low.\n TABLE 4-20: ACL REGISTERS\nRegisters Description\nPort Interrupt Status Register ,\nPort Interrupt Mask RegisterACL interrupt\nPort ACL Access 0 Register  through \nPort ACL Access F Register , \nPort ACL Byte Enable MSB Register , \nPort ACL Byte Enable LSB Register , \nPort ACL Access Control 0 RegisterACL Table access\nPort Priority Control Register Priority classification\nPort Authentication Control Register ACL enable\nTABLE 4-21: NAND TREE TEST PIN ORDER\nNAND Tree Sequence Pin Number Pin Name NAND Tree Description\n15 2 TXD6_7 Input\n25 3 TXD6_6 Input\n35 4 TXD6_5 Input\n45 5 TXD6_4 Input\n55 8 RXD6_7 Input\n65 9 RXD6_6 Input\n76 0 RXD6_5 Input\n86 2 RXD6_4 Input\n96 3 TXCLK6/REFCLKI6 Input\n10 64 TX_EN6/TXCTL6 Input\n11 65 TX_ER6 Input\n12 66 COL6 Input\n13 67 TXD6_3 Input\n14 68 TXD6_2 Input\n15 69 TXD6_1 Input\n16 70 TXD6_0 Input\n17 72 RX_CLK6/REFCLKO6 Input\n18 73 RX_DV6/CRS_DV6/RX_CTL6 Input\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 49KSZ9896C\nThe following procedure can be used to check for faults on the KSZ9896C digital I/O pin connections to the board:\n1. Enable NAND tree mode via the LED2_1 , LED2_0 , and LED4_0  configuration strap pins option.\n2. Use board logic to drive all KSZ9896C NAND tree input pins high and verify that the INTRP_N  pin output is high.\n3. Use board logic to drive each NAND tree input pin, per the NAND Tree pin order, as follows:\na) Toggle the first pin in the NAND tree sequence ( TXD6_7 ) from high to low, and verify the INTRP_N  pin\nswitches from high to low to indicate that the first pin is connected properly.\nb) Leave the first pin ( TXD6_7 ) low.\nc) Toggle the second pin in the NAND tree sequence ( TXD6_6 ) from high to low, and verify the INTRP_N  pin\nswitches from low to high to indicate that the second pin is  connected properly.\nd) Leave the first pin ( TXD6_7 ) and the second pin ( TXD6_6 ) low.\ne) Toggle the third pin in the NAND tree sequence ( TXD6_5 ) from high to low, and verify the INTRP_N  pin\nswitches from high to low to indicate that the third pin is connected properly.\nf) Continue with this sequence until all KSZ9896C NAND tree input pins have been toggled.\nEach KSZ9896C NAND tree input pin must cause the INTRP_N  output pin to toggle high-to-low or low-to-high to indi-\ncate a good connection. If the INTRP_N  pin fails to toggle when the KSZ9896C input pin toggles from high to low, the\ninput pin has a fault.19 75 RX_ER6/RX_CLK6 Input\n20 76 CRS6 Input\n21 77 RXD6_3 Input\n22 78 RXD6_2 Input\n23 79 RXD6_1 Input\n24 80 RXD6_0 Input\n25 82 LED4_0 Input\n26 83 LED4_1 Input\n27 85 LED3_0 Input\n28 86 LED3_1 Input\n29 87 NC Input\n30 88 NC Input\n31 89 LED2_0 Input\n32 90 LED2_1 Input\n33 91 PME_N Input\n34 94 CLKO_25_125 Input\n35 96 SDO Input\n36 97 SDI/SDA/MDIO Input\n37 99 SCS_N Input\n38 100 SCL/MDC Input\n39 102 LED5_0 Input\n40 103 LED5_1 Input\n41 105 LED1_0 Input\n42 106 LED1_1 Input\n43 92 INTRP_N OutputTABLE 4-21: NAND TREE TEST PIN ORDER (CONTINUED)\nNAND Tree Sequence Pin Number Pin Name NAND Tree Description\nKSZ9896C\nDS00002390A-page 50 \uf0e3 2017 Microchip Technology Inc.4.6 Clocking\n4.6.1 PRIMARY CLOCK\nThe device requires a 25MHz reference clock input at the XI pin. This clock is internally multiplied up and used to clock\nall of the internal logic and switching functions. It is also normally used as to clock the PHY transmit paths. This clock\nmay be supplied by connecting a crystal between the XI and XO pins (and appropriate load capacitors to ground). Alter-\nnatively, an external CMOS clock signal may drive XI, while XO is left unconnected. The XI/XO block is powered from\nA VDDH .\n4.6.2 PORT 6 RGMII/MII/RMII CLOCKS\nThe MII interface is clocked asymmetrica lly, with the PHY device driving both the RX_CLK6  receive clock and the TX_-\nCLK6  transmit clock to the MAC device. The MII port may be conf igured at reset by a strapping option to take the role\nof either the PHY or the MAC. RX_CLK6  and TX_CLK6  are therefore either both in puts or both outputs, depending on\nthe MII mode.\nThe RMII interface uses a single 50MHz clock. This REFCLK may be sourced ei ther from the KSZ9896C or from the\nconnected device. A strapping option is used to select t he mode. “Normal Mode” is the mode where the other device\nsupplies the clock, and the clock is an input to the REFCLKI6  pin of the device. “Clock Mode” is the mode where the\nKSZ9896C generates the 50MHz clock on the REFCLKO6  pin.\nThe RGMII interface employs source synchronous clocking, so  it is symmetrical and does not require a mode selection.\nAn output clock is generated on the RX_CLK6  pin, while an input clock is received on the TX_CLK6  pin. The clock\nspeed scales with the interface data rate - either 10, 100  or 1000 Mbps. A strapping option is used to select between\nthe 100 and 1000 Mbps speeds. If the 10 Mbps rate is requ ired, then a register settin g is used to set that speed.\nThe Port 6 MAC interface is powered from VDDIO .\n4.6.3 SERIAL MANAGEMENT INTERFACE CLOCK\nWhether configured to be SPI, I2C or MIIM, the KSZ9896C is always a slave and receives the clock as an input. The\nserial management interface is powered from VDDIO .\n4.6.4 CLKO_25_125\nAn output clock, derived from the local 25MHz reference at XI, is provided on the CLKO_25_125  pin. The output fre-\nquency choices are 25MHz (default) and 125MHz. If not  needed, this output clock can also be disabled. CLKO_25_125\nis controlled via the Output Clock Control Register , and is powered from VDDIO .Note: Refer to Section 3.2.1, "Configuration Straps," on page 17  for additional information on using configuration\nstraps. \n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 51KSZ9896C\n4.7 Power\nThe KSZ9896C requires two to three supply voltages. The device core operates from a 1.2V supply ( DVDDL  and\nA VDDL ). The PHY transceivers and XI/XO crystal/c lock interface operate from a 2.5V supply ( AV D D H ). The digital I/\nO\'s can be operated from 1.8V, 2.5V or 3.3V ( VDDIO ). The digital I/Os powered from VDDIO  include RGMII, RMII, MII,\nSPI, I2C, MIIM, LED, RESET_N , PME_N , INTRP_N  and CLKO_25_125 . An example power connection diagram can be\nseen in Figure 4-8 . \n4.8 Power Management\nThe device supports enhanced power manag ement features in a low-power state with energy detection to ensure low-\npower dissipation during device idle periods. There are three operation modes under the power management function\nwhich are implemented globally (i.e., applying to all ports):\n• Normal Operation Mode\n• Energy Detect Mode• Global Soft Power Down Mode\nTable 4-22  summarizes all internal function blocks status under the three power-management operation modes.FIGURE 4-8: POWER CONNECTION DIAGRAM\nTABLE 4-22: MDI/MDI-X PIN DEFINITIONS\nFunctional BlocksPower Management Operation Modes\nNormal Mode Energy Detect Mode Soft Power Down Mode\nInternal PLL Clock Enabled Disabled Disabled\nTX/RX PHYs Enabled Energy Detect at RX Disabled0.1µF22µF0.1µF\nVDDIO\nVDDIO\nVDDIOAVDDH\nAVDDHAVDDH\nAVDDH\nAVDDH\nAVDDH\nAVDDH\nDVDDL\nAVDDLAVDDL\nAVDDL\nAVDDL\nAVDDL\nAVDDL\nAVDDL\nAVDDL\nAVDDLDVDDL\nDVDDL\nDVDDL\nDVDDL\nDVDDL\nDVDDLDVDDL\nGNDGND\nGND\nGND\nGND\nGND\nGND\n(exposed pad )+1.8V, 2.5V or 3.3V+2.5V +1.2V\n0.1µF\n0.1µF\n0.1µF\n0.1µF0.1µF0.1µF\n0.1µF\n0.1µF\n0.1µF\n0.1µF22µF\n0.1µF\n0.1µF\n0.1µF\n0.1µF\n0.1µF0.1µF\n0.1µF22µF\n0.1µF\n0.1µF\n0.1µF0.1µF0.1µF\n0.1µF\n0.1µF0.1µF10µF\nGND\nGND0.1µFDVDDL\nVDDIO0.1µF\nKSZ9896C\nDS00002390A-page 52 \uf0e3 2017 Microchip Technology Inc.There is one additional power saving mode t hat may be implemented on a per-port basis:\n• Port-Based Power DownThe first three global power modes are mutually exclusive; only one mode may be selected at a time. Port-based power\ndown may be enabled independent of the global power mode. \n4.8.1 NORMAL OPERATION MODE\nAt power-up, the device enters into Normal operation mode . It is also selected via bits [4:3] = 00 in the Power Down\nControl 0 Register . When the device is in normal operation mode, al l PLL clocks are running, PHYs and MACs are on,\nand the CPU is ready to read or write the device registers through the serial interface (SPI, I2C or MIIM). \nDuring normal operation mode, t he host processor can change the power management mode bits in the Power Down\nControl 0 Register  to transition to any of the other power management modes.\n4.8.2 ENERGY-DETECT MODE\nEnergy-detect mode, also known as energy-detect power down (EDPD) mode, is enabled by setting bits [4:3] to 01 in\nthe Power Down Control 0 Register . Energy-detect mode provides a mechanism to save power when the device is not\nconnected to an active link partner. Auto-negotia tion must be enabled when in energy-detect mode.\nEnergy-detect mode consists of two states, normal-power st ate and low-power state. When the device is in this mode,\nit will monitor the cable energy. If there is no energy on the ca ble for a time longer than a pre-configured value, the device\nwill go into the low-power state. While in low-power state,  the device reduces power consumption by disabling all cir-\ncuitry except the energy-detect circuitry of the receiver, which consumes minimal power. When the device is in the low-\npower state, it will transmit link pulses at long intervals, wit h a very low duty cycle. At the same time, it continuously\nmonitors for energy on the cable. Once energy is detected from the cable and is present for a time longer than 100ns,\nthe device will enter the normal-power state.\n4.8.3 GLOBAL SOFT POWER-DOWN MODE\nSoft power-down mode is used to power down the device when it is not in use after power-up. This mode disables all\ninternal functions except for the serial (SPI or I2C) management interface.\nWhen soft power-down mode is exited, all registers are reset to their default values, and al l configuration strap pins are\nsampled to set the device settings.\n4.8.4 PORT-BASED POWER DOWN\nUnused ports may be powered down individually to save power.\n4.8.5 WAKE ON LAN (WOL)\nWake on LAN allows a computer to be turned on or wok en up by a network message. The message is usually sent by\na program executed on another computer on the same local area network. Wake-up frame events are used to awaken\nthe system whenever meaningful data is  presented to the system over the network. Examples of  meaningful data\ninclude the reception of a Magic Packet, a management reques t from a remote administrator, or simply network traffic\ndirectly targeted to the lo cal system. The device can be prog rammed to notify the host of  the Wake-Up frame detection\nwith the assertion of the power management event signal ( PME_N ).\nThe device’s MACs support the detect ion of the following Wake-Up events:\n• Detection of energy signal over a pre-configured value\n• Detection of a linkup in the network link state• Receipt of a Magic Packet \nThere are also other types of Wake-Up ev ents that are not listed here as manu facturers may choose to implement these\nin their own way.MACs Enabled Disabled Disabled\nHost Interface Enabled Disabled DisabledTABLE 4-22: MDI/MDI-X PIN DEFINITIONS (CONTINUED)\nFunctional BlocksPower Management Operation Modes\nNormal Mode Energy Detect Mode Soft Power Down Mode\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 53KSZ9896C\n4.8.5.1 Direction of Energy\nThe energy is detected from the cable and is continuously presented for a time  longer than pre-configured value, espe-\ncially when this energy change  may impact the level at which the system should re-enter to the normal power state.\n4.8.5.2 Direction of Link-up\nLink status wake events are useful to indicate a linkup in the network\'s connectivity status.\n4.8.5.3 Magic PacketTM\nThe Magic Packet is a broadcast frame containing anywhere within its payload 6 bytes of all 1s (FF FF FF FF FF FF)\nfollowed by sixteen repetitions of the target computer\'s 48-b it DA MAC address. Since the magic packet is only scanned\nfor the above string, and not actually pars ed by a full protocol stack, it may be sent as any network- and transport-layer\nprotocol.\nMagic Packet technology is used to remotely wake up a sleeping or powered-off PC on a LAN. This is accomplished by\nsending a specific packet of information, called a Magic Packe t frame, to a node on the network. When a PC capable\nof receiving the specific fram e goes to sleep, it enables the Magic Packet RX mode in the LAN controller, and when the\nLAN controller receives a Magic Packet frame, it will alert the system to wake up. Once the device has been enabled\nfor Magic Packet Detection, it scans al l incoming frames addressed to the node for a specific data sequence, which\nindicates to the controller this is a Magic Packet frame.\nA Magic Packet frame must also meet the basic requiremen ts for the LAN technology chos en, such as Source Address\n(SA), Destination Address (DA), which may be the receiving station\'s IEEE MAC address, or a multicast or broadcast\naddress and CRC. The specific sequence consists of 16 dupl ications of the MAC address of  this node, with no breaks\nor interruptions. This sequence can be located anywhere within the packet, but must be preceded by a synchronization\nstream. The synchronization stream is defined as 6 bytes of 0xFF. The device will also accept a broadcast frame, as\nlong as the 16 duplications of the IEEE address match the address of the machine to be awakened.\n4.8.5.4 Interrupt Generation on Power Management Related Events\nThere are two ways an interrupt can be generated to the ho st whenever a power management  related event takes place.\nThe resulting interrupts are via the PME_N  signal pin or via the INTRP_N  signal pin.\n4.9 Management Interface\nThe management interface may be used by an external host processor to read and write the device’s registers. This\ninterface has three available modes of operation: SPI, I2C or MIIM. The interface mode is selected at the deassertion\nof reset by a strapping option (refer to Section 3.2.1, "Configuration Straps," on page 17  for additional information).\nOf the three interface options, SPI provid es the highest performance, while MIIM performance is the lowest. Most impor-\ntantly, MIIM provides access to the PHY control and status re gisters, but not to any of t he switch registers. The vast\nmajority of applications therefore can use SPI or I2C, but not MIIM.\nRegister access is also available through the high-perf ormance in-band management interface as described in Section\n4.10, "In-Band Management," on page 57 . \n4.9.1 SPI SLAVE BUS\nThe KSZ9896C supports a slave mode SPI in terface that provides complete access to all device registers via an SPI\nmaster device. The SPI master device supplies the clock ( SCL), select ( SCS_N ), and serial input data ( SDI). Serial out-\nput data ( SDO) is driven by the KSZ9896C. \nSCL is expected to stay low when SPI operation is idle. SPI operations start with the falling edge of SCS_N  and end with\nthe rising edge of SCS_N . A single read or write access consists of a 27-bit command/address phase, then a 5-bit turn-\naround (TA) phase, then an 8-bit data phase. For burst read or write access, SCS_N  is held low while SCL continues to\ntoggle. For every 8 cycles of SCL, the device will increment the address counter, and the corresponding data byte will\nbe transferred on SDI or SDO in succession.\nAll commands, addresses and data are transferred most significant bit first. Input data on SDI is latched on the rising\nedge of clock SCL. Output data on SDO is clocked on the falling edge of SCL.\nAs shown in Figure 4-23 , there are two commands: regist er read and register write. Figure 4-9  and Figure 4-10  show\nthe timing for these two operations.\nKSZ9896C\nDS00002390A-page 54 \uf0e3 2017 Microchip Technology Inc.Note 4-8 TA bits are turn-around bits. They are “don\'t care” bits.\n4.9.2 I2C BUS\nThe management interface may be configured to be an I2C slave. In this mode, an I2C master has complete program-\nming access to the device\'s internal control and status regi sters, including all MIB counters, address lookup tables,\nVLAN table and ACL table.\nThe 7-bit device address is fixed as 1011_111. Because of the fixed address, only one KSZ9896C may be on the I2C\nbus at a time. The R/W control bit is then appended as the le ast significant bit to form thes e 8-bit address/control words:\n1011_1110 <write>1011_1111 <read>TABLE 4-23: REGISTER ACCESS USING THE SPI INTERFACE\nSPI OperationCommand/Address Phase (SDI pin)TA bits\n(Note 4-8 )Data Phase \n(SDO or SDI pins)Command Register Address\nRegister Read 011 A23 A22 A21 A20 … A7 A6 A5 A4  A3 A2 A1 A0 XXXXX D7 D6 D5 D4 D3 D2 D1 D0\nRegister Write 010 A23 A22 A21 A20 … A7 A6 A5 A4  A3 A2 A1 A0 XXXXX D7 D6 D5 D4 D3 D2 D1 D0\nNote: The actual device address space is 16 bits (A15 - A0), so the values of address bits A23 - A16 in the SPI\ncommand/address phase are “don\'t care”.\nFIGURE 4-9: SPI REGISTER READ OPERATION\nFIGURE 4-10: SPI REGISTER WRITE OPERATIONSCS_N\nSCL\nSDI\n (MOSI)\nSDO\n (MISO)\nRead\nCommandRead Address TurnAroundD0D1D2D3D4D5D6D7TA TA TA TA TA A1 A0 A2 A3 A4 A5 A6 A7 A9 A10 A11 A8 A12 A13 A14 A15 A17 A16 A18 01 1 A20 A19 A22 A21 A23123456789 1 0 1 1 1 2 1 3 1 4 1 5 1 6 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40\nRead Data\nSCS_N\nSCL\nSDI\n (MOSI)\nSDO\n (MISO)\nWrite\nCommandWrite Address Write Data TurnAround123456789 1 0 1 1 1 2 1 3 1 4 1 5 1 6 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40\nD0D1D2D3D4D5D6D7 TA TA TA TA TA A1 A0 A2 A3 A4 A5 A6 A7 A9 A10 A11 A8 A12 A13 A14 A15 A17 A16 A18 00 1 A20 A19 A22 A21 A23\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 55KSZ9896C\nThe internal registers and tables  of the device are accessed using 16-bit addr essing and 8-bit data. The access formats\nare as follows:\n4.9.3 MII MANAGEMENT (MIIM) INTERFACE\nThe device supports the IEEE 802.3 MII management inte rface, also known as the management data input/output\n(MDIO) interface. This interface allows upper-layer devi ces to monitor and control the states of the KSZ9896C PHY\nblocks, but it does not provide access to  the switch registers. An external de vice with MDC/MDIO capability can read\nthe PHY status or configure the PHY settings. Details on th e MIIM interface can be found in Clauses 22 and 45 of the\nIEEE 802.3 Specification.\nUse of MIIM conflic ts with use of the In-Band Management  interface. These interfaces cannot be used simultaneously.\nThe MIIM interface consists of the following: • A physical connection that uses a data signal ( MDIO ) and a clock signal ( MDC ) for communication between an \nexternal controller and the KSZ9896C. Note that the MDIO  signal is open-drain.\n• A specific protocol that o perates across the two signal physical connecti on that allows an external controller to \ncommunicate with the internal PHY devices.\n• Access to a set of standard, vendor-specific and exte nded (MMD) 16-bit registers. These registers are also \ndirectly accessible via the SPI and I\n2C interface options.FIGURE 4-11: SINGLE BYTE REGISTER WRITE\nFIGURE 4-12: SINGLE BYTE REGISTER READ\nFIGURE 4-13: BURST REGISTER WRITE\nFIGURE 4-14: BURST REGISTER READ\n\nKSZ9896C\nDS00002390A-page 56 \uf0e3 2017 Microchip Technology Inc.The MIIM Interface can operate up to a maximum clock speed of  5MHz. Access is limited to only the registers in the\nPHY blocks of ports 1 through 5. Table 4-24  summarizes the MII management interface frame format.\nThe MIIM PHY address to PHY port mapping is as follows:\n• PHY Address 1h to PHY port 1\n• PHY Address 2h to PHY port 2\n• PHY Address 3h to PHY port 3• PHY Address 4h to PHY port 4\n• PHY Address 5h to PHY port 5\nThe MIIM register address space consists of two distinct areas. •Standard MIIM Registers (Direct)\n•MDIO Manageable Device (MMD) Registers (Indirect)\n4.9.3.1 Standard MIIM Registers (Direct)\nStandard registers provide direct read/writ e access to a 32-register address space, as defined in Clause 22 of the IEEE\n802.3 Specification. Within this address space, the first 16 registers (Registers 0h to Fh) are defined according to the\nIEEE specification, while the remaining 16 registers (Registers 10h to 1Fh) are defined specific to the PHY vendor.\nThe KSZ9896C supports the standard registers listed in Table 4-25  for each PHY port. Each 16-bit MIIM Standard Reg-\nister Address maps to two corresponding 8-bit Port N Regi ster Addresses. The register  bit map and description are\nlocated at the 8-bit Port N Register Addresses.TABLE 4-24: MII MANAGEMENT INTERFACE FRAME FORMAT\nOperation \nModePreamble \n(32-bit)Start of \nFrame \n(2-bit)Operation \nCode \n(2-bit)PHY \nAddress \n(5-bit)Register \nAddress \n(5-bit)Turn \nAround\n(2-bit)Register \nData\n(16-bit)Idle\nRead All 1s 01 10 A[4:0] Reg[4:0] Z0 D[15:0] Z\nWrite All 1s 01 01 A[4:0] Reg[4:0] 10 D[15:0] Z\nTABLE 4-25: STANDARD MIIM REGISTERS\nMIIM Standard \nRegister Address\n (hex)Port N \nRegister Address\n(hex)Description\nIEEE-Defined Registers\n0h 0xN100 - 0xN101 PHY Basic Control Register\n1h 0xN102 - 0xN103 PHY Basic Status Register\n2h 0xN104 - 0xN105 PHY ID High Register\n3h 0xN106 - 0xN107 PHY ID Low Register\n4h 0xN108 - 0xN109 PHY Auto-Negotiation Advertisement Register\n5h 0xN10A - 0xN10B PHY Auto-Negotiation Link Partner Ability Register\n6h 0xN10C - 0xN10D PHY Auto-Negotiation Expansion Status Register\n7h 0xN10E - 0xN10F PHY Auto-Negotiation Next Page Register\n8h 0xN110 - 0xN111 PHY Auto-Negotiation Link Partner Next Page Ability Register\n9h 0xN112 - 0xN113 PHY 1000BASE-T Control Register\nAh 0xN114 - 0xN115 PHY 1000 BASE-T Status Register\nBh-Ch - RESERVED\nDh 0xN11A - 0xN11B PHY MMD Setup Register\nEh 0xN11C - 0xN11D PHY MMD Data Register\nFh 0xN11E - 0xN11F PHY Extended Status Register\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 57KSZ9896C\n4.9.3.2 MDIO Manageable Device (MMD) Registers (Indirect)\nThe MIIM interface provides indirect access to a set of MMD registers as defined in Section 5.4, "MDIO Manageable\nDevice (MMD) Registers (I ndirect)," on page 167 .\n4.10 In-Band Management\nThe in-band management access (IBA) is a feature that provides full register read and write access via any one of the\nsix data ports. Port 6 is the default IBA port. The in-band fe ature is enabled or disabled by  a strapping option at power-\nup and reset. To use a different port inst ead of port 6 for IBA, the SPI or I2C interface or IBA must be used to write to a\ncontrol register. IBA may not be used  on more than one port at a time.\nIn-band management frames are processe d differently from normal network fram es. They are recognized as special\nframes, so address and VID lookup, VLAN tagging, source addre ss filtering, un-tag discard, tagged frame drop, etc. are\nnot applied to them. Received in-band manag ement frames are never forwarded to the switch fabric or to any other port.\nThe In-Band Management (IBA) Control Register  is used to enable and control the IBA feature and to specify one of the\nsix ports as the IBA port.\nThe IBA frame format is shown in Figure 4-15 . The layer 2 portion of the IBA frame contains normal destination address\n(DA) and source address (SA) fields. Th e DA of the frames are defined to be the switch MAC address (default 00-10-\nA1-FF-FF-FF), and the SA is the MAC address of the source device. The DA and SA will be swapped in the response\nframe. A special 4-byte IBA tag follows the SA. This is then followed by the 2-byte EtherType/Length field that serves to\nidentify this as an IBA frame.\nOnly one IBA frame can be processed at a time. Any s ubsequent IBA frames received by the device will be dropped\nunless the most recent response frame has been fully transmitted.\nThere are six types of read/write comm ands: READ, WRITE, WAIT on 0, WAIT on 1, MODIFY to 0 and MODIFY to 1.\nThe burst commands offer fast and bundled data return, up to  the capacity of the IBA fr ame buffer. There are two types\nof operations in burst comma nd: READ burst and Write burst.Vendor-Specific Registers\n10h - RESERVED\n11h 0xN122 - 0xN123 PHY Remote Loopback Register\n12h 0xN124 - 0xN125 PHY LinkMD Register\n13h 0xN126 - 0xN127 PHY Digital  PMA/PCS Status Register\n14h - RESERVED15h 0xN12A - 0xN12B Port RXER Count Register\n16h-1Ah - RESERVED\n1Bh 0xN136 - 0xN137 Port Interrupt Control / Status Register\n1Ch 0xN138 - 0xN139 PHY Auto MDI / MDI-X Register\n1Dh-1Eh - RESERVED\n1Fh 0xN13E - 0xN13F PHY Control RegisterTABLE 4-25: STANDARD MIIM REGISTERS (CONTINUED)\nMIIM Standard \nRegister Address\n (hex)Port N \nRegister Address\n(hex)Description\nKSZ9896C\nDS00002390A-page 58 \uf0e3 2017 Microchip Technology Inc.4.11 MAC Interface (Port 6)\nStrapping options are used to individually select any of these MAC interface options for port 6: \n•Media Independent Interface (MII) (Port 6) : Supports 100 and 10 Mbps data rates\n•Reduced Media Independent Interface (RMII) (Port 6) : Supports 100 and 10 Mbps data rates\n•Gigabit Media Independent Interface (GMII) (Port 6) : Supports 1000Mbps data rate\n•Reduced Gigabit Media Independent  Interface (RGMII) (Port 6) : Supports 1000, 100 and 10 Mbps data rates\nNote that the signals on the KSZ9896C MAC interface are na med as they would be for a PHY: the TX direction is into\nthe KSZ9896C, while the RX direction is out of the KSZ9896C , as if to a host processor with integrated MAC. Signal\nconnection to such a “MAC” devic e is TX-to-TX, and RX-to-RX.\nAn external PHY (such as the Microchip KSZ9031RNX) may be co nnected to port 6, but in that case the signal connec-\ntion will be RX-to-TX, and TX-to-RX.FIGURE 4-15: IN-BAND MA NAGEMENT FRAME FORMAT\nLSB 0 1 6 5 4 3 27 M S B\nPREAMBLE\nSFD7 Bytes\n1 Byte\nDES. ADDRESS6 Bytes\nIBAF TAG TYPE2 BytesSRC. ADDRESS6 Bytes\nIBAF TAG CONTROL INFO.2 Bytes\n2 Bytes46 bit address i/g u/li/g=0, Individual Address; i/g=1, Group Address\nu/l=0, Globally Admin. Addr. u/l=1, Locally Admin. Addr.\n2 BytesMAC LENGTH/TYPE\n2 BytesTPID \n10011000\n00000000\n00000000\n000000000x9800 for 98xx Family\nReserved010xxxxx\n11111110\nSequence #p cfi3 bits of Priority, 1 bit of Canonical Format Indicator = 0 \n4 bits of mode, 8 bits of sequence #\nIBAF TAG\n2 Bytes\nACCESS COMMAND4 Bytes\nDATA4 Bytes\n4 Bytes\n4 Bytes\n4 Bytes\n4 Bytes\n4 Bytes\n4 Bytes\n4 BytesACCESS CODE\n4 Bytes\nEXTENSIONVariableFRAME CHECK SEQUENCE4 BytesPADVariableIBAF \nLayer 3 \nData\n38/42/46 \n– 1500\nMAC \nDATA0eeeeAAAAAAAAOP. \nCode\nBits Transmitted from Left to Rightmode\nACCESS FORMAT\nReserved 0x0001 = Rd/Wr,\n0x0002 = Burst\nACCESS COMMAND/DATA\nACCESS COMMAND/DATA\nACCESS COMMAND/DATA\nACCESS COMMAND/DATADATA\nDATA\nDATA\nDATAAAAAAAAAAAAAAAAACOMMAND = 0x0001 (Rd/Wr)\n0000000000000OP. \nCode\n00000000000aaaaaCOMMAND = 0x0002 (Dump)\n0xddddddddCOMMAND = 0x0001 (Rd/Wr)3 bits of OP code: \n001 = READ, 010 = WRITE, \n100 = WAIT on 0, 101 = WAIT on 1,\n110 = MODIFY to 0, 111 = MODIFY to 1,\n000 = end of command list\neeee = Byte enable\nAAAA..AAAA[23:0] = Register Address\n000000AAAAAAAA Dir\nAAAAAAAAAAAAAAAACOMMAND = 0x0002 (Burst)\n2 bits of Direction: \n01 = READ, 10 = WRITE, \nAAAA..AAAA[23:0] = Starting Register Address\n0xmaskmaskCOMMAND = 0x0001 (WAIT/\nMODIFY)\nMask (1) = bit in reg. to be tested for OP code 100/101\nOR\nset (1) = bit to be set to 0/1 based on OP code 110/111dddddddd = data written/read\n26 0\'s and 6 bits of burst count COMMAND = 0x0002 (Burst)\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 59KSZ9896C\nThe Port 6 MII/RMII/GMII/RGMII interface is powered by the VDDIO  power supply.\n4.11.1 MEDIA INDEPENDENT INTERFACE (MII) (PORT 6)\nThe media independent interface (MII) is  specified in Clause 22 of the IEEE 802. 3 standard. It provides a common inter-\nface between PHY layer and MAC layer devices. The data inte rface is 4-bits wide and runs at one quarter the network\nbit rate; either 2.5MHz in 10BASE-Te or 25MHz in 100BASE- TX (not encoded). Additional signals on the transmit side\nindicate when data is valid or when an error occurs during tr ansmission. Similarly, the receive side provides signals that\nconvey when the data is valid and without physical layer errors . For half duplex operation, the COL signal indicates if a\ncollision has occurred during transmission.\nThe MII interface operates in either PHY Mode or MAC Mode . Select PHY Mode when the port is connected to a pro-\ncessor or other device with a MAC function ; select MAC Mode when connecting to an external PHY. Note that the direc-\ntion of the TX_CLK6 , RX_CLK6 , COL6  and CRS6  signals is affected by the PHY mode or MAC mode setting, while\nother MII signals do not change direction.\nMII mode is selected at reset by a configuration strap option on pins RXD6_3  and RXD6_2  for port 6. The Speed strap-\nping option (on pin RXD6_0  for port 6) should be set for 100/10 Mbps M ode. PHY Mode or MAC Mode is selected by a\nconfiguration strap option on pin RXD6_1  (port 6). Refer to Section 3.2.1, "Configuration Straps," on page 17  for addi-\ntional information.\nAnother configuration strap on the RX_ER6/RX_CLK6  pin selects either 2-Wire Mode or 3-Wire Mode for the GMII / MII\nclocking. This option determines which pin is used for the KSZ9896C\'s MII RX_CLK. The 3-Wire Mode option isintended for use when connecting to a 1000/100/10 Mbps PH Y such as the Microchip KSZ9031MNX, which has sepa-\nrate pins for its GTX_CLK and TX_CLK signals. When 3-Wire Mode is selected, the MII (MAC Mode) RX_CLK6  input\nclock is on pin 75. When in 2-Wire Mode, RX_CLK6  is on pin 72. If GMII will not be used, or when in PHY Mode, the\nclock mode should be 2-Wire. Refer to Section 3.2.1, "Configurat ion Straps," on page 17  for additional information.\nThe interface contains two distinct groups of signal s, one for transmission and the other for reception. Table 4-26  and\nTable 4-27  describe the signals used by the MII interface to connect  to an external MAC or to an external PHY, respec-\ntively.\nTABLE 4-26: MII (PHY MODE) CONNECTION TO EXTERNAL MAC\nMII Interface Signals Description KSZ9896C Sign als in PHY Mode External MAC Device Signals\nTransmit Enable TX_EN6  (input) TX_EN (output)\nTransit Error TX_ER6  (input) TX_ER (output)\nTransmit Data Bits [3:0] TXD6 _[3:0] (input) TXD[3:0] (output)\nTransmit Clock TX_CLK6  (output) TX_CLK (input)\nCollision Detection COL6  (output) COL (input)\nCarrier Sense CRS6  (output) CRS (input)\nReceived Data Valid RX_DV6  (output) RX_DV (input)\nReceive Error RX_ER6  (output) RX_ER (input)\nReceive Data Bits [3:0] RXD6[3:0]  (output) RXD[3:0] (input)\nReceive Clock RX_CLK6  (output) RX_CLK (input)\nTABLE 4-27: MII (MAC MODE) CONNECTION TO EXTERNAL PHY\nMII Interface Signals Description KSZ9896C Signal s in MAC Mode External PHY Device Signals\nTransmit Enable RX_DV6  (output) TX_EN (input)\nTransit Error RX_ER6  (output) TX_ER (input)\nTransmit Data Bits [3:0] RXD6 _[3:0] (output) TXD[3:0] (input)\nTransmit Clock RX_CLK6  (input)\n(Actual pin depends on GMII/MII \nClock Mode)TX_CLK (output)\nCollision Detection COL6  (input) COL (output)\nCarrier Sense CRS6  (input) CRS (output)\nKSZ9896C\nDS00002390A-page 60 \uf0e3 2017 Microchip Technology Inc.4.11.2 REDUCED MEDIA INDEPENDENT INTERFACE (RMII) (PORT 6)\nThe reduced media independent interface (RMI I) specifies a low pin count interface, which is based on MII, that provides\ncommunication with a MAC attached to the port. As with MII,  RMII provides a common interface between physical layer\nand MAC layer devices, or between two MAC layer devices, and has the following key characteristics:\n• Supports network data rates of either 10Mbps or 100Mbps.\n• Uses a single 50MHz clock reference (provided internally  or externally) for both transmit and receive data.\n• Uses independent 2-bit wide transmit and receive data paths.\n• Contains two distinct groups of signals: o ne for transmission and the other for reception.\nThe user selects one of the two RMII clocking mo des by setting the appropriate strapping option. \nWhile in RMII Normal Mode, the port will require an external 50MHz signal to be input to TX_CLK6/REFCLKI6  from an\nexternal source. This mode is selected by strapping the RXD6_1  pin high during reset. \nWhile in RMII Clock Mode, the port will output a 50MHz clock on RX_CLK6/REFCLKO6 , which is derived from the\n25MHz crystal or oscillator attached to the XI clock input. The TX_CLK6/REFCLKI6  input is unused in this mode. This\nmode is selected by strapping the RXD6_1 pin low during reset. \nRefer to Section 3.2.1, "Configuration Straps," on page 17  for additional configuration strap information.\nTable 4-28  describes the signals used by the RMII interface. Refer to the RMII specification for full details on the signal\ndescriptions. \nA device port in RMII mode may connect to either an external MAC device (such as a host processor) or to an external\nPHY; but unlike MII, RMII does not provide separate PHY and MAC modes of operation. However, it is necessary to\nconnect the pins properly.Received Data Valid TX_EN6  (input) RX_DV (output)\nReceive Error TX_ER6  (input) RX_ER (output)\nReceive Data Bits [3:0] TXD6 _[3:0] (input) RXD[3:0] (output)\nReceive Clock TX_CLK6  (input) RX_CLK (output)\nTABLE 4-28: RMII SIGNAL DESCRIPTIONS\nRMII Signal \nName\n(per spec)RMII Signal\n(per KSZ9896C)Pin Direction \n(with Respect to \nPHY, KSZ9896C)Pin Direction \n(with Respect to \nMAC)RMII Signal Description\nREF_CLK REFCLKI6 Input Input or OutputSynchronous 50MHz reference clock, \nwhen port is in RMII Normal Mode\nn/a REFCLKO6 Output InputSynchronous 50MHz reference clock, \nwhen port is in RMII Clock Mode\nTX_EN TX_EN6 Input Output Transmit Enable\nTXD[1:0] TXD6_[1:0] Input Output Transmit Data Bit [1:0]\nCRS_DV RX_DV6 Output Input Carrier Sense / Receive Data Valid\nRX_ER RX_ER6 OutputInput or \nnot requiredReceive Error\nRXD[1:0] RXD6_[1:0] Output Input Receive Data Bit [1:0]TABLE 4-27: MII (MAC MODE) CONNECTI ON TO EXTERNAL PHY (CONTINUED)\nMII Interface Signals Description KSZ9896C Signal s in MAC Mode External  PHY Device Signals\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 61KSZ9896C\n4.11.3 GIGABIT MEDIA INDEPENDENT INTERFACE (GMII) (PORT 6)\nThe Gigabit Media Independent Interface (G MII) is compliant to clause 35 of the IEEE 802.3 standard. It provides a com-\nmon interface between GMII PHYs and MACs at 1000 Mbps. GM II is based heavily on the MII interface, with the key\nsignal differences being the data bus width, clock rate, and direction of the transmit clock.\nThe KSZ9896C interface combines GMII mode with MII mode to form GMII/MII mode to support data transfer at 10/100/\n1000 Mbps. Port 6 is configured at power-up or reset to  GMII/MII mode via the confi guration strap option on the RXD6_3\nand RXD6_2  pins. The Port 6 Speed Select  configuration strap, on the RXD6_0  pin, determines whether the interface\nis in MII mode (for 100 and 10 Mbps), or GMII mode (for 1 000 Mbps) at power-up or reset. There is no method for the\nKSZ9896C to automatically switch speeds based on the spe ed of the connected device, but any of the three speeds\ncan be selected via the port 6 XMII Port Control 0 Register  and XMII Port Control 1 Register . When switching from 1000\nMbps to 100 or 10 Mbps speed, the interface swit ches automatically from GMII to MII operation. \nWhen this change occurs, one of the two GMII / MII clocks will  change direction. If the GMII / MII interface is in PHY\nmode, the transmit clock (TX_CLK) will change between input (GMII) and output (MII). If the interface is in MAC mode,\nthe receive clock (RX_CLK) will change between output (GMII) and input (MII).\nAnother configuration strap on the RX_ER6/RX_CLK6  pin selects either 2-Wire Mode or 3-Wire Mode for the GMII / MII\nclocking. This option determines which pin is used for the KSZ9896C\'s MII RX_CLK. The 3-Wire Mode option is\nintended for use when connecting to a 1000/100/10 Mbps PH Y such as the Microchip KSZ9031MNX, which has sepa-\nrate pins for its GTX_CLK and TX_CLK signals. When 3-Wire Mode is selected, the MII (MAC Mode) RX_CLK6  input\nclock is on pin 75. When in 2-Wire Mode, RX_CLK6  is on pin 72. If GMII will not be used, or when in PHY Mode, the\nclock mode should be 2-Wire. Refer to Section 3.2.1, "Configurat ion Straps," on page 17  for additional information.TABLE 4-29: RMII CONNECTION TO EXTERNAL MAC\nRMII Interface Signals Description KSZ989 6C Signals External MAC Device Signals\nTransmit Enable TX_EN6  (input) TX_EN (output)\nTransmit Data Bits [1:0] TXD6 _[1:0] (input) TXD[1:0] (output)\nReference Clock REFCLKI6  (input)\nor REFCLKO6 (output)REF_CLK\n(input or output)\nCarrier Sense Data Valid RX_DV6  (output) CRS_DV (input)\nReceive Error RX_ER6  (output) RX_ER (input)\nReceive Data Bits [1:0] RXD6 _[1:0] (output) RXD[1:0] (input)\nTABLE 4-30: RMII CONNECTION TO EXTERNAL PHY\nRMII Interface Signals Description KSZ9896C Signals External PHY Device Signals\nTransmit Enable RX_DV6  (output) TX_EN (input)\nTransmit Data Bits [1:0] RXD6 _[1:0] (output) TXD[1:0] (input)\nReference Clock REFCLKI6  (input)\nor REFCLKO6 (output)REF_CLK\n(input or output)\nCarrier Sense Data Valid TX_EN6  (input) CRS_DV (output)\nReceive Error No connection RX_ER (output)\nReceive Data Bits [1:0] TXD6 _[1:0] (input) RXD[1:0] (output)\nKSZ9896C\nDS00002390A-page 62 \uf0e3 2017 Microchip Technology Inc.4.11.4 REDUCED GIGABIT MEDIA INDEPENDENT INTERFACE (RGMII) (PORT 6)\nRGMII provides a common interface between RGMII PHYs  and MACs, and has the following key characteristics:\n• Pin count is reduced from 24 pins for GMII to 12 pins for RGMII. \n• All speeds (10Mbps, 100Mbps and 1000Mbps) are supported at both half- and full-duplex.\n• Data transmission and reception are independent and belong to separate signal groups.• Transmit data and receive data are each four bits wide - a nibble.\nIn RGMII operation, the RGMII pins function as follows: • The MAC sources the transmit reference clock, TX_CLK6 , at 125MHz for 1000Mbps, 25MHz for 100Mbps, and \n2.5MHz for 10Mbps.\n• The PHY recovers and sources the receive reference clock, RX_CLK6 , at 125MHz for 1000Mbps, 25MHz for \n100Mbps, and 2.5MHz for 10Mbps.\n• For 1000BASE-T, the transmit data, TXD6_[3:0] , is presented on both edges of TX_CLK6 , and the received data, \nRXD6_[3:0] , is clocked out on both edges of the recovered 125MHz clock, RX_CLK6 .\n• For 10BASE-T/100BASE-TX, the MAC holds TX_CTL6  low until both the PHY and MAC operate at the same \nspeed. During the speed transition, the receive clock is stretched on either a positive of negative pulse to ensure \nthat no clock glitch is presented to the MAC. \n•TX_ER6  and RX_ER6  are combined with TX_EN6  and RX_DV6 , respectively, to form TX_CTL6  and RX_CTL6 . \nThese two RGMII control signals ar e valid at the falling clock edge.TABLE 4-31: GMII CONNECTION (PHY MODE) TO EXTERNAL MAC INTERFACE\nGMII Interface Signals Description KSZ9896C Si gnals in PHY Mode External MAC Device Signals\nTransmit Enable TX_EN6  (input) TX_EN (output)\nTransmit Error TX_ER6  (input) TX_ER (output)\nTransmit Data Bits [170] TXD6 _[7:0] (input) TXD[7:0] (output)\nTransmit Clock GTX_CLK  (input) GTX_CLK (output)\nCollision Detection COL6  (output) COL (input)\nCarrier Sense CRS_DV6  (output) CRS (input)\nReceive Data Valid RX_DV6  (output) RX_DV (input)\nReceive Error RX_ER6  (output) RX_ER (input)\nReceive Data Bits [7:0] RXD6 _[7:0] (output) RXD[7:0] (input)\nReceive Clock RX_CLK6  (output) RX_CLK (input)\nTABLE 4-32: GMII CONNECTION (MAC MODE) TO EXTERNAL PHY\nGMII Interface Signals Description KSZ9896C Sign als in MAC Mode External PHY Device Signals\nTransmit Enable RX_DV6  (output) TX_EN (input)\nTransmit Error RX_ER6  (output) TX_ER (input)\nTransmit Data Bits [170] RXD6 _[7:0] (output) TXD[7:0] (input)\nTransmit Clock GRX_CLK  (output) GTX_CLK (input)\nCollision Detection COL6  (input) COL (output)\nCarrier Sense CRS_DV6  (input) CRS (output)\nReceive Data Valid TX_EN6  (input) RX_DV (output)\nReceive Error TX_ER6  (input) RX_ER (output)\nReceive Data Bits [7:0] TXD6 _[7:0] (output) RXD[7:0] (output)\nReceive Clock GTX_CLK6  (input) RX_CLK (output)\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 63KSZ9896C\nAfter power-up or reset, the device is configured to RGMII mode if  the appropriate configurat ion strap pins are set to\none of the RGMII mode capability options. Refer to Section 3.2.1, "Configur ation Straps," on page 17  for available\noptions. Note that there is no mechanism for the RGMII interface to adapt  its speed automatically to the speed of the\nconnected RGMII device. A configuration strap option sets  the speed of the RGMII inte rface at power-up to either\n1000Mbps or 100Mbps. A control register can override the configuration strap op tion and set the RGMII speed to either\n1000, 100 or 10Mbps. If a PHY is connected to the RGMII port , it should be ensured that the PHY link speed is fixed in\norder to avoid a mismatch to the RGMII speed.\nThe device provides the option to add a mi nimum of 1.5ns internal delay to either TX_CLK6  or RX_CLK6 , via the RGMII\nInternal Delay control bits in the XMII Port Control 1 Register . This can reduce or eliminate the need to add trace delay\nto the clock signals on the printed circuit board. RGMII_ID_ig enables delay on TX_CLK6 , and the default is off.\nRGMII_ID_eg enables delay on RX_CLK6 , and the default is on. Users should also be aware of any internal clock delay\nthat may be added by the connected RGMII device.\nTABLE 4-33: RGMII SIGNAL DESCRIPTIONS\nRGMII Signal \nName\n(per spec)RGMII Signal\n(per KSZ9896C)Pin Direction \n(with respect to \nPHY, KSZ9896C)Pin Direction \n(with respect to \nMAC)RGMII Signal Description\nTXC TX_CLK6 Input OutputTransmit Reference Clock\n(125MHz for 1000Mbps, 25MHz for 100Mbps, 2.5MHz for 10Mbps)\nTX_CTL TX_CTL6 Input Output Transmit Control\nTXD[3:0] TXD6_[3:0] Input Output Transmit Data [3:0]\nRXC RX_CLK6 Output InputReceive Reference Clock\n(125MHz for 1000Mbps, 25MHz for \n100Mbps, 2.5MHz for 10Mbps)\nRX_CTL RX_CTL6 Output Input Receive Control\nRXD[3:0] RXD6_[3:0] Output Input Receive Data [3:0]\nKSZ9896C\nDS00002390A-page 64 \uf0e3 2017 Microchip Technology Inc.5.0 DEVICE REGISTERS\nThe KSZ9896C has a rich set of registers for device ma nagement. The registers are accessed by the SPI or I2C inter-\nfaces, or by in-band management. Alter natively, the MIIM interface can be used  to access the PHY registers only. The\nMIIM interface cannot access the switch registers.\nA 16-bit address is used to access the device registers. This  address is split into three hierarchical spaces, as shown\nin Figure 5-1 . These three spaces are used to designate the port/c hannel (4-bits), function (page) of the port (4-bits),\nand register of function (8-bits). The in dividual ports are numbered 1 through 6. In  the port space, a value of 0 is used\nfor global registers. Address bit 15 is always 0.\nFIGURE 5-1: REGISTER ADDRESS MAPPING\n15 14 13 12 11 10 9 8 7 0 1 2 3 4 5 6= 0x0312\n0 = GlobalRegister SpaceFunction Space \n(Page)Port Space0Examples:\n000001100010010\nN = Port #= 0xN408 0N NN010000001000\nControl,\nStatus,\nStorage,\nEtc.0 = Operation1 = I/O Interface\n2 = PHY\n3 = General\n4 = Look-up Tables\n5-F = Reserved\n0 = Operation1 = PHY\n2 = Reserved\n3 = RGMII / GMII / MII / RMII\n4 = MAC5 = MIB Counters6 = ACL\n7 = Reserved\n8 = Ingress – Classification, Policing\n9 = Egress – Shaping\nA = Queue managementB = Address lookup engine\nC-F = ReservedRegister \nAddress\nValues of N \nare 1 - 6\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 65KSZ9896C\nRegister addressing is by bytes, a nd the management interface (SPI, I2C or in-band) transfers data by bytes. Where\nregisters are shown as 16-bits or 32-bits, this is for descr iptive purposes only. Data can always be written and read as\nindividual bytes and in any order.\nFor multi-byte registers, the data is a ddressed in a big-endian format, with the most significant byte at the lowest\naddress, and the least significant byte at the highest address, as shown in Figure 5-2 .\nThe global and port register address maps are detailed in Table 5-1  and Table 5-2 , respectively. Table 1-3, “Register\nNomenclature,” on page 7  provides a list of register bit type notations.\nThe remainder of this chapter is organized as follows:•Global Registers\n•Port Registers\n•Tables and MIB Counters (Access)\n•MDIO Manageable Device (MMD) Registers (Indirect)FIGURE 5-2: BYTE ORDERING\nTABLE 5-1: GLOBAL REGISTER ADDRESS MAP\nAddress Functional Group\n0x0000 - 0x00FF Global Operation Control Registers (0x0000 - 0x00FF)\n0x0100 - 0x01FF Global I/O Control Registers (0x0100 - 0x01FF)\n0x0200 - 0x02FF Global PHY Control and Status Registers (0x0200 - 0x02FF)\n0x0300 - 0x03FF Global Switch Control Registers (0x0300 - 0x03FF)\n0x0400 - 0x04FF Global Switch Look Up Engine (LUE) Control Registers (0x0400 - 0x04FF)\n0x0500 - 0x0FFF RESERVED0A0B0C0D 0A0B016-bit register32-bit register\n0A\n0B\n0C\n0D0A\n0B\nmemory\nmemoryaddress a\naddress a+1address a\naddress a+1\naddress a+2\naddress a+3\nKSZ9896C\nDS00002390A-page 66 \uf0e3 2017 Microchip Technology Inc.TABLE 5-2: PORT N (1-6) REGISTER ADDRESS MAP\nAddress Functional Group\n0xN000 - 0xN0FF Port N: Port Operation Contro l Registers (0xN000 - 0xN0FF)\n0xN100 - 0xN1FF Port N: Port Ethernet PHY Registers (0xN100 - 0xN1FF)\n0xN200 - 0xN2FF RESERVED\n0xN300 - 0xN3FF Port N: Port RGMII/GMII/MII/RMII Co ntrol Registers (0xN300 - 0xN3FF)\n0xN400 - 0xN4FF Port N: Port Switch MAC Control Registers (0xN400 - 0xN4FF)\n0xN500 - 0xN5FF Port N: Port Switch MIB Counters Registers (0xN500 - 0xN5FF)\n0xN600 - 0xN6FF Port N: Port Switch ACL Control Registers (0xN600 - 0xN6FF)\n0xN700 - 0xN7FF RESERVED\n0xN800 - 0xN8FF Port N: Port Switch Ingress C ontrol Registers (0xN800 - 0xN8FF)\n0xN900 - 0xN9FF Port N: Port Switch Egress C ontrol Registers (0xN900 - 0xN9FF)\n0xNA00 - 0xNAFF Port N: Port Switch Queue Managemen t Control Registers (0xNA00 - 0xNAFF)\n0xNB00 - 0xNBFF Port N: Port Switch Address Lookup Control Registers (0xNB00 - 0xNBFF)\n0xNC00 - 0xNFFF RESERVED\nNote: RESERVED address space must not be written unde r any circumstances. Failu re to heed this warn-\ning may result in untoward operation and unexpected results. If it is necessary to write to registerswhich contain both writable and reserved bits in the same register, the user should first read back\nthe reserved bits (RO or R/W), “OR” the desired se ttable bits with the value read, and then write\nback the “ORed” value to the register.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 67KSZ9896C\n5.1 Global Registers\nThis section details the device’s global  registers. For an overview of the dev ice’s entire register  map, refer to Section\n5.0, "Device Registers" . For details on the device’s port registers, refer to Section 5.2, "Port Registers" .\n5.1.1 GLOBAL OPERATION CONTROL REGISTERS ( 0x0000 - 0x00FF )\n5.1.1.1 Global Chip ID 0 Register \n5.1.1.2 Global Chip ID 1 Register \n5.1.1.3 Global Chip ID 2 Register \n5.1.1.4 Global Chip ID 3 Register Address: 0x0000 Size: 8 bits\nBits Description Type Default\n7:0 Fixed Value RO 0x00\nAddress: 0x0001 Size: 8 bits\nBits Description Type Default\n7:0 Chip ID (MSB) RO 0x98 \nAddress: 0x0002 Size: 8 bits\nBits Description Type Default\n7:0 Chip ID (LSB) RO 0x96 \nAddress: 0x0003 Size: 8 bits\nBits Description Type Default\n7:4 Revision ID RO -\n3:1 RESERVED RO -\n0 Global Software Reset\nRefer to the Switch Operation Register  for another reset control bit.\n0 = Normal operation 1 = Resets the data path and state machines, but not register values.R/W\nSC0b\nKSZ9896C\nDS00002390A-page 68 \uf0e3 2017 Microchip Technology Inc.5.1.1.5 PME Pin Control Register \n5.1.1.6 Global Interrupt Status Register \nThis register provides the top level interrupt stat us for the LUE. These interrupts are enabled in the Global Interrupt Mask\nRegister . For port specific interrupts, refer to the Port Interrupt Status Register .\n5.1.1.7 Global Interrupt Mask Register \nThis register enables the interrupts in the Global Interrupt Status Register .Address: 0x0006 Size: 8 bits\nBits Description Type Default\n7:2 RESERVED RO -\n1 PME Pin Output Enable\n0 = Disabled\n1 = EnabledR/W 0b\n0 PME Pin Output Polarity\n0 = PME is active low\n1 = PME is active highR/W 0b\nAddress: 0x0010 - 0x0013 Size: 32 bits\nBits Description Type Default\n31 Lookup Engine (LUE) Interrupt Status\nRefer to the Address Lookup Table Interrupt Register  for detailed LUE \ninterrupt status bits.\n0 = No interrupt 1 = Interrupt requestRO 0b\n30:0 RESERVED RO -\nAddress: 0x0014 - 0x0017 Size: 32 bits\nBits Description Type Default\n31 Lookup Engine (L UE) Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n30:0 RESERVED RO -\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 69KSZ9896C\n5.1.1.8 Global Port Interrupt Status Register \nThis register provides the top level interrupt status for the individual port s. These interrupts are enabled in the Global\nPort Interrupt Mask Register . Refer to the Port Interrupt Status Register  for detailed port interrupt status.Address: 0x0018 - 0x001B Size: 32 bits\nBits Description Type Default\n31:6 RESERVED RO -\n5 Port 6 Interrupt Status \n0 = No interrupt 1 = Interrupt requestRO 0b\n4 Port 5 Interrupt Status\n0 = No interrupt 1 = Interrupt requestRO 0b\n3 Port 4 Interrupt Status\n0 = No interrupt 1 = Interrupt requestRO 0b\n2 Port 3 Interrupt Status\n0 = No interrupt \n1 = Interrupt requestRO 0b\n1 Port 2 Interrupt Status\n0 = No interrupt \n1 = Interrupt requestRO 0b\n0 Port 1 Interrupt Status\n0 = No interrupt \n1 = Interrupt requestRO 0b\nKSZ9896C\nDS00002390A-page 70 \uf0e3 2017 Microchip Technology Inc.5.1.1.9 Global Port Interrupt Mask Register \nThis register enables the interrupts in the Global Port Interrupt Status Register .Address: 0x001C - 0x001F Size: 32 bits\nBits Description Type Default\n31:6 RESERVED RO -\n5 Port 6 Interrupt Mask \n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n4 Port 5 Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n3 Port 4 Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n2 Port 3 Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n1 Port 2 Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n0 Port 1 Interrupt Mask\n0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 71KSZ9896C\n5.1.2 GLOBAL I/O CONTROL REGISTERS ( 0x0100 - 0x01FF )\n5.1.2.1 Serial I/O Control Register \n5.1.2.2 Output Clock Control Register Address: 0x0100 Size: 8 bits\nBits Description Type Default\n7:3 RESERVED R/W 0100_0b\n2 MIIM Preamble Suppression\nThis feature affects only the MIIM (M DIO / MDC) interface. When using SPI \nor I2C, this bit has no effect. \n0 = Normal operation. The switch always expects the MIIM preamble. \n1 = The switch will respond to MIIM commands even in the absence of a \npreamble.R/W 0b\n1 Automatic SPI Data  Out Edge Select\nWhen enabled, this feat ure automatically dete rmines the edge of SCL that is \nused to clock out the SPI data on SDO. If SCL ≥ ~25MHz, SDO data is \nclocked by the rising edge of SCL. If SCL < ~25 MHz, SDO data is clocked \nby the falling edge of SCL.\n0 = The automatic feature is disabled, and bit 0 determines the SCL clock \nedge used for SDO.\n1 = The automatic feature is enabled, and bit 0 is ignored.R/W 1b\n0 SPI Data Out Edge Select\nWhen bit 1 is zero, then this bit det ermines the clock edge used for SPI data \nout. When bit 1 is set to 1, this bit is ignored.\n0 = SDO data is clocked by the falling edge of SCL \n1 = SDO data is clocked by the rising edge of SCLR/W 0b\nAddress: 0x0103 Size: 8 bits\nBits Description Type Default\n7:5 RESERVED RO 000b\n4:2 RESERVED R/W 000b\n1 CLKO_25_125 Output Pin Enable \n0 = Disabled 1 = EnabledR/W 1b\n0 CLKO_25_125 Frequency \n0 = 25 MHz 1 = 125 MHzR/W 0b\nKSZ9896C\nDS00002390A-page 72 \uf0e3 2017 Microchip Technology Inc.5.1.2.3 In-Band Management (IBA) Control Register \nThis register controls the In-Band Access (IBA) feature.\nNote 5-1 The default value of this field is determined by the associated configuration strap value. Refer to\nSection 3.2.1, "Configuration Straps," on page 17  for additional information.Address: 0x0104 - 0x0107 Size: 32 bits\nBits Description Type Default\n31 IBA Enable\nThe initial value is strapped in from the RX_DV6/CRS_DV6/RX_CTL6  pin. \n0 = Disabled \n1 = EnabledR/W Note 5-1\n30 IBA Destination MAC Address Match Enable\nSet this bit to enable checking of the destination MAC address in received \nIBA frames against the switch MAC address in the Switch MAC Address 0 \nRegister  through Switch MAC Address 5 Register . Non-matching frames are \ndiscarded.\nWhen not enabled, the MAC address is not checked.R/W 0b\n29 IBA Reset\nSet this bit to initialize the IBA state machine. This bit is self-clearing.R/W\nSC0b\n28:24 RESERVED RO 0x00\n23:22 Priority Queue for IBA response\nSpecifies the transmit priority queue for the IBA response frame. Typically \nthis value is not changed.R/W 01b\n21:19 RESERVED RO 00_0b\n18:16 Port used for IBA communication\n000 = Port 1\n001 = Port 2010 = Port 3011 = Port 4100 = Port 5101 = Port 6110 = Reserved111 = ReservedR/W 101b\n15:0 TPID (EtherType) value for IBA frame header R/W 0x40FE\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 73KSZ9896C\n5.1.2.4 I/O Drive Strength Register \n5.1.2.5 In-Band Management (IBA) Operation Status 1 Register Address: 0x010D Size: 8 bits\nBits Description Type Default\n7 RESERVED R/W 0b\n6:4 High Speed Drive Strength (24mA)\nControls drive strength of GMII / RGMII / MII / RMII (except TX_CLK  / \nREFCLKI , COL  and CRS) and CLKO_25_125 .R/W 110b\n3 RESERVED R/W 0b\n2:0 Low Speed Drive Strength (8mA)\nControls drive strength of TX_CLK  / REFCLKI , COL , CRS, LEDs, PME_N , \nINTRP_N , SDO and SDI/SDA/MDIO .R/W 10b\nAddress: 0x0110 - 0x0113 Size: 32 bits\nBits Description Type Default\n31 Good IBA Packet Detect\n1 = A good IBA packet is received. RO 0b\n30 IBA Response Packet Transmit Done\n1 = An IBA response packet is sent out.This bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n29 IBA Execution Done\n1 = All the commands in one IBA packet are completely executed.This bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n28:15 RESERVED RO 0x0000\n14 IBA MAC Address Mismatch Error\nThis bit is active only when IBA_ENABLE ( In-Band Management (IBA) \nControl Register , bit 30) is set.\n1 = An IBA packet is received with an unmatched MAC address, unequal to \nthe switch’s MAC address.\nThis bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n13 IBA Access Format Error\n1 = An IBA packet with a wrong access format (not equal to 0x9800) is \nreceived.\nThis bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n12 IBA Access Code Error\n1 = An IBA packet with an unrecognize d access code is received. (Valid \naccess codes are 0x0001 and 0x0002.)\nThis bit is cleared when a packet with a matching IBA tag field is received.RO 0b\nKSZ9896C\nDS00002390A-page 74 \uf0e3 2017 Microchip Technology Inc.5.1.2.6 LED Override Register \n5.1.2.7 LED Output Register11 IBA Access Command Error\n1 = An IBA packet with an unrecognized command code is received.This bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n10 IBA Oversize Packet Error\n1 = An oversized IBA packet is rece ived. The maximum IBA packet size is \n320 bytes, including 8-byte zeros bef ore FCS and the 4-byte FCS. No \nresponse packet is sent.\nThis bit is cleared when a packet with a matching IBA tag field is received.RO 0b\n9:7 RESERVED RO 000b\n6:0 IBA Access Code Error Location\nWhen IBA Access Command E rror (bit 11) is set, these bits indicate the \naddress location of the wrong command code within the IBA packet.RO 0x000\nAddress: 0x0120 - 0x0123 Size: 32 bits\nBits Description Type Default\n31:10 RESERVED RO 0x00000\n9:0 Override LED\nThese bits select whether each LEDx_0  and LEDx_1  pin will function as an \nLED or General Purpose Out put (GPO). The LSB bit of  this field represents \nLED1_0 , followed by LED1_1 , LED2_0 , etc. When configured as a GPO, the \nGPO output is controlled via the LED Output Register .\n0 = LEDx_y  pin functions as an LED\n1 = LEDx_y  pin functions as a GPO0000000000b\nAddress: 0x0124 - 0x0127 Size: 32 bits\nBits Description Type Default\n31:10 RESERVED RO 0x00000\n9:0 GPO Output Control\nWhen configured as a GPO via the LED Override Register , the GPO output \nis controlled via this field. The LSB bit of this field represents LED1_0 , \nfollowed by LED1_1 , LED2_0 , etc.\n0 = LEDx_y  pin outputs low\n1 = LEDx_y  pin outputs highR/W 0000000000bBits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 75KSZ9896C\n5.1.3 GLOBAL PHY CONTROL AND STATUS REGISTERS ( 0x0200 - 0x02FF )\n5.1.3.1 Power Down Control 0 Register \n5.1.3.2 LED Configuration Strap Register \nNote 5-2 The default value of this field is determined by the associated configuration strap values. Refer to\nSection 3.2.1, "Configuration Straps," on page 17  for additional information.Address: 0x0201 Size: 8 bits\nBits Description Type Default\n7:6 RESERVED RO 00b\n5 PLL Power Down\n0 = Normal operation.1 = Disable PLL. This may be used in  combination with EDPD mode – see \nbelow.R/W 0b\n4:3 Power Management Mode\n00 = Normal operation01 = Energy Detect Power Down (EDPD) Mode10 = Soft Power Down Mode11 = invalidR/W 00b\n2:0 RESERVED RO 000b\nAddress: 0x0210 - 0x0213 Size: 32 bits\nBits Description Type Default\n31:10 RESERVED RO 0x000000\n9:0 Configuration strap values of LED pins\n[LED5_1 , LED5_0 , LED4_1 , LED4_0 , LED3_1 , LED3_0 , LED2_1 , LED2_0 , \nLED1_1 , LED1_0 ]  RO Note 5-2\nKSZ9896C\nDS00002390A-page 76 \uf0e3 2017 Microchip Technology Inc.5.1.4 GLOBAL SWITCH CONTROL REGISTERS ( 0x0300 - 0x03FF )\n5.1.4.1 Switch Operation Register \nNote 5-3 The default value of this field is determined by the LED5_1  configuration strap value. Refer to Section\n3.2.1, "Configuration Straps," on page 17  for additional information.\n5.1.4.2 Switch MAC Address 0 Register \n5.1.4.3 Switch MAC Address 1 Register Address: 0x0300 Size: 8 bits\nBits Description Type Default\n7 Double Tag Enable\n1 = Double tagging is enabled0 = Double tagging is disabledR/W 0b\n6:2 RESERVED RO 0x00\n1 Soft Hardware Reset\nWhen set to 1, all register settings, except configurati on strap options, are \nreset to default values.R/W\nSC0b\n0 Start Switch\n1 = Switch function is enabled0 = Switch function is disabled; no tr affic will be passed until this bit is setR/W Note 5-3\nAddress: 0x0302 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [47:40]\nThis register, along with the Switch MA C Address 1-5 Registers, define the \nswitch’s MAC address to be used as the source address in MAC pause control frames, and for self-address filtering.R/W 0x00\nAddress: 0x0303 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [39:32] R/W 0x10\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 77KSZ9896C\n5.1.4.4 Switch MAC Address 2 Register \n5.1.4.5 Switch MAC Address 3 Register \n5.1.4.6 Switch MAC Address 4 Register \n5.1.4.7 Switch MAC Address 5 Register Address: 0x0304 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [31:24] R/W 0xA1\nAddress: 0x0305 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [23:16] R/W 0xFF\nAddress: 0x0306 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [15:8] R/W 0xFF\nAddress: 0x0307 Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [7:0] R/W 0xFF\nKSZ9896C\nDS00002390A-page 78 \uf0e3 2017 Microchip Technology Inc.5.1.4.8 Switch Maximum Transmit Unit Register \n5.1.4.9 Switch ISP TPID Register \n5.1.4.10 Switch Lookup Engine Control 0 Register Address: 0x0308 - 0x0309 Size: 16 bits\nBits Description Type Default\n15:14 RESERVED R/W 00b\n13:0 Maximum Frame Length (MTU)\nSpecifies the maximum transmission unit (MTU), which is the maximum \nframe payload size. Frames which exceed  this maximum are truncated. This \nvalue can be set as high as 9000 (=  0x2328) if jumbo frame support is \nrequired. Also refer to the Switch MAC Control 1 Register  and Port MAC \nControl 0 Register .R/W 0x07D0\nAddress: 0x030A - 0x030B Size: 16 bits\nBits Description Type Default\n15:0 ISP Tag TPID\nDefault tag TPID (EtherType) for unt agged incoming frames or the ISP frame \ntag TPID for the double tagging function.R/W 0x9100\nAddress: 0x0310 Size: 8 bits\nBits Description Type Default\n7 802.1Q VLAN Enable\nThis is the master enable for VLAN forw arding and filterin g. Note that the \nVLAN Table must be set up before VLAN mode is enabled.\n1 = VLAN mode enabled0 = VLAN mode disabledR/W 0b\n6 Drop Invalid VID\n1 = All received packets with invalid VLAN ID are dropped.0 = Received packets with invalid VLAN ID are forwarded to the host port.Note that the Unknown VID Forwarding feature ( Unknown VLAN ID Control \nRegister ), if enabled, takes precedence over this bit.R/W 1b\n5:3 Age Count\nThis bit, in combination with the Age Period value ( Switch Lookup Engine \nControl 3 Register ), determines the aging time of dynamic entries in the \naddress lookup table. This value is used for the Age Count field whenever a dynamic table entry is updated.R/W 10_0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 79KSZ9896C\n5.1.4.11 Switch Lookup Engine Control 1 Register 2 Reserved Multicast Lookup Enable\n1 = Enable Reserved Multicast Table0 = Disable Reserved Multicast TableR/W 0b\n1:0 HASH_OPTION\nDefines the hashing option for mapping entries to the dynamic lookup table. \n00, 11 = Entry is mapped directly using the 10 least significant bits of the \ndestination address.\n01 = The CRC hashing function is used.10 = The XOR hashing function is used.Refer to Section 4.4.2.1, "Address Loo kup (ALU) Table," on page 29  for \nadditional information.R/W 01b\nAddress: 0x0311 Size: 8 bits\nBits Description Type Default\n7 Unicast Learning Disable\n1 = Unicast address learning is disabled0 = Unicast address learning is enabledR/W 0b\n6 Self-Address Filtering – Global Enable\nThe source address of received packets is compared to the MAC address in \nregisters Switch MAC Address 0 Register  through Switch MAC Address 5 \nRegister , and the packet is dropped if there is a match.\nSelf-address filtering can be enabled on a port-by-port basis by setting the \nport enable bit in the Port Control 2 Register  in addition to setting this bit. \n1 = Enable self-address filtering globally  for those ports whose port enable \nbit (Port Control 2 Register ) is set. \n0 = Do not filter self-addressed packets on any port.R/W 0b\n5 Flush Address Lookup Table\nThe Flush Option bit in the Switch Lookup Engine Control 2 Register  \ndetermines whether flushing is performed on dynamic entries, static entries, or both.\n1 = Trigger a flush of the entire addre ss lookup table. The static address \ntable is not flushed.\n0 = Normal operationR/W\nSC0b\n4 Flush MSTP Address Entries (Address Lookup Table)\nThe Flush Option bit in the Switch Lookup Engine Control 2 Register  \ndetermines whether flushing is performed on dynamic entries, static entries, or both.\n1 = Trigger a flush of the matched MSTP entries0 = Normal operationR/W\nSC0b\n3 Multicast Source Address Filtering\n1 = Forward packets with a multicast source address0 = Drop packets with a multicast source addressR/W 1bBits Description Type Default\nKSZ9896C\nDS00002390A-page 80 \uf0e3 2017 Microchip Technology Inc.5.1.4.12 Switch Lookup Engine Control 2 Register 2 Aging Enable\n1 = Enable address table aging0 = Disable address table agingR/W 1b\n1 Fast Aging\n1 = Enable fast aging0 = Disable fast agingR/W 0b\n0 Link Down Flush\n1 = Link down will cause the entries of any link down port to be flushed0 = Link down flush is disabledR/W 0b\nAddress: 0x0312 Size: 8 bits\nBits Description Type Default\n7 RESERVED R/W 0b\n6 Double Tag Multicast Trap\n1 = When double tagging mode is enabled, forward all reserved multicast \npackets to the host port only.\n0 = Normal forwardingR/W 0b\n5 Dynamic Entry Egress VLAN Filtering\nEgress VLAN filtering uses the forwardi ng port map from the VLAN table to \nrestrict the forwarding ports determine d from the address lo okup. This is the \nrecommended mode of operation when VLAN is enabled. The default value is 0 only for backwards compatib ility with previous switches.\n1 = Enable. For successful lookup of a dynamic entry in the address table, \nthe forwarding ports are determined from the AND function of the address table port map and the VLAN table port map.\n0 = Disable. For successful lookup of a dynamic entry in the address table, \nthe forwarding ports are determined from the address table only.R/W 0b\n4 Static Entry Egre ss VLAN Filtering\nEgress VLAN filtering uses the forwardi ng port map from the VLAN table to \nrestrict the forwarding ports determine d from the address lo okup. This is the \nrecommended mode of operation when VLAN is enabled. The default value is 0 only for backwards compatib ility with previous switches.\n1 = Enable. For successful lookup of a static entry in the address table, the \nforwarding ports are determined from the AND function of  the address table \nport map and the VLAN table port map.\n0 = Disable. For successful lookup of a static entry in the address table, the \nforwarding ports are determined from the address table only.R/W 0bBits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 81KSZ9896C\n5.1.4.13 Switch Lookup Engine Control 3 Register 3:2 Flush Option\nDetermines which address lookup table entries may be flushed by either of \nthe flush operations in the Switch Lookup Engine Control 1 Register .\n00 = No flush or flush is done01 = Flush only dynamic table entries10 = Flush only static table entries11 = Flush both static and dynamic table entriesR/W 00b\n1:0 MAC Address Priority\n00 = MAC Address (MACA) priority for a packet is determined from the \ndestination address (DA) lookup\n01 = MACA priority for a packet is det ermined from the source address (SA) \nlookup\n10 = MACA priority for a packet is determined from the higher of the DA and \nSA lookups\n11 = MACA priority for a packet is dete rmined from the lower of the DA and \nSA lookupsR/W 00b\nAddress: 0x0313 Size: 8 bits\nBits Description Type Default\n7:0 Age Period\nThis value, multiplied by the Age Count value in the entries of the Address \nLookup Table, determines the aging time  of dynamic entries in that table. \nThe unit is seconds .R/W 0x4BBits Description Type Default\nKSZ9896C\nDS00002390A-page 82 \uf0e3 2017 Microchip Technology Inc.5.1.4.14 Address Lookup Table Interrupt Register \nThis register provides the detailed interrupt status for t he Address Lookup Table. These interrupts are enabled in the\nAddress Lookup Table Mask Register . The LUE interrupt status bit in the Global Interrupt Status Register  is the OR of\nthe status bits in this register.\n5.1.4.15 Address Lookup Table Mask Register \nThis register masks the Address Lookup Table interrupts in the Address Lookup Table Interrupt Register .Address: 0x0314 Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0x00\n2 Learn Fail Interrupt Status\nAn Address Lookup Table entry was no t learned because all entries in the \nbucket are staticR/WC 0b\n1 Almost Full Interrupt Status\nInterrupt indicates that the Address Lookup Table bucket was almost full (2 \nor 3 valid entries) when a new static entry was written.R/WC 0b\n0 Write Fail Interrupt Status\nInterrupt indicates that the Address Lookup Table bucket is full and a write \nfailedR/WC 0b\nAddress: 0x0315 Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0x00\n2 Learn Fail Interrupt Mask\n1 = Interrupt is disabled0 = Interrupt is enabledR/W 1b\n1 Almost Full Interrupt Mask\n1 = Interrupt is disabled0 = Interrupt is enabledR/W 1b\n0 Write Fail Interrupt Mask\n1 = Interrupt is disabled\n0 = Interrupt is enabledR/W 1b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 83KSZ9896C\n5.1.4.16 Address Lookup Table Entry Index 0 Register \n5.1.4.17 Address Lookup Table Entry Index 1 Register \n5.1.4.18 Address Lookup Table Entry Index 2 Register Address: 0x0316 - 0x0317 Size: 16 bits\nBits Description Type Default\n15:12 RESERVED RO 0x0\n11:0 / \n9:0Almost Full Entry Index [11:0] \nWhen a static entry is successfully wr itten into the Address Lookup Table, \nbut the table bucket is almost full (contains 2 or 3 static entries prior to the write), the entry address is reported here.\nFail Write Index [9:0]\nWhen a static entry write failure occu rs in the Address Lookup Table, the \nbucket address is reported here.RO 0x000\nAddress: 0x0318 - 0x0319 Size: 16 bits\nBits Description Type Default\n15:10 RESERVED RO 0000_00\n9:0 Fail Learn Index\nWhen a destination address fails to be  learned in the Address Lookup Table \nbecause the bucket contains 4 static entries, the bucket address is reported \nhere.RO 0x000\nAddress: 0x031A - 0x031B Size: 16 bits\nBits Description Type Default\n15:10 RESERVED RO 0000_00\n9:0 CPU Access Index\nWhenever there is an external read or  write to the Address Lookup Table, \nthe bucket address of the access is reported here.RO 0x000\nKSZ9896C\nDS00002390A-page 84 \uf0e3 2017 Microchip Technology Inc.5.1.4.19 Unknown Unicast Control Register \nThe following three registers control forwarding of packets  with 1) unknown unicast de stination address, 2) unknown\nmulticast destination address, and 3) unknown VLAN ID.\nIf a received packet falls into more than one of these categories, the precedence is:\n1. Unknown VID\n2. Unknown Unicast\n3. Unknown Multicast\n5.1.4.20 Unknown Multicast Control Register Address: 0x0320 - 0x0323 Size: 32 bits\nBits Description Type Default\n31 Unknown Unicast Packet Forward\n1 = Enable forwarding of unknown unicast packets to the ports specified \nbelow\n0 = Disable unknown unicast packet forwardingR/W 0b\n30:6 RESERVED RO 0x000000\n5:0 Unknown Unicast Forwarding Ports\nBit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward unknown unicast packets to that port0 = Do not forward to that portAll ones = Forwarded to all portsAll zeros = Forwarded to no portsR/W 00_0000b\nAddress: 0x0324 - 0x0327 Size: 32 bits\nBits Description Type Default\n31 Unknown Multicast Packet Forward\n1 = Enable forwarding of unknown multicast packets to the ports specified \nbelow\n0 = Disable unknown multicast packet forwardingR/W 0b\n30:6 RESERVED RO 0x000000\n5:0 Unknown Multicast Forwarding Ports\nBit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward unknown multicast packets to that port0 = Do not forward to that portAll ones = Forwarded to all portsAll zeros = Forwarded to no portsR/W 00_0000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 85KSZ9896C\n5.1.4.21 Unknown VLAN ID Control Register \n5.1.4.22 Switch MAC Control 0 Register Address: 0x0328 - 0x032B Size: 32 bits\nBits Description Type Default\n31 Unknown VID Packet Forward\n1 = Enable forwarding of unknown VL AN ID (VID) packets to the ports \nspecified below\n0 = Disable unknown VID packet forwardingR/W 0b\n30:6 RESERVED RO 0x000000\n5:0 Unknown VID Forwarding Ports\nBit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward unknown VID packets to that port0 = Do not forward to that portAll ones = Forwarded to all portsAll zeros = Forwarded to no portsR/W 00_0000b\nAddress: 0x0330 Size: 8 bits\nBits Description Type Default\n7 Alternate Back-off Mode\nThe back-off mode applies to half-duplex only. This bit should be set if the \nNo Excessive Collision Drop bit in the Switch MAC Control 1 Register  is \nenabled.\n1 = Enable alternate back-off mode0 = DisableR/W 0b\n6:4 RESERVED R/W 000b\n3 Frame Length Field Check\nThis applies only when the EtherType/Length field is <1500.\n1 = Discard any packet if the actual packet length does not match the frame \nlength field.\n0 = Do not check the packet length. R/W 0b\n2 RESERVED R/W 1b\nKSZ9896C\nDS00002390A-page 86 \uf0e3 2017 Microchip Technology Inc.5.1.4.23 Switch MAC Control 1 Register 1 Flow Control Packet Drop Mode\nThis bit controls which flow control packets may be forwarded or dropped. To \nenable forwarding of all flow control packets, refer to bit 0 of the Switch MAC \nControl 4 Register . Enabling of flow control is managed in the PHY Auto-\nNegotiation Advertisement Register  (for PHY ports) and the XMII Port \nControl 0 Register  (for MAC ports).\n1 = The switch will drop received packets with either EtherType = 0x8808 or \ndestination address (D A) = 01-80-C2-00-00-01.\n0 = The switch will drop received packets with both EtherType = 0x8808 and \nDA = 01-80-C2-00-00-01.R/W 0b\n0 Aggressive Back-off Enable \nFor use with half-duplex back pressu re. This is not an IEEE standard.\n1 = Enable aggressive back-off algorithm in half-duplex mode to enhance \nperformance.\n0 = DisableR/W 0b\nAddress: 0x0331 Size: 8 bits\nBits Description Type Default\n7 RESERVED R/W 1b\n6 Multicast Storm Pr otection Disable\n1 = Multicast packets are not included in Broadcast Storm Protection 0 = Multicast packets are included in Broadcast Storm ProtectionR/W 1b\n5 Back Pressure Mode\n1 = Use carrier sense based back pressure mode0 = Use collision based back pressure mode. (This is the recommended \nmode.)R/W 1b\n4 Flow Control and Back Pressure Fair Mode\n1 = Enable fair mode. If a flow controlled ingress port and a non-flow \ncontrolled ingress port forward traffic to  the same egress port, packets from \nthe non-flow controlled port may be dropped.\n0 = Disable fair mode. In this scenario the flow controlled port will be flow \ncontrolled, and the non-flow controlled po rt will be neither flow controlled nor \npackets dropped.R/W 1b\n3 No Excessive Collision Drop\nIf this bit is set, Alternate Back-odd Mode (bit 7 in the Switch MAC Control 0 \nRegister ) should also be set. \n1 = The switch will not drop packets when 16 or more collisions occur.0 = The switch will drop packets when 16 or more collisions occurR/W 0bBits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 87KSZ9896C\n5.1.4.24 Switch MAC Control 2 Register 2 Jumbo Packet Support\nThe programmable packet payload size limi t is specified in register 0x0308 – \n0x0309, up to a maximum of 9000 bytes. This bit overrides bit 1 of this register.\n1 = Enable support for jumbo packets0 = DisableR/W 0b\n1 Legal Maximum Packet Size Check Disable\n1 = Accept packets up to 2000 bytes in size.0 = Accept only standard size packets, up to 1522 bytes for tagged packets, \nor 1518 bytes for untagged packets. Larger packets will be dropped.R/W 0b\n0 Pass Short Packet\n1 = Accept packets between 32 and 64 bytes in size.\n0 = Accept only standard size packets, at least 64 bytes. Smaller packets are \ndropped.R/W 0b\nAddress: 0x0332 Size: 8 bits\nBits Description Type Default\n7:4 RESERVED R/W 0x0\n3 Null VID Replacement\nDescribes the behavior when a packet is received with a null (zero) VID.\n1 = Replace a null VID with the Port  Default VID as defined in the Port \nDefault Tag 0 Register  and Port Default Tag 1 Register\n0 = No replacement of null VIDR/W 0b\n2:0 Broadcast Storm Protection Rate bits [10:8]\nThe remainder of this fields bits are in the Switch MAC Control 3 Register .\nMultiply this value by 64 to determine how many bytes of packet data are \nallowed on an input port in a preset  period. The period is 5ms for a \n1000Mbps port, 50ms for a 100Mbps port, or 500ms for a 10Mbps. The \ndefault is 1%.R/W 000bBits Description Type Default\nKSZ9896C\nDS00002390A-page 88 \uf0e3 2017 Microchip Technology Inc.5.1.4.25 Switch MAC Control 3 Register \n5.1.4.26 Switch MAC Control 4 Register \n5.1.4.27 Switch MAC Control 5 Register Address: 0x0333 Size: 8 bits\nBits Description Type Default\n7:0 Broadcast Storm Protection Rate bits [7: 0]\nThe remainder of this fields bits are in the Switch MAC Control 2 Register .\nMultiply this value by 64 to determine how many bytes of packet data are \nallowed on an input port in a preset  period. The period is 5ms for a \n1000Mbps port, 50ms for a 100Mbps port, or 500ms for a 10Mbps. The \ndefault is 1%.R/W 0x4A\nAddress: 0x0334 Size: 8 bits\nBits Description Type Default\n7:1 RESERVED RO 0000_000b\n0 Pass Flow Control Packets\n1 = Switch will forward 802.3x PAUSE flow control frames.0 = Switch will filter PAUSE frames.R/W 0b\nAddress: 0x0335 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6 RESERVED R/W 0b\n5:4 Ingress Rate Limit Period\n00 = 16ms01 = 64ms1x = 256msR/W 01b\n3 Queue Based Egress Rate Limit Enable\n1 = Queue-based egress rate limiting0 = Port-based egress rate limitingR/W 0b\n2:0 RESERVED RO 000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 89KSZ9896C\n5.1.4.28 Switch MIB Control Register \nMIB counters are provided on a per-port basis. They are read and controlled via the Port N: Port Switch MIB Counters\nRegisters (0xN500 - 0xN5FF) .\n5.1.4.29 802.1p Priority Mapping 0 Register \n5.1.4.30 802.1p Priority Mapping 1 Register Address: 0x0336 Size: 8 bits\nBits Description Type Default\n7 Flush MIB Counters\n1 = Flush all MIB counters of enabled ports. Refer to the Port MIB Control \nand Status Register .\n0 = Normal counter operationR/W\nSC0b\n6 Freeze MIB Counters\n1 = Freeze MIB counters of enabled ports. Refer to the Port MIB Control and \nStatus Register .\n0 = Normal counter operationR/W 0b\n5:0 RESERVED RO 00_0000b\nAddress: 0x0338 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When the tag PCP field is 0x1,  use this value for priority R/W 001b\n3 RESERVED RO 0b\n2:0 When the tag PCP field is 0x0,  use this value for priority R/W 000b\nAddress: 0x0339 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When the tag PCP field is 0x3,  use this value for priority R/W 011b\n3 RESERVED RO 0b\n2:0 When the tag PCP field is 0x2,  use this value for priority R/W 010b\nKSZ9896C\nDS00002390A-page 90 \uf0e3 2017 Microchip Technology Inc.5.1.4.31 802.1p Priority Mapping 2 Register \n5.1.4.32 802.1p Priority Mapping 3 Register \n5.1.4.33 IP DiffServ Priority Enable Register Address: 0x033A Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When the tag PCP field is 0x5,  use this value for priority R/W 101b\n3 RESERVED RO 0b\n2:0 When the tag PCP field is 0x4,  use this value for priority R/W 100b\nAddress: 0x033B Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When the tag PCP field is 0x7,  use this value for priority R/W 111b\n3 RESERVED RO 0b\n2:0 When the tag PCP field is 0x6,  use this value for priority R/W 110b\nAddress: 0x033E Size: 8 bits\nBits Description Type Default\n7:2 RESERVED RO 0000_00b\n1 RESERVED R/W 0b\n0 DiffServ Priority Remap Enable\n1 = Use the following registers to remap the DSCP (DiffServ) priority to a 3-\nbit priority value\n0 = Use DSCP bits [5:3] for priorityR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 91KSZ9896C\n5.1.4.34 IP DiffServ Priority Mapping 0 Register \n5.1.4.35 IP DiffServ Priority Mapping 1 Register \n5.1.4.36 IP DiffServ Priority Mapping 2 Register \n5.1.4.37 IP DiffServ Priority Mapping 3 Register Address: 0x0340 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x01, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x00, use this value for priority R/W 000b\nAddress: 0x0341 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x03, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x02, use this value for priority R/W 000b\nAddress: 0x0342 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x05, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x04, use this value for priority R/W 000b\nAddress: 0x0343 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x07, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x06, use this value for priority R/W 000b\nKSZ9896C\nDS00002390A-page 92 \uf0e3 2017 Microchip Technology Inc.5.1.4.38 IP DiffServ Priority Mapping 4 Register \n5.1.4.39 IP DiffServ Priority Mapping 5 Register \n5.1.4.40 IP DiffServ Priority Mapping 6 Register \n5.1.4.41 IP DiffServ Priority Mapping 7 Register Address: 0x0344 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x09, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x08, use this value for priority R/W 000b\nAddress: 0x0345 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x0B, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x0A, use this value for priority R/W 000b\nAddress: 0x0346 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x0D, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x0C, use this value for priority R/W 000b\nAddress: 0x0347 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x0F, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x0E, use this value for priority R/W 000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 93KSZ9896C\n5.1.4.42 IP DiffServ Priority Mapping 8 Register \n5.1.4.43 IP DiffServ Priority Mapping 9 Register \n5.1.4.44 IP DiffServ Priority Mapping 10 Register \n5.1.4.45 IP DiffServ Priority Mapping 11 Register Address: 0x0348 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x11, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x10, use this value for priority R/W 000b\nAddress: 0x0349 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x13, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x12, use this value for priority R/W 000b\nAddress: 0x034A Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x15, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x14, use this value for priority R/W 000b\nAddress: 0x034B Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x17, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x16, use this value for priority R/W 000b\nKSZ9896C\nDS00002390A-page 94 \uf0e3 2017 Microchip Technology Inc.5.1.4.46 IP DiffServ Priority Mapping 12 Register \n5.1.4.47 IP DiffServ Priority Mapping 13 Register \n5.1.4.48 IP DiffServ Priority Mapping 14 Register \n5.1.4.49 IP DiffServ Priority Mapping 15 Register Address: 0x034C Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x19, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x18, use this value for priority R/W 000b\nAddress: 0x034D Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x1B, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x1A, use this value for priority R/W 000b\nAddress: 0x034E Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x1D, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x1C, use this value for priority R/W 000b\nAddress: 0x034F Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x1F, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x1E, use this value for priority R/W 000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 95KSZ9896C\n5.1.4.50 IP DiffServ Priority Mapping 16 Register \n5.1.4.51 IP DiffServ Priority Mapping 17 Register \n5.1.4.52 IP DiffServ Priority Mapping 18 Register \n5.1.4.53 IP DiffServ Priority Mapping 19 Register Address: 0x0350 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x21, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x20, use this value for priority R/W 000b\nAddress: 0x0351 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x23, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x22, use this value for priority R/W 000b\nAddress: 0x0352 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x25, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x24, use this value for priority R/W 000b\nAddress: 0x0353 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x27, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x26, use this value for priority R/W 000b\nKSZ9896C\nDS00002390A-page 96 \uf0e3 2017 Microchip Technology Inc.5.1.4.54 IP DiffServ Priority Mapping 20 Register \n5.1.4.55 IP DiffServ Priority Mapping 21 Register \n5.1.4.56 IP DiffServ Priority Mapping 22 Register \n5.1.4.57 IP DiffServ Priority Mapping 23 Register Address: 0x0354 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x29, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x28, use this value for priority R/W 000b\nAddress: 0x0355 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x2B, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x2A, use this value for priority R/W 000b\nAddress: 0x0350 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x2D, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x2C, use this value for priority R/W 000b\nAddress: 0x0357 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x2F, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x2E, use this value for priority R/W 000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 97KSZ9896C\n5.1.4.58 IP DiffServ Priority Mapping 24 Register \n5.1.4.59 IP DiffServ Priority Mapping 25 Register \n5.1.4.60 IP DiffServ Priority Mapping 26 Register \n5.1.4.61 IP DiffServ Priority Mapping 27 Register Address: 0x0358 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x31, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x30, use this value for priority R/W 000b\nAddress: 0x0359 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x33, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x32, use this value for priority R/W 000b\nAddress: 0x035A Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x35, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x34, use this value for priority R/W 000b\nAddress: 0x035B Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x37, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x36, use this value for priority R/W 000b\nKSZ9896C\nDS00002390A-page 98 \uf0e3 2017 Microchip Technology Inc.5.1.4.62 IP DiffServ Priority Mapping 28 Register \n5.1.4.63 IP DiffServ Priority Mapping 29 Register \n5.1.4.64 IP DiffServ Priority Mapping 30 Register \n5.1.4.65 IP DiffServ Priority Mapping 31 Register Address: 0x035C Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x39, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x38, use this value for priority R/W 000b\nAddress: 0x035D Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x3B, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x3A, use this value for priority R/W 000b\nAddress: 0x035E Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is  0x3D, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is  0x3C, use this value for priority R/W 000b\nAddress: 0x035F Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:4 When IPv4 / IPv6 DSCP field is 0x3F, use this value for priority R/W 000b\n3 RESERVED RO 0b\n2:0 When IPv4 / IPv6 DSCP field is 0x3E, use this value for priority R/W 000b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 99KSZ9896C\n5.1.4.66 Global Port Mirroring and Snooping Control Register \nThis register contains global controls for port mirroring and IGMP and MLD snooping. Mirroring also requires additional\nregister settings for the individual ports. Refer to the Port N: Port Switch Ingress Control Registers (0xN800 - 0xN8FF) .\n5.1.4.67 WRED DiffServ Color Mapping Register Address: 0x0370 Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6 IGMP Snooping Enable (IPv4)\n1 = IGMP snooping is enabled. All IG MP packets will be forwarded to the \nhost port.\n0 = IGMP snooping is disabled.R/W 0b\n5:4 RESERVED RO 00b\n3 MLD Snooping Option\n1 = Snooping criteria: IPv6 next header = 43, 44, 50, 51 or 60; or next header \n= 0 and hop-by-hop next header = 43, 44, 50, 51 or 60.\n0 = Snooping criteria: IPv6 next header = 1 or 58; or next header = 0 and \nhop-by-hop next header = 1 or 58.R/W 0b\n2 MLD Snooping Enable (IPv6)\n1 = MLD snooping is enabled. All MLD packets will be forwarded to the host \nport.\n0 = MLD snooping is disabled.R/W 0b\n1 RESERVED RO 0b\n0 Sniff Mode Select\n1 = Sniffing filter is “Rx AND Tx”. Both  the source port and destination ports \nneed to match.\n0 = Sniffing filter is “Rx OR Tx”. Either  the source port of the destination port \nneeds to match. This mode is used to implement Rx-only sniffing.R/W 0b\nAddress: 0x0378 Size: 8 bits\nBits Description Type Default\n7:6 RESERVED RO 00b\n5:4 Red\nThis field specifies the red Differentiated Services Code Point (DSCP) value.R/W 11b\n3:2 Yellow\nThis field specifies the yellow DSCP value.R/W 10b\n1:0 Green\nThis field specifies the green DSCP value.R/W 01b\nKSZ9896C\nDS00002390A-page 100 \uf0e3 2017 Microchip Technology Inc.5.1.4.68 Queue Management Control 0 Register \nAddress: 0x0390 - 0x0393 Size: 32 bits\nBits Description Type Default\n31:8 RESERVED RO 0x000000\n7:6 Priority_2Q\nWhen the 2 queue configuration is sele cted, this determines how to map the \n2-bit priority regeneration result from the Port Priority to Queue Mapping \nRegister  into 2 queues.\n00 = Priorities 0, 1, 2 map to the Low priority queue. Priority 3 maps to the \nHigh priority queue.\n01 = Not used.10 = Priorities 0, 1 map to the Low prio rity queue. Priorities 2, 3 map to the \nHigh priority queue.\n11 = Priority 0 maps to the Low priority queue. Priorities 1, 2, 3 map to the \nHigh priority queue.R/W 10b\n5:2 RESERVED R/W 00_00b\n1 Unicast Port VLAN Membership Discard\nThis bit applies to the Port VLAN Membership function in registers 0xNA04-\n07. \n1 = All frames are restricted to t he forwarding ports as defined in the Port \nControl 1 Register .\n0 = Frames forwarding to a single destination port are not limited to the \nforwarding ports defined in the Port Control 1 Register . Note that when \nmirroring is enabled, a single-destination frames will be dropped if it is mirrored to another port.R/W 1b\n0 RESERVED R/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 101KSZ9896C\n5.1.5 GLOBAL SWITCH LOOK UP EN GINE (LUE) CONTROL REGISTERS ( 0x0400 - 0x04FF )\nThe following registers are used for accessing the VLAN Tabl e, Address Lookup Table, Static Address Table and the\nReserved Multicast Address Table. The organizations of these tables, and inst ructions for accessing them, are provided\nin Section 5.3, "Tables and MIB Counters (Access)," on page 155 .\n5.1.5.1 VLAN Table Entry 0 Register \nAddress: 0x0400 - 0x403 Size: 32 bits\nBits Description Type Default\n31 VALID\nThis field in the VLAN Table specifies if the table entry is valid.1 = Table entry is valid0 = Table entry is invalidR/W 0b\n30:28 RESERVED RO 000b\n27 FORWARD OPTION\nThis field in the VLAN Table specifies how the forwarding ports are \ndetermined.\n1 = Forward to the VLAN Table port map (PORT FORWARD field).0 = Forwarding ports are determined by other variables. It may be the ALU \nport map, the VLAN port map, the combination of the two, or the Unknown Unicast/Multicast feature.R/W 0b\n26:24 PRIORITY\nThis field in the VLAN Table specifies the priority level.R/W 000b\n23:15 RESERVED RO\n0000_0000_0b\n14:12 MSTP INDEX\nThis field in the VLAN Table specifies the Multiple Spanning Tree Protocol \nindex.R/W 000b\n11:7 RESERVED RO 0000_0b\n6:0 FID\nThis field in the VLAN Table specifies the Filter ID. The FID value is normally \ncombined with the destination address and then hashed to index the address lookup table.R/W 000_0000b\nNote: Refer to Section 5.3.4, "VLAN Table," on page 162  for additional information on VLAN tables.\nKSZ9896C\nDS00002390A-page 102 \uf0e3 2017 Microchip Technology Inc.5.1.5.2 VLAN Table Entry 1 Register \n5.1.5.3 VLAN Table Entry 2 Register \n5.1.5.4 VLAN Table Index Register Address: 0x0404 - 0x407 Size: 32 bits\nBits Description Type Default\n31:6 RESERVED R/O 0x0000000\n5:0 PORT UNTAG\nThis field in the VLAN Table specifies the untagging policy for each egress \nport.\nBits [5:0] correspond to ports [6:1] .\n1 = Untag packets upon egress at this port0 = Do not untag upon egress at this portR/W 0x00\nNote: Refer to Section 5.3.4, "VLAN Table," on page 162  for additional information on VLAN tables.\nAddress: 0x0408 - 0x040B Size: 32 bits\nBits Description Type Default\n31:6 RESERVED R/O 0x0000000\n5:0 PORT FORWARD\nThis field specifies the forwarding policy to each port. The policy is applied if \nthe FO bit is set.\nBits [5:0] correspond to ports [6:1] .\n1 = Forward to this port\n0 = Do not forward to this portR/W 0x00\nNote: Refer to Section 5.3.4, "VLAN Table," on page 162  for additional information on VLAN tables.\nAddress: 0x040C - 0x040D Size: 16 bits\nBits Description Type Default\n15:12 RESERVED RO 0x0\n11:0 VLAN Index\nThis value addresses the VLAN table, in combination with the VLAN table \naction in the following register.R/W 0x000\nNote: Refer to Section 5.3.4, "VLAN Table," on page 162  for additional information on VLAN tables.\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 103KSZ9896C\n5.1.5.5 VLAN Table Access Control Register \n5.1.5.6 ALU Table Index 0 Register \nThe ALU Table Index 0 Register  and ALU Table Index 1 Register  contain the index values for searching and reading/\nwriting the address lookup table as  specified by the action in the ALU Table Access Control Register . For additional infor-\nmation on ALU tables, refer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155 .Address: 0x040E Size: 8 bits\nBits Description Type Default\n7 Start VLAN Table Action\n1 = Start the action defined below0 = Action finishedR/W\nSC0b\n6:2 RESERVED RO 000_00b\n1:0 Action\nSpecify the action to be taken for the VLAN table entry addressed in the \nindex register\n00 = No operation01 = Write10 = Read11 = Clear all entries to zeroR/W 00b\nNote: Refer to Section 5.3.4, "VLAN Table," on page 162  for additional information on VLAN tables.\nAddress: 0x0410 - 0x0413 Size: 32 bits\nBits Description Type Default\n31 RESERVED R/W 0b\n30:23 RESERVED RO\n000_0000_0b\n22:16 FID Index [6:0]\nThis is the FID value used to hash index the tableR/W 000_0000b\n15:0 MAC Index [47:32]\nThese are the upper 16 bits of the MAC addressed used to hash index the \ntableR/W 0x0000\nKSZ9896C\nDS00002390A-page 104 \uf0e3 2017 Microchip Technology Inc.5.1.5.7 ALU Table Index 1 Register \nThe ALU Table Index 0 Register  and ALU Table Index 1 Register  contain the index values for searching and reading/\nwriting the address lookup table as  specified by the action in the ALU Table Access Control Register . For additional infor-\nmation on ALU tables, refer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155 .\n5.1.5.8 ALU Table Access Control Register \nThis register provides control and status for se arching and reading or writing the ALU Table. The ALU Table Index 0\nRegister  and ALU Table Index 1 Register  contain the index values, while the ALU / Static Address Table Entry 1 Register ,\nALU / Static Address / Reserved Multicast Table Entry 2 Register , ALU / Static Address Table Entry 3 Register , and ALU\n/ Static Address Table Entry 4 Register  are used for the entry values. Refer to Section 5.3.1, "Address Lookup (ALU)\nTable," on page 155  for additional information on ALU tables.Address: 0x0414 - 0x0417 Size: 32 bits\nBits Description Type Default\n31:0 MAC Index [31:0]\nThese are the lower 32 bits of the MAC addressed used to hash index the \naddress lookup table. If direct addressi ng is enabled, then bits [11:0] are \nused to directly index the address lookup table.R/W 0x00000000\nAddress: 0x0418 - 0x041B Size: 32 bits\nBits Description Type Default\n31:30 RESERVED RO 00b\n29:16 VALID_COUNT\nIndicates the total number of valid ent ries in the table after the search \nfinishesRO 0x0000\n15:8 RESERVED RO 0x00\n7 START_FINISH\n1 = Start the action defined below\n0 = Action finishedR/W, SC 0b\n6 VALID\nFor search operation. It is cleared when register 0x042F ( ALU / Static \nAddress Table Entry 4 Register ) is read.\n1 = Indicates that the next valid entry is ready0 = Next valid entry is not readyRO 0b\n5 VALID_ENTRY_OR_SEARCH_END\nFor search operation. It is intended for added convenience when accessing \nregisters by in-band management  (IBA) rather than SPI or I\n2C. It combines \nbits 6 and 7.\n1 = Indicates either that th e next valid entry is ready, or that the search has \nended.\n0 = Neither next valid entry ready nor search ended.RO 0b\n4:3 RESERVED R/W 00b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 105KSZ9896C\n5.1.5.9 Static Address and Reserved Multicast Table Control Register \nThis register provides control and index for reading and writing the Static Address Ta ble and the Reserved Multicast\nTable. The ALU / Static Address Table Entry 1 Register , ALU / Static Address / Reserved Multicast Table Entry 2 Reg-\nister, ALU / Static Address Table Entry 3 Register , and ALU / Static Address Table Entry 4 Register  are used for the\nStatic Address Table entry values, while only the ALU / Static Address / Reserved Multicast Table Entry 2 Register  is\nused for the Reserved Multicas t Table entry value. Refer to Section 5.3.2, "Static Address Table," on page 159  and Sec-\ntion 5.3.3, "Reserved Multicas t Address Table," on page 161  for additional information on these tables.2 DIRECT\n1 = Access by direct addressing the ALU Table. This method is used only for \ndebugging, if at all.\n0 = Hashing function is used to index t he table. This is the normal method. \nRefer to the Switch Lookup Engine Control 0 Register .R/W 0b\n1:0 ACTION\nSpecifies the action to be taken for the ALU Table entry access00 = No operation01 = Write10 = Read11 = SearchR/W 00b\nAddress: 0x041C - 0x041F Size: 32 bits\nBits Description Type Default\n31:22 RESERVED RO 0x000\n21:16 TABLE_INDEX\nBits [21:16] used to index t he Reserved Multicast Table\nBits [19:16] used to index the Static Address TableR/W 00_0000b\n15:8 RESERVED RO 0x00\n7 START_FINISH\n1 = Start access0 = Access is finishedR/W, SC 0b\n6:2 RESERVED R/W 000_00b\n1 TABLE_SELECT\nSpecifies which table is being accessed\n1 = Access Reserved Multicast Table\n0 = Access Static Address TableR/W 0b\n0 ACTION\nSpecifies the action to be taken for the table1 = Read0 = WriteR/W 0bBits Description Type Default\nKSZ9896C\nDS00002390A-page 106 \uf0e3 2017 Microchip Technology Inc.5.1.5.10 ALU / Static Address Table Entry 1 Register \nThis register contains the table entry values for read a nd write operations to the Ad dress Lookup Table and Static\nAddress Table. The field definitions of this register differ  dependent on the table type used, as defined in the following\nsections:\n•ALU Table Entry 1 Register on page 158\n•Static Address Table Entry 1 Register on page 160\nRefer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155  and Section 5.3.2, "Stati c Address Table," on\npage 159  for additional information.\n5.1.5.11 ALU / Static Address / Reserved Multicast Table Entry 2 Register \nThe field definitions of this register differ dependent on the table type used, as defin ed in the following sections:\n•ALU Table Entry 2 Register on page 158\n•Static Address Table Entry 2 Register on page 160\n•Reserved Multicast Address Table Entry 2 Register on page 162\nRefer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155 , Section 5.3.2, "Static Address Table," on page 159 ,\nand Section 5.3.3, "Reserved Multicast Address Table," on page 161  for additional information.\n5.1.5.12 ALU / Static Address Table Entry 3 Register \nThe field definitions of this register differ dependent on the table type used, as defin ed in the following sections:\n•ALU Table Entry 3 Register on page 159\n•Static Address Table Entry 3 Register on page 161\nRefer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155  and Section 5.3.2, "Stati c Address Table," on\npage 159  for additional information.\n5.1.5.13 ALU / Static Address Table Entry 4 Register \nThis register contains the table entry values for read a nd write operations to the Ad dress Lookup Table and Static\nAddress Table. The field definitions of this register differ  dependent on the table type used, as defined in the following\nsections:\n•ALU Table Entry 4 Register on page 159\n•Static Address Table Entry 4 Register on page 161\nRefer to Section 5.3.1, "Address Lookup (ALU) Table," on page 155  and Section 5.3.2, "Stati c Address Table," on\npage 159  for additional information.Address: 0x0420 - 0x0423 Size: 32 bits\nAddress: 0x0424 - 0x0427 Size: 32 bits\nAddress: 0x0428 - 0x042B Size: 32 bits\nAddress: 0x042C - 0x042F Size: 32 bits\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 107KSZ9896C\n5.2 Port Registers\nThis section details the device’s port registers. All settings are on a per-port basis. Address field “N” specifies the port\nnumber. Valid values for “N” are 1 to 6 for some registers, 6 for MAC port specific registers, and 0 to 5 for PHY specific\nregisters.\nFor an overview of the device’s entire register map, refer to Section 5.0, "Device Registers" . For details on the device’s\nglobal registers, refer to Section 5.1, "Global Registers" .\n5.2.1 PORT N: PORT OPERATION CONTROL REGISTERS ( 0xN000 - 0xN0FF )\n5.2.1.1 Port Default Tag 0 Register \n5.2.1.2 Port Default Tag 1 Register \n5.2.1.3 Port PME_WoL Event Register Address: 0xN000\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Port Default 802.1Q Tag [15:8]\nBits [7:5]: Priority Code Point (PCP)\nBit [4]: Drop Eligible Indicator (DEI)Bits [3:0]: VLAN Identifier (VID) [11:8]R/W 0x00\nAddress: 0xN001\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Port Default 80 2.1Q tag [7:0]\nVLAN Identifier (VID) [7:0]R/W 0x01\nAddress: 0xN013\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0000_0b\n2 Magic Packet Detect\nTo be detected, the destination address of the Magic Packet must match the \nGlobal Switch MAC Address in the Switch MAC Address 0 Register  through \nSwitch MAC Address 5 Register .\n1 = Magic Packet is detected at this port0 = Not detectedRO/WC 0b\nKSZ9896C\nDS00002390A-page 108 \uf0e3 2017 Microchip Technology Inc.5.2.1.4 Port PME_WoL Enable Register 1 Link Up Detect\nApplicable only to ports with integrated PHY.\n1 = Link up is detected at this port\n0 = Not detectedRO/WC 0b\n0 Energy Detect\nApplicable only to ports with integrated PHY.1 = Cable energy is detected at this port0 = Not detectedRO/WC 0b\nAddress: 0xN017\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0000_0b\n2 Magic Packet Detect Enable\nTo be detected, the destination address of the Magic Packet must match the \nGlobal Switch MAC Address in the Switch MAC Address 0 Register  through \nSwitch MAC Address 5 Register .\n1 = The PME pin will be asserted when a Magic Packet is detected at this \nport\n0 = The PME pin will not be asserted by Magic Packet detection at this portRO/WC 0b\n1 Link Up Detect Enable\nApplicable only to ports with integrated PHY.\n1 = The PME pin will be asserted when  link up is detected at this port\n0 = The PME pin will not be asserted by link up detection at this portRO/WC 0b\n0 Energy Detect Enable\nApplicable only to ports with integrated PHY.\n1 = The PME pin will be asserted when cable energy is detected at this port0 = The PME pin will not be asserted by cable energy detection at this portRO/WC 0bBits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 109KSZ9896C\n5.2.1.5 Port Interrupt Status Register \nThese registers provide interrupt status for the indi vidual ports. these interrupts are enabled in the Port Interrupt Mask\nRegister . For non-port specific interrupt status, refer to the Global Interrupt Status Register .\n5.2.1.6 Port Interrupt Mask Register \nThis register enables the interrupts in the Port Interrupt Status Register .Address: 0xN01B\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:2 RESERVED RO 0000b\n1 PHY Interrupt Status\nApplies only to PHY ports, not MAC port(s). Refer to the Port Interrupt \nControl / Status Register  for individual PHY interrupts.\n0 = No interrupt1 = Interrupt detectedRO 0b\n0 ACL Interrupt Status\nACL interrupts can be generated by configuring an entry in the ACL Table for \ncounter mode. All ports have an ACL Table.\nTo clear this bit, toggle the ACL Interrupt Mask bit in the Port Interrupt Mask \nRegister .\n0 = No interrupt1 = Interrupt detectedRO 0b\nAddress: 0xN01F\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:2 RESERVED RO 0000b\n1 PHY Interrupt Enable\nApplies only to PHY ports.0 = Interrupt enabled1 = Interrupt disabledR/W 0b\n0 ACL Interrupt Enable\nApplies to all ports.0 = Interrupt enabled1 = Interrupt disabledR/W 0b\nKSZ9896C\nDS00002390A-page 110 \uf0e3 2017 Microchip Technology Inc.5.2.1.7 Port Operation Control 0 Register \nAddress: 0xN020\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 Local Loopback\nData going from the internal switch fabric to an egress port is looped back at \nthat egress port and returned to the internal switch fabric. \n1 = Local loopback0 = Normal operationR/W 0b\n6 Remote Loopback\nData received at the external pins of  a port is looped back and sent out the \nsame port, without passing through the internal switch fabric. For PHY ports, data is received on the RX+/- pins and transmitted out the TX+/- pins. For xMII ports, data is received on t he TXD pins and transmitted on the RXD \npins. \n1 = Remote loopback0 = Normal operationR/W 0b\n5:3 RESERVED RO 000b\n2 Tail Tag Enable\nWhen tail tagging is enabled for a port, it designates that port to be the “host” \nor “CPU” port. Do not enable tail tagging for more than one port.\nSee the tail tagging description for details.1 = Enable tail tagging on this port0 = Disable tail tagging for this portR/W 0b\n1:0 Egress Queue Split Enable\n11 = Reserved10 = Four egress queues. Packets are assigned to a queue based on \npriority.\n01 = Two egress queues. Packets are assigned to a queue based on priority.00 = Single egress queue. There is no priority differentiation.R/W 00b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 111KSZ9896C\n5.2.1.8 Port Status Register \nAddress: 0xN030\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:5 RESERVED RO 000\n4:3 Port Speed Status\nFor non-PHY ports, these bits duplicate the speed setting in the XMII Port \nControl 1 Register  bit 6 and XMII Port Control 0 Register  bit 4.\nFor PHY ports, these bits indicate t he actual link speed, which is also \navailable in the PHY Control Register .\n00 = 10 Mb/s01 = 100 Mb/s10 = 1000 Mb/sRO -\n2 Port Duplex Status\nFor non-PHY ports, this bit duplicates the duplex setting in the XMII Port \nControl 0 Register  bit 6 .\nFor PHY ports, this bit indicates the actual link duplex, which is also available \nin the PHY Control Register . \n1 = Full duplex0 = Half duplexRO 1 or -\n1 Transmit Flow Control Enabled Status\nFor non-PHY ports, this bit duplicates the Tx FC enable bit 5 in the XMII Port \nControl 0 Register .\nFor PHY ports, this bit is set only when FC is enabled ( PHY Auto-Negotiation \nAdvertisement Register , bits 11:10), link is up and FC is established via auto-\nnegotiation.\n1 = TX flow control is enabled0 = DisabledRO -\n0 Receive Flow Control Enabled Status\nFor non-PHY ports, this bit duplicates the Rx FC enable bit 3 in the XMII Port \nControl 0 Register .\nFor PHY ports, this bit is set only when FC is enabled ( PHY Auto-Negotiation \nAdvertisement Register , bits 11:10), link is up and FC is established via auto-\nnegotiation.\n1 = RX flow control is enabled0 = DisabledRO -\nKSZ9896C\nDS00002390A-page 112 \uf0e3 2017 Microchip Technology Inc.5.2.2 PORT N: PORT ETHERNET PHY REGISTERS ( 0xN100 - 0xN1FF )\nThe registers in this section are for PHY ports only. Refer to the IEEE802.3 clause 22.3.4 for additional details. \n5.2.2.1 PHY Basic Control Register \nPHY register 0x00.Address: 0xN100 - 0xN101\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 PHY Software Reset\nSet this bit to reset this PHY. Registers are not reset. This bit is self-clearing.R/W\nSC0b\n14 Local Loopback Mode\nData going from the internal switch fabric to an egress port is looped back at \nthat egress port and returned to the internal switch fabric. \n1 = Local Loopback mode0 = Normal operationR/W 0b\n13 Speed Select (LSB)\nThis bit is ignored if auto-negotiation is enabled (bit 12 in this register).\nBits [6, 13]\n11 = Reserved\n10 = 1000 Mb/s\n01 = 100 Mb/s\n00 = 10 Mb/sR/W Note 5-4\n12 Auto-Negotia tion Enable\n1 = Auto-negotiation is enabled0 = Auto-negotiation is disabledThe initial value of this bit is determine d by a strapping option, but it may be \noverwritten.R/W Note 5-4\n11 Power Down\n1 = Power-down mode0 = Normal operationWhen this bit is set to ‘1’, the link-down status might not get updated in the \nPHY status register. Softwa re should note link is down and should not rely on \nthe PHY status register link status.\nAfter this bit is changed from ‘1’ to ‘0’,  an internal reset is performed. Wait a \nminimum of 1ms before read/write access to this PHY’s registers.R/W 0b\n10 Isolate\n1 = Logical isolation of the PHY from the switch core0 = Normal operationR/W 0b\n9 Re-start Auto-Negotiation\nSet this bit to re-start auto-negotiation. This bit is self-clearing.R/W, SC 0b\n8 Duplex Mode\nThis bit is ignored if auto-negotiation is enabled (bit 12 in this register).\n1 = Full duplex\n0 = Half duplexR/W 1b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 113KSZ9896C\nNote 5-4 The default value of this field is determined by the associated configuration strap value. Refer to\nSection 3.2.1, "Configuration Straps," on page 17  for additional information.\n5.2.2.2 PHY Basic Status Register \nPHY register 0x01. 7 Collision Test\n1 = Enable COL test0 = Disable COL testR/W 0b\n6 Speed Select (MSB)\nThis bit is ignored if auto-negotiation is enabled (bit 12 in this register).\nBits [6, 13]\n11 = Reserved10 = 1000 Mb/s01 = 100 Mb/s00 = 10 Mb/sR/W Note 5-4\n5:0 RESERVED RO 0x00\nAddress: 0xN102 - 0xN103\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 100BASE-T4\n0 = PHY is not 100BASE-T4 capableRO 0b\n14 100BASE-TX Full Duplex\n1 = PHY is 100BASE-TX full-duplex capableRO 1b\n13 100BASE-TX Half Duplex\n1 = PHY is 100BASE-TX half-duplex capableRO 1b\n12 10 Mb/s Full Duplex\n1 = PHY is 10 Mb/s full-duplex capableRO 1b\n11 10 Mb/s Half Duplex\n1 = PHY is 10 Mb/s half-duplex capableRO 1b\n10:9 RESERVED RO 00b\n8 Extended Status\n1 = PHY Extended Status Register  contains extended status information.RO 1b\n7 RESERVED RO 0b\n6 MF Preamble Suppression\n1 = PHY will accept management fr ames with preamble suppressedRO 1b\n5 Auto-negotiati on Complete\n1 = Auto-negotiation process is complete0 = Auto-negotiation process is not completeRO -\n4 Remote (Far End) Fault\n1 = Remote fault condition detected0 = No remote fault detectedRO\nLH-Bits Description Type Default\nKSZ9896C\nDS00002390A-page 114 \uf0e3 2017 Microchip Technology Inc.5.2.2.3 PHY ID High Register \nPHY register 0x02. \n5.2.2.4 PHY ID Low Register \nPHY register 0x03. 3 Auto-Negotiation Ability\n1 = PHY is able to perform auto-negotiationRO 1b\n2 Link Status\n1 = Link is up0 = Link is downRO\nLL-\n1 Jabber Detect\n1 = Jabber condition detected0 = No jabber condition detectedRO\nLH-\n0 Extended Capability\n1 = Supports extended capabilities register0 = Basic register set capabilities onlyRO 1b\nAddress: 0xN104 - 0xN105\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:0 PHY Identifier High Word RO 0x0022\nAddress: 0xN106 - 0xN107\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:0 PHY Identifier Low Word RO 0x1631Bits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 115KSZ9896C\n5.2.2.5 PHY Auto-Negotiation Advertisement Register \nPHY register 0x04. Address: 0xN108 - 0xN109\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Next Page\n1 = Next page capable0 = No next page capabilityR/W 0b\n14 Reserved RO 0b\n13 Remote Fault\n1 = Remote fault capable0 = No remote fault capabilityR/W 0b\n12 RESERVED RO 0b\n11:10 Pause (Flow Control) Capability\n11 = Both Symmetric PAUSE and Asymmetric PAUSE toward local device10 = Asymmetric PAUSE toward link partner01 = Symmetric PAUSE00 = No PAUSER/W 01b\n9 100BASE-T4\n1 = 100BASE-T4 capable0 = No 100BASE-T4 capabilityRO 0b\n8 100BASE-TX Full Duplex\n1 = 100BASE-TX full duplex capable0 = No 100BASE-TX full duplex capabilityR/W 1b\n7 100BASE-TX Half Duplex\n1 = 100BASE-TX half duplex capable0 = No 100BASE-TX half duplex capabilityR/W 1b\n6 10BASE-T Full Duplex\n1 = 10BASE-T full duplex capable0 = No 10BASE-T full duplex capabilityR/W 1b\n5 10BASE-T Half Duplex\n1 = 10BASE-T half duplex capable0 = No 10BASE-T half duplex capabilityR/W 1b\n4:0 Selector Field\n00001 = IEEE 802.3R/W 0x01\nKSZ9896C\nDS00002390A-page 116 \uf0e3 2017 Microchip Technology Inc.5.2.2.6 PHY Auto-Negotiation Link Partner Ability Register \nPHY register 0x05.Address: 0xN10A - 0xN10B\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Next Page\n1 = Next page capable0 = No next page capabilityRO -\n14 Acknowledge\n1 = Link code word received from partner0 = Link code word not yet receivedRO -\n13 Remote Fault\n1 = Remote fault detected0 = No remote fault RO -\n12 RESERVED RO -\n11:10 Pause (Flow Control) Capability\n11 = Both Symmetric PAUSE and Asy mmetric PAUSE toward local device\n10 = Asymmetric PAUSE toward link partner01 = Symmetric PAUSE00 = No PAUSERO -\n9 100BASE-T4\n1 = 100BASE-T4 capable0 = No 100BASE-T4 capabilityRO -\n8 100BASE-TX Full Duplex\n1 = 100BASE-TX full duplex capable0 = No 100BASE-TX full duplex capabilityRO -\n7 100BASE-TX Half Duplex\n1 = 100BASE-TX half duplex capable0 = No 100BASE-TX half  duplex capabilityRO -\n6 10BASE-T Full Duplex\n1 = 10BASE-T full duplex capable0 = No 10BASE-T full duplex capabilityRO -\n5 10BASE-T Half Duplex\n1 = 10BASE-T half duplex capable0 = No 10BASE-T half duplex capabilityRO -\n4:0 Selector Field\n00001 = IEEE 802.3RO -\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 117KSZ9896C\n5.2.2.7 PHY Auto-Negotiation Expansion Status Register \nPHY register 0x06. \n5.2.2.8 PHY Auto-Negotiation Next Page Register \nPHY register 0x07. Address: 0xN10C - 0xN10D\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:5 RESERVED RO 0x000\n4 Parallel Detection Fault\n1 = Fault detected by parallel detection0 = No fault detected by parallel detectionRO\nLH-\n3 Link Partner Next Page Able\n1 = Link partner has next page capability0 = Link partner does not have next page capabilityRO -\n2 Next Page Able\n1 = Local device has next page capability0 = Local device does not have next page capabilityRO 1b\n1 Page Received\n1 = New page received0 = New page not receivedRO\nLH-\n0 Link Partner Auto-Negotiation Able\n1 = Link partner has auto-negotiation capability0 =Link partner does not have auto-negotiation capabilityRO -\nAddress: 0xN10E - 0xN10F\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Next Page\n1 = Additional next page(s) will follow0 = Last pageR/W 0b\n14 Reserved RO 0b\n13 Message Page\n1 = Message page0 = Unformatted pageR/W 1b\n12 Acknowledge 2\n1 = Will comply with message0 = Cannot comply with messageR/W 0b\nKSZ9896C\nDS00002390A-page 118 \uf0e3 2017 Microchip Technology Inc.5.2.2.9 PHY Auto-Negotiation Link Partner Next Page Ability Register \nPHY register 0x08. 11 Toggle\n1 = Previous value of transmitted link code word equaled logic one\n0 = Previous value of transmitted link code word equaled logic zeroRO 0b\n10:0 Message Field R/W 0x001\nAddress: 0xN110 - 0xN111\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Next Page\n1 = Additional next page(s) will follow0 = Last pageR/W -\n14 Acknowledge\n1 = Successful receipt of link word0 = No successful receipt of link wordRO -\n13 Message Page\n1 = Message page0 = Unformatted pageRO -\n12 Acknowledge 2\n1 = Able to act on the information\n0 = Not able to act on the informationRO -\n11 Toggle\n1 = Previous value of transmitted link code word equaled logic zero0 = Previous value of transmitted link code word equaled logic oneRO -\n10:0 Message Field RO -Bits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 119KSZ9896C\n5.2.2.10 PHY 1000BASE-T  Control Register \nPHY register 0x09. \n5.2.2.11 PHY 1000BASE-T Status Register \nPHY register 0x0A. Address: 0xN112 - 0xN113\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:13 Test Mode Bits R/W 000b\n12 Master-Slave Manual Configuration Enable\n1 = Enable master-slave manual configuration0 = Disable master-slave manual configurationR/W 0b\n11 Master-Slave Manual Configuration Value\nThis bit is ignored if master-slave man ual configuration is disabled (bit 12)\n1 = Configure PHY as master du ring master-slave negotiation\n0 = Configure PHY as slave during master-slave negotiationR/W 0b\n10 Port Type\nThis bit is valid only if master-slave m anual configuration is disabled (bit 12)\n1 = Indicate the preference to operate as multi-port device (master)0 = Indicate the preference to operate as single-port device (slave)R/W 0b\n9 1000BASE-T Full Duplex\n1 = Advertise that PHY is 1 000BASE-T full d uplex capable\n0 = Advertise that PH Y is not 1000BASE-T full duplex capableR/W 1b\n8 1000BASE-T Half Duplex\n1 = Advertise that PHY is 1 000BASE-T half duplex capable\n0 = Advertise that PH Y is not 1000BASE-T ha lf duplex capableR/W 1b\n7:0 RESERVED RO -\nAddress: 0xN114 - 0xN115\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Master-Slave Configuration Fault\n1 = Master-slave configuration fault detected0 = No master-slave configuration fault detectedRO\nLH\nSC0b\n14 Master-Slave Configuration Resolution\n1 = Local PHY configuration resolved to master0 = Local PHY configuration resolved to slaveRO -\n13 Local Receiver Status\n1 = Local receiver OK0 = Local receiver not OKRO -\nKSZ9896C\nDS00002390A-page 120 \uf0e3 2017 Microchip Technology Inc.5.2.2.12 PHY MMD Setup Register \nPHY register 0x0D. 12 Remote Receiver Status\n1 = Remote receiver OK0 = Remote receiver not OKRO -\n11 Link Partner 1000BASE-T Full Duplex Capability\n1 = Link partner is capable of 1000BASE-T full duplex0 = Link partner is not capab le of 1000BASE-T full duplexRO -\n10 Link Partner 1000BASE-T Half Duplex Capability\n1 = Link partner is capable of 1000BASE-T half duplex0 = Link partner is not capab le of 1000BASE-T half duplexRO -\n9:8 RESERVED RO 00b\n7:0 Idle Error Count\nCumulative count of errors detected when receiver is receiving idles and \nPMA_TXMODE.indicate = Send_N. \nThe counter is incremented every sym bol period that rxerror_status = \nERROR. RO\nSC0x00\nAddress: 0xN11A - 0xN11B\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:14 MMD Operation Mode\nFor the selected MMD device address (bits [4:0] of this register), these two \nbits select one of the following register  or data operations and the usage for \nthe PHY MMD Data Register .\n00 = Register01 = Data, no post increment10 = Data, post increment on reads and writes11 = Data, post increment on writes onlyR/W 00b\n13:5 RESERVED R/W 0x000\n4:0 MMD Device Address R/W 0x00Bits Description Type Default\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 121KSZ9896C\n5.2.2.13 PHY MMD Data Register \nPHY register 0x0E. \n5.2.2.14 PHY Extended Status Register \nPHY register 0x0F. Address: 0xN11C - 0xN11D\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:0 MMD R/W Index/Data\nFor the selected MMD device address (in the PHY MMD Setup Register , bits \n[4:0]): \nWhen the PHY MMD Setup Register  bits [15:14] = 00, this register contains \nthe read/write regi ster access for the MDD device address.\nOtherwise, this register contains t he read/write data value for the MMD \ndevice address and its selected register address\nRefer to the PHY MMD Setup Register  bits [15:14] for descriptions of post \nincrement reads and writes of th is register for data operation.R/W 0x0000\nAddress: 0xN11E - 0xN11F\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 1000BASE-X Full-Duplex\n1 = PHY able to perf orm 1000BASE-T full duplex\n0 = PHY cannot perfor m 1000BASE-T full-duplexRO 0b\n14 1000BASE-X Half-Duplex\n1 = PHY able to perfor m 1000BASE-T half duplex\n0 = PHY cannot perfor m 1000BASE-T half-duplexRO 0b\n13 1000BASE-T Full-Duplex\n1 = PHY able to perf orm 1000BASE-T full duplex\n0 = PHY cannot perfor m 1000BASE-T full-duplexRO 1b\n12 1000BASE-T Half-Duplex\n1 = PHY able to perfor m 1000BASE-T half duplex\n0 = PHY cannot perfor m 1000BASE-T half-duplexRO 1b\n11:0 RESERVED RO –\nKSZ9896C\nDS00002390A-page 122 \uf0e3 2017 Microchip Technology Inc.5.2.2.15 PHY Remote Loopback Register \nPHY register 0x11. \n5.2.2.16 PHY LinkMD Register \nPHY register 0x12. Address: 0xN122 - 0xN123\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:9 RESERVED R/W 0x00\n8 Remote Loopback\nData received at the external pins of  a port is looped back and sent out the \nsame port, without passing through the internal switch fabric. For PHY ports, data is received on the RX+/- pins and transmitted out the TX+/- pins. For xMII ports, data is received on t he TXD pins and transmitted on the RXD \npins. \n1 = Remote loopback0 = Normal operationR/W 0b\n7:2 RESERVED R/W 1111_01b\n1 RESERVED R/W\nRC0b\n0 RESERVED RO 0b\nAddress: 0xN124 - 0xN125\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Cable Diagnostic Test Enable\nWrite value:1 = Enable cable diagnostic test. After test has completed, this bit is self-\ncleared.\n0 = Disable cable diagnostic test.Read value:1 = Cable diagnostic test is in progress.0 = Indicates cable diagnostic test (i f enabled) has completed and the status \ninformation is valid for read.R/W, SC 0b\n14 RESERVED R/W 0b\n13:12 Cable Diagnostic Test Pair\nThese two bits select the differential pair for testing:00 = Differential pair A01 = Differential pair B\n10 = Differential pair C\n11 = Differential pair DR/W 00b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 123KSZ9896C\n5.2.2.17 PHY Digital PMA/PCS Status Register \nPHY register 0x13. \n5.2.2.18 Port RXER Count Register \nPHY register 0x15. 11:10 RESERVED R/W 00b\n9:8 Cable Diagnostic Status\n00 = Normal cable condition (no fault detected)01 = Open cable fault detected10 = Short cable fault detected11 = ReservedRO 00b\n7:0 RESERVED RO 0x00\nAddress: 0xN126 - 0xN127\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:2 RESERVED RO\nLH0x0000\n1 1000BASE-T Link Status\n1 = Link is up0 = Link is downRO -\n0 100BASE-TX Link Status\n1 = Link is up0 = Link is downRO -\nAddress: 0xN12A - 0xN12B\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:0 RXER Counter\nCount of receive frames with one or more symbol errors.RO\nRC0x0000Bits Description Type Default\nKSZ9896C\nDS00002390A-page 124 \uf0e3 2017 Microchip Technology Inc.5.2.2.19 Port Interrupt Control / Status Register \nPHY register 0x1B. Address: 0xN136 - 0xN137\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15 Jabber Interrupt Enable\n1 = Enable jabber interrupt0 = Disable jabber interruptR/W 0b\n14 Receive Error Interrupt Enable\n1 = Enable receive error interrupt0 = Disable receive error interruptR/W 0b\n13 Page Received Interrupt Enable\n1 = Enable page received interrupt0 = Disable page received interruptR/W 0b\n12 Parallel Detect Fa ult Interrupt Enable\n1 = Enable parallel detect fault interrupt0 = Disable parallel detect fault interruptR/W 0b\n11 Link Partner Acknowledge Interrupt Enable\n1 = Enable link partner acknowledge interrupt0 = Disable link partner acknowledge interruptR/W 0b\n10 Link Down Interrupt Enable\n1 = Enable link down interrupt0 = Disable link down interruptR/W 0b\n9 Remote Fault In terrupt Enable\n1 = Enable remote fault interrupt0 = Disable remote fault interruptR/W 0b\n8 Link Up Interrupt Enable\n1 = Enable link up interrupt0 = Disable link up interruptR/W 0b\n7 Jabber Interrupt\n1 = Jabber occurred0 = Jabber did not occurRO\nRC0b\n6 Receive Error Interrupt\n1 = Receive e rror occurred\n0 = Receive error did not occurRO\nRC0b\n5 Page Received Interrupt\n1 = Page receive occurred0 = Page receive did not occurRO\nRC0b\n4 Parallel Detect Fault Interrupt\n1 = Parallel detect fault occurred0 = Parallel detect fault did not occurRO\nRC0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 125KSZ9896C\n5.2.2.20 PHY Auto MDI / MDI-X Register \nPHY register 0x1C. 3 Link Partner Acknowledge Interrupt\n1 = Link partner acknowledge occurred0 = Link partner acknowledge did not occurRO\nRC0b\n2 Link Down Interrupt\n1 = Link down occurred0 = Link down did not occurRO\nRC0b\n1 Remote Fault Interrupt\n1 = Remote fault occurred0 = Remote fault did not occurRO\nRC0b\n0 Link Up Interrupt\n1 = Link up occurred0 = Link up did not occurRO\nRC0b\nAddress: 0xN138 - 0xN139\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:8 RESERVED R/W 0x00\n7 MDI Set\nWhen Swap-Off bit is one,\n1 = PHY is set to operate in MDI mode0 = PHY is set to operate in MDI-X mode\nThis bit has no function when Swap-Off is zero.R/W 0b\n6 Swap-Off\n1 = Disable Auto MDI / MDI-X function0 = Enable Auto MDI / MDI-X function (normal operation)R/W 0b\n5:0 RESERVED R/W 0x00Bits Description Type Default\nKSZ9896C\nDS00002390A-page 126 \uf0e3 2017 Microchip Technology Inc.5.2.2.21 PHY Control Register \nPHY register 0x1F. Address: 0xN13E - 0xN13F\nPort N: 1-5Size: 16 bits\nBits Description Type Default\n15:12 RESERVED R/W 0x0\n11:10 RESERVED RO\nLH\nRC00b\n9 Enable Jabber\n1 = Enable jabber counter0 = Disable jabber counterR/W 1b\n8:7 RESERVED R/W 10b\n6 Speed Status 1000BASE-T\n1 = PHY final speed status is 1000BASE-TRO -\n5 Speed Status 100BASE-TX\n1 = PHY final speed status is 100BASE-TXRO -\n4 Speed Status 10BASE-T\n1 = PHY final speed status is 10BASE-TRO -\n3 Duplex Status\n1 = Full duplex0 = Half duplexRO -\n2 1000BASE-T Master / Slave Status\n1 = 1000BASE-T master mode0 = 1000BASE-T slave modeRO -\n1 RESERVED R/W\nRC0b\n0 RESERVED RO\nRC-\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 127KSZ9896C\n5.2.3 PORT N: PORT RGMII/GMII/MII/RMII CONTROL REGISTERS ( 0xN300 - 0xN3FF )\n5.2.3.1 XMII Port Control 0 Register \nNote 5-5 The default value of this field is determined by the LED1_1  configuration strap value. Refer to Section\n3.2.1, "Configuration Straps," on page 17  for additional information.\nNote 5-6 The default value of this field is determined by the RX_ER6/RX_CLK6  configuration strap value.\nRefer to Section 3.2.1, "Configur ation Straps," on page 17  for additional information.Address: 0xN300\nPort N: 6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6 MAC Port Duplex\n1 = Port MAC interface operates in full-duplex mode0 = Port MAC interface operates in half-duplex modeR/W 1b\n5 MAC Port Transmit Flow Control Enable\n1 = Enable transmit flow control on this port0 = Disable transmit flow control on this portR/W Note 5-5\n4 MAC Port Speed 10/100\nThis bit is ignored if bit 6 in the XMII Port Control 1 Register  selects 1000 Mb/\ns. \nIf bit 6 in the XMII Port Control 1 Register  is one, then this bit determines the \nport speed:\n1 = Port operates at 100 Mb/s0 = Port operates at 10 Mb/sR/W 1b\n3 MAC Port Receive Flow Control Enable\n1 = Enable receive flow control on this port\n0 = Disable receive flow control on this portR/W Note 5-5\n2:1 RESERVED R/W 00b\n0 RESERVED\nGMII/MII Clock Mode\nThese modes affect the GMII and MII clocks for outgoing data on the Port 6 \nRX signals.\n1 = 3-Wire mode. Pin 72 ( RX_CLK6/REFCLKO6 ) is used for the GMII out-\nput clock, and pin 75 ( RX_ER6/RX_CLK6 ) is used for the MII input clock \nwhen in MAC mode. 3-Wire mode is in tended as an option, when in MAC \nmode, for connection to a 1000/100/10Mbps PHY which has separate pins for the GMII (1000Mbps) GTX_CLK clock and the MII (100/10Mbps) TX_CLK \nclock.\n0 = 2-Wire mode. Pin 72 ( RX_CLK6/REFCLKO6 ) is used for either the GMII \noutput clock or the MII clock.\nNote: When the MAC interface does not need to be switchable between\nGMII and MII, or when in PHY mode, do not select 3-Wire mode.R/W Note 5-6\nKSZ9896C\nDS00002390A-page 128 \uf0e3 2017 Microchip Technology Inc.5.2.3.2 XMII Port Control 1 Register \nAddress: 0xN301\nPort N: 6Size: 8 bits\nBits Description Type Default\n7 RESERVED R/W 0b\n6 Port Speed 1000 \n1 = RGMII operates at 10 or 100 Mb/s, as determined by bit 4 in the XMII Port \nControl 0 Register\n0 = RGMII operates at 1000 Mb/sR/W  Config. strap \nvalue from \nRXD6_0\n5 RESERVED R/W 0b\n4 RGMII Ingress Internal Delay (RGMII_ID_ig)\n1 = Minimum 1.5 ns delay is added to ingress RGMII clock0 = No delay is addedR/W 0b\n3 RGMII Egress Internal Delay (RGMII_ID_eg)\n1 = Minimum 1.5 ns delay is added to egress RGMII clock0 = No delay is addedR/W 1b\n2 MII / RMII Modes \nFor MII interface:\n1 = The MII interface operates as a MAC device (receives clocks, etc.)\n0 = The MII interface operates as a PHY device (drives clocks, etc.)\nFor RMII interface:\n1 = The 50 MHz RMII REFCLK is received at the RXC pin0 = A 50 MHz RMII REFCLK is generated from the RXC pinR/W  Config. strap \nvalue from \nRXD6_1\n1:0 Port Interface Type Select\n00 = Interface is RGMII01 = Interface is RMII10 = Interface is GMII (if bit 6 = 0) or MII (if bit 6 = 1)11 = Interface is MIIR/W Config. \nstrap value \nfrom \nRXD6_[3:2]\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 129KSZ9896C\n5.2.4 PORT N: PORT SWITCH  MAC CONTROL REGISTERS ( 0xN400 - 0xN4FF )\n5.2.4.1 Port MAC Control 0 Register \n5.2.4.2 Port MAC Control 1 Register Address: 0xN400\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:4 RESERVED RO 0x0\n3 RESERVED R/W 0b\n2 RESERVED RO 0b\n1 Broadcast Storm Protection Enable\n1 = Enable broadcast storm protection for ingress traffic\n0 = Disable broadcast storm protection for ingress trafficR/W 0b\n0 Jumbo Packet Enable\n1 = Accept packets sizes up to 9000 bytes payload (excludes header and \nCRC)\n0 = Standard payload limit of 1500 bytes appliesR/W 0b\nAddress: 0xN401\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED R/W 0b\n6 RESERVED RO 0b\n5:4 RESERVED R/W 00b\n3 Back pressure Enable\nBack pressure is used only for half duplex. Full duplex uses PAUSE frame \nflow control which is enabled separately .\n1 = Enable port back pressure\n0 = Disable port back pressureR/W 0b\n2:1 Reserved R/W 00b\n0 Pass All Frames\nBad frames (CRC error, too large, to o small) are normally dropped. This \nfeature allows them to be forwarded for mirroring purposes only. \nThis bit does not affect filtering of flow  control frames. To disable filtering of \nflow control frames, refer to the Switch MAC Control 4 Register .\n1 = Enable0 = DisableR/W 0b\nKSZ9896C\nDS00002390A-page 130 \uf0e3 2017 Microchip Technology Inc.5.2.4.3 Port Ingress Rate Limit Control Register \nAddress: 0xN403\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6 Port or Priority Based Ingress Rate Limiting\n1 = Ingress rate limiting is port based0 = Ingress rate limiti ng is priority basedR/W 0b\n5 Ingress PPS Mode\n1 = Ingress rate limiting is based on number of packets (PPS mode enabled)\n0 = Ingress rate limiting is based on number of bits (PPS mode disabled)R/W 0b\n4 Ingress Rate Limit Flow Control Enable\nTo use this feature, flow control must also be enabled for this port. Refer to \nthe XMII Port Control 0 Register  for non-PHY ports, and the PHY Auto-\nNegotiation Advertisement Register  for PHY ports.\n1 = Flow control is asserted if the port’s receive rate is exceeded0 = Flow control is not asserted based on ingress rate limitsR/W 0b\n3:2 Ingress Limit Mode\nThese bits determine what kind of fr ames are limited and counted against \ningress rate limiting.\n00 = Count and limit all frames01 = Count and limit broadcast, multicast and flooded unicast frames only10 = Count and limit broadcast and multicast frames only11 = Count and limit broadcast frames onlyR/W 00b\n1 Count IFG Bytes\n1 = Each frame’s minimum inter-frame gap (IFG) bytes (12 per frame) are \nincluded in ingress rate limiting calculations\n0 = IFG byte count is not includedR/W 0b\n0 Count Preamble Bytes\nNot valid when PPS mode is enabled (bit 5)1 = Each frame’s preamble bytes (8 per frame) are included in ingress rate \nlimiting calculations\n0 = Preamble byte count is not includedR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 131KSZ9896C\n5.2.4.4 Port Priority 0 Ingress Limit Control Register \nAddress: 0xN410\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 Reserved RO 0b\n6:0 Ingress Data Rate Limi t for Priority 0 Frames\nReference Table 5-3  for code values .\nNote that the update will no t take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nTABLE 5-3: DATA RATE SELECTION TABL E FOR INGRESS AND EGRESS RATE LIMITING\nCode 10Mbps 100Mbps 1000Mbps\n7 bits, \ndecimalPPS BPS PPS BPS PPS BPS\n7d’0 19.2k 10Mbps 192k 100Mbps 1.92M 1000Mbps\n7d’1 – \n7d’101.92k * code 1Mbps * code 1.92k * code 1Mbps * code 19.2k * code 1Mbps * code\n7d’11 – \n7d’100– 10Mbps 1.92k * code 1Mbps * code 19.2k * code 10Mbps * code\n7d’101 64 64kbps 64 640kbps 640 640kbps\n7d’102 128 128kbps 128 1280kbps 1280 1280kbps\n7d’103 256 192kbps 256 1920kbps 2560 1920kbps7d’104 384 256kbps 384 256kbps 3840 2560kbps\n7d’105 512 320kbps 512 320kbps 5120 3200kbps\n7d’106 640 384kbps 640 384kbps 6400 3840kbps\n7d’107 768 448kbps 768 448kbps 7680 4480kbps\n7d’108 896 512kbps 896 512kbps 8960 5120kbps\n7d’109 1024 576kbps 1024 576kbps 10,240 5760kbps\n7d’110 1152 640kbps 1152 640kbps 11,520 6400kbps7d’111 1280 704kbps 1280 704kbps 12,800 7040kbps\n7d’112 1408 768kbps 1408 768kbps 14,080 7680kbps\n7d’113 1536 832kbps 1536 832kbps 15,360 8320kbps\n7d’114 1664 896kbps 1664 896kbps 16,640 8960kbps\n7d’115 1792 960kbps 1792 960kbps 17,920 9600kbps\nNote: PPS = Packets Per Second, BPS = Bits Per Second.\nKSZ9896C\nDS00002390A-page 132 \uf0e3 2017 Microchip Technology Inc.5.2.4.5 Port Priority 1 Ingress Limit Control Register \n5.2.4.6 Port Priority 2 Ingress Limit Control Register \n5.2.4.7 Port Priority 3 Ingress Limit Control Register Address: 0xN411\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 1 Frames\nNote that the update will not take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN412\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 2 Frames\nNote that the update will not take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN413\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 3 Frames\nNote that the update will not take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 133KSZ9896C\n5.2.4.8 Port Priority 4 Ingress Limit Control Register \n5.2.4.9 Port Priority 5 Ingress Limit Control Register \n5.2.4.10 Port Priority 6 Ingress Limit Control Register \n5.2.4.11 Port Priority 7 Ingress Limit Control Register Address: 0xN414\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 4 Frames\nNote that the update will no t take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN415\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 5 Frames\nNote that the update will no t take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN416\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 6 Frames\nNote that the update will no t take effect until the Port Priority 7 Ingress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN417\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Ingress Data Rate Limi t for Priority 7 Frames R/W 0x00\nKSZ9896C\nDS00002390A-page 134 \uf0e3 2017 Microchip Technology Inc.5.2.4.12 Port Queue 0 Egress Limit Control Register \n5.2.4.13 Port Queue 1 Egress Limit Control Register \n5.2.4.14 Port Queue 2 Egress Limit Control Register Address: 0xN420\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Egress Data Rate Limit for Queue 0 Frames\nWhen egress rate limiting is configured to “port-based” via bit 3 of the Switch \nMAC Control 5 Register , only this register is used for setting. The Port \nQueue 1-3 Egress Limit Control Registers are used only for queue-based rate limiting.\nNote that the update will not take effect until the Port Queue 3 Egress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN421\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Egress Data Rate Limit for Queue 1 Frames\nNote that the update will not take effect until the Port Queue 3 Egress Limit \nControl Register  is written.R/W 0x00\nAddress: 0xN422\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Egress Data Rate Limit for Queue 2 Frames\nNote that the update will not take effect until the Port Queue 3 Egress Limit \nControl Register  is written.R/W 0x00\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 135KSZ9896C\n5.2.4.15 Port Queue 3 Egress Limit Control Register \n5.2.5 PORT N: PORT SWITCH MIB COUNTERS REGISTERS ( 0xN500 - 0xN5FF )\nThirty MIB counters are provided for each port. They are a ccessed via the following two indi rect registers. MIB Counters\nare read-clear. Refer to Section 5.3.6, "Management Info rmation Base (MIB) Counters"  for additional details.\n5.2.5.1 Port MIB Control and Status Register Address: 0xN423\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Egress Data Rate Li mit for Queue 3 Frames R/W 0x00\nNote: The Switch MIB Control Register  contains two additional bits for global control of MIB counters.\nAddress: 0xN500 - 0xN503\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31 MIB Counter Over flow Indication\n1 = Counter has overflowed0 = Counter has not overflowedRO 0b\n30:26 RESERVED RO 0x00\n25 MIB Read Enable / Count Valid\nSet this bit to ‘1’ to initiate a counter  read. When the counter read is complete \nand the count value is available in the MIB Counter Value, this bit will automatically clear to ‘0’.R/W\nSC0b\n24 MIB Flush and Freeze Enable\nRefer to the Switch MIB Control Register  for the associated global MIB \ncontrol bits for flushing and freezing port counters.\n1 = Enable MIB counter flush and freeze function for this port0 = Disable MIB counter flush and  freeze function for this portR/W 0b\n23:16 MIB Index R/W 0x00\n15:4 RESERVED RO 0x000\n3:0 MIB Counter Value [35:32] RO 0x0\nKSZ9896C\nDS00002390A-page 136 \uf0e3 2017 Microchip Technology Inc.5.2.5.2 Port MIB Data Register \n5.2.6 PORT N: PORT SWITCH ACL CONTROL REGISTERS ( 0xN600 - 0xN6FF )\nAn Access Control List (ACL) Table is provided for each port. It is accessed via the following two indirect registers. Refer\nto Section 5.3.5, "Access Control List (ACL) Table"  for additional details.\n5.2.6.1 Port ACL Access 0 Register \n5.2.6.2 Port ACL Access 1 Register Address: 0xN504 - 0xN507\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:0 MIB Counter Value [31:0] RO 0x0000\nAddress: 0xN600\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:4 RESERVED RO 0x0\n3:0 First Rule Number (FRN) R/W 0x0\nAddress: 0xN601\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:6 RESERVED R/W 00b\n5:4 Mode\n00 = No action taken01 = Layer 2 MAC header filtering10 = Layer 3 IP address filtering11 = Layer 4 TCP port number  / IP protocol filteringR/W 00b\n3:2 Enable  R/W 00b\n1 Source / Destination\n1 = Source0 = DestinationR/W 0b\n0 Compare Equal\n1 = Match if the compared values are equal0 = Match if the compared values are not equalR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 137KSZ9896C\n5.2.6.3 Port ACL Access 2 Register \n5.2.6.4 Port ACL Access 3 Register \n5.2.6.5 Port ACL Access 4 Register \n5.2.6.6 Port ACL Access 5 Register \n5.2.6.7 Port ACL Access 6 Register Address: 0xN602\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [47:40] R/W 0x00\nAddress: 0xN603\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [39:32] R/W 0x00\nAddress: 0xN604\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [31:24] R/W 0x00\nAddress: 0xN605\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [23:16] R/W 0x00\nAddress: 0xN606\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [15:8] R/W 0x00\nKSZ9896C\nDS00002390A-page 138 \uf0e3 2017 Microchip Technology Inc.5.2.6.8 Port ACL Access 7 Register \n5.2.6.9 Port ACL Access 8 Register \n5.2.6.10 Port ACL Access 9 Register \n5.2.6.11 Port ACL Access A Register Address: 0xN607\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 MAC Address [7:0] R/W 0x00\nAddress: 0xN608\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 EtherType [15:8] R/W 0x00\nAddress: 0xN609\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 EtherType [7:0] R/W 0x00\nAddress: 0xN60A\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:6 Priority Mode (PM) R/W 00b\n5:3 Priority R/W 00_0b\n2 Remark Priority Enable (RPE) R/W 0b\n1:0 Remark Priority [2:1]\nThe two MSB of the 3-bit Remark Priority field. Refer to the Port ACL Access \nB Register  for the LSB.R/W 00b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 139KSZ9896C\n5.2.6.12 Port ACL Access B Register \n5.2.6.13 Port ACL Access C Register \n5.2.6.14 Port ACL Access D Register \n5.2.6.15 Port ACL Access E Register Address: 0xN60B\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 Remark Priority [0]\nThe LSB of the 3-bit Remark Pr iority field. Refer to the Port ACL Access B \nRegister  for the MSB.R/W 0b\n6:5 Map Mode (MM) R/W 00b\n4:0 RESERVED R/W 0b\nAddress: 0xN60C\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 RESERVED R/W 0x00\nAddress: 0xN60D\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:6 RESERVED R/W 00b\n5:0 Port Forward Map\nEach bit corresponds to a forwarding port.Bit 0 corresponds to port 1,Bit 1 corresponds to port 2, etc.1 = enable forwarding to that port0 = do not forward to that portR/W 00_0000b\nAddress: 0xN60E\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Ruleset [15:8] R/W 0x00\nKSZ9896C\nDS00002390A-page 140 \uf0e3 2017 Microchip Technology Inc.5.2.6.16 Port ACL Access F Register \n5.2.6.17 Port ACL Byte Enable MSB Register \n5.2.6.18 Port ACL Byte Enable LSB Register Address: 0xN60F\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Ruleset [7:0] R/W 0x00\nAddress: 0xN610\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Byte Enable [15:8]\nEach bit enables accessing one of the ACL bytes when a read or write is \ninitiated by writing to the Port ACL Byte Enable LSB Register .\nBit 0 applies to the Port ACL Access 7 Register\nBit 1 applies to the Port ACL Access 6 Register , etc.\nBit 7 applies to the Port ACL Access 0 Register\n1 = Byte is selected for read/write0 = Byte is not selectedR/W 0x00\nAddress: 0xN611\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:0 Byte Enable [7:0]\nEach bit enables accessing one of the ACL bytes when a read or write is \ninitiated by writing to the Port ACL Byte Enable LSB Register .\nBit 0 applies to the Port ACL Access F Register\nBit 1 applies to the Port ACL Access E Register , etc.\nBit 7 applies to the Port ACL Access 8 Register\n1 = Byte is selected for read/write0 = Byte is not selectedR/W 0x00\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 141KSZ9896C\n5.2.6.19 Port ACL Access Control 0 Register \nAddress: 0xN612\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED R/O 0b\n6 Write Status\n1 = Write operation is complete0 = Write operation is not completeRO 1b\n5 Read Status\n1 = Read operation is complete0 = Read operation is not complete; cont inue polling until this bit is set before \nreading results registersRO 1b\n4 Write / Read\n1 = Write0 = ReadR/W 0b\n3:0 ACL Index R/W 0x0\nKSZ9896C\nDS00002390A-page 142 \uf0e3 2017 Microchip Technology Inc.5.2.7 PORT N: PORT SWITCH INGRESS CONTROL REGISTERS ( 0xN800 - 0xN8FF )\n5.2.7.1 Port Mirroring Control Register \nThis register contains the port controls for port  mirroring. The Global Port Mirroring and Snooping Control Register  must\nalso be properly configured.\n5.2.7.2 Port Priority Control Register \nTo achieve the desired functionality, do not set more than one bit at a time in this register. Address: 0xN800\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6 Receive Sniff\n1 = All packets received on this port  are designated as “monitored packets” \nand will be forwarded to t he designated “sniffer port”.\n0 = No receive monitoring.R/W 0b\n5 Transmit Sniff\n1 = All packets transmitted on this port are designated as “monitored \npackets” and will be forwarded to the designated “sniffer port”.\n0 = No transmit monitoring.R/W 0b\n4:2 RESERVED RO 0_00b\n1 Sniffer Port\n1 = This port is designated as the sniffer port and will transmit monitored \npackets.\n0 = Not a sniffer port. Normal operation.R/W 0b\n0 RESERVED RO 0b\nAddress: 0xN801\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 Highest Priority\n1 = Highest priority selected0 = Highest priority not selectedR/W 0b\n6 OR’ed Priority\n1 = All available priority OR’ed0 = All available priority not OR’edR/W 0b\n5 RESERVED RO 0b\n4 MAC Address Priority Classification\n1 = Enable MAC address priority classification for ingress packets on port0 = Disable MAC address classificationR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 143KSZ9896C\n5.2.7.3 Port Ingress MAC Control Register 3 VLAN Priority Classification\n1 = Enable VLAN priority classification for ingress packets on port0 = Disabled VLAN classificationR/W 0b\n2 802.1p Priority Classification\n1 = Enable 802.1p priority classification for ingress packets on port0 = Disable 802.1p priority classificationR/W 0b\n1 Diffserv Priority Classification\n1 = Enable Diffserv priority classifi cation for ingre ss packets on port\n0 = Disable Diffserv priority classificationR/W 0b\n0 ACL Priority Classification\n1 = Enable ACL priority classification for ingress packets on port0 = Disable ACL priority classification R/W 0b\nAddress: 0xN802\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 User Priority Ceiling\n1 = If a packet’s “user priority field” is greater than the “user priority field” in \nthe port default tag register, replace the packet’s user priority field with the user priority field in t he port default tag from the Port Default Tag 0 Register .\n0 = Do not replace the user priority field at this port.R/W 0b\n6:5 RESERVED RO 0b\n4 Discard Untagged Packets\nThis bit should be left as 0 for the host port.1 = Any ingress packet at this port wit hout an IEEE 802.1Q tag is discarded.\n0 = Do not discard.R/W 0b\n3 Discard Tagged Packets\n1 = Any ingress packet at this port with an IEEE 802.1Q ta g is discarded.\n0 = Do not discard. R/W 0b\n2:0 Port Default Priority Classification\nIf Diffserv classification, 802.1p classification and VLAN classification are not \nenabled or fail to classify, ingress packets at this port will be classified with the priority specified here. Possible values are 0 to 7.R/W 000bBits Description Type Default\nKSZ9896C\nDS00002390A-page 144 \uf0e3 2017 Microchip Technology Inc.5.2.7.4 Port Authentication Control Register \n5.2.7.5 Port Pointer Register Address: 0xN803\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0000_0b\n2 Access Control List (ACL) Enable\n1 = enable0 = enableR/O 0b\n1:0 Authentication Mode\n00 = Pass Mode. Authentication is disabl ed. When ACL is enabled, all traffic \nthat misses the ACL rules is forwarded; otherwise ACL actions apply.\n01 = Block Mode. Authentication is enabled. When ACL is enabled, all traffic \nthat misses the ACL rules is blocked; otherwise ACL actions apply. \n10 = Trap Mode. Authentication is enabled . All traffic is forwarded to the host \nport. When ACL is enabled, all traffic that misses the ACL rules is blocked; \notherwise ACL actions apply.\n11 = ReservedR/W 00b\nAddress: 0xN804 - 0xN807\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:19 RESERVED RO 0x0000\n18:16 Port Index\nUsed to point to the indirect mapping locations for the 6 ports R/W 000b\n15:2 RESERVED RO 0x0000\n1:0 Queue Pointer\n Used to point to the indirect mapping locations for the 4 queuesR/W 00b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 145KSZ9896C\n5.2.7.6 Port Priority to Queue Mapping Register \nAddress: 0xN808 - 0xN80B\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:28 Regenerated priority (queue) value for priority 7. \nThe 2 most significant bits are reserved.R/W xx11b\n27:24 Regenerated priority (queue) value for priority 6. \nThe 2 most significant bits are reserved.R/W xx11b\n23:20 Regenerated priority (queue) value for priority 5. \nThe 2 most significant bits are reserved.R/W xx10b\n19:16 Regenerated priority (queue) value for priority 4. \nThe 2 most significant bits are reserved.R/W xx10b\n15:12 Regenerated priority (queue) value for priority 3. \nThe 2 most significant bits are reserved.R/W xx01b\n11:8 Regenerated priority (queue) value for priority 2. \nThe 2 most significant bits are reserved.R/W xx01b\n7:4 Regenerated priority (queue) value for priority 1. \nThe 2 most significant bits are reserved.R/W xx00b\n3:0 Regenerated priority (queue) value for priority 0. \nThe 2 most significant bits are reserved.R/W xx00b\nKSZ9896C\nDS00002390A-page 146 \uf0e3 2017 Microchip Technology Inc.5.2.7.7 Port Police Control Register \nAddress: 0xN80C - 0xN80F\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:12 RESERVED RO 0x00000\n11 Dropped Color\n1 = Color packet PMON holds dropped packets of that color\n0 = Color packet PMON holds all packets of that colorR/W 0b\n10 Drop All\n1 = All packets are dropped while max threshold is exceeded in PM WRED\n0 = Drop packet based on WRED_PM_PROB_MULTIPLIERR/W 0b\n9:8 Packet Type\n PMON packet type to be read for the connection from Queue Pointer  of the \nport pointed by Port Index\n11 = WRED_PMON holds the number of RED packets while read\n10 = WRED_PMON holds the number of YELLOW packets while read01 = WRED_PMON holds the number of GREEN packets while read\n00 = WRED_PMON holds the number of dropped packets while readR/W 00b\n7 Port Based Policing\n1 = Policing is per-port per-queue based\n0 = Policing is per-queue based only, \nPort Index  = 0 is used to set aggregated CIR, PIR for each queueR/W 0b\n6:5 NONDSCP_COLOR\n Color of non-IP frame for color awareR/W 01b\n4 Color Mark Enable\n1 = DSCP color mark enable\n0 = DSCP color mark disableR/W 0b\n3 Color Remap Enable\n1 = DSCP color remap enable for color aware\n0 = DSCP color remap disable, use DSCP colorR/W 0b\n2 Drop SRP\n1 = Allow drop SRP packets while WRED is enabled\n0 = Don’t allow drop SRP packet while WRED is enabledR/W 0b\n1 Police Mode\nThis bit sets the policing modes for the queue if policing is enabled\n1 = Color blind\n0 = Color aware modeR/W 0b\n0 Police Enable\n1 = Enable policing and WRED\n0 = Disable policing and WREDR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 147KSZ9896C\n5.2.7.8 Port Police Queue Rate Register \n5.2.7.9 Port Police Queue Burst Size Register \n5.2.7.10 Port WRED Packet Memory Control Register 0Address: 0xN820 - 0xN823\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:16 Committed Information Rate\nSpecifies the committed information ra te for the connection from the Queue \nPointer of the port pointed by the Port index.R/W 0x1000\n15:0 Peak Information Rate\nSpecifies the queue’s peak information rate for the connection from the Queue \nPointer of the port pointed by the Port index.R/W 0x2000\nAddress: 0xN824 - 0xN827\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:16 Committed Burst Size\nSpecifies the queue’s committed burst size in bytes that is supported for the \nconnection from the Queue Pointer of the port pointed by the Port index.R/W 0x1000\n15:0 Peak Information Rate\nSpecifies the queue’s peak burst size in bytes that is supported for the con-\nnection from the Queue Pointer of the port pointed by the Port index.R/W 0x3000\nAddress: 0xN830 - 0xN833\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:27 RESERVED RO 00000b\n26:16 WRED Packet Memory Maximum Threshold R/W 0x400\n15:11 RESERVED RO 00000b\n10:0 WRED Packet Memory Minimum Threshold R/W 0x080\nKSZ9896C\nDS00002390A-page 148 \uf0e3 2017 Microchip Technology Inc.5.2.7.11 Port WRED Packet Memory Control Register 1\n5.2.7.12 Port WRED Queue Control Register 0\n5.2.7.13 Port WRED Queue Control Register 1Address: 0xN834 - 0xN837\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:27 RESERVED RO 00000b\n26:16 WRED Packet Memory Probability Multiplier R/W 0x020\n15:11 RESERVED RO 00000b\n10:0 WRED Packet Memory Average Queue Size R-\nAddress: 0xN840 - 0xN843\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:27 RESERVED RO 00000b\n26:16 WRED Maximum Queue Threshold\nWRED maximum threshold for the connec tion from the Queue Pointer of the \nport pointed to by the Port index. R/W 0x080\n15:11 RESERVED RO 00000b\n10:0 WRED Minimum Queue Threshold\nWRED minimum threshold for the connec tion from the Queue Pointer of the \nport pointed to by the Port index. R/W 0x009\nAddress: 0xN844 - 0xN847\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:27 RESERVED RO 00000b\n26:16 WRED Queue Probability Multiplier\nProbability multiplier for the connection from the Queue Pointer of the port \npointed to by the Port index. R/W 0x010\n15:11 RESERVED RO 00000b\n10:0 WRED Packet Memory Average Queue Size\nAverage queue size for the connection from the Queue Pointer of the port pointed to by the Port index.R-\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 149KSZ9896C\n5.2.7.14 Port WRED Queue Performance Monitor Control Register\nAddress: 0xN848 - 0xN84B\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31 Random Drop Enable\n1 = Random Drop enabled0 = Random Drop disabledR/W 0b\n30 PMON Flush\n1 = PMON counters are flushed. This is a low to high edge triggered clear.\n0 = No activityR/W 0x010\n29 GYR Drop Disable\n1 = Drop GREEN/YELLOW/RED is disabled0 = Drop GREEN/YELLOW/RED is enabledR/W 0b\n28 YR Drop Disable\n1 = Drop YELLOW/RED is disabled0 = Drop YELLOW/RED is enabledR/W 0b\n27 R Drop Disable\n1 = Drop RED is disabled0 = Drop RED is enabledR/W 0b\n26 Drop All\n1 = Drop all packets wile the max threshold is exceeded0 = Drop based on WRED Queue Probability MultiplierR/W 0b\n25:24 RESERVED RO 00b\n23:0 Packet Event Counter\nPacker event count for the connection from the Queue Pointer of the port pointed to by the Port index.R 0x00000\nKSZ9896C\nDS00002390A-page 150 \uf0e3 2017 Microchip Technology Inc.5.2.8 PORT N: PORT SWITCH EGRESS CONTROL REGISTERS ( 0xN900 - 0xN9FF )\n5.2.8.1 Port Transmit Queue Index Register \nThis register holds an index value that is used when acce ssing several registers that follow. This register may be\naccessed as an 8-bit register, with bits [7:0] located at address 0xN903.\n5.2.8.2 Port Transmit Queue PVID Register \nThis register may be accessed as an 8-bit regist er, with bits [7:0] located at address 0xN903.Address: 0xN900 - 0xN903\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:2 RESERVED RO 0x00000000\n1:0 Queue Index\n Points to the queue number for su bsequent queue configuration registers.R/W 00\nAddress: 0xN904 - 0x907\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:1 RESERVED RO 0x00000000\n0 Port VID Replacement\n1 = For any egress packet with a non-zero VLAN ID, replace the VID with the \nport default VID from the Port Default Tag 0 Register  and Port Default Tag 1 \nRegister . If double tagging is enabled, it is the ISP tag ID that will be \nreplaced.\n0 = Do not replace the VID.R/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 151KSZ9896C\n5.2.8.3 Port Transmit Queue Control 0 Register \nThis register is indexed. Settings are applied on a per-queue an d per-port basis. Specify the target queue number in the\nPort Transmit Queue Index Register  before accessing this register. \n5.2.8.4 Port Transmit Queue Control 1 Register \nThis register is indexed. Settings are applied on a per-queue an d per-port basis. Specify the target queue number in the\nPort Transmit Queue Index Register  before accessing this register. Address: 0xN914\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:6 Scheduler Mode\n Determines the egress scheduling policy when 2 or 4 transmit queues are \nenabled.\n00 = Strict Priority. All packets in queue 3 are transmitted before any packets from any lower number queue will be tr ansmitted. All packets in queue 2 are \ntransmitted before any packets from any lower number queue, etc.\n10 = Weighted Round Robin (WRR). As determined by the weight values in the (queue indexed) Port Transmit Queue Control 1 Register , a limited num-\nber of packets are transmitted from a queue before the next queue is serviced. \nAll queues are serviced in turn.01 and 11 = RESERVEDR/W 10b\n5:0 RESERVED RO 000000b\nAddress: 0xN915\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 RESERVED RO 0b\n6:0 Queue Weight for WRR Scheduling\n During weighted round robin (WRR) sch eduling, this value specifies the num-\nber of packets that may be transmitted from the particular queue before the \nnext queue is serviced. These values are not relevant when the port is config-\nured for a single egress queue. Do not assign 0 to any queue.Example values for a 4-queue configurat ion are 8 (for queue 3), 4 (for queue \n2), 2 (for queue1) and 1 (for queue 0). R/W 0000001\nKSZ9896C\nDS00002390A-page 152 \uf0e3 2017 Microchip Technology Inc.5.2.9 PORT N: PORT SWITCH QUEUE MANAGEMENT CONTROL REGISTERS ( 0xNA00 - \n0xNAFF )\n5.2.9.1 Port Control 0 Register \n5.2.9.2 Port Control 1 Register Address: 0xNA00 - 0xNA03\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n32:2 RESERVED RO 0x0000000\n1:0 Drop Mode\n00 = No drop, issue flow control to this port when destination is in congestion \nstate.\n01 = Drop packets with priority 0 sourced from this port when destination is in \ncongestion state and disable the flow control to this port.\n10 = Drop packets with priority 0, 1 sour ced from this port when destination is \nin congestion state and disable the flow control to this port.\n11 = Drop packets with priority 0, 1, 2 sourced from this port when destination \nis in congestion state and disable the flow control to this port.R/W 00b\nAddress: 0xNA04 - 0xNA07\nPort N: 1-6Size: 32 bits\nBits Description Type Default\n31:7 RESERVED RO 0x0000000\n6:0 Port VLAN Membership\nEach bit corresponds to a device port. This feature does not utilize VLAN \ntags or the VLAN Table, and is unrelated to tag-based VLAN functions. Also refer to bit 1 in the Queue Management Control 0 Register .\nBit 0 is for port 1Bit 1 is for port 2, etc.1 = Frames may be forwarded to the corresponding port0 = Frames are blocked from being forwarded to corresponding portR/W 0x7F\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 153KSZ9896C\n5.2.10 PORT N: PORT SWITCH ADDRESS LOOKUP CONTROL REGISTERS ( 0xNB00 - 0xNBFF )\n5.2.10.1 Port Control 2 Register \nAddress: 0xNB00\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7 Null VID Lookup Enable\nHow to handle tagged packets with VID = 0.1 = Non-standard operation. VLAN  Table lookup using VID = 0.\n0 = Standard operation. VLAN Table lookup using the port default VID ( Port \nDefault Tag 0 Register  and Port Default Tag 1 Register )R/W 0b\n6 Ingress VLAN Filtering\n1 = Discard packets whose VID port membership in the VLAN Table does \nnot include the ingress port\n0 = No ingress filteringR/W 0b\n5 Discard Non-PVID Packet\n1 = Discard packets whose VID does not  match the ingress port default VID\n0 = Do not compare VID to the port default VIDR/W 0b\n4 MAC Based 802.1X Enable\n1 = Enable MAC based 802.1X authentication in lookup engine0 = Only use ACL (if enabled) to perform MAC based authenticationR/W 0b\n3 Self-Address Filtering – Port Enable\nThe source address of received packets is compared to the MAC address in \nthe Switch MAC Address 0 Register  through Switch MAC Address 5 \nRegister , and the packet is dropped if there is a match.\nBoth this port enable bit and the global enable bit in the Switch Lookup \nEngine Control 1 Register  must be set to enable self-address filtering.\n1 = Enable self-address filtering for this port.0 = Disable self-address filtering for this port.R/W 0b\n2 RESERVED RO 0b\n1 RESERVED R/W 0b\n0 RESERVED RO 0b\nKSZ9896C\nDS00002390A-page 154 \uf0e3 2017 Microchip Technology Inc.5.2.10.2 Port MSTP Pointer Register \n5.2.10.3 Port MSTP State Register \nThere are eight MSTPs, and the MSTP Pointer in the Port MSTP Pointer Register  is used as an index to select a par-\nticular MSTP when reading or writing this register.Address: 0xNB01\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:3 RESERVED R/W 0000_0b\n2:0 MSTP Pointer\nPoints to one of the 8 MSTPs. It is used as an index when reading or writing \nthe Port MSTP State Register . R/W 000b\nAddress: 0xNB04\nPort N: 1-6Size: 8 bits\nBits Description Type Default\n7:3 RESERVED RO 0000_0b\n2 Port Transmit Enable\n1 = Enable packet transmission on the port0 = Disable packet transmission on the portR/W 1b\n1 Port Receive Enable\n1 = Enable packet reception on the port0 = Disable packet reception on the portR/W 1b\n0 Port Learning Disable\n1 = Disable switch address learning on the port0 = Enable switch address learning on the portR/W 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 155KSZ9896C\n5.3 Tables and MIB Counters (Access)\nIndirect address and data registers are used to access the various tables and counters:\n•Address Lookup (ALU) Table\n•Static Address Table\n•Reserved Multicast Address Table\n•VLAN Table\n•Access Control List (ACL) Table\n•Management Information Base (MIB) Counters\n5.3.1 ADDRESS LOOKUP (ALU) TABLE\nThe Address Lookup Table is the largest of three tables us ed for MAC address lookup. It  supports both dynamic and\nstatic MAC address entries. In response to a destination add ress (DA) lookup, all tables ar e searched to make a packet\nforwarding decision. In response to a source address (SA) lookup, only this table is searched for aging, migration and\nlearning of the dynamic entries.\nIt is suggested that static address entri es be programmed to the Static Address Ta ble. When that table is full, additional\nstatic address entries may be programmed into this table. Static entries will not be aged out.\nA static DA lookup result (in either this table or the Static Address Table ) takes precedence over the dynamic DA lookup\nresult.\nThis table is a 4-way associative memory, with 1K buckets, for a total of 4K entries. In normal operation, the MAC\naddress (and optionally the FID) are hashed to generate a 10-b it index. The 10-bit index specifies a bucket of up to 4\nentries, but the entries within each bucket are not individually  addressable. A new entry can be added to a bucket if the\nbucket contains 3 or fewer valid entries. Once a bucket is full  with 4 valid entries, any new entry will overwrite the least-\nrecently-used dynamic entry.\nIf a bucket contains 2 or 3 static entries, adding an additional  static entry to that bucket will generate an Almost Full\ninterrupt. (Refer to the Address Lookup Table Interrupt Register  and Global Interrupt Status Register ). Once the interrupt\nis generated, the 12-bit absolute address of the new static entry will be available for reading in the Address Lookup Table\nEntry Index 0 Register  bits [11:0].\nIf a bucket is full with 4 static entries,  attempting to write an additional static entry will fail and will result in a Write Fail\nInterrupt. Once the interrupt is generated, the 10-bit in dex of the full bucket will be available for reading in the Address\nLookup Table Entry Index 0 Register  bits [9:0].\nA bucket with 4 static entries will also block any dynamic ent ries from being learned. Such a failure will generate a Learn\nFail Interrupt. Once the interrupt is generated, the 10-bit in dex of the full bucket will be available for reading in the\nAddress Lookup Table Entry Index 1 Register  bits [9:0].\nThis table is accessed indirectly via the ALU Table registers:•ALU Table Index 0 Register\n•ALU Table Index 1 Register\n•ALU Table Access Control Register\n•ALU Table Entry 1 Register\n•ALU Table Entry 2 Register\n•ALU Table Entry 3 Register\n•ALU Table Entry 4 Register\nAll static and dynamic entries may be read, but only static ent ries may be written. Because most of the table entries are\ncreated automatically by hardware address learning, and because the table is 4-wa y associative, three different meth-\nods are available for accessing the memory:\n1. Lookup by MAC address. This utilizes the same hash tag lookup circuitry that is used for ingress packet forward-\ning lookup. The hash tag algorithm is specified by the Hash Option bits in the Switch Lookup Engine Control 0\nRegister . This is normally how static entrie s should be written (Read or write).\n2. Direct addressing (Read or write).\n3. Sequential search, returning all valid entries (Read only).\nKSZ9896C\nDS00002390A-page 156 \uf0e3 2017 Microchip Technology Inc.5.3.1.1 Address Lookup Table Read Operation\n1. Write the index to the ALU Table Index 0 Register  and ALU Table Index 1 Register .\na) A MAC address is used for the hashing indexing fu nction, which is the normal access mechanism for this\ntable.\nb) A FID is also required if VLAN is enabled.c) If directly addressing the table, a 12-bit index is  written to bits [11:0] of the MAC address field.\n2. Write to the ALU Table Access Control Register .\na) Set the ACTION field to 10 to indicate a read operation.b) Select the addressing me thod via the DIRECT bit.\nc) Set the START_FINISH bit to initiate the operation.\n3. Read / poll the ALU Table Access Control Register .\na) The START_FINISH bit transitions to 0 to indicate that the operation is complete.\nb) Once START_FINISH is 0, the VALID bit indicates whet her or not a valid entry was found. If VALID is false,\nthere is no need to proceed to step 4.\nc) The VALID_ENTRY_OR_SEARCH_END bit is an aggregate of the START_FINISH bi t and the VALID bit. It\nis intended for use when accessing registers by in- band management (IBA), where polling multiple bits is\nless practical.\n4. Read the contents of the returned table entry from the ALU Table Entry 1 Register , ALU Table Entry 2 Register ,\nALU Table Entry 3 Register , and ALU Table Entry 4 Register . If no VALID entry is retu rned, these registers will\ncontain all zeros.FIGURE 5-3: ADDRESS LOO KUP TABLE CONFIGURATION\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 157KSZ9896C\n5.3.1.2 Address Lookup Table Search Operation\nThe second method to access the Address Lookup Table is through the search operation.  The entire table is searched\nsequentially, revealing each valid entry. Invalid address en tries are skipped, providing an efficient way to search the\nentire table. Setting the START_FINISH bit in the ALU Table Access Control Register  begins the search from the top of\nthe table. This bit is cleared when the search is complete. During the table search, the VALID bit in the ALU Table Access\nControl Register  is cleared when the search starts. The VALID bit indicates when a found valid entry is available in the\nALU Table Entry registers (0x0420 - 0x042F). Afte r reading the last ALU Table Entry register ( ALU Table Entry 4 Reg-\nister), the search process automatically c ontinues to seek the next valid entry in the address table. The START_FINISH\nbit remains set until all the valid entries in the table have been returned. The search can be stopped any time by setting\nthe ALU Table Access Control Register  START_FINISH bit to 0.\n1. Write to the ALU Table Access Control Register .\na) Set the ACTION field to 11 to indicate a search operation.b) Set the START_FINISH bit to initiate the operation.\n2. Poll the VALID bit until it is set.\na) If register access is by in-band management (IBA) rather than SPI or I\n2C, poll VALID_ENTRY_OR_-\nSEARCH_END instead. This bit goes high to indicate ei ther a new valid entry is returned or the search is\ncomplete.\n3. Read the entry from the ALU Table Entry 1 Register , ALU Table Entry 2 Register , ALU Table Entry 3 Register ,\nand ALU Table Entry 4 Register , in that order. \na) If the search has ended and there are no more valid en tries to read, these registers will return all zeros. In\nthis case, go to step 5.\n4. If START_FINISH = 0, go to step 5; else go to step 2.\n5. Read VALID_COUNT to verify the number of valid entries.\n5.3.1.3 Address Lookup Table Write Operation\n1. Perform a read operation to get the contents of the current entry. The values are kept in the ALU Table Entry 1\nRegister , ALU Table Entry 2 Register , ALU Table Entry 3 Register , and ALU Table Entry 4 Register . \n2. Modify the correct entry as necessary. Set the STATIC bit so that the entry is not aged out.\n3. Write to the ALU Table Access Control Register .\na) Set the ACTION field to 01 to indicate a write operation.\nb) Select the addressing me thod via the DIRECT bit.\nc) Set the START_FINISH bit to initiate the operation.\nKSZ9896C\nDS00002390A-page 158 \uf0e3 2017 Microchip Technology Inc.5.3.1.4 ALU Table Entry 1 Register\n5.3.1.5 ALU Table Entry 2 RegisterAddress: 0x0420 - 0x0423 Size: 32 bits\nBits Description Type Default\n31 STATIC\n1 = Entry is static and updated by a host processor; will not be aged out\n0 = Entry is dynamically learned and agedR/W 0b\n30 SRC FILTER\n1 = Drop packet if source address match during source learning0 = Don’t drop if source address matchR/W 0b\n29 DES FILTER\n1 = Drop packet if destination address match during lookup0 = Don’t drop if destination address matchR/W 0b\n28:26 PRIORITY  (for static entries)\nAGE COUNT  (for dynamic entries)\n>0 = Entry has been accessed or learned since last aging process. A default \nvalue is reloaded every time the entry is learned or accessed. It is decremented during aging process.\n0 = Entry has not been accessed or learned since last aging process. Entry \nis not valid if it’s not static.R/W 0_00b\n25:3 RESERVED RO 0x000000\n2:0 MSTP\nMultiple Spanning Tree Protocol group ID for matchingR/W 000b\nAddress: 0x0424 - 0x0427 Size: 32 bits\nBits Description Type Default\n31 OVERRIDE\n1 = Enable overriding of port state0 = Do not enableR/W 0b\n30:6 RESERVED RO 0x000000\n5:0 PORT FORWARD\nEach bit corresponds to a device port.Bit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward to the corresponding port0 = Do not forward to the corresponding portR/W 0x00\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 159KSZ9896C\n5.3.1.6 ALU Table Entry 3 Register\n5.3.1.7 ALU Table Entry 4 Register\n5.3.2 STATIC ADDRESS TABLE\nThe Static Address Table is one of three tables used for MA C address lookup. It can hold up to 16 static address entries,\nthereby minimizing the number of  static entries that may need to be programmed into the Address Lookup Table, which\nis used primarily for dynamic entries. In response to a desti nation address (DA) lookup, all tables are searched to make\na packet forwarding decision. Entries in this table ar e programmed by the host processor, and are never aged. \nA static DA lookup result (in either this table or the Address Lookup Table) takes precedence over the dynamic DA\nlookup result.\nThe Static Address Table has 16 entries and is accessed indirectly. The Static Address and Reserved Multicast Table\nControl Register  is used for indexing and read/write control. The following registers are used for the data fields:\n•Static Address Table Entry 1 Register\n•Static Address Table Entry 2 Register\n•Static Address Table Entry 3 Register\n•Static Address Table Entry 4 Register\n5.3.2.1 Static Address Table Write Operation\n1. Write the content of the table entry to the Static Address Table Entry 1 Register , Static Address Table Entry 2\nRegister , Static Address Table Entry 3 Register , and Static Address Table Entry 4 Register .\n2. Write to the Static Address and Reserved Mu lticast Table Control Register .\na) Write the TABLE_INDEX field with the 4-bit index value.b) Set the TABLE_SELECT bit to 0 to select the Static Address Table.\nc) Set the ACTION bit to 0 to indicate a write operation.\nd) Set the START_FINISH bit to  1 to initiate the operation.\n3. When the operation is complete, the START_FINISH bit will be cleared automatically.\n5.3.2.2 Static Address Table Read Operation\n1. Write to the Static Address and Reserved Mu lticast Table Control Register .\na) Write the TABLE_INDEX field with the 4-bit index value.\nb) Set the TABLE_SELECT bit to 0 to select the Static Address Table.Address: 0x0428 - 0x042B Size: 32 bits\nBits Description Type Default\n31:23 RESERVED RO 0x000\n22:16 FID\nVLAN group ID for matchingR/W 000_0000\n15:0 MAC Address [47:32] R/W 0x0000\nAddress: 0x042C - 0x042F Size: 32 bits\nBits Description Type Default\n31:0 MAC Address [31:0] R/W 0x00000000\nKSZ9896C\nDS00002390A-page 160 \uf0e3 2017 Microchip Technology Inc.c) Set the ACTION bit to 1 to indicate a read operation.\nd) Set the START_FINISH bit to  1 to initiate the operation.\n2. When the operation is complete, the START_FINISH bit will be cleared automatically.\na) Read the contents of the indexed entry from the Static Address Table Entry 1 Register , Static Address Table\nEntry 2 Register , Static Address Table Entry 3 Register , and Static Address Table Entry 4 Register .\n5.3.2.3 Static Address Table Entry 1 Register\n5.3.2.4 Static Address Table Entry 2 RegisterAddress: 0x0420 - 0x0423 Size: 32 bits\nBits Description Type Default\n31 VALID\n1 = Entry is valid0 = Entry is not validR/W 0b\n30 SRC FILTER\n1 = Drop packet if source address match during source learning0 = Don’t drop if source address matchR/W 0b\n29 DES FILTER\n1 = Drop packet if destination address match during lookup0 = Don’t drop if destination address matchR/W 0b\n28:26 PRIORITY R/W 0_00b\n25:3 RESERVED RO 0x000000\n2:0 MSTP\nMultiple Spanning Tree Protocol group ID for matchingR/W 000b\nAddress: 0x0424 - 0x0427 Size: 32 bits\nBits Description Type Default\n31 OVERRIDE\n1 = Enable overriding of port state0 = Do not enableR/W 0b\n30 USE FID\nUse FID on multicast packets for matchingR/W 0b\n29:6 RESERVED RO 0x000000\n5:0 PORT FORWARD\nEach bit corresponds to a device port.Bit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward to the corresponding port0 = Do not forward to the corresponding portR/W 0x00\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 161KSZ9896C\n5.3.2.5 Static Address Table Entry 3 Register\n5.3.2.6 Static Address Table Entry 4 Register\n5.3.3 RESERVED MULTICAST ADDRESS TABLE\nThe Reserved Multicast Address Table determines the forwardi ng ports for 48 specific multicast addresses. The table\nis addressed by the least significant 6 bits of the multicas t address, and the table contents are the bits (the PORT_FOR-\nWARD field) that represent each possible forwarding port of  the device. It is not addresse d by the group number in the\nfirst column of Table 4-6 . Note that the 48 addresses are organized into 8 fixed groups, and changing a forwarding port\nfor one address also makes the same change for all other addresses in the same group.\nThe Reserved Multicast Table is accessed in the same manner as the Static Address Table , using the same indirect\naccess registers. The Static Address and Reserved Multicast Table Control Register  is used for indexing and read/write\ncontrol, while the Reserved Multicast Address Table Entry 2 Register  is used for the data fields.\n5.3.3.1 Reserved Multicas t Table Write Operation\n1. Write the PORT_FORWARD value to the Reserved Multicast Address Table Entry 2 Register .\n2. Write to the Static Address and Reserved Mu lticast Table Control Register .\na) Write the TABLE_INDEX field with the 6-bit index value.b) Set the TABLE_SELECT bit to 1 to se lect the Reserved Multicast Table.\nc) Set the ACTION bit to 0 to indicate a write operation.\nd) Set the START_FINISH bit to  1 to initiate the operation.\n3. When the operation is complete, the START_FINISH bit will be cleared automatically.\n5.3.3.2 Reserved Multicast Table Read Operation\n1. Write to the Static Address and Reserved Mu lticast Table Control Register .\na) Write the TABLE_INDEX field with the 6-bit index value.\nb) Set the TABLE_SELECT bit to 1 to se lect the Reserved Multicast Table.\nc) Set the ACTION bit to 1 to indicate a read operation.\nd) Set the START_FINISH bit to  1 to initiate the operation.\n2. When the operation is complete, the START_FINISH bit will be cleared automatically.\na) Read the contents of the indexed entry from the Reserved Multicast Address Table Entry 2 Register .Address: 0x0428 - 0x042B Size: 32 bits\nBits Description Type Default\n31:23 RESERVED RO 0x000\n22:16 FID\nVLAN group ID for matchingR/W 000_0000b\n15:0 MAC Address [47:32] R/W 0x0000\nAddress: 0x042C - 0x042F Size: 32 bits\nBits Description Type Default\n31:0 MAC Address [31:0] R/W 0x00000000\nKSZ9896C\nDS00002390A-page 162 \uf0e3 2017 Microchip Technology Inc.5.3.3.3 Reserved Multicast Address Table Entry 2 Register\n5.3.4 VLAN TABLE\nAn internal VLAN Table is used for VLAN lookup. If 802.1Q VLAN mode is enabled ( Switch Lookup Engine Control 0\nRegister ), this table will be used to retrieve the VLAN inform ation that is associated with the ingress packet. The table\nholds 4096 entries - one for each possible VLAN. The table must be set up before 802.1Q VLAN is enabled. The VLAN\ntable is accessed one entry at a time using the following indirect registers:\n•VLAN Table Entry 0 Register\n•VLAN Table Entry 1 Register\n•VLAN Table Entry 2 Register\n•VLAN Table Index Register\n•VLAN Table Access Control Register\nThe table data fields are described in Figure 5-4  and Table 5-4 . Address: 0x0424 - 0x0427 Size: 32 bits\nBits Description Type Default\n31:30 RESERVED R/W 00b\n29:6 RESERVED RO 0x000000\n5:0 PORT FORWARD\nEach bit corresponds to a device port.Bit 0 is for port 1Bit 1 is for port 2, etc.1 = Forward to the corresponding port0 = Do not forward to the corresponding portR/W 0x00\nFIGURE 5-4: VLAN TABLE STRUCTURE\nPORT FORWARD\nFILTER IDPORT UNTAG\nMSTP INDEX\nPRIORITYFORWARD OPTIONVALIDEntry # 0\nEntry # 4095Entry # 4094Entry # 1\nEntry # 2\nEntry # 3\nEntry # 4\nV    FO    PRIORITY    MSTP    FID    UNTAG    FORWARD\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 163KSZ9896C\nTABLE 5-4: VLAN TABLE DATA FIELDS\n5.3.4.1 VLAN Table Write Operation\n1. Write to the VLAN Table Entry 0 Register , VLAN Table Entry 1 Register , and VLAN Table Entry 2 Register  to set\nup the data fields as described in Figure 5-4  and Table 5-4 .\n2. Write the VLAN Index value in the VLAN Table Index Register . This is the 12-bit index (address) to select the\ntable entry. It is equivalent to the VID which indexes the table during lookup.\n3. Write the VLAN Table Access Control Register  to specify a write operation, and set START (bit 7). When the oper-\nation is complete, bit 7 will be cleared automatically.\n5.3.4.2 VLAN Table Read Operation\n1. Write the VLAN Index value in the VLAN Table Index Register  to select one of the 4k table entries.\n2. Write the VLAN Table Access Control Register  to specify a read operation and set START (bit 7). When the oper-\nation is complete, bit 7 will be cleared automatically.\n3. Read the VLAN Table Entry 0 Register , VLAN Table Entry 1 Register , and VLAN Table Entry 2 Register  to retrieve\nthe read results from the VLAN table.\n5.3.5 ACCESS CONTROL LIST (ACL) TABLE\nACL filtering is implemented individually per-p ort. The ACL tables are accessed using the Port N: Port Switch ACL Con-\ntrol Registers (0xN600 - 0xN6FF) . The 16 entries in each ACL table are addr essed indirectly by an index register.\nTable 5-5  shows how the various fields of the ACL Tabl e entries are mapped to data registers. The Port ACL Byte Enable\nMSB Register  and Port ACL Byte Enable LSB Register  make it possible to write or read any combination of bytes. This\nis useful for writing the Matching rule, Action rule and Process field separately. There are 16 bits in these byte enableregisters, corresponding to the 16 data registers Port ACL Access 0 Register  through Port ACL Access F Register . Note\nthat the enable bits are applied in reverse order:\nBit 0 for the Port ACL Access F Register\nBit 1 for the Port ACL Access E Register\n…Bit 14 for the Port ACL Access 1 Register\nBit 15 for the Port ACL Access 0 Register\nAlso note that the Port ACL Access C Register  is not used, so byte enable bit 3 is a don\'t care.Field Size (bits) Description\nVALID 1 When 1, indicates that the table entry is valid.\nFORWARD OPTION 1 When 1, forward to VLAN  port table (PORT FORWARD field). \nWhen 0, see Table 4-8, "VLAN Forwarding"  for details.\nPRIORITY 3 Priority value for this VID.\nMSTP INDEX 3 Multiple Spanning Tree Protocol index.\nFID 7 Filter ID value. It is combined wi th destination address and hashed to index \nthe Address Lookup Table.\nPORT UNTAG 7 \n(1 per port)When 1, untag at that egress port. \nWhen 0, don’t untag.\nPORT FORWARD 7\n(1 per port)VLAN port membership list. There is one bit per port, starting with the LSB \nwhich corresponds to port 1. \nA bit value of 1 indicates the associ ated port is included in the port \nmembership list for that VID. \nWhen 0, that port is excluded.\nKSZ9896C\nDS00002390A-page 164 \uf0e3 2017 Microchip Technology Inc.5.3.5.1 ACL Table Read\n1. Write to the Port ACL Access Control 0 Register  with the table entry number (0 to 15) in the ACL Index field, and\nthe Write/Read bit 4 cleared to zero. This one writ e to this register initiates the read operation.\n2. Poll the Read Status bit in the Port ACL Access Control 0 Register  to determine when the read operation is com-\nplete.\n3. When the operation is complete, data may be retrieved from the Port ACL Access 0 Register  through Port ACL\nAccess F Register . TABLE 5-5: ACL FIELD REGISTER MAPPING\nRegister BitsMD = 01\nENB = 00\nCount ModeMD = 01\nENB ≠ 00MD = 10 MD = 11\n0xN600 7:4 RESERVED\n3:0 Process Field: FRN [3:0]\n0xN601 7:6 RESERVED\n5:4 MD [1:0]\n3:2 ENB [1:0]\n1S  /  D0E Q\n0xN602 7:0 MAC ADDRESS [47:0] IP Address [31:0] MAX PORT [15:0]\n0xN603 7:00xN604 7:0 MIN PORT [15:0]\n0xN605 7:0\n0xN606 7:3 IP MASK [31:0] RESERVED\n2:1 PC [1:0]\n0 PRO [7:0]\n0xN607 7:1\n0 FME\n0xN608 7:0 TYPE [15:0] FMSK [7:0]\n0xN609 7:0 FLAG [7:0]\n0xN60A 7:6 COUNT [10:3] Action Rule: PM [1:0]\n5:3 Action Rule: P [2:0]\n2 Action Rule: RPE\n1:0 Action Rule: RP [2:1]\n0xN60B 7 COUNT [2:0] Action Field: RP [0]\n6:5 Action Field: MM [1:0]4:0 RESERVED\n0xN60C 7:0 RESERVED\n0xN60D 7 RESERVED\n6 TU Action Field: FORWARD [6:0]\n5C A\n4:0 RESERVED\n0xN60E 7:0 Process Field: RuleSet [15:8]\n0xN60F 7:0 Process Field: RuleSet [7:0]\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 165KSZ9896C\n5.3.5.2 ACL Table Write\n1. Write the ACL table entry values to the Port ACL Access 0 Register  through Port ACL Access F Register .\n2. Write the Port ACL Byte Enable MSB Register  and Port ACL Byte En able LSB Register  to select which registers\n(Port ACL Access 0 Register  through Port ACL Access F Register ) are to be written into the ACL table.\n3. Write to the Port ACL Access Control 0 Register  with the table entry number in t he ACL Index field, and the Write/\nRead bit 4 set to one. This one write to this register initiate s the write operation.\n4. The Write Status bit in the Port ACL Access Control 0 Register  may be polled to determine when the operation\nis complete.\n5.3.6 MANAGEMENT INFORMAT ION BASE (MIB) COUNTERS\nThere are 36 MIB counters per port. These counters accumulate a variety of  statistics on ingress and egress traffic and\nevents for network management. They  are accessed indirectly using the Port MIB Control and Status Register  and Port\nMIB Data Register . The Switch MIB Control Register  provides global flush and free ze control of the MIB counters.\nTABLE 5-6: MIB COUNTERS\nMIB \nIndexMIB CounterSize \n(bits)Description\n0x00 RxHiPriorityByte 30 RX high priority octet count, including bad packets.\n0x01 RxUndersizePkt 30 RX undersize packets with good CRC.\n0x02 RxFragments 30 RX fragment packets with bad CRC, symbol errors or alignment errors.\n0x03 RxOversize 30 RX oversize packets w/ good CRC (max: 1536 or 1522 bytes).\n0x04 RxJabbers 30 RX packets longer than 1522 bytes with either CRC errors, alignment \nerrors or symbol errors (depends on max packet size setting); or RX packets longer than 1916 bytes only.\n0x05 RxSymbolError 30 RX packets with invalid data symbol; and legal preamble and packet \nsize.\n0x06 RxCRCerror 30 RX packets between 64 and 1522 bytes in size, with an integral number \nof bytes and a bad CRC. (Upper limit depends on max packet size setting.)\n0x07 RxAlighmentError 30 RX packets between 64 and 1522 bytes in size, with a non-integral \nnumber of bytes and a bad CRC. (Upper limit depends on max packet size setting.)\n0x08 RxControl8808Pkts 30 MAC control frames received with 0x8808 in the EtherType field.\n0x09 RxPausePkts 30 PAUSE frames received. PAUSE is defined as EtherType (0x8808), DA, \ncontrol opcode (0x0001), minimum 64 byte data length, and a valid CRC.\n0x0A RxBroadcast 30 RX good broadcast packets. Does not include erred broadcast packets \nor valid multicast packets.\n0x0B RXMulticast 30 RX good multicast packets. Does not  include MAC control frames, erred \nmulticast packets, or valid broadcast packets.\n0x0C RxUnicast 30 RX good unicast packets.\n0x0D Rx64Octets 30 RX packets (bad packets included) that are 64 bytes in length.\n0x0E Rx65to127Octets 30 RX packets (bad packets included) that are 65 to 127 bytes in length.\n0x0F Rx128to255Octets 30 RX packets (bad packets included) that are 128 to 255 bytes in length.\n0x10 Rx256to511Octets 30 RX packets (bad packets included) that are 256 to 511 bytes in length.\n0x11 Rx512to2023Octets 30 RX packets (bad packets included) that are 512 to 1023 bytes in length.\n0x12 Rx1024to1522Octets 30 RX packets (bad packets included) that are 1024 to 1522 bytes in length.\n0x13 Rx1523to2000Octets 30 RX packets (bad packets included) that are 1523 t0 2000 bytes in length.\n0x14 Rx2001+Octets 30 RX packets (bad packets included) that are between 2001 bytes and the \nupper limit in length.\nKSZ9896C\nDS00002390A-page 166 \uf0e3 2017 Microchip Technology Inc.5.3.6.1 MIB Counter Read Operation\nIndirect access registers are used to read the MIB counters . Separate access registers are provided for each port via\nthe Port MIB Control and Status Register  and Port MIB Data Register . All MIB Counters are read-clear. The steps for\nreading a counter are as follows:\n1. Write the MIB Index to bits [23:16] of the Port MIB Control and Status Register .\n2. Set the MIB Read Enable in bit 25 of the Port MIB Control and Status Register . This step and the previous step\nmay be done together.\n3. Read the MIB Read Enable / Count Valid in bit 25 of the Port MIB Control and Status Register . A \'0\' value indi-\ncates that the read is complete and the count is valid.\n4. Read the count value from the Port MIB Data Register . For 36-bit counters, counter bits [35:32] are read from the\nPort MIB Control and Status Register . The Counter Overflow bit is also found in the Port MIB Control and Status\nRegister .0x15 TxHiPriorityByte 30 TX high priority good octet count, including PAUSE packets.\n0x16 TxLateCollision 30 Collision is detected later than 512 bit times into the transmission of a \npacket.\n0x17 TxPausePkts 30 PAUSE frames transmitted. PAUSE is EtherType (0x8808), DA, control \nopcode (0x0001), minimum 64 byte data length, and a valid CRC.\n0x18 TxBroadcastPkts 30 TX good broadcast packets. Does not include erred broadcast packets or \nvalid multicast packets.\n0x19 TxMulticastPkts 30 TX good multicast packets. Does not include MAC control frames, erred \nmulticast packets, or valid broadcast packets.\n0x1A TxUnicastPkts 30 TX good unicast packets.\n0x1B TxDeferred 30 TX packets where the first transmit attempt is delayed due to the busy \nmedium.\n0x1C TxTotalCollision 30 TX total collisions. Half duplex only.\n0x1D TxExcessiveCollision 30 TX fails due to excessive collisions.\n0x1E TxSingleCollision 30 Successfully transmitted frames where transmission is inhibited by \nexactly one collision.\n0x1F TxMultipleCollision 30 Successfully transmitted frames where transmission is inhibited by more \nthan one collision.\n0x80 RxByteCnt 36 RX byte count.\n0x81 TxByteCnt 36 TX byte count.\n0x82 RxDropPackets 30 RX packets dropped due to lack of resources.\n0x83 TXDropPackets 30 TX packets dropped due to lack of resources.TABLE 5-6: MIB COUNTERS (CONTINUED)\nMIB \nIndexMIB CounterSize \n(bits)Description\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 167KSZ9896C\n5.3.6.2 MIB Counter Freeze and Flush Functions\nCounter freeze and flush functions are available on a port-by- port basis. Freezing or flushing counters is initiated by\nsetting the appropriate bit in the Switch MIB Control Register . The freeze or flush function will be applied to all ports for\nwhich the flush and freeze functions have been enabled. To  enable flush and freeze for a port, set bit 24 in the Port MIB\nControl and Status Register .\nThe following steps show an example of how flush and freeze are used to collect MIB statistics for all ports for a period\nof 1 second:\n1. Set the MIB Flush and Freeze Enable bit 24 in the Port MIB Control and Status Register  for all ports N.\n2. Write 0x40 to the Switch MIB Control Register  to freeze the MIB counters for all enabled ports.\n3. Write 0xC0 to the Switch MIB Control Register  to clear the MIB counters for all enabled ports (while continuing\nto also freeze the counters).\n4. At the beginning of the 1 second period, write 0x00 to the Switch MIB Control Register  to enable the counters.\n5. At the end of the 1 second period, write 0x40 to the Switch MIB Control Register  to freeze the counters.\n6. Read each counter for each port.\n5.4 MDIO Manageable Device (MMD) Registers (Indirect)\nMMD registers provide indirect read/write access to up to  32 MMD device addresses with each device supporting up to\n65,536 16-bit registers, as defined in Clause 22 of the IEEE 802.3 Specification. However, the KSZ9896C uses only a\nsmall fraction of the available registers. Refer to Table 5-7, "MMD Register Map"  for a list of accessible MMD device\naddresses and their associated register addresses. Detailed descriptions of the supported  MMD registers are provided\nin the following subsections. Additional information on the MIIM interface is provided in Section 4.9.3, "MII Management\n(MIIM) Interface," on page 55 .\nThe following two standard port registers serve as the portal registers to access the indirect MMD registers.\n•PHY MMD Setup Register  \n•PHY MMD Data Register  \nExample: MMD Register Write\nWrite MMD - Device Address 2h, Register 00h = 0010h to enable single-LED mode.1. Write the PHY MMD Setup Register  with 0002h    // Set up register address for MMD – Device Address 2h.\n2. Write the PHY MMD Data Register  with 0000h    // Select Register 00h of MMD – Device Address 2h.\n3. Write the PHY MMD Setup Register  with 4002h    // Select register data for MMD – Device Address 2h, Reg. 00h.\n4. Write the PHY MMD Data Register  with 0010h    // Write value 0010h to MMD – Device Address 2h, Reg. 00h.\nExample: MMD Register ReadRead MMD - Device Address 2h, Register 11h – 13h for the LED mode status.1. Write the PHY MMD Setup Register  with 0002h    // Set up register address for MMD – Device Address 2h.\n2. Write the PHY MMD Data Register  with 0000h    // Select Register 00h of MMD – Device Address 2h.\n3. Write the PHY MMD Setup Register  with 4002h    // Select register data for MMD – Device Address 2h, Reg. 00h.\n4. Read the PHY MMD Data Register                       // Read data in MMD – Device Address 2h, Reg. 00h.TABLE 5-7: MMD REGISTER MAP\nDevice Address\n (hex)Register Address\n(hex)Description\n2h 00h MMD LED Mode Register\n7h 3Ch MMD EEE Advertisement Register\nKSZ9896C\nDS00002390A-page 168 \uf0e3 2017 Microchip Technology Inc.5.4.1 MMD LED MODE REGISTER\n5.4.2 MMD EEE ADVERTISEMENT REGISTERMMD Address:\nRegister:0x02\n0x00Size: 16 bits\nBits Description Type Default\n15:5 RESERVED RO 0x000\n4 LED Mode\n1 = Single-LED Mode\n0 = Tri-color Dual-LED ModeR/W 0b\n3:0 RESERVED RO 0001b\nMMD Address:\nRegister:0x07\n0x3CSize: 16 bits\nBits Description Type Default\n15:3 RESERVED RO 0x000\n2 1000BASE-T EEE Enable\n1 = 1000 Mbps EEE capable\n0 = No 1000 Mbps EEE capabilityR/W 1b\n1 100BASE-T EEE Enable\n1 = 100 Mbps EEE capable\n0 = No 100 Mbps EEE capabilityR/W 1b\n0 RESERVED RO 0b\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 169KSZ9896C\n6.0 OPERATIONAL CHARACTERISTICS\n6.1 Absolute Maximum Ratings*\nSupply Voltage ( A VDDL , DVDDL ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -0.5 V to +1.8 V\nSupply Voltage ( A VDDH , VDDIO )  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -0.5 V to +5.0 V\nInput Voltage (all inputs) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . -0.5 V to +5.0 V\nOutput Voltage (all outputs). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  . . . . . . . . . -0.5 V to +5.0 V\nLead Temperature (soldering, 20 sec.) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .+260oC\nStorage Temperature (TS). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .-65oC to +150oC\nMaximum Junction Temperature (TJ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .+125oC\nHBM ESD Performance  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  . . . . . . . . . . . . . . +/-6 kV\n*Stresses exceeding those listed in th is section could cause permanent damage to the device. This is a stress rating\nonly. Exposure to absolute maximum rating conditions for extended periods may affect device reliability. Functional\noperation of the device at any condit ion exceeding those indicated in Section 6.2, "Operating Conditions**" , Section 6.3,\n"Electrical Characteristics" , or any other applicable section of  this specification is not implied.\n6.2 Operating Conditions**\nSupply Voltage ( A VDDL , DVDDL ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . +1.14V to +1.26 V\nSupply Voltage ( A VDDH )  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . +2.375 V to +2. 625 V\nSupply Voltage ( VDDIO  @ 3.3V) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . +3.135 V to +3.465 V\nSupply Voltage ( VDDIO  @ 2.5V) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . +2.375 V to +2.625 V\nSupply Voltage ( VDDIO  @ 1.8V) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . +1.71 V to +1.89 V\nAmbient Operating Temperature in Still Air (TA) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .  Note 6-1\nJunction to Ambient Resistance ( \uf051JA) (Note 6-2 ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Note 6-3\nJunction to Case Characterization ( \uf059JT) (Note 6-2 ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 0.04oC/W\nJunction to Case Resistance ( \uf051JC) (Note 6-2 ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Note 6-4\nNote 6-1  0oC to +70oC for commercial version, -40oC to +85oC for industrial version.\nNote 6-2 \uf059JT and \uf051JA are under a 0 m/s air velocity. A 6-layer PCB is required for industrial applications.\nNote 6-3 11.3oC/W on a 6-layer PCB per JESD51, 14.4oC/W on a 4-layer PCB per JESD51. \nNote 6-4 1.5oC/W on a 6-layer PCB per JESD51, 1.21oC/W on a 4-layer PCB per JESD51. \n**Proper operation of the device is ensured only  within the ranges specified in this section.\nKSZ9896C\nDS00002390A-page 170 \uf0e3 2017 Microchip Technology Inc.6.3 Electrical Characteristics\nTA = 25oC.\nTABLE 6-1: ELECTRICAL CHARACTERISTICS\nSymbol Parameter Condit ions Min Typ Max Units\nSupply Current - Full 1000 Mbps Operation\nIDD_AH A VDDH  supply current\nVDDIO  @ 3.3V\nPorts 1-5 in 1000BASE-TPort 6 @ 1000 Mbps\nAll ports 100% utilization330 mA\nI\nDD_IO VDDIO  supply current 80 mA\nIDD_CA A VDDL  supply current 460 mA\nIDD_CD DVDDL  supply current 750 mA\nSupply Current - Mixed 1000/100 Mbps OperationI\nDD_AH A VDDH  supply current\nVDDIO  @ 3.3V\nPorts 1-5 in 100BASE-TX\nPort 6 @ 1000 MbpsAll ports 100% utilization140 mA\nI\nDD_IO VDDIO  supply current 80 mA\nIDD_CA A VDDL  supply current 140 mA\nIDD_CD DVDDL  supply current 350 mA\nSupply Current - Full 100 Mbps Operation\nIDD_AH A VDDH  supply current\nVDDIO  @ 3.3V\nPorts 1-5 in 100BASE-TX\nPort 6 @ 100 Mbps\nAll ports 100% utilization140 mA\nIDD_IO VDDIO  supply current 35 mA\nIDD_CA A VDDL  supply current 140 mA\nIDD_CD DVDDL  supply current 350 mA\nSupply Current - Full 10 Mbps Operation\nIDD_AH A VDDH  supply current\nVDDIO  @ 3.3V\nPorts 1-5 in 10BASE-TPort 6 @ 10Mbps\nAll ports 100% utilization100 mA\nI\nDD_IO VDDIO  supply current (3.3V) 30 mA\nIDD_CA A VDDL  supply current 30 mA\nIDD_CD DVDDL  supply current 150 mA\nSupply Current - Power Management - Energy Detect ModeI\nDD_AH A VDDH  supply current 20 mA\nIDD_IO VDDIO  supply current (3.3V) 30 mA\nIDD_CA A VDDL  supply current 30 mA\nIDD_CD DVDDL  supply current 150 mA\nSupply Current - Power Management - Global Soft Power Down Mode\nIDD_AH A VDDH  supply current 2 mA\nIDD_IO VDDIO  supply current (3.3V) 6 mA\nIDD_CA A VDDL  supply current 0.01 mA\nIDD_CD DVDDL  supply current 5 mA\nI Type CMOS Input Buffers ( VDDIO  = 3.3/2.5/1.8V)\nVIH Input High Voltage 2.1/1.7/1.3 V\nVIL Input Low Volt age 0.9/0.9/0.6 V\nIIN Input Current VIN = GND  ~ VDDIO -10 10 µA\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 171KSZ9896C\nO8 Type CMOS Output Buffers ( VDDIO  = 3.3/2.5/1.8V)\nVOH Output High Voltage IOH = 8/8/6 mA 2.4/1.9/1.5 V\nVOL Output Low Voltage IOL = 8/8/6 mA 0.4/0.4/0.2 V\nIOZ Output Tri-State Leakage VIN = GND  ~ VDDIO 10 µA\nO24 Type CMOS Output Buffers ( VDDIO  = 3.3/2.5/1.8V)\nVOH Output High Voltage IOH = 24/24/20 mA 2.4/1.9/1.5 V\nVOL Output Low Voltage IOL = 24/24/20 mA 0.4/0.4/0.2 V\nIOZ Output Tri-State Leakage VIN = GND  ~ VDDIO 10 µA\nI/O Pin Internal Pull-Up and Pull-Down Effective Resistance\nR1.8PU I/O Pin Effective \nPull-Up Resistance\nVDDIO  = 1.8V125 k Ω\nR1.8PD I/O Pin Effective \nPull-Down Resistance97 k Ω\nR2.5PU I/O Pin Effective \nPull-Up Resistance\nVDDIO  = 2.5V58 k Ω\nR2.5PD I/O Pin Effective \nPull-Down Resistance51 k Ω\nR3.3PU I/O Pin Effective \nPull-Up Resistance\nVDDIO  = 3.3V38 k Ω\nR3.3PD I/O Pin Effective \nPull-Down Resistance39 k Ω\n100BASE-TX Transmit (Measured Differentially After 1:1 Transformer)\nVO Peak Differential Output 100 Ω termination on the \ndifferential output±0.95 ±1.05 V\nVimb Output Voltage Imbalance 100 Ω termination on the \ndifferential output2%\ntr , tf Rise/Fall Time 3 5 ns\nRise/Fall Time Imbalance 0 0.5 nsDuty cycle Distortion\n±0.25 ns\nOvershoot 5%\nVSET Reference Voltage of ISET  \n(using 6.04k Ω - 1% resistor)1.21 V\nOutput Jitter Peak-to-Peak 0.7 1.4 ns\n10BASE-Te ReceiveV\nsq Squelch Threshold 5MHz Square Wave 400 mVTABLE 6-1: ELECTRICAL CHARACTERISTICS (CONTINUED)\nSymbol Parameter Conditions Min Typ Max Units\nKSZ9896C\nDS00002390A-page 172 \uf0e3 2017 Microchip Technology Inc.10BASE-Te Transmit (Measured Differentially After 1:1 Transformer)\nVp Peak Differential Output \nVoltage100Ω termination on the \ndifferential output1.54 1.75 1.96 V\nJitter Added 100 Ω termination on the \ndifferential output (peak-to-peak)3.5 ns\ntr , tf Rise/Fall Time 25 nsTABLE 6-1: ELECTRICAL CHARACTERISTICS (CONTINUED)\nSymbol Parameter Condit ions Min Typ Max Units\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 173KSZ9896C\n6.4 Timing Specifications\nThis section details the various ti ming specifications of the device.\n6.4.1 GMII TIMING\nFigure 6-1  illustrates the GMII timing requirements. Note: The I2C interface timing adheres to the NXP I2C-Bus Specification (UM10204, Rev. 6) (high-speed mode\nand slower). Refer to the I2C-Bus Specification  for additional information. \nFIGURE 6-1: GMII TIMING\nTABLE 6-2: GMII TIMING VALUES\nSymbol Description Min Typ Max Units\ntCYC Clock Period 7.5 8.0 8.5 ns\ntSU TX_DV , TX_ER , TXD[7:0]  setup time to rising edge of \nGTX_CLK2.0 ns\ntHD TX_DV , TX_ER , TXD[7:0]  hold time from rising edge of \nGTX_CLK1.2 ns\ntOD Output skew between GTX_CLK  and RX_DV , RX_ER , \nRXD[7:0]  1n sGTX_CLK\nTX_DV\nTX_ER\nTXD[7:0]tCYC\ntSU tHD\nRX_DV\nRX_ERRXD[7:0]GRX_CLK\ntODtCYC\nKSZ9896C\nDS00002390A-page 174 \uf0e3 2017 Microchip Technology Inc.6.4.2 RGMII TIMING\nFigure 6-2  illustrates the RGMII timing requirements. \nNote 6-5 For cases where there is no (or insufficient) ske w between the input data and input clock, it is\npossible to add internal delay to the TX_CLK pinout by setting the RGMII Ingress Internal Delay bit\nin the XMII Port Control 1 Register  register. This feature reduces the setup time requirement and\nincreases the hold time requi rement nominally by 1.3ns. \nNote 6-6 The RGMII interface adheres to the RGMII Specification Version 2.0, which specified that the driving\ndevice delay the output clock relative to the output data. This is the TSKEW  parameter. This skew can\nbe disabled by clearing the RGMII Egress Internal Delay bit in the XMII Port Control 1 Register\nregister. Generally this is not recommended. \nNote 6-7 For 10Mbps and 100Mbps, TCYC will scale to 400ns +/- 40ns and 40ns +/- 4 ns, respectively. \nNote 6-8 0.75ns for VDDIO  = 3.3V/2.5V, 1.0ns for VDDIO  = 1.8VFIGURE 6-2: RGMII TIMING\nTABLE 6-3: RGMII TIMING VALUES\nSymbol Description Min Typ Max Units\nTSETUP Data to clock input setup ( Note 6-5 )1 . 3 n s\nTHOLD Data to clock input hold ( Note 6-5 )0 . 7 n s\nTSKEW Data to clock output skew ( Note 6-6 )1 . 2 2 . 0 n s\nTCYC Clock cycle duration ( Note 6-7 ) 7 . 288 . 8 n s\nDuty_G 1000Mbps duty cycle 45 50 55 %\nDuty_T 10/100Mbps duty cycle 40 50 60 %\nTr / Tf Rise / Fall time (20-80%) Note 6-8 nsTX_CLK\nTX_CTL\nTXD[3:0]TCYC\nTSETUP THOLD TSETUP THOLD\nRX_CTL\nRXD[3:0]RX_CLK\nTSKEWTCYC\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 175KSZ9896C\n6.4.3 MII TIMING\n6.4.3.1 MII Transmit Timing in MAC Mode\nFigure 6-3  illustrates a write operation from the KSZ9896C to a PHY or other device while operating the KSZ9896C in\nMAC Mode. \nFIGURE 6-3: MII TRANSMIT TIMING IN MAC MODE\nTABLE 6-4: MII TRANSMIT TIMING IN MAC MODE VALUES\nSymbol Description Min Typ Max Units\ntP\n(100BASE-TX / \n10BASE-Te)RX_CLK  period 40/400 ns\ntWL\n(100BASE-TX / \n10BASE-Te)RX_CLK  pulse width low 20/200 ns\ntWH\n(100BASE-TX / \n10BASE-Te)RX_CLK  pulse width high 20/200 ns\ntOD RX_DV , RXD_[3:0]  output delay from rising edge of RX_CLK 16 ns\n\nKSZ9896C\nDS00002390A-page 176 \uf0e3 2017 Microchip Technology Inc.6.4.3.2 MII Receive Timing in MAC Mode\nFigure 6-4  illustrates a read operation by the KSZ9896C from a PHY or other device while operating the KSZ9896C in\nMAC Mode. \nFIGURE 6-4: MII RECEIVE TIMING IN MAC MODE\nTABLE 6-5: MII RECEIVE TIMING IN MAC MODE VALUES\nSymbol Description Min Typ Max Units\ntP\n(100BASE-TX / \n10BASE-Te)TX_CLK  period 40/400 ns\ntWL\n(100BASE-TX / \n10BASE-Te)TX_CLK  pulse width low 20/200 ns\ntWH\n(100BASE-TX / \n10BASE-Te)TX_CLK  pulse width high 20/200 ns\ntSU1 TXD_[3:0]  setup time to rising edge of TX_CLK 10 ns\ntSU2 TX_EN , TX_ER  setup time to rising edge of TX_CLK 10 ns\ntHD1 TXD_[3:0]  hold time from rising edge of TX_CLK 10 ns\ntHD2 TX_EN , TX_ER  hold time from rising edge of TX_CLK 10 ns\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 177KSZ9896C\n6.4.3.3 MII Receive Timing in PHY Mode\nFIGURE 6-5: MII RECEIVE TIMING IN PHY MODE\nTABLE 6-6: MII RECEIVE TIMING IN PHY MODE VALUES\nSymbol Description Min Typ Max Units\ntP\n(100BASE-TX / \n10BASE-Te)RX_CLK  period 40/400 ns\ntWL\n(100BASE-TX / \n10BASE-Te)RX_CLK  pulse width low 20/200 ns\ntWH\n(100BASE-TX / \n10BASE-Te)RX_CLK  pulse width high 20/200 ns\ntOD RX_DV , RXD_[3:0]  output delay from rising edge of RX_CLK 20 ns\n\nKSZ9896C\nDS00002390A-page 178 \uf0e3 2017 Microchip Technology Inc.6.4.3.4 MII Transmit Timing in PHY Mode\nFIGURE 6-6: MII TRANSMIT TIMING IN PHY MODE\nTABLE 6-7: MII TRANSMIT TIMING IN PHY MODE VALUES\nSymbol Description Min Typ Max Units\ntP\n(100BASE-TX / \n10BASE-Te)TX_CLK  period 40/400 ns\ntWL\n(100BASE-TX / \n10BASE-Te)TX_CLK  pulse width low 20/200 ns\ntWH\n(100BASE-TX / \n10BASE-Te)TX_CLK  pulse width high 20/200 ns\ntSU1 TXD_[3:0]  setup time to rising edge of TX_CLK 10 ns\ntSU2 TX_EN , TX_ER  setup time to rising edge of TX_CLK 10 ns\ntHD1 TXD_[3:0]  hold time from rising edge of TX_CLK 0n s\ntHD2 TX_EN , TX_ER  hold time from rising edge of TX_CLK 0n s\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 179KSZ9896C\n6.4.4 RMII TIMING\nFigure 6-7  and Figure 6-8  illustrate the RMII timing requirements. \nFIGURE 6-7: RMII TRANSMIT TIMING\nFIGURE 6-8: RMII RECEIVE TIMING\nTABLE 6-8: RMII TIMING VALUES\nSymbol Description Min Typ Max Units\ntcyc Clock cycle 20 ns\nt1 Setup time 4 ns\nt2 Hold time 2 ns\ntod Output delay 7 9 13 ns\n\nKSZ9896C\nDS00002390A-page 180 \uf0e3 2017 Microchip Technology Inc.6.4.5 MIIM TIMING\nFigure 6-9  illustrates the MIIM timing requirements. \nFIGURE 6-9: MIIM TIMING\nTABLE 6-9: MIIM TIMING VALUES\nSymbol Description Min Typ Max Units\ntP MDC  period 400 ns\ntOD Output delay 200 ns\ntSU MDIO  setup time to rising edge of MDC 10 ns\ntHD MDIO  hold time from rising edge of MDC 5n s\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 181KSZ9896C\n6.4.6 SPI TIMING\nFigure 6-10  and Figure 6-11  illustrate the SPI timing requirements. \nFIGURE 6-10: SPI DATA INPUT TIMING\nFIGURE 6-11: SPI DATA OUTPUT TIMING\nTABLE 6-10: SPI TIMING VALUES\nSymbol Description Min Typ Max Units\nfSCLK SCL clock frequency 50 MHz\nt1 SCS_N  active setup time 8 ns\nt2 SDI data input setup time 3 ns\nt3 SDI data input hold time 3 ns\nt4 SCS_N  active hold time 8 ns\nt5 SCS_N  disable high time 8 ns\nt6 SCL falling edge to SDO data output valid 2 9 ns\nt7 SCS_N  inactive to SDO data input invalid 1 ns\nSCS_N\nSDI\nSDOSCL\nSCLSCS_N\nSDO\nSDO\nSDI\nKSZ9896C\nDS00002390A-page 182 \uf0e3 2017 Microchip Technology Inc.6.4.7 AUTO-NEGOTIATION TIMING\nFigure 6-12  illustrates the Auto-Negotiation timing requirements. \nFIGURE 6-12: AUTO- NEGOTIATION TIMING\nTABLE 6-11: AUTO-NEGOTIATION TIMING VALUES\nSymbol Description Min Typ Max Units\ntBTB FLP burst to FLP burst 8 16 24 ms\ntFLPW FLP burst width 2 ms\ntPW Clock/Data pulse width 100 ns\ntCTD Clock pulse to data pulse 55.5 64 69.5 \uf06ds\ntCTC Clock pulse to cl ock pulse 111 128 139 \uf06ds\nNumber of clock/data pulses per burst 17 33\n\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 183KSZ9896C\n6.4.8 POWER-UP AND RESET TIMING\nFigure 6-13  illustrates the power-up and reset timing requirements. \nFIGURE 6-13: POWER-UP AND RESET TIMING\nTABLE 6-12: POWER-UP AND RESET TIMING VALUES\nSymbol Description Min Typ Max Units\ntvr Supply voltage rise time (must be monotonic) 200 \uf06ds\ntsr Stable supply voltages to de-assertion of reset 10 ms\ntcs Configuration strap input setup time 5 ns\ntch Configuration strap input hold time 5 ns\ntrc De-assertion of reset to configuration strap pin output 6 ns\ntpc Supply voltages cycle off-to-on time 150 ms\nNote 1: The recommended powering sequence is to bring up all voltages at the same time. However, if that cannot\nbe attained, then the recommended power-up sequence is to power-up the transceiver ( A VDDH ) and dig-\nital I/Os ( VDDIO ) voltages before the low voltage core ( A VDDL  and DVDDL ). There is no power sequence\nrequirement between transceiver ( A VDDH ) and digital I/Os ( VDDIO ) power rails. The power-up waveforms\nshould be monotonic for all supply voltages. \nNote 2: After the de-assertion of reset, it is recommended to wait a minimum of 100 \uf06ds before starting to program\nthe device through any interface.\nNote 3: The recommended power down sequence is to power down the low voltage core before powering downthe transceiver and digital I/O voltages, or to have all supplies power down in unison.Before the next power-up cycle, all supply voltages to the device should reach less than 0.4V and there\nshould be a minimum wait time of 150ms from power-off to power-on.tsr\ntcs tch\ntrcSUPPLY \nVOLTAGES\nRESET_N\nCONFIGURATION \nSTRAP INPUT\nCONFIGURATION \nSTRAP OUTPUTCORE (AVDDL, DVDDL)TRANSCEIVER (AVDDH), DIGITAL I/Os (VDDIO)\ntvrtpcNOTE \n1\nNOTE \n2NOTE \n3\nKSZ9896C\nDS00002390A-page 184 \uf0e3 2017 Microchip Technology Inc.6.5 Clock Specifications\nA crystal or external clock source, such as an oscillator,  is used to provide a 25MHz reference clock for the KSZ9896C.\nIf an external clock source is used, the XO pin must be left floating. Since the XI/XO circuit is powered from A VDDH ,\nthe external clock source should also be powered from the same power rail. Figure 6-14  details the available connection\nmethods. Table 6-13  details the recommended crystal specifications.\nFIGURE 6-14: INPUT REFERENCE  CLOCK CONNECTION OPTIONS\nTABLE 6-13: REFERENCE CRYSTAL CHARACTERISTICS\nCharacteristic Min Typ Max Units\nOscillation Mode Fundamental\nFrequency 25 MHz\nFrequency tolerance ±50 ppm\nEffective Series Resistance (ESR) 50 Ω\nTotal period jitter (peak-to-peak) 100 ps\nDrive level 100 uW\n25 MHz OSC \n+/-50ppm\nNo\nConnect\n                \n   XI\n   XO\n               \n   XI\n   XO\n25 MHz XTAL \n+/-50ppmEthernet Switch Ethernet Switch\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 185KSZ9896C\n7.0 DESIGN GUIDELINES\nThis section provides general design guidelines for the following:\n•Reset Circuit Guidelines\n•Magnetics Connection and Selection Guidelines\n7.1 Reset Circuit Guidelines\nFigure 7-1  illustrates the recommended reset circuit for powering up the KSZ9896C if reset is triggered by the power\nsupply. \nFigure 7-2  illustrates a reset circuit recommended for applications where reset is driven by another device, such as a\nCPU. At power-on reset, R, C and D1 provide the necessary ramp rise time to reset the KSZ9896C. The RST_OUT_N\nfrom the CPU provides a warm reset after power-up.FIGURE 7-1: SIMPLE RESET CIRCUIT\nFIGURE 7-2: RESET CIRCUI T FOR CPU RESET INTERFACEEthernet\nSwitchVDDIO\nD1D1: 1N4148\nR 10K\nC 10uFRESET_N\nEthernet\nSwitch CPU/FPGAVDDIO\nC 10uFR 10K\nRST_OUT_ND1\nD2\nD1, D2: 1N4148RESET_N\nKSZ9896C\nDS00002390A-page 186 \uf0e3 2017 Microchip Technology Inc.7.2 Magnetics Connection and Selection Guidelines\nA 1:1 isolation transformer is required at the line interfac e. For designs exceeding FCC requirements, utilize one with\nintegrated common-mode chokes. An optional auto-transform er stage following the chokes provides additional com-\nmon-mode noise and signal attenuation.\nThe KSZ9896C PHY port design incorporates voltage-mode tr ansmit drivers and on-chip terminations. With the voltage-\nmode implementation, the transmit drivers supply the common-m ode voltages to the four differential pairs. Therefore,\nthe four transformer center tap pins on the KSZ9896C chip side should not be connected to any power supply source\non the board; rather, the center tap pins should be sepa rated from one another and connected through separate 0.1µF\ncommon-mode capacitors to ground. Separation is re quired because the common-mode voltage could be different\nbetween the differential pairs, depending on the connected speed mode.\nFigure 7-3  details a typical magnetic interface circuit for the KSZ9896C PHY port. \nTable 7-1  provides a list of recommended magnetic characteristics. FIGURE 7-3: TYPICAL MAGNETIC INTERFACE CIRCUIT\nTABLE 7-1: MAGNETICS SELECTION CRITERIA\nParameter Value Test Condition\nTurns ratio 1 CT : 1 CT\nOpen-circuit inductance (min.) 350µH 100mV, 100KHz, 8mA\nInsertion loss (typ.) 1.0dB 100KHz to 100MHzHIPOT (min.) 1500vrms\n1\n2\n3\n7\n84\n5\n6\n4X 75 \nOhm\n1000 pF / 2kV\nCHASSIS GROUND(4X 0.1uF)TXRX xP_A\nTXRX xM_A\nTXRX xP_B\nTXRX xM_B\nTXRX xP_C\nTXRX xM_C\nTXRX xP_D\nTXRX xM_D\nSIGNAL GROUND\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 187KSZ9896C\nTable 7-2  provides a list of KSZ9896C compatible single-port magnetics with separated transformer center tap pins on\nthe Gigabit PHY chip side. \nTABLE 7-2: COMPATIBLE SINGLE -PORT 10/100/1000 MAGNETICS\nManufacturer Part Nu mber Auto-TransformerTemperature \nRangeMagnetic + \nRJ-45\nBel Fuse 0826-1G1T-23-F Yes 0°C to 70°C Yes\nHALO TG1G-E001NZRL No –40°C to 85°C No\nHALO TG1G-S001NZRL No 0°C to 70°C No\nHALO TG1G-S002NZRL Yes 0°C to 70°C No\nPulse H5007NL Yes 0°C to 70°C No\nPulse H5062NL Yes 0°C to 70°C No\nPulse HX5008NL Yes –40°C to 85°C No\nPulse JK0654219NL Yes 0°C to 70°C Yes\nPulse JK0-0136NL No 0°C to 70°C Yes\nTDK TLA-7T101LF No 0°C to 70°C No\nWurth/Midcom 000-7093-37R-LF1 Yes 0°C to 70°C No\nKSZ9896C\nDS00002390A-page 188 \uf0e3 2017 Microchip Technology Inc.8.0 PACKAGE INFORMATION\n8.1 Package Marking Information\n \n*Standard device marking consists of Microchip part number, year code, week code and traceability code.\nFor device marking beyond this, certain price adders apply. Please check with your Microchip Sales Office.\nFor QTP devices, any special marking adders are included in QTP price.Legend: t Temperature range designator (C = commercial, I = industrial)R Product revision\nnnn Internal code\ne3 Pb-free JEDEC\n® designator for Matte Tin (Sn)\nVVV Plant assembly\nCO Country of origin\nYY Year code (last two digits of calendar year)WW Week code (week of January 1 is week ‘01’)\nNNN Alphanumeric traceability code\nNote: In the event the full Microchip part number cannot be marked on one line, it\nwill be carried over to the next line, thus limiting the number of availablecharacters for customer-specific information.128-TQFP-EP\nMICROCHIPKSZ9896CTXt\nRnnn e3VVVCO\nYYWWNNN\ne3\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 189KSZ9896C\n8.2 Package Drawings\nNote: For the most current package drawings, please see the Microchip Packaging Specification located at \nhttp://www.microchip.com/packaging\nFIGURE 8-1: PACKAGE (DRAWING & DIMENSIONS)\n\nKSZ9896C\nDS00002390A-page 190 \uf0e3 2017 Microchip Technology Inc.APPENDIX A: DATA SHEET  REVISION HISTORY\nTABLE A-1: REVISION HISTORY\nRevision Section/Figure/Entry Correction\nDS00002390A (03-06-17) Initial Document Release\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 191KSZ9896C\nTHE MICROCHIP WEB SITE\nMicrochip provides online support via our WWW site at www.microchip.com . This web site is used as a means to make\nfiles and information easily available to customers. Accessible by using your favorite Internet browser, the web site con-\ntains the following information:\n•Product Support  – Data sheets and errata, application notes and sample programs, design resources, user’s \nguides and hardware support documents, latest software releases and archived software\n•General Technical Support  – Frequently Asked Questions (FAQ), technical support requests, online discussion \ngroups, Microchip consultant program member listing\n•Business of Microchip  – Product selector and ordering guides, latest  Microchip press releases, listing of semi-\nnars and events, listings of Microchip sales offi ces, distributors and factory representatives\nCUSTOMER CHANGE NOTIFICATION SERVICE\nMicrochip’s customer notification service helps keep customer s current on Microchip products. Subscribers will receive\ne-mail notification whenever there are changes, updates, revisi ons or errata related to a specified product family or\ndevelopment tool of interest.\nTo register, access the Microchip web site at www.microchip.com . Under “Support”, click on “Customer Change Notifi-\ncation” and follow the registration instructions.\nCUSTOMER SUPPORT\nUsers of Microchip products can receive assistance through several channels:\n• Distributor or Representative\n• Local Sales Office• Field Application Engineer (FAE)\n• Technical Support\nCustomers should contact their distributor, representative or field application engineer (FAE) for support. Local sales\noffices are also available to help customers. A listing of sales offices and locations is included in the back of this docu-\nment.\nTechnical support is available through the web site at: http://www.microchip.com/support\nKSZ9896C\nDS00002390A-page 192 \uf0e3 2017 Microchip Technology Inc.PRODUCT IDENTIFICATION SYSTEM\nTo order or obtain information, e.g., on pricing or de livery, refer to the factory or the listed sales office . \n   \nDevice: KSZ9896C = 7-Port Switch with 1 GMII/RGMII/MII/RMII\nPackage: TX = 128-pin TQFP-EP\nTemperature \nRange:C=  0 \uf0b0C to +70 \uf0b0C (Commercial)\nI=  - 4 0 \uf0b0C to +85 \uf0b0C (Industrial)\nTape and Reel \nOption:Blank = Standard packaging (tray)\n-TR = Tape and Reel (Note 1)Examples:\na) KSZ9896CTXC\n128-pin TQFP-EP package,\nCommercial temperature,Standard packaging\nb) KSZ9896CTXI-TR\n128-pin TQFP-EP package,Industrial temperature,\nTape and reel\nNote 1: Tape and Reel identifier only appears in the catalog part number description. This \nidentifier is used for ordering purposes and is not printed on the device package. \nCheck with your Microc hip Sales Office for \npackage availability with the Tape and Reel option.PART NO. X XX\nPackage Temp. Device[XX](1)\nTape & Reel\nOption Range\n\uf0e3 2017 Microchip Technology Inc. DS00002390A-page 193KSZ9896C\nInformation contained in this publication r egarding device applications and the like is  provided only for your convenience and may be\nsuperseded by updates. It is your responsibility to ensure that your application meets with yo ur specifications. MICROCHIP MAKE S NO\nREPRESENTATIONS OR WARRANTIES OF ANY KIND WHETHER EXPRESS OR IMPLIED, WRITTEN OR ORAL, STATUTORY OR\nOTHERWISE, RELATED TO THE INFORMATION, INCLUDING BUT NOT LIMITED TO ITS CONDITION, QUALITY, PERFORMANCE,\nMERCHANTABILITY OR FI TNESS FOR PURPOSE . Microchip disclaims all liabilit y arising from this information and its use. Use of Micro-\nchip devices in life support and/or safety  applications is entirely at the buyer’ s risk, and the buyer agrees to defend, indemn ify and hold\nharmless Microchip from any and all damages, claims, suits, or ex penses resulting from such use. No licenses are conveyed, impl icitly or\notherwise, under any Microchip intellectual property rights unless otherwise stated.\nTrademarks\nThe Microchip name and logo, the Microchip logo, AnyRate, AVR, AVR logo, AVR Freaks, BeaconThings, BitCloud, CryptoMemory, Cryp toRF, \ndsPIC, FlashFlex, flexPWR, Heldo, JukeBlox, K EELOQ, KEELOQ logo, Kleer, LANCheck, LINK MD, maXStylus, maXTouch, MediaLB, megaAVR, \nMOST, MOST logo, MPLAB, OptoLyzer, PIC, picoPower, PICSTART, PIC32 logo, Prochip Designer, QTouch, RightTouch, SAM-BA, SpyNIC, SST, SST Logo, SuperFlash, tinyAVR, UNI/O, and XMEGA are registered trademarks of Microchip Technology Incorporated in the U.S. A. and \nother countries.\nClockWorks, The Embedded Control Solutions Company, EtherSynch, Hyper Speed Control, HyperLight Load, IntelliMOS, mTouch, Preci sion \nEdge, and Quiet-Wire are registered trademarks of Microchip Technology Incorporated in the U.S.A.\nAdjacent Key Suppression, AKS, Analog-for-the-Digital Age, Any Capacitor, AnyIn, AnyOut, BodyCom, chipKIT, chipKIT logo, CodeGu ard, \nCryptoAuthentication, CryptoCompanion, CryptoController, dsPICDEM, dsPICDEM.net, Dynamic Average Matching, DAM, ECAN, EtherGREEN, In-Circuit Serial Programming, ICSP, Inter-Chip Connectivity, JitterBlocker, KleerNet, KleerNet logo, Mindi, MiWi, motorBench, \nMPASM, MPF, MPLAB Certified logo, MPLIB, MPLINK, MultiTRAK, NetDetach, Omniscient Code Generation, PICDEM, PICDEM.net, PICkit, \nPICtail, PureSilicon, QMatrix, RightTouch logo, REAL ICE, Ripple Blocker, SAM-ICE, Serial Quad I/O, SMART-I.S., SQI, SuperSwitc her, \nSuperSwitcher II, Total Endurance, TSHARC, USBCheck, VariSense, ViewSpan, WiperLock, Wireless DNA, and ZENA are trademarks of \nMicrochip Technology Incorporated in the U.S.A. and other countries.\nSQTP is a service mark of Microchip Technology Incorporated in the U.S.A.Silicon Storage Technology is a registered trademark of Microchip Technology Inc. in other countries.\nGestIC is a registered trademark of Microchip Technology Germany II GmbH & Co. KG, a subsidiary of Microchip Technology Inc., i n other \ncountries. \nAll other trademarks mentioned herein are property of their respective companies.\n© 2017, Microchip Technology Incorporated, All Rights Reserved. \nISBN: 9781522414520Note the following details of the code protection feature on Microchip devices:\n• Microchip products meet the specification cont ained in their particular Microchip Data Sheet.\n• Microchip believes that its family of products is one of the mo st secure families of its kind on the market today, when used i n the \nintended manner and under normal conditions.\n• There are dishonest and possibly illegal meth ods used to breach the code protection fe ature. All of these methods, to our \nknowledge, require using the Microchip pr oducts in a manner outside the operating specif ications contained in Microchip’s Data \nSheets. Most likely, the person doing so is engaged in theft of intellectual property.\n• Microchip is willing to work with the customer  who is concerned about the integrity of their code.\n• Neither Microchip nor any other semiconduc tor manufacturer can guarantee the security of their code. Code protection does not \nmean that we are guaranteeing the product as “unbreakable.”\nCode protection is constantly evolving. We at Microchip are committed to continuously improving the code protection features of  our\nproducts. Attempts to break Microchip’s c ode protection feature may be a violation of  the Digital Millennium  Copyright Act. If such acts\nallow unauthorized access to your softwa re or other copyrighted work, you may have a right to sue for relief under that Act.\nMicrochip received ISO/TS-16949:2009 certification for its worldwide \nheadquarters, design and wafer fabrication facilities in Chandler and Tempe, Arizona; Gresham, Oregon and design centers in California and India. The Company’s quality system processes and procedures \nare for its PIC\n® MCUs and dsPIC® DSCs, K EELOQ® code hopping \ndevices, Serial EEPROMs, microper ipherals, nonvolatile memory and \nanalog products. In addition, Microchip’s quality system for the design and manufacture of development syst ems is ISO 9001:2000 certified.QUALITY \tMANAGEMENT \t\tSYSTEM\t\nCERTIFIED \tBY\tDNV\t\n== ISO/TS\t16949 \t==\t\nDS00002390A-page 194 \uf0e3 2017 Microchip Technology Inc.\nAMERICAS\nCorporate Office\n2355 West Chandler Blvd.\nChandler, AZ 85224-6199Tel: 480-792-7200 \nFax: 480-792-7277\nTechnical Support: http://www.microchip.com/\nsupport\nWeb Address: www.microchip.com\nAtlanta\nDuluth, GA Tel: 678-957-9614 Fax: 678-957-1455\nAustin, TX\nTel: 512-257-3370 \nBoston\nWestborough, MA Tel: 774-760-0087 \nFax: 774-760-0088\nChicago\nItasca, IL \nTel: 630-285-0071 \nFax: 630-285-0075\nDallas\nAddison, TX \nTel: 972-818-7423 \nFax: 972-818-2924\nDetroit\nNovi, MI \nTel: 248-848-4000\nHouston, TX \nTel: 281-894-5983\nIndianapolis\nNoblesville, IN Tel: 317-773-8323\nFax: 317-773-5453\nTel: 317-536-2380\nLos Angeles\nMission Viejo, CA Tel: 949-462-9523\nFax: 949-462-9608\nTel: 951-273-7800 \nRaleigh, NC \nTel: 919-844-7510\nNew York, NY \nTel: 631-435-6000\nSan Jose, CA \nTel: 408-735-9110Tel: 408-436-4270\nCanada - Toronto\nTel: 905-695-1980 Fax: 905-695-2078ASIA/PACIFIC\nAsia Pacific Office\nSuites 3707-14, 37th FloorTower 6, The GatewayHarbour City, Kowloon\nHong Kong\nTel: 852-2943-5100Fax: 852-2401-3431\nAustralia - Sydney\nTel: 61-2-9868-6733\nFax: 61-2-9868-6755\nChina - Beijing\nTel: 86-10-8569-7000 \nFax: 86-10-8528-2104\nChina - Chengdu\nTel: 86-28-8665-5511Fax: 86-28-8665-7889\nChina - Chongqing\nTel: 86-23-8980-9588\nFax: 86-23-8980-9500\nChina - Dongguan\nTel: 86-769-8702-9880 \nChina - Guangzhou\nTel: 86-20-8755-8029 \nChina - Hangzhou\nTel: 86-571-8792-8115 \nFax: 86-571-8792-8116\nChina - Hong Kong SAR\nTel: 852-2943-5100 \nFax: 852-2401-3431\nChina - Nanjing\nTel: 86-25-8473-2460\nFax: 86-25-8473-2470\nChina - Qingdao\nTel: 86-532-8502-7355Fax: 86-532-8502-7205\nChina - Shanghai\nTel: 86-21-3326-8000 \nFax: 86-21-3326-8021\nChina - Shenyang\nTel: 86-24-2334-2829\nFax: 86-24-2334-2393\nChina - Shenzhen\nTel: 86-755-8864-2200 \nFax: 86-755-8203-1760\nChina - Wuhan\nTel: 86-27-5980-5300\nFax: 86-27-5980-5118\nChina - Xian\nTel: 86-29-8833-7252Fax: 86-29-8833-7256ASIA/PACIFIC\nChina - Xiamen\nTel: 86-592-2388138 Fax: 86-592-2388130\nChina - Zhuhai\nTel: 86-756-3210040 \nFax: 86-756-3210049\nIndia - Bangalore\nTel: 91-80-3090-4444 \nFax: 91-80-3090-4123\nIndia - New Delhi\nTel: 91-11-4160-8631Fax: 91-11-4160-8632\nIndia - Pune\nTel: 91-20-3019-1500\nJapan - Osaka\nTel: 81-6-6152-7160 Fax: 81-6-6152-9310\nJapan - Tokyo\nTel: 81-3-6880- 3770 \nFax: 81-3-6880-3771\nKorea - Daegu\nTel: 82-53-744-4301\nFax: 82-53-744-4302\nKorea - Seoul\nTel: 82-2-554-7200Fax: 82-2-558-5932 or 82-2-558-5934\nMalaysia - Kuala Lumpur\nTel: 60-3-6201-9857Fax: 60-3-6201-9859\nMalaysia - Penang\nTel: 60-4-227-8870\nFax: 60-4-227-4068\nPhilippines - Manila\nTel: 63-2-634-9065\nFax: 63-2-634-9069\nSingapore\nTel: 65-6334-8870Fax: 65-6334-8850\nTaiwan - Hsin Chu\nTel: 886-3-5778-366Fax: 886-3-5770-955\nTaiwan - Kaohsiung\nTel: 886-7-213-7830\nTaiwan - Taipei\nTel: 886-2-2508-8600 Fax: 886-2-2508-0102\nThailand - Bangkok\nTel: 66-2-694-1351Fax: 66-2-694-1350EUROPE\nAustria - Wels\nTel: 43-7242-2244-39Fax: 43-7242-2244-393\nDenmark - Copenhagen\nTel: 45-4450-2828 \nFax: 45-4485-2829\nFinland - Espoo\nTel: 358-9-4520-820\nFrance - Paris\nTel: 33-1-69-53-63-20 Fax: 33-1-69-30-90-79\nFrance - Saint Cloud\nTel: 33-1-30-60-70-00 \nGermany - Garching\nTel: 49-8931-9700\nGermany - Haan\nTel: 49-2129-3766400\nGermany - Heilbronn\nTel: 49-7131-67-3636\nGermany - Karlsruhe\nTel: 49-721-625370\nGermany - Munich\nTel: 49-89-627-144-0 \nFax: 49-89-627-144-44\nGermany - Rosenheim\nTel: 49-8031-354-560\nIsrael - Ra’anana \nTel: 972-9-744-7705\nItaly - Milan \nTel: 39-0331-742611 \nFax: 39-0331-466781\nItaly - Padova\nTel: 39-049-7625286 \nNetherlands - Drunen\nTel: 31-416-690399 Fax: 31-416-690340\nNorway - Trondheim\nTel: 47-7289-7561\nPoland - Warsaw\nTel: 48-22-3325737 \nRomania - Bucharest\nTel: 40-21-407-87-50\nSpain - Madrid\nTel: 34-91-708-08-90Fax: 34-91-708-08-91\nSweden - Gothenberg\nTel: 46-31-704-60-40\nSweden - Stockholm\nTel: 46-8-5090-4654\nUK - Wokingham\nTel: 44-118-921-5800\nFax: 44-118-921-5820Worldwide Sales and Service\n11/07/16\nMouser Electronics\n  \nAuthorized Distributor\n \n  \nClick to View Pricing, Inventory, Delivery & Lifecycle Information:\n \n \n \n Microchip:   \n\xa0 KSZ9896CTXC\xa0 KSZ9896CTXC-TR\xa0 KSZ9896CTXI\xa0 KSZ9896CTXI-TR\n'}]
!==============================================================================!
### Component Summary: KSZ9896CTXI-TR

**Manufacturer:** Microchip Technology  
**Product Code:** KSZ9896CTXI-TR  
**Description:** The KSZ9896C is a highly integrated, IEEE 802.3 compliant networking device that functions as a managed Gigabit Ethernet switch. It includes five integrated 10/100/1000BASE-T PHY transceivers and one configurable GMII/RGMII/MII/RMII MAC port for direct connection to a host processor or another Ethernet switch.

#### Key Specifications:
- **Voltage Ratings:**
  - Core Supply Voltage (AVDDL, DVDDL): +1.14V to +1.26V
  - PHY Supply Voltage (AVDDH): +2.375V to +2.625V
  - I/O Supply Voltage (VDDIO): +1.8V, +2.5V, or +3.3V

- **Current Ratings:**
  - Supply Current (Full 1000 Mbps Operation): 330 mA (AVDDH), 80 mA (VDDIO), 460 mA (AVDDL), 750 mA (DVDDL)

- **Power Consumption:**
  - Varies based on operation mode; energy detect mode consumes significantly less power.

- **Operating Temperature Range:**
  - Commercial: 0°C to +70°C
  - Industrial: -40°C to +85°C

- **Package Type:**
  - 128-pin TQFP-EP (14 x 14 mm), RoHS compliant

- **Special Features:**
  - Supports IEEE 802.1X access control
  - Non-blocking wire-speed Ethernet switching fabric
  - Full VLAN and QoS support
  - EtherGreen™ power management features, including low power standby
  - Flexible management interface options: SPI, I2C, MIIM, and in-band management via any port
  - Supports jumbo frames up to 9000 bytes
  - LinkMD® cable diagnostics for cable integrity checks

- **Moisture Sensitive Level (MSL):** 
  - MSL is not specified in the provided data.

#### Typical Applications:
- Stand-alone 10/100/1000 Mbps Ethernet switches
- VoIP infrastructure switches
- Broadband gateways/firewalls
- Wi-Fi access points
- Integrated DSL/cable modems
- Security/surveillance systems
- Industrial control/automation switches
- Networked measurement and control systems

### Conclusion:
The KSZ9896CTXI-TR is a versatile and efficient Ethernet switch suitable for various networking applications, particularly in environments requiring robust performance and power management. Its support for multiple Ethernet standards and management interfaces makes it an ideal choice for modern networking solutions.