[{'role': 'system', 'content': 'You are a technical specialist with expertise in electronics. Your task is to analyze datasheets for electronic components and provide a concise summary of the product’s key characteristics and specifications. In addition, you need to gather textual information about the component, including its description and typical applications.Instructions:    Identify the correct component in the datasheet using the provided product code.    Summarize key parameters, including:        Voltage ratings        Current ratings        Power consumption        Operating temperature range        Package type        Special features or notes (if applicable)        Moisture Sensetive Level JEDEC J-STD-020E    Provide a short description of the component, including what it is (e.g., transistor, microcontroller, sensor) and its primary function.    Explain typical applications for the component (e.g., power management, signal processing, data storage, etc.).    Be thorough and accurate: Ensure the information corresponds specifically to the product code, as some datasheets cover multiple variants.Your goal is to create a clear and accurate technical summary that includes both key specifications and a description of what the component is used for.'}, {'role': 'user', 'content': 'Give me information about the component of PIC16F684-I/SL production of MICROCHIP TECHNOLOGY from the text:© 2007 Microchip Technology Inc. DS41202FPIC16F684\nData Sheet\n14-Pin, Flash-Based 8-Bit\nCMOS Microcontrollers\nwith nanoWatt Technology\nDS41202F-page ii © 2007 Microchip Technology Inc.Information contained in this publication regarding device\napplications and the like is provided only for your convenience\nand may be superseded by updates. It is your responsibility toensure that your application meets with your specifications.\nMICROCHIP MAKES NO REPRESENTATIONS OR\nWARRANTIES OF ANY KIND WHETHER EXPRESS OR\nIMPLIED, WRITTEN OR ORAL, STATUTORY OR\nOTHERWISE, RELATED TO THE INFORMATION,\nINCLUDING BUT NOT LIMITED TO ITS CONDITION,\nQUALITY, PERFORMANCE, MERCHANTABILITY OR\nFITNESS FOR PURPOSE . Microchip disclaims all liability\narising from this information and its use. Use of Microchip\ndevices in life support and/or safety applications is entirely at\nthe buyer’s risk, and the buyer agrees to defend, indemnify and\nhold harmless Microchip from any and all damages, claims,suits, or expenses resulting from such use. No licenses are\nconveyed, implicitly or otherwise, under any Microchip\nintellectual property rights.Trademarks\nThe Microchip name and logo, the Microchip logo, Accuron, \ndsPIC, K EELOQ, KEELOQ logo, micro ID, MPLAB, PIC, \nPICmicro, PICSTART, PRO MATE, PowerSmart, rfPIC, and \nSmartShunt are registered tr ademarks of Microchip \nTechnology Incorporated in the U.S.A. and other countries.\nAmpLab, FilterLab, Linear Active Thermistor, Migratable \nMemory, MXDEV, MXLAB, PS logo, SEEVAL, SmartSensor \nand The Embedded Control Solutions Company are \nregistered trademarks of Micr ochip Technology Incorporated \nin the U.S.A.\nAnalog-for-the-Digital Age, Appl ication Maestro, CodeGuard, \ndsPICDEM, dsPICDEM.net, dsPICworks, ECAN, \nECONOMONITOR, FanSense, FlexROM, fuzzyLAB, \nIn-Circuit Serial Programming, ICSP, ICEPIC, Mindi, MiWi, MPASM, MPLAB Certified logo, MPLIB, MPLINK, PICkit, \nPICDEM, PICDEM.net, PICLAB, PICtail, PowerCal, \nPowerInfo, PowerMate, Powe rTool, REAL ICE, rfLAB, \nrfPICDEM, Select Mode, Smart Serial, SmartTel, Total \nEndurance, UNI/O, WiperLock and ZENA are trademarks of \nMicrochip Technology Incorporated in the U.S.A. and other countries.\nSQTP is a service mark of Mi crochip Technology Incorporated \nin the U.S.A.\nAll other trademarks mentioned herein are property of their \nrespective companies.\n© 2007, Microchip Technology Incorporated, Printed in the \nU.S.A., All Rights Reserved.\n Printed on recycled paper.\nNote the following details of the code protection feature on Microchip devices:\n\x81 Microchip products meet the specification cont ained in their particular Microchip Data Sheet.\n\x81 Microchip believes that its family of products is one of the mo st secure families of its kind on the market today, when used i n the \nintended manner and under normal conditions.\n\x81 There are dishonest and possibly illegal methods used to breach the code protection feature. All of these methods, to our \nknowledge, require using the Microchip produc ts in a manner outside the operating specif ications contained in Microchip’s Data \nSheets. Most likely, the person doing so is  engaged in theft of intellectual property.\n\x81 Microchip is willing to work with the customer who is concerned about the integrity of their code.\n\x81 Neither Microchip nor any other semiconductor manufacturer c an guarantee the security of their code. Code protection does not \nmean that we are guaranteeing the product as “unbreakable.”\nCode protection is constantly evolving. We at Microchip are co mmitted to continuously improvi ng the code protection features of  our\nproducts. Attempts to break Microchip’s c ode protection feature may be a violation of the Digital Millennium Copyright Act. If such acts\nallow unauthorized access to your software or other copyrighted work, you may have a right to sue for relief under that Act.\nMicrochip received ISO/TS-16949:2002 certification for its worldwide \nheadquarters, design and wafer fabrication facilities in Chandler and \nTempe, Arizona, Gresham, Oregon and Mountain View, California. The \nCompany’s quality system processes and procedures are for its PIC® \nMCUs and dsPIC® DSCs, K EELOQ® code hopping devices, Serial \nEEPROMs, microperipherals, nonvolatile memory and analog products. In addition, Microchip’s quality system for the design and \nmanufacture of development systems is ISO 9001:2000 certified.\n\n© 2007 Microchip Technology Inc. DS41202F-page 1PIC16F684\nHigh-Performance RISC CPU:\n\x81 Only 35 instructions to learn:\n- All single-cycle instructions except branches\n\x81 Operating speed:\n- DC – 20 MHz oscillator/clock input\n- DC – 200 ns instruction cycle\n\x81 Interrupt capability\n\x81 8-level deep hardware stack\n\x81 Direct, Indirect and Relative Addressing modes\nSpecial Microcontroller Features:\n\x81 Precision Internal Oscillator:\n- Factory calibrated to ±1%, typical\n- Software selectable frequency range of \n8 MHz to 125 kHz\n- Software tunable\n- Two-Speed Start-up mode- Crystal fail detect for critical applications\n- Clock mode switching during operation for \npower savings\n\x81 Software Selectable 31 kHz Internal Oscillator\n\x81 Power-Saving Sleep mode\x81 Wide operating voltage range (2.0V-5.5V)\n\x81 Industrial and Extended Temperature range\n\x81 Power-on Reset (POR)\x81 Power-up Timer (PWRT) and Oscillator Start-up \nTimer (OST)\n\x81 Brown-out Reset (BOR) with software control \noption\n\x81 Enhanced low-current Watchdog Timer (WDT) \nwith on-chip oscillator (software selectable nominal 268 seconds with full prescaler) with \nsoftware enable\n\x81 Multiplexed Master Clear with pull-up/input pin\n\x81 Programmable code protection\x81 High Endurance Flash/EEPROM cell:\n- 100,000 write Flash endurance\n- 1,000,000 write EEPROM endurance\n- Flash/Data EEPROM retention: > 40 yearsLow-Power Features:\n\x81 Standby Current:\n- 50 nA @ 2.0V, typical\n\x81 Operating Current:\n-1 1 μA @ 32 kHz, 2.0V, typical\n-2 2 0 μA @ 4 MHz, 2.0V, typical\n\x81 Watchdog Timer Current:\n-1μA @ 2.0V, typical\nPeripheral Features:\n\x81 12 I/O pins with individual direction control:\n- High current source/sink for direct LED drive\n- Interrupt-on-change pin\n- Individually programmable weak pull-ups\n- Ultra Low-Power Wake-Up (ULPWU)\n\x81 Analog Comparator module with:\n- Two analog comparators\n- Programmable on-chip voltage reference \n(CV REF) module (% of V DD)\n- Comparator inputs and outputs externally \naccessible\n\x81 A/D Converter:\n- 10-bit resolution and 8 channels\n\x81 Timer0: 8-bit timer/counter with 8-bit \nprogrammable prescaler\n\x81 Enhanced Timer1:\n- 16-bit timer/counter with prescaler\n- External Timer1 Gate (count enable)\n- Option to use OSC1 and OSC2 in LP mode \nas Timer1 oscillator if INTOSC mode \nselected\n\x81 Timer2: 8-bit timer/counter with 8-bit period \nregister, prescaler and postscaler\n\x81 Enhanced Capture, Compare, PWM module:\n- 16-bit Capture, max resolution 12.5 ns\n- Compare, max resolution 200 ns\n- 10-bit PWM with 1, 2 or 4 output channels, \nprogrammable “dead time”, max frequency 20 kHz\n\x81 In-Circuit Serial Programming\nTM (ICSPTM) via two \npins\nDeviceProgram \nMemoryData Memory\nI/O10-bit A/D \n(ch)ComparatorsTimers\n8/16-bit Flash\n(words) SRAM \n(bytes)EEPROM \n(bytes)\nPIC16F684 2048 128 256 12 8 2 2/114-Pin Flash-Based, 8-Bit CMOS Microcontrollers with nanoWatt Technology\nPIC16F684\nDS41202F-page 2 © 2007 Microchip Technology Inc.14-Pin Diagram (PDIP, SOIC, TSSOP)\nTABLE 1: DUAL IN-LINE PIN SUMMARY\nI/O Pin Analog Comparators Timer CCP Interrupts Pull-ups Basic\nRA0 13 AN0 C1IN+ — — IOC Y ICSPDAT/ULPWU\nRA1 12 AN1/V REF C1IN- — — IOC Y ICSPCLK\nRA2 11 AN2 C1OUT T0CKI — INT/IOC Y —\nRA3(1)4— — — — I O C Y(2)MCLR /VPP\nRA4 3 AN3 — T1G — IOC Y OSC2/CLKOUT\nRA5 2 — — T1CKI — IOC Y OSC1/CLKIN\nRC0 10 AN4 C2IN+ — — — — —\nRC1 9 AN5 C2IN- — — — — —\nRC2 8 AN6 — — P1D — — —\nRC3 7 AN7 — — P1C — — —\nRC4 6 — C2OUT — P1B — — —\nRC5 5 — — — CCP1/P1A — — —\n— 1 — — — — — — VDD\n—1 4 — — — — — — V SS\nNote 1: Input only.\n2:Only when pin is configured for external MCLR .VDD\nRA5/T1CKI/OSC1/CLKIN\nRA4/AN3/T1G /OSC2/CLKOUT\nRA3/MCLR /VPP\nRC5/CCP1/P1A\nRC4/C2OUT/P1B\nRC3/AN7/P1CVSS\nRA0/AN0/C1IN+/ICSPDAT/ULPWU\nRA1/AN1/C1IN-/V REF/ICSPCLK\nRA2/AN2/T0CKI/INT/C1OUTRC0/AN4/C2IN+\nRC1/AN5/C2IN-\nRC2/AN6/P1DPIC16F6841234\n56714\n13\n12\n  911\n10\n  8\n© 2007 Microchip Technology Inc. DS41202F-page 3PIC16F684\n16-Pin Diagram (QFN)\nTABLE 2: QFN PIN SUMMARY\nI/O Pin Analog Comparators Timers CCP Interrupts Pull-ups Basic\nRA0 12 AN0 C1IN+ — — IOC Y ICSPDAT/ULPWU\nRA1 11 AN1/V REF C1IN- — — IOC Y ICSPCLK\nRA2 10 AN2 C1OUT T0CKI — INT/IOC Y —\nRA3(1)3— — — — I O C Y(2)MCLR /VPP\nRA4 2 AN3 — T1G — IOC Y OSC2/CLKOUT\nRA5 1 — — T1CKI — IOC Y OSC1/CLKIN\nRC0 9 AN4 C2IN+ — — — — —\nRC1 8 AN5 C2IN- — — — — —\nRC2 7 AN6 — — P1D — — —\nRC3 6 AN7 — — P1C — — —\nRC4 5 — C2OUT — P1B — — —\nRC5 4 — — — CCP1/P1A — — —\n— 16 — — — — — — VDD\n—1 3 — — — — — — V SS\nNote 1: Input only.\n2:Only when pin is configured for external MCLR .1\n2\n3\n4 91011125\n6\n7\n816\n15\n14\n13\nPIC16F684RA5/T1CKI/OSC1/CLKIN\nRA4/AN3/T1G /OSC2/CLKOUT\nRA3/MCLR /VPP\nRC5/CCP1/P1A\nVDD\nNC\nNC\nVSS\nRA0/AN0/C1IN+/ICSPDAT/ULPWURA1/AN1/C1IN-/V\nREF/ICSPCLK\nRA2/AN2/T0CKI/INT/C1OUT\nRC0/AN4/C2IN+RC4/C2OUT/P1B\nRC3/AN7/P1C\nRC2/AN6/P1D\nRC1/AN5/C2IN-\nPIC16F684\nDS41202F-page 4 © 2007 Microchip Technology Inc.Table of Contents\n1.0 Device Overview ............................................................................................................. ............................................................. 5\n2.0 Memory Organization ......................................................................................................... .......................................................... 7\n3.0 Oscillator Module (With Fail-Safe Clock Monitor)............................................................................ ........................................... 19\n4.0 I/O Ports ................................................................................................................... .................................................................. 31\n5.0 Timer0 Module ............................................................................................................... ............................................................ 43\n6.0 Timer1 Module with Gate Control............................................................................................. .................................................. 47\n7.0 Timer2 Module ............................................................................................................... ............................................................ 53\n8.0 Comparator Module........................................................................................................... ......................................................... 55\n9.0 Analog-to-Digital Converter (ADC) Module .................................................................................... ............................................ 65\n10.0 Data EEPROM Memory ......................................................................................................... .................................................... 75\n11.0 Enhanced Capture/Compare/PWM (With Auto-Shutdown and Dead Band) Module..................................................... ............ 79\n12.0 Special Features of the CPU................................................................................................ ...................................................... 97\n13.0 Instruction Set Summary .................................................................................................... ...................................................... 115\n14.0 Development Support........................................................................................................ ....................................................... 125\n15.0 Electrical Specifications.................................................................................................. .......................................................... 129\n16.0 DC and AC Characteristics Graphs and Tables................................................................................ ....................................... 151\n17.0 Packaging Information...................................................................................................... ........................................................ 173\nAppendix A: Data Sheet Revision History........................................................................................ .................................................. 179\nAppendix B: Migrating from other PIC® Devices .................................................................................. ............................................. 179\nIndex .......................................................................................................................... ........................................................................ 181\nThe Microchip Web Site......................................................................................................... ............................................................ 187\nCustomer Change Notification Service ........................................................................................... ................................................... 187\nCustomer Support............................................................................................................... ............................................................... 187\nReader Response ................................................................................................................ .............................................................. 188\nProduct Identification System.................................................................................................. ........................................................... 189\nTO OUR VALUED CUSTOMERS\nIt is our intention to provide our valued customers with the bes t documentation possible to ensure successful use of your Micro chip\nproducts. To this end, we will continue to improve our  publications to better suit your  needs. Our publications will be refined  and\nenhanced as new volumes and updates are introduced. \nIf you have any questions or comments regarding this publication, please contact the Marketing Communications Department via \nE-mail at docerrors@microchip.com  or fax the Reader Response Form  in the back of this data sheet to (480) 792-4150. We \nwelcome your feedback.\nMost Current Data Sheet\nTo obtain the most up-to-date version of this data s heet, please register at our Worldwide Web site at:\nhttp://www.microchip.com\nYou can determine the version of a data sheet by examining its literature number found on the bottom outside corner of any page .\nThe last character of the literature number is the vers ion number, (e.g., DS30000A is version A of document DS30000).\nErrata\nAn errata sheet, describing minor operational differences from  the data sheet and recommended workarounds, may exist for curren t\ndevices. As device/documentation issues bec ome known to us, we will publish an errata sheet. The errata will specify the revisi on of\nsilicon and revision of document to which it applies.\nTo determine if an errata sheet exists for a particul ar device, please check with one of the following:\n\x81 Microchip’s Worldwide Web site; http://www.microchip.com\n\x81 Your local Microchip sales office (see last page)\nWhen contacting a sales office, please specify which device, re vision of silicon and data sheet (include literature number) you  are\nusing.\nCustomer Notification System\nRegister on our web site at www.microchip.com  to receive the most current information on all of our products.\n© 2007 Microchip Technology Inc. DS41202F-page 5PIC16F684\n1.0 DEVICE OVERVIEW\nThe PIC16F684 is covered by this data sheet. It is\navailable in 14-pin PDIP, SOIC, TSSOP and 16-pin\nQFN packages. Figure 1-1 shows a block diagram ofthe PIC16F684 device. Table 1-1 shows the pinout\ndescription.\nFIGURE 1-1: PIC16F 684 BLOCK DIAGRAM\nFlash\nProgram\nMemory13Data Bus8\n14Program\nBus\nInstruction RegProgram Counter\nRAM\nFile\nRegisters\nDirect  Addr 7RAM Addr 9\nAddr MUX\nIndirect\nAddr\nFSR Reg\nSTATUS Reg\nMUX\nALU\nW RegInstruction\nDecode &\nControl\nTiming\nGenerationOSC1/CLKIN\nOSC2/CLKOUTPORTA\n8\n88\n38-Level Stack 128 Bytes2k X 14 \n(13-Bit)\nPower-up\nTimer\nOscillator\nStart-up Timer\nPower-on\nReset\nWatchdog\nTimer\nMCLR VSSBrown-out\nReset\n Timer0 Timer1\nData\nEEPROM256 BytesEEDATA\nEEADDRRA0\nRA1\nRA2RA3RA4RA5\n2 Analog Comparators\nAnalog-To-Digital Converter\nAN0 AN1 AN2 AN3 C1IN- C1IN+ C1OUTT0CKIINT\nT1CKIConfiguration\nInternal\nOscillator\nVREFand ReferenceT1GPORTC\nRC0\nRC1RC2\nRC3\nRC4RC5\nAN4 AN5 AN6 AN7VDD\n8Timer2\nC2IN- C2IN+ C2OUTECCPBlockCCP1/P1A P1B P1C P1D\nPIC16F684\nDS41202F-page 6 © 2007 Microchip Technology Inc.TABLE 1-1: PIC16F684 PINOUT DESCRIPTION\nName FunctionInput \nTypeOutput \nTypeDescription\nRA0/AN0/C1IN+/ICSPDAT/ULPWU RA0 TTL CMOS PORTA I/O with prog. pull-up and interrupt-on-change\nAN0 AN — A/D Channel 0 input\nC1IN+ AN — Comparator 1 non-inverting input\nICSPDAT TTL CMOS Serial Programming Data I/O\nULPWU AN — Ultra Low-Power Wake-Up input\nRA1/AN1/C1IN-/V REF/ICSPCLK RA1 TTL CMOS PORTA I/O with prog. pull-up and interrupt-on-change\nAN1 AN — A/D Channel 1 input\nC1IN- AN — Comparator 1 inverting input\nVREF AN — External Voltage Reference for A/D\nICSPCLK ST — Serial Programming Clock\nRA2/AN2/T0CKI/INT/C1OUT RA2 ST CMOS PORTA I /O with prog. pull-up and interrupt-on-change\nAN2 AN — A/D Channel 2 input\nT0CKI ST — Timer0 clock input\nINT ST — External Interrupt\nC1OUT — CMOS Comparator 1 output\nRA3/MCLR /VPP RA3 TTL — PORTA input with interrupt-on-change\nMCLR ST — Master Clear w/internal pull-up\nVPP HV — Programming voltage\nRA4/AN3/T1G /OSC2/CLKOUT RA4 TTL CMOS PORTA I/O with prog. pull-up and interrupt-on-change\nAN3 AN — A/D Channel 3 input\nT1G ST — Timer1 gate (count enable)\nOSC2 — XTAL Crystal/Resonator\nCLKOUT — CMOS F OSC/4 output\nRA5/T1CKI/OSC1/CLKIN RA5 TTL CMOS PORTA I /O with prog. pull-up and interrupt-on-change\nT1CKI ST — Timer1 clock\nOSC1 XTAL — Crystal/Resonator\nCLKIN ST — External clock input/RC oscillator connection\nRC0/AN4/C2IN+ RC0 TTL CMOS PORTC I/O\nAN4 AN — A/D Channel 4 input\nC2IN+ AN — Comparator 2 non-inverting input\nRC1/AN5/C2IN- RC1 TTL CMOS PORTC I/O\nAN5 AN — A/D Channel 5 input\nC2IN- AN — Comparator 2 inverting input\nRC2/AN6/P1D RC2 TTL CMOS PORTC I/O\nAN6 AN — A/D Channel 6 inputP1D — CMOS PWM output\nRC3/AN7/P1C RC3 TTL CMOS PORTC I/O\nAN7 AN — A/D Channel 7 inputP1C — CMOS PWM output\nRC4/C2OUT/P1B RC4 TTL CMOS PORTC I/O\nC2OUT — CMOS Comparator 2 output\nP1B — CMOS PWM output\nRC5/CCP1/P1A RC5 TTL CMOS PORTC I/O\nCCP1 ST CMOS Capture input/Compare output\nP1A — CMOS PWM output\nV\nDD VDD Power — Positive supply\nVSS VSS Power — Ground reference\nLegend: AN = Analog input or output CMOS= CMOS compatible input or output HV = High Voltage\nST = Schmitt Trigger input with CMOS levels TTL  = TTL compatible input XTAL = Crystal\n© 2007 Microchip Technology Inc. DS41202F-page 7PIC16F684\n2.0 MEMORY ORGANIZATION\n2.1 Program Memory Organization\nThe PIC16F684 has a 13-bit program counter capable\nof addressing an 8k x 14 program memory space. Only\nthe first 2k x 14 (0000h-07FFh) for the PIC16F684 is\nphysically implemented. Accessing a location abovethese boundaries will cause a wrap around within the\nfirst 2k x 14 space. The Reset vector is at 0000h and\nthe interrupt vector is at 0004h (see Figure 2-1).\nFIGURE 2-1: PROGRAM MEMORY MAP \nAND STACK FOR THE PIC16F684 2.2 Data Memory Organization\nThe data memory (see Figure 2-2) is partitioned into two\nbanks, which contain the General Purpose Registers(GPR) and the Special Function Registers (SFR). The\nSpecial Function Registers are located in the first 32\nlocations of each bank. Register locations 20h-7Fh inBank 0 and A0h-BFh in Bank 1 are General Purpose\nRegisters, implemented as static RAM. Register\nlocations F0h-FFh in Bank 1 point to addresses 70h-7Fhin Bank 0. All other RAM is unimplemented and returns\n‘0’ when read. The RP0 bit of the STATUS register is the\nbank select bit.\nRP0\n0 → Bank 0 is selected\n1 → Bank 1 is selectedPC<12:0>\n13\n0000h\n0004h\n0005h\n07FFh\n0800h\n1FFFhStack Level 1\nStack Level 8\nReset Vector\nInterrupt Vector\nOn-chip Program\nMemory CALL, RETURN\nRETFIE, RETLW\nStack Level 2\nWraps to 0000h-07FFhNote: The IRP and RP1 bits of the STATUS\nregister are reserved and should always be\nmaintained as ‘ 0’s.\nPIC16F684\nDS41202F-page 8 © 2007 Microchip Technology Inc.2.2.1 GENERAL PURPOSE REGISTER \nFILE\nThe register file is organized as 128 x 8 in the\nPIC16F684. Each register is accessed, either directlyor indirectly, through the File Select Register (FSR)\n(see Section 2.4 “Indirect Addressing, INDF and\nFSR Registers” ).\n2.2.2 SPECIAL FUNCTION REGISTERS\nThe Special Function Registers are registers used by\nthe CPU and peripheral functions for controlling the\ndesired operation of the device (see Table 2-1). These\nregisters are static RAM.\nThe special registers can be classified into two sets:\ncore and peripheral. The Special Function Registers\nassociated with the “core” are described in this section.\nThose related to the operation of the peripheral featuresare described in the section of that peripheral feature.FIGURE 2-2: DATA MEMORY MAP OF \nTHE PIC16F684 \nIndirect Addr.(1)\nTMR0\nPCL\nSTATUS\nFSR\nPORTA\nPCLATH\nINTCON\nPIR1\nTMR1L\nTMR1H\nT1CON00h\n01h\n02h\n03h\n04h\n05h06h\n07h\n08h09h0Ah\n0Bh\n0Ch\n0Dh\n0Eh0Fh\n10h\n11h12h\n13h\n14h15h16h17h\n18h\n19h1Ah1Bh1Ch1Dh\n1Eh\n1Fh\n20h\n7Fh\nBank 0\nUnimplemented data memory locations, read as ‘ 0’.\nNote 1: Not a physical register.CMCON0 VRCON\nGeneral\nPurpose\nRegisters\n96 BytesEEDAT\nEEADR\nEECON2(1)File\nAddressFile\nAddress\nWPUA\nIOCAIndirect Addr.(1)\nOPTION_REG\nPCL\nSTATUS\nFSR\nTRISA\nPCLATH\nINTCON\nPIE1\nPCON80h\n81h\n82h\n83h\n84h\n85h86h\n87h\n88h89h8Ah\n8Bh\n8Ch\n8Dh\n8Eh8Fh\n90h\n91h92h\n93h\n94h95h96h97h\n98h\n99h9Ah9Bh9Ch9Dh\n9Eh\n9Fh\nA0h\nFFh\nBank 1ADRESH\nADCON0EECON1\nADRESL\nADCON1ANSELTRISC PORTC\nBFhGeneral\nPurpose\nRegisters\n32 Bytes\nAccesses 70h-7FhF0hTMR2\nT2CON\nCCPR1L\nCCPR1H\nCCP1CON\nPWM1CON\nECCPAS\nWDTCON\nCMCON1OSCCON\nOSCTUNE\nPR2\n706Fh\n© 2007 Microchip Technology Inc. DS41202F-page 9PIC16F684\nTABLE 2-1: PIC16F684 SPECIAL FUNCTION REGISTERS SUMMARY BANK 0 \nAddr Name Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on \nPOR, BORPage\nBank 0\n00h INDF Addressing this location uses contents of FSR to address data memory (not a physical register) xxxx xxxx 19, 104\n01h TMR0 Timer0 Module’s Register xxxx xxxx 43, 104\n02h PCL Program Counter’s (PC) Least Significant Byte 0000 0000 19, 104\n03h STATUS IRP(1)RP1(1)RP0 TO PD ZD CC 0001 1xxx 13, 104\n04h FSR Indirect Data Memory Address Pointer xxxx xxxx 19, 104\n05h PORTA(2)— — RA5 RA4 RA3 RA2 RA1 RA0 --x0 x000 31, 104\n06h — Unimplemented — —\n07h PORTC(2)— — RC5 RC4 RC3 RC2 RC1 RC0 --xx 0000 40, 104\n08h — Unimplemented — —\n09h — Unimplemented — —\n0Ah PCLATH — — — Write Buffer for upper 5 bits of Program Counter ---0 0000 19, 104\n0Bh INTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 15, 104\n0Ch PIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 17, 104\n0Dh — Unimplemented — —\n0Eh TMR1L Holding Register for the Least Significant Byte of the 16-bit TMR1 Register xxxx xxxx 47, 104\n0Fh TMR1H Holding Register for the Most Significant Byte of the 16-bit TMR1 Register xxxx xxxx 47, 104\n10h T1CON T1GINV TMR1GE T1CKPS1 T1CKPS0 T1OSCEN T1SYNC TMR1CS TMR1ON 0000 0000 50, 104\n11h TMR2 Timer2 Module Register 0000 0000 53, 104\n12h T2CON — TOUTPS3 TOUTPS2 TOUTPS1 TOUTPS0 TMR2ON T2CKPS1 T2CKPS0 -000 0000 54, 104\n13h CCPR1L Capture/Compare/PWM Register 1 Low Byte XXXX XXXX 80, 104\n14h CCPR1H Capture/Compare/PWM Register 1 High Byte XXXX XXXX 80, 104\n15h CCP1CON P1M1 P1M0 DC1B1 DC1B0 CCP1M3 CCP1M2 CCP1M1 CCP1M0 0000 0000 79, 104\n16h PWM1CON PRSEN PDC6 PDC5 PDC4 PDC3 PDC2 PDC1 PDC0 0000 0000 96, 104\n17h ECCPAS ECCPASE ECCPAS2 ECCPAS1 ECCPAS0 PSSAC1 PSSAC0 PSSBD1 PSSBD0 0000 0000 93, 104\n18h WDTCON — — — WDTPS3 WDTPS2 WDTPS1 WDTPS0 SWDTEN ---0 1000 111, 104\n19h CMCON0 C2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0 0000 0000 61, 104\n1Ah CMCON1 — — — — — — T1GSS C2SYNC ---- --10 62, 104\n1Bh — Unimplemented — —\n1Ch — Unimplemented — —\n1Dh — Unimplemented — —\n1Eh ADRESH Most Significant 8 bits of the left shifted A/D result or 2 bits of right shifted result xxxx xxxx 71, 104\n1Fh ADCON0 ADFM VCFG — CHS2 CHS1 CHS0 GO/DONE ADON 00-0 0000 70, 104\nLegend: – = Unimplemented locations read as ‘ 0’, u = unchanged, x = unknown, q = value depends on condition, shaded = unimplemented\nNote 1: IRP and RP1 bits are reserved, always maintain these bits clear.\n2: Port pins with analog functions controlled by the ANSEL register will read ‘ 0’ immediately after a Reset even though the data latches are \neither undefined (POR) or unchanged (other Resets).\nPIC16F684\nDS41202F-page 10 © 2007 Microchip Technology Inc.TABLE 2-2: PIC16F684 SPECIAL FUNCTION REGISTERS SUMMARY BANK 1\nAddr Name Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on \nPOR, BORPage\nBank 1\n80h INDF Addressing this location uses contents of FSR to address data memory (not a physical register) xxxx xxxx 19, 104\n81h OPTION_REG RAPU INTEDG T0CS T0SE PSA PS2 PS1 PS0 1111 1111 14, 104\n82h PCL Program Counter’s (PC) Least Significant Byte 0000 0000 19, 104\n83h STATUS IRP(1)RP1(1)RP0 TO PD ZD CC 0001 1xxx 13, 104\n84h FSR Indirect Data Memory Address Pointer xxxx xxxx 19, 104\n85h TRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0 --11 1111 31, 104\n86h — Unimplemented — —\n87h TRISC — — TRISC5 TRISC4 TRISC3 T RISC2 TRISC1 TRISC0 --11 1111 40, 104\n88h — Unimplemented — —\n89h — Unimplemented — —\n8Ah PCLATH — — — Write Buffer for upper 5 bits of Program Counter ---0 0000 19, 104\n8Bh INTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 15, 104\n8Ch PIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 16, 104\n8Dh — Unimplemented — —\n8Eh PCON — — ULPWUE SBOREN — —P O R BOR--01 --qq 18, 104\n8Fh OSCCON — IRCF2 IRCF1 IRCF0 OSTS(2)HTS LTS SCS -110 x000 20, 104\n90h OSCTUNE — — — TUN4 TUN3 TUN2 TUN1 TUN0 ---0 0000 24, 105\n91h ANSEL ANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS0 1111 1111 32, 105\n92h PR2 Timer2 Module Period Register 1111 1111 53, 105\n93h — Unimplemented — —\n94h — Unimplemented — —\n95h WPUA(3)— — WPUA5 WPUA4 — WPUA2 WPUA1 WPUA0 --11 -111 33, 105\n96h IOCA — — IOCA5 IOCA4 IOCA3 IOCA2 IOCA1 IOCA0 --00 0000 33, 105\n97h — Unimplemented — —\n98h — Unimplemented — —\n99h VRCON VREN —V R R — VR3 VR2 VR1 VR0 0-0- 0000 63, 105\n9Ah EEDAT EEDAT7 EEDAT6 EEDAT5 EEDAT4 EEDAT3 EEDAT2 EEDAT1 EEDAT0 0000 0000 75, 105\n9Bh EEADR EEADR7 EEADR6 EEADR5 EEADR4 EEADR3 EEADR2 EEADR1 EEADR0 0000 0000 75, 105\n9Ch EECON1 — — — — WRERR WREN WR RD ---- x000 76, 105\n9Dh EECON2 EEPROM Control Register 2 (not a physical register) ---- ---- 76, 105\n9Eh ADRESL Least Significant 2 bits of the left shifted result or 8 bits of the right shifted result xxxx xxxx 71, 105\n9Fh ADCON1 — ADCS2 ADCS1 ADCS0 — — — —-000 ---- 70, 105\nLegend: – = Unimplemented locations read as ‘ 0’, u = unchanged, x = unknown, q = value depends on condition, shaded = unimplemented\nNote 1: IRP and RP1 bits are reserved, always maintain these bits clear.\n2: OSTS bit of the OSCCON register reset to ‘ 0’ with Dual Speed Start-up and LP, HS or XT selected as the oscillator.\n3: RA3 pull-up is enabled when MCLRE is ‘ 1’ in the Configuration Word register.\n© 2007 Microchip Technology Inc. DS41202F-page 11PIC16F684\n2.2.2.1 STATUS Register\nThe STATUS register, shown in Register 2-1, contains:\n\x81 the arithmetic status of the ALU\n\x81 the Reset status\n\x81 the bank select bits for data memory (SRAM)\nThe STATUS register can be the destination for any\ninstruction, like any other register. If the STATUS\nregister is the destination for an instruction that affects\nthe Z, DC or C bits, then the write to these three bits isdisabled. These bits are set or cleared according to the\ndevice logic. Furthermore, the TO\n and PD  bits are not\nwritable. Therefore, the result of an instruction with theSTATUS register as destination may be different than\nintended.\nFor example, CLRF STATUS,  will clear the upper three\nbits and set the Z bit. This leaves the STATUS registeras ‘000u u1uu’  (where u = unchanged).It is recommended, therefore, that only BCF, BSF,\nSWAPF  and MOVWF  instructions are used to alter the\nSTATUS register, because these instructions do not\naffect any Status bits. For other instructions not affect-ing any Status bits, see Section 13.0 “Instruction Set\nSummary” . \n             Note 1: Bits IRP and RP1 of the STATUS register\nare not used by the PIC16F684 and\nshould be maintained as clear. Use of\nthese bits is not recommended, since thismay affect upward compatibility with\nfuture products.\n2:The C and DC bits operate as a Borrow\nand Digit Borrow  out bit, respectively, in\nsubtraction. See the SUBLW  and SUBWF\ninstructions for examples.\nREGISTER 2-1: STATUS: STATUS REGISTER\nReserved Reserved R/W-0 R-1 R-1 R/W-x R/W-x R/W-x\nIRP RP1 RP0 TO PD ZD C C\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 IRP: This bit is reserved and should be maintained as ‘ 0’\nbit 6 RP1:  This bit is reserved and should be maintained as ‘ 0’\nbit 5 RP0:  Register Bank Select bit (used for direct addressing)\n1 = Bank 1 (80h – FFh)\n0 = Bank 0 (00h – 7Fh)\nbit 4 TO\n: Time-out bit\n1 = After power-up, CLRWDT  instruction or SLEEP  instruction\n0 = A WDT time-out occurred\nbit 3 PD: Power-down bit\n1 = After power-up or by the CLRWDT  instruction\n0 = By execution of the SLEEP  instruction\nbit 2 Z: Zero bit\n1 = The result of an arithmetic or logic operation is zero\n0 = The result of an arithmetic or logic operation is not zero\nbit 1 DC: Digit Carry/Bo rrow bit (ADDWF , ADDLW,SUBLW,SUBWF  instructions), For Bo rrow, the polarity is \nreversed.\n1 = A carry-out from the 4th low-order bit of the result occurred\n0 = No carry-out from the 4th low-order bit of the result\nbit 0 C: Carry/Bo rrow bit(1) (ADDWF , ADDLW, SUBLW, SUBWF instructions)\n1 = A carry-out from the Most Significant bit of the result occurred\n0 = No carry-out from the Most Significant bit of the result occurred\nNote 1: For Bo rrow, the polarity is reversed. A subtraction is executed by adding the two’s complement of the sec-\nond operand. For rotate ( RRF, RLF) instructions, this bit is loaded with either the high-order or low-order bit \nof the source register.\nPIC16F684\nDS41202F-page 12 © 2007 Microchip Technology Inc.2.2.2.2 OPTION Register\nThe OPTION register is a readable and writable register,\nwhich contains various control bits to configure:\n\x81 Timer0/WDT prescaler\n\x81 External RA2/INT interrupt\n\x81T i m e r 0\n\x81 Weak pull-ups on PORTA\n             Note: To achieve a 1:1 prescaler assignment for\nTimer0, assign the prescaler to the WDT\nby setting PSA bit to ‘ 1’ of the OPTION\nregister. See Section 5.1.3 “Software\nProgrammable Prescaler” .\nREGISTER 2-2: OPTION_REG: OPTION REGISTER\nR/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1\nRAPU INTEDG T0CS T0SE PSA PS2 PS1 PS0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 RAPU : PORTA Pull-up Enable bit\n1 = PORTA pull-ups are disabled\n0 = PORTA pull-ups are enabled by individual PORT latch values\nbit 6 INTEDG:  Interrupt Edge Select bit\n1 = Interrupt on rising edge of RA2/INT pin\n0 = Interrupt on falling edge of RA2/INT pin\nbit 5 T0CS:  Timer0 Clock Source Select bit\n1 = Transition on RA2/T0CKI pin\n0 = Internal instruction cycle clock (F OSC/4)\nbit 4 T0SE:  Timer0 Source Edge Select bit\n1 = Increment on high-to-low transition on RA2/T0CKI pin\n0 = Increment on low-to-high transition on RA2/T0CKI pin\nbit 3 PSA:  Prescaler Assignment bit\n1 = Prescaler is assigned to the WDT\n0 = Prescaler is assigned to the Timer0 module\nbit 2-0 PS<2:0>:  Prescaler Rate Select bits\n000\n001010011\n100\n1011101111 : 2\n1 : 41 : 81 : 161 : 321 : 641 : 128\n1 : 2561 : 1\n1 : 21 : 41 : 8\n1 : 16\n1 : 321 : 641 : 128BIT VALUE TIMER0 RATE WDT RATE\n© 2007 Microchip Technology Inc. DS41202F-page 13PIC16F684\n2.2.2.3 INTCON Register\nThe INTCON register is a readable and writable\nregister, which contains the various enable and flag bitsfor TMR0 register overflow, PORTA change and\nexternal RA2/INT pin interrupts. \n             Note: Interrupt flag bits are set when an interrupt\ncondition occurs, regardless of the state of\nits corresponding enable bit or the globalenable bit, GIE of the INTCON register.\nUser software should ensure the\nappropriate interrupt flag bits are clearprior to enabling an interrupt.\nREGISTER 2-3: INTCON: INTERRUPT CONTROL REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nGIE PEIE T0IE INTE RAIE T0IF INTF RAIF\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 GIE: Global Interrupt Enable bit\n1 = Enables all unmasked interrupts\n0 = Disables all interrupts\nbit 6 PEIE:  Peripheral Interrupt Enable bit\n1 = Enables all unmasked peripheral interrupts\n0 = Disables all peripheral interrupts\nbit 5 T0IE:  Timer0 Overflow Interrupt Enable bit\n1 = Enables the Timer0 interrupt\n0 = Disables the Timer0 interrupt\nbit 4 INTE:  RA2/INT External Interrupt Enable bit\n1 = Enables the RA2/INT external interrupt\n0 = Disables the RA2/INT external interrupt\nbit 3 RAIE:  PORTA Change Interrupt Enable bit(1)\n1 = Enables the PORTA change interrupt\n0 = Disables the PORTA change interrupt\nbit 2 T0IF:  Timer0 Overflow Interrupt Flag bit(2)\n1 = Timer0 register has overflowed (must be cleared in software)\n0 = Timer0 register did not overflow\nbit 1 INTF:  RA2/INT External Interrupt Flag bit\n1 = The RA2/INT external interrupt occurred (must be cleared in software)\n0 = The RA2/INT external interrupt did not occur\nbit 0 RAIF:  PORTA Change Interrupt Flag bit\n1 = When at least one of the PORTA <5:0> pins changed state (must be cleared in software)\n0 = None of the PORTA <5:0> pins have changed state\nNote 1: IOCA register must also be enabled.\n2:T0IF bit is set when TMR0 rolls over. TMR0 is unchanged on Reset and should be initialized before \nclearing T0IF bit.\nPIC16F684\nDS41202F-page 14 © 2007 Microchip Technology Inc.2.2.2.4 PIE1 Register\nThe PIE1 register contains the peripheral interrupt\nenable bits, as shown in Register 2-4.\n             Note: Bit PEIE of the INTCON register must be\nset to enable any peripheral interrupt.\nREGISTER 2-4: PIE1: PERIPHERAL INTERRUPT ENABLE REGISTER 1\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nEEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 EEIE: EE Write Complete Interrupt Enable bit\n1 = Enables the EE write complete interrupt\n0 = Disables the EE write complete interrupt\nbit 6 ADIE:  A/D Converter (ADC) Interrupt Enable bit\n1 = Enables the ADC interrupt\n0 = Disables the ADC interrupt\nbit 5 CCP1IE:  CCP1 Interrupt Enable bit\n1 = Enables the CCP1 interrupt\n0 = Disables the CCP1 interrupt\nbit 4 C2IE:  Comparator 2 Interrupt Enable bit\n1 = Enables the Comparator 2 interrupt\n0 = Disables the Comparator 2 interrupt\nbit 3 C1IE:  Comparator 1 Interrupt Enable bit\n1 = Enables the Comparator 1 interrupt\n0 = Disables the Comparator 1 interrupt \nbit 2 OSFIE:  Oscillator Fail Interrupt Enable bit\n1 = Enables the oscillator fail interrupt\n0 = Disables the oscillator fail interrupt \nbit 1 TMR2IE:  Timer2 to PR2 Match Interrupt Enable bit\n1 = Enables the Timer2 to PR2 match interrupt\n0 = Disables the Timer2 to PR2 match interrupt\nbit 0 TMR1IE:  Timer1 Overflow Interrupt Enable bit\n1 = Enables the Timer1 overflow interrupt\n0 = Disables the Timer1 overflow interrupt\n© 2007 Microchip Technology Inc. DS41202F-page 15PIC16F684\n2.2.2.5 PIR1 Register\nThe PIR1 register contains the peripheral interrupt flag\nbits, as shown in Register 2-5.\n             Note: Interrupt flag bits are set when an interrupt\ncondition occurs, regardless of the state of\nits corresponding enable bit or the globalenable bit, GIE of the INTCON register. User\nsoftware should ensure the appropriate\ninterrupt flag bits are clear prior to enablingan interrupt.\nREGISTER 2-5: PIR1: PERIPHERAL INTERRUPT REQUEST REGISTER 1\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nEEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 EEIF: EEPROM Write Operation Interrupt Flag bit\n1 = The write operation completed (must be cleared in software)\n0 = The write operation has not completed or has not been started\nbit 6 ADIF:  A/D Interrupt Flag bit \n1 = A/D conversion complete\n0 = A/D conversion has not completed or has not been started\nbit 5 CCP1IF:  CCP1 Interrupt Flag bit\nCapture mod\ne:\n1 = A TMR1 register capture occurred (must be cleared in software)\n0 = No TMR1 register capture occurred\nCompare mode :\n1 = A TMR1 register compare match occurred (must be cleared in software)\n0 = No TMR1 register compare match occurred\nPWM mode :\nUnused in this mode\nbit 4 C2IF:  Comparator 2 Interrupt Flag bit\n1 = Comparator 2 output has changed (must be cleared in software)\n0 = Comparator 2 output has not changed\nbit 3 C1IF:  Comparator 1 Interrupt Flag bit\n1 = Comparator 1 output has changed (must be cleared in software)\n0 = Comparator 1 output has not changed\nbit 2 OSFIF:  Oscillator Fail Interrupt Flag bit \n1 = System oscillator failed, clock input has changed to INTOSC (must be cleared in software)\n0 = System clock operating\nbit 1 TMR2IF:  Timer2 to PR2 Match Interrupt Flag bit\n1 = Timer2 to PR2 match occurred (must be cleared in software)\n0 = Timer2 to PR2 match has not occurred\nbit 0 TMR1IF:  Timer1 Overflow Interrupt Flag bit\n1 = Timer1 register overflowed (must be cleared in software)\n0 = Timer1 has not overflowed\nPIC16F684\nDS41202F-page 16 © 2007 Microchip Technology Inc.2.2.2.6 PCON Register\nThe Power Control (PCON) register (see Table 12-2)\ncontains flag bits to differentiate between a:\n\x81 Power-on Reset (POR )\n\x81 Brown-out Reset (BO R)\n\x81 Watchdog Timer Reset (WDT)\n\x81 External MCLR  Reset\nThe PCON register also controls the Ultra Low-Power\nWake-up and software enable of the BO R.\nThe PCON register bits are shown in Register 2-6.\n             \nREGISTER 2-6: PCON: POWER CONTROL REGISTER\nU-0 U-0 R/W-0 R/W-1 U-0 U-0 R/W-0 R/W-x\n— — ULPWUE SBOREN — —P O R BOR\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented: Read as ‘0’\nbit 5 ULPWUE:  Ultra Low-Power Wake-Up Enable bit\n1 = Ultra Low-Power Wake-up enabled\n0 = Ultra Low-Power Wake-up disabled\nbit 4 SBOREN:  Software BOR Enable bit\n(1)\n1 = BOR enabled\n0 = BOR disabled\nbit 3-2 Unimplemented: Read as ‘0’\nbit 1 POR : Power-on Reset Status bit\n1 = No Power-on Reset occurred\n0 = A Power-on Reset occurred (must be set in software after a Power-on Reset occurs)\nbit 0 BOR: Brown-out Reset Status bit\n1 = No Brown-out Reset occurred\n0 = A Brown-out Reset occurred (must be set in software after a Power-on Reset or Brown-out Reset\noccurs)\nNote 1: BOREN<1:0> = 01 in the Configuration Word register for this bit to control the BO R.\n© 2007 Microchip Technology Inc. DS41202F-page 17PIC16F684\n2.3 PCL and PCLATH\nThe Program Counter (PC) is 13 bits wide. The low byte\ncomes from the PCL register, which is a readable andwritable register. The high byte (PC<12:8>) is not directly\nreadable or writable and comes from PCLATH. On any\nReset, the PC is cleared. Figure 2-3 shows the twosituations for the loading of the PC. The upper example\nin Figure 2-3 shows how the PC is loaded on a write to\nPCL (PCLATH<4:0> → PCH). The lower example in\nFigure 2-3 shows how the PC is loaded during a CALL  or\nGOTO  instruction (PCLATH<4:3> → PCH).\nFIGURE 2-3: LOADING OF PC IN \nDIFFERENT SITUATIONS\n2.3.1 MODIFYING PCL\nExecuting any instruction with the PCL register as the\ndestination simultaneously causes the ProgramCounter PC<12:8> bits (PCH) to be replaced by the\ncontents of the PCLATH register. This allows the entire\ncontents of the program counter to be changed by firstwriting the desired upper 5 bits to the PCLATH register.\nThen, when the lower 8 bits are written to the PCL\nregister, all 13 bits of the program counter will changeto the values contained in the PCLATH register and\nthose being written to the PCL register.\nA computed GOTO  is accomplished by adding an offset\nto the program counter ( ADDWF PCL ). Care should be\nexercised when jumping into a look-up table or\nprogram branch table (computed GOTO ) by modifying\nthe PCL register. Assuming that PCLATH is set to thetable start address, if the table length is greater than\n255 instructions or if the lower 8 bits of the memory\naddress rolls over from 0xFF to 0x00 in the middle ofthe table, then PCLATH must be incremented for each\naddress rollover that occurs between the table\nbeginning and the target location within the table.\nFor more information refer to Application Note AN556,\n“Implementing a Table Read ” (DS00556).2.3.2 STACK\nThe PIC16F684 Family has an 8-level x 13-bit wide\nhardware stack (see Figure 2-1). The stack space isnot part of either program or data space and the Stack\nPointer is not readable or writable. The PC is PUSHed\nonto the stack when a CALL  instruction is executed or\nan interrupt causes a branch. The stack is POPed in\nthe event of a RETURN, RETLW  or a RETFIE\ninstruction execution. PCLATH is not affected by aPUSH or POP operation.\nThe stack operates as a circular buffer. This means that\nafter the stack has been PUSHed eight times, the ninth\npush overwrites the value that was stored from the firstpush. The tenth push overwrites the second push (and\nso on). \n2.4 Indirect Addressing, INDF and \nFSR Registers   \nThe INDF register is not a physical register. Addressing\nthe INDF register will cause indirect addressing.\nIndirect addressing is possible by using the INDF register.\nAny instruction using the INDF register actually accessesdata pointed to by the File Select Register (FSR).\nReading INDF itself indirectly will produce 00h. Writing to\nthe INDF register indirectly results in a no operation(although Status bits may be affected). An effective 9-bit\naddress is obtained by concatenating the 8-bit FSR and\nthe IRP bit of the STATUS register, as shown inFigure 2-4.\nA simple program to clear RAM location 20h-2Fh using\nindirect addressing is shown in Example 2-1.\nEXAMPLE 2-1: INDIRECT ADDRESSINGPC12 8 7 0\n5PCLATH<4:0>\nPCLATHInstruction wit h\nALU Result\nGOTO, CALL\nOPCODE <10:0 >8\nPC12 11 10 0\n11 PCLATH<4:3>PCH PCL\n87\n2\nPCLATHPCH PCLPCL a s \nDestinatio nNote 1: There are no Status bits to indicate stack\noverflow or stack underflow conditions. \n2:There are no instructions/mnemonics\ncalled PUSH or POP. These are actions\nthat occur from the execution of theCALL, RETURN, RETLW  and RETFIE\ninstructions or the vectoring to an\ninterrupt address.\nMOVLW 0x20 ;initialize pointer\nMOVWF FSR ;to RAM\nNEXT CLRF INDF ;clear INDF register\nINCF FSR, f ;inc pointer\nBTFSS FSR,4 ;all done?\nGOTO NEXT ;no clear next\nCONTINUE ;yes continue\nPIC16F684\nDS41202F-page 18 © 2007 Microchip Technology Inc.FIGURE 2-4: DIRECT/INDIRECT ADDRESSING PIC16F684 \nFor memory map detail, see Figure 2-2.\nNote 1: The RP1 and IRP bits are reserved; always maintain these bits clear.Data\nMemoryIndirect Addressing Direct Addressing\nBank Select Location SelectRP1(1)RP0 6 0 From Opcode IRP(1)File Select Register7 0\nBank Select Location Select\n00 01 10 11\n180h\n1FFh00h\n7Fh\nBank 0 Bank 1 Bank 2 Bank 3NOT USED\n© 2007 Microchip Technology Inc. DS41202F-page 19PIC16F684\n3.0 OSCILLATOR MODULE (WITH \nFAIL-SAFE CLOCK MONITOR)\n3.1 Overview\nThe Oscillator module has a wide variety of clock\nsources and selection features that allow it to be used\nin a wide range of applications while maximizing perfor-mance and minimizing power consumption. Figure 3-1\nillustrates a block diagram of the Oscillator module.\nClock sources can be configured from external\noscillators, quartz crystal resonators, ceramic resonatorsand Resistor-Capacitor (RC) circuits. In addition, the\nsystem clock source can be configured from one of two\ninternal oscillators, with a choice of speeds selectable viasoftware. Additional clock features include:\n\x81 Selectable system clock source between external \nor internal via software.\n\x81 Two-Speed Start-up mode, which minimizes \nlatency between external oscillator start-up and \ncode execution.\n\x81 Fail-Safe Clock Monitor (FSCM) designed to \ndetect a failure of the external clock source (LP, XT, HS, EC or RC modes) and switch \nautomatically to the internal oscillator.The Oscillator module can be configured in one of eight\nclock modes.\n1. EC – External clock with I/O on OSC2/CLKOUT.\n2. LP – 32 kHz Low-Power Crystal mode.3. XT – Medium Gain Crystal or Ceramic Resonator\nOscillator mode.\n4. HS – High Gain Crystal or Ceramic Resonator\nmode.\n5. RC – External Resistor-Capacitor (RC) with\nF\nOSC/4 output on OSC2/CLKOUT.\n6. RCIO – External Resistor-Capacitor (RC) with\nI/O on OSC2/CLKOUT.\n7. INTOSC – Internal oscillator with F OSC/4 output\non OSC2 and I/O on OSC1/CLKIN.\n8. INTOSCIO – Internal oscillator with I/O on\nOSC1/CLKIN and OSC2/CLKOUT.\nClock Source modes are configured by the FOSC<2:0>\nbits in the Configuration Word register (CONFIG). The\ninternal clock can be generated from two internal\noscillators. The HFINTOSC is a calibratedhigh-frequency oscillator. The LFINTOSC is an\nuncalibrated low-frequency oscillator.\nFIGURE 3-1: PIC® MCU CLOCK SOURCE BLOCK DIAGRAM \n(CPU and Peripherals)OSC1OSC2\nSleepExternal Oscillator\nLP, XT, HS, RC, RCIO, EC\nSystem ClockPostscaler\nMUXMUX8 MHz\n4 MHz\n2 MHz\n1 MHz\n500 kHz\n125 kHz250 kHzIRCF<2:0>\n111\n110\n101\n100\n011\n010\n001000\n31 kHz\nPower-up Timer (PWRT)FOSC<2:0>\n(Configuration Word Register)\nSCS<0>\n(OSCCON Register)\nInternal Oscillator(OSCCON Register)\nWatchdog Timer (WDT)\nFail-Safe Clock Monitor (FSCM)HFINTOSC\n8 MHz\nLFINTOSC\n31 kHzINTOSC\nPIC16F684\nDS41202F-page 20 © 2007 Microchip Technology Inc.3.2 Oscillator Control\nThe Oscillator Control (OSCCON) register (Figure 3-1)\ncontrols the system clock and frequency selectionoptions. The OSCCON register contains the following\nbits:\n\x81 Frequency selection bits (IRCF)\n\x81 Frequency Status bits (HTS, LTS)\n\x81 System clock control bits (OSTS, SCS)\n  \nREGISTER 3-1: OSCCON: OSCILLATOR CONTROL REGISTER\nU-0 R/W-1 R/W-1 R/W-0 R-1 R-0 R-0 R/W-0\n— IRCF2 IRCF1 IRCF0 OSTS(1)HTS LTS SCS\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 Unimplemented:  Read as ‘ 0’\nbit 6-4 IRCF<2:0>:  Internal Oscillator Frequency Select bits\n111 =8 MHz\n110 =4 MHz (default)\n101 =2 MHz\n100 =1 MHz\n011 =500 kHz\n010 =250 kHz\n001 =125 kHz\n000 =31 kHz (LFINTOSC)\nbit 3 OSTS:  Oscillator Start-up Time-out Status bit\n(1)\n1 = Device is running from the external clock defined by FOSC<2:0> of the CONFIG register\n0 = Device is running from the internal oscillator (HFINTOSC or LFINTOSC)\nbit 2 HTS:  HFINTOSC Status bit (High Frequency – 8 MHz to 125 kHz)\n1 = HFINTOSC is stable\n0 = HFINTOSC is not stable\nbit 1 LTS:  LFINTOSC Stable bit (Low Frequency – 31 kHz)\n1 = LFINTOSC is stable\n0 = LFINTOSC is not stable\nbit 0 SCS:  System Clock Select bit\n1 = Internal oscillator is used for system clock\n0 = Clock source defined by FOSC<2:0> of the CONFIG register\nNote 1: Bit resets to ‘ 0’ with Two-Speed Start-up and LP, XT or HS selected as the Oscillator mode or Fail-Safe \nmode is enabled.\n© 2007 Microchip Technology Inc. DS41202F-page 21PIC16F684\n3.3 Clock Source Modes\nClock Source modes can be classified as external or\ninternal.\n\x81 External Clock modes rely on external circuitry for \nthe clock source. Examples are: Oscillator mod-\nules (EC mode), quartz crystal resonators or \nceramic resonators (LP, XT and HS modes) and Resistor-Capacitor (RC) mode circuits.\n\x81 Internal clock sources are contained internally \nwithin the Oscillator module. The Oscillator \nmodule has two internal oscillators: the 8 MHz \nHigh-Frequency Internal Oscillator (HFINTOSC) and the 31 kHz Low-Frequency Internal Oscillator \n(LFINTOSC).\nThe system clock can be selected between external or\ninternal clock sources via the System Clock Select(SCS) bit of the OSCCON register. See Section 3.6\n“Clock Switching”  for additional information.3.4 External Clock Modes\n3.4.1 OSCILLATOR START-UP TIMER (OST)\nIf the Oscillator module is configured for LP, XT or HS\nmodes, the Oscillator Start-up Timer (OST) counts\n1024 oscillations from OSC1. This occurs following aPower-on Reset (POR) and when the Power-up Timer\n(PWRT) has expired (if configured), or a wake-up from\nSleep. During this time, the program counter does notincrement and program execution is suspended. The\nOST ensures that the oscillator circuit, using a quartz\ncrystal resonator or ceramic resonator, has started andis providing a stable system clock to the Oscillator\nmodule. When switching between clock sources, a\ndelay is required to allow the new clock to stabilize.These oscillator delays are shown in Table 3-1.\nIn order to minimize latency between external oscillator\nstart-up and code execution, the Two-Speed Clock\nStart-up mode can be selected (see Section 3.7\n“Two-Speed Clock Start-up Mode” ).\nTABLE 3-1: OSCILLATOR DELAY EXAMPLES\n3.4.2 EC MODE\nThe External Clock (EC) mode allows an externally\ngenerated logic level as the system clock source. When\noperating in this mode, an external clock source is\nconnected to the OSC1 input and the OSC2 is availablefor general purpose I/O. Figure 3-2 shows the pin\nconnections for EC mode.\nThe Oscillator Start-up Timer (OST) is disabled when\nEC mode is selected. Therefore, there is no delay inoperation after a Power-on Reset (POR) or wake-up\nfrom Sleep. Because the PIC MCU design is fully static,\nstopping the external clock input will have the effect ofhalting the device while leaving all data intact. Upon\nrestarting the external clock, the device will resume\noperation as if no time had elapsed.FIGURE 3-2: EXTERNAL CLOCK (EC) \nMODE OPERATIONSwitch From Switch To Frequency Oscillator Delay\nSleep/PORLFINTOSC\nHFINTOSC31 kHz\n125 kHz to 8 MHzOscillator Warm-Up Delay (T WARM )\nSleep/POR EC, RC DC – 20 MHz 2 cycles\nLFINTOSC (31 kHz) EC, RC DC – 20 MHz 1 cycle of each\nSleep/POR LP, XT, HS 32 kHz to 20 MHz 1024 Clock Cycles (OST)LFINTOSC (31 kHz) HFINTOSC 125 kHz to 8 MHz 1 μs (approx.)\nOSC1/CLKIN\nOSC2/CLKOUT(1)I/OClock from\nExt. System\nPIC® MCU\nNote 1: Alternate pin functions are listed in the \nSection 1.0 “Device Overview” .\nPIC16F684\nDS41202F-page 22 © 2007 Microchip Technology Inc.3.4.3 LP, XT, HS MODES\nThe LP, XT and HS modes support the use of quartz\ncrystal resonators or ceramic resonators connected toOSC1 and OSC2 (Figure 3-3). The mode selects a low,\nmedium or high gain setting of the internal\ninverter-amplifier to support various resonator typesand speed.\nLP Oscillator mode selects the lowest gain setting of the\ninternal inverter-amplifier. LP mode current consumption\nis the least of the three modes. This mode is designed todrive only 32.768 kHz tuning-fork type crystals (watch\ncrystals).\nXT Oscillator mode selects the intermediate gain\nsetting of the internal inverter-amplifier. XT modecurrent consumption is the medium of the three modes.\nThis mode is best suited to drive resonators with a\nmedium drive level specification.\nHS Oscillator mode selects the highest gain setting of the\ninternal inverter-amplifier. HS mode current consumption\nis the highest of the three modes. This mode is best\nsuited for resonators that require a high drive setting.\nFigure 3-3 and Figure 3-4 show typical circuits for\nquartz crystal and ceramic resonators, respectively.\nFIGURE 3-3: QUARTZ CRYSTAL \nOPERATION (LP, XT OR HS MODE)FIGURE 3-4: CERAMIC RESONATOR \nOPERATION(XT OR HS MODE)\nNote 1: A series resistor (R S) may be required for\nquartz crystals with low drive level.\n2:The value of R F varies with the Oscillator mode\nselected (typically between 2 M Ω to 10 M Ω).C1\nC2Quartz\nRS(1) OSC1/CLKIN\nRF(2) SleepTo Internal \nLogicPIC® MCU\nCrystal\nOSC2/CLKOUTNote 1: Quartz crystal characteristics vary according\nto type, package and manufacturer. The\nuser should consult the manufacturer data\nsheets for specifications and recommendedapplication.\n2:Always verify oscillator performance over\nthe V\nDD and temperature range that is\nexpected for the application.\n3:For oscillator design assistance, reference\nthe following Microchip Applications Notes:\n\x81 AN826, “ Crystal Oscillator Basics and \nCrystal Selection for rfPIC® and PIC® \nDevices ” (DS00826)\n\x81 AN849, “ Basic PIC® Oscillator Design ” \n(DS00849)\n\x81 AN943, “ Practical PIC® Oscillator \nAnalysis and Design ” (DS00943)\n\x81 AN949, “ Making Your Oscillator Work ” \n(DS00949)\nNote 1: A series resistor (R S) may be required for\nceramic resonators with low drive level.\n2:The value of R F varies with the Oscillator mode\nselected (typically between 2 M Ω to 10 M Ω).\n3:An additional parallel feedback resistor (R P)\nmay be required for proper ceramic resonator\noperation.C1\nC2Ceramic RS(1) OSC1/CLKIN\nRF(2) SleepTo Internal \nLogicPIC® MCU\nRP(3) \nResonatorOSC2/CLKOUT\n© 2007 Microchip Technology Inc. DS41202F-page 23PIC16F684\n3.4.4 EXTERNAL RC MODES\nThe external Resistor-Capacitor (RC) modes support\nthe use of an external RC circuit. This allows thedesigner maximum flexibility in frequency choice while\nkeeping costs to a minimum when clock accuracy is not\nrequired. There are two modes: RC and RCIO.\nIn RC mode, the RC circuit connects to OSC1.\nOSC2/CLKOUT outputs the RC oscillator frequency\ndivided by 4. This signal may be used to provide a clock\nfor external circuitry, synchronization, calibration, testor other application requirements. Figure 3-5 shows\nthe external RC mode connections.\nFIGURE 3-5: EXTERNAL RC MODES \nIn RCIO mode, the RC circuit is connected to OSC1.\nOSC2 becomes an additional general purpose I/O pin.\nThe RC oscillator frequency is a function of the supply\nvoltage, the resistor (R EXT) and capacitor (C EXT) values\nand the operating temperature. Other factors affectingthe oscillator frequency are:\n\x81 threshold voltage variation\n\x81 component tolerances\x81 packaging variations in capacitance\nThe user also needs to take into account variation due\nto tolerance of external RC components used.3.5 Internal Clock Modes\nThe Oscillator module has two independent, internal\noscillators that can be configured or selected as thesystem clock source.\n1. The HFINTOSC  (High-Frequency Internal\nOscillator) is factory calibrated and operates at\n8 MHz. The frequency of the HFINTOSC can beuser-adjusted via software using the OSCTUNE\nregister (Register 3-2).\n2. The LFINTOSC  (Low-Frequency Internal\nOscillator) is uncalibrated and operates at\n31 kHz.\nThe system clock speed can be selected via software\nusing the Internal Oscillator Frequency Select bits\nIRCF<2:0> of the OSCCON register.\nThe system clock can be selected between external or\ninternal clock sources via the System Clock Selection(SCS) bit of the OSCCON register. See Section 3.6\n“Clock Switching”  for more information.\n3.5.1 INTOSC AND INTOSCIO MODES\nThe INTOSC and INTOSCIO modes configure the\ninternal oscillators as the system clock source whenthe device is programmed using the oscillator selection\nor the FOSC<2:0> bits in the Configuration Word\nregister (CONFIG).\nIn INTOSC  mode, OSC1/CLKIN is available for general\npurpose I/O. OSC2/CLKOUT outputs the selected\ninternal oscillator frequency divided by 4. The CLKOUT\nsignal may be used to provide a clock for externalcircuitry, synchronization, calibration, test or other\napplication requirements.\nIn INTOSCIO  mode, OSC1/CLKIN and OSC2/CLKOUT\nare available for general purpose I/O.\n3.5.2 HFINTOSC\nThe High-Frequency Internal Oscillator (HFINTOSC) isa factory calibrated 8 MHz internal clock source. The\nfrequency of the HFINTOSC can be altered via\nsoftware using the OSCTUNE register (Register 3-2).\nThe output of the HFINTOSC connects to a postscaler\nand multiplexer (see Figure 3-1). One of seven\nfrequencies can be selected via software using the\nIRCF<2:0> bits of the OSCCON register. SeeSection 3.5.4 “Frequency Select Bits (IRCF)”  for\nmore information.\nThe HFINTOSC is enabled by selecting any frequency\nbetween 8 MHz and 125 kHz by setting the IRCF<2:0>bits of the OSCCON register ≠000. Then, set the\nSystem Clock Source (SCS) bit of the OSCCON\nregister to ‘ 1’ or enable Two-Speed Start-up by setting\nthe IESO bit in the Configuration Word register\n(CONFIG) to ‘ 1’.\nThe HF Internal Oscillator (HTS) bit of the OSCCON\nregister indicates whether the HFINTOSC is stable or not.OSC2/CLKOUT(1)CEXTREXTPIC® MCU\nOSC1/CLKIN\nFOSC/4 orInternal\nClockVDD\nVSS\nRecommended values: 10 k Ω ≤ REXT ≤ 100 k Ω, <3V\n3 kΩ ≤ REXT ≤ 100 k Ω, 3-5V\nCEXT > 20 pF, 2-5V\nNote 1: Alternate pin functions are listed in \nSection 1.0 “Device Overview” .\n2: Output depends upon RC or RCIO Clock \nmode.I/O(2)\nPIC16F684\nDS41202F-page 24 © 2007 Microchip Technology Inc.3.5.2.1 OSCTUNE Register\nThe HFINTOSC is factory calibrated but can be\nadjusted in software by writing to the OSCTUNEregister (Register 3-2).\nThe default value of the OSCTUNE register is ‘ 0’. The\nvalue is a 5-bit two’s complement number. When the OSCTUNE register is modified, the\nHFINTOSC frequency will begin shifting to the new\nfrequency. Code execution continues during this shift.\nThere is no indication that the shift has occurred.\nOSCTUNE does not affect the LFINTOSC frequency.\nOperation of features that depend on the LFINTOSC\nclock source frequency, such as the Power-up Timer\n(PWRT), Watchdog Timer (WDT), Fail-Safe ClockMonitor (FSCM) and peripherals, are not affected by the\nchange in frequency.\n  \nREGISTER 3-2: OSCTUNE: OSCILLATOR TUNING REGISTER\nU-0 U-0 U-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\n— — — TUN4 TUN3 TUN2 TUN1 TUN0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-5 Unimplemented:  Read as ‘ 0’\nbit 4-0 TUN<4:0>:  Frequency Tuning bits\n01111  = Maximum frequency\n01110  = \n\x81\n\x81\n\x8100001  = \n00000  = Oscillator module is running at the calibrated frequency.\n11111  = \n\x81\n\x81\n\x8110000  = Minimum frequency\n© 2007 Microchip Technology Inc. DS41202F-page 25PIC16F684\n3.5.3 LFINTOSC\nThe Low-Frequency Internal Oscillator (LFINTOSC) is\nan uncalibrated 31 kHz internal clock source.\nThe output of the LFINTOSC connects to a postscaler\nand multiplexer (see Figure 3-1). Select 31 kHz, via\nsoftware, using the IRCF<2:0> bits of the OSCCON\nregister. See Section 3.5.4 “Frequency Select Bits\n(IRCF)”  for more information. The LFINTOSC is also the\nfrequency for the Power-up Timer (PWRT), Watchdog\nTimer (WDT) and Fail-Safe Clock Monitor (FSCM).\nThe LFINTOSC is enabled by selecting 31 kHz\n(IRCF<2:0> bits of the OSCCON register = 000)  as the\nsystem clock source (SCS bit of the OSCCON\nregister = 1), or when any of the following are enabled:\n\x81 Two-Speed Start-up IESO bit of the Configuration \nWord register = 1 and IRCF<2:0> bits of the \nOSCCON register = 000\n\x81 Power-up Timer (PWRT)\n\x81 Watchdog Timer (WDT)\x81 Fail-Safe Clock Monitor (FSCM)\nThe LF Internal Oscillator (LTS) bit of the OSCCON\nregister indicates whether the LFINTOSC is stable ornot.\n3.5.4 FREQUENCY SELECT BITS (IRCF)\nThe output of the 8 MHz HFINTOSC and 31 kHz\nLFINTOSC connects to a postscaler and multiplexer\n(see Figure 3-1). The Internal Oscillator FrequencySelect bits IRCF<2:0> of the OSCCON register select\nthe frequency output of the internal oscillators. One of\neight frequencies can be selected via software:\n\x818  M H z\n\x81 4 MHz (Default after Reset)\n\x812  M H z\n\x811  M H z\x81 500 kHz\n\x81 250 kHz\n\x81 125 kHz\x81 31 kHz (LFINTOSC)3.5.5 HFINTOSC AND LFINTOSC CLOCK \nSWITCH TIMING\nWhen switching between the LFINTOSC and the\nHFINTOSC, the new oscillator may already be shutdown to save power (see Figure 3-6). If this is the case,\nthere is a delay after the IRCF<2:0> bits of the\nOSCCON register are modified before the frequencyselection takes place. The LTS and HTS bits of the\nOSCCON register will reflect the current active status\nof the LFINTOSC and HFINTOSC oscillators. Thetiming of a frequency selection is as follows:\n1. IRCF<2:0> bits of the OSCCON register are\nmodified.\n2. If the new clock is shut down, a clock start-up\ndelay is started.\n3. Clock switch circuitry waits for a falling edge of\nthe current clock.\n4. CLKOUT is held low and the clock switch\ncircuitry waits for a rising edge in the new clock.\n5. CLKOUT is now connected with the new clock.\nLTS and HTS bits of the OSCCON register are\nupdated as required.\n6. Clock switch is complete.\nSee Figure 3-1 for more details.If the internal oscillator speed selected is between\n8 MHz and 125 kHz, there is no start-up delay beforethe new frequency is selected. This is because the old\nand new frequencies are derived from the HFINTOSC\nvia the postscaler and multiplexer.\nStart-up delay specifications are located in the\noscillator tables of Section 15.0 “Electrical\nSpecifications” .\nNote: Following any Reset, the IRCF<2:0> bits of\nthe OSCCON register are set to ‘ 110’ and\nthe frequency selection is set to 4 MHz.\nThe user can modify the IRCF bits to\nselect a different frequency.\nPIC16F684\nDS41202F-page 26 © 2007 Microchip Technology Inc.FIGURE 3-6: INTERNAL OSCILLATOR SWITCH TIMING\nHFINTOSC\nLFINTOSC\nIRCF <2:0>\nSystem Clock\nHFINTOSC\nLFINTOSC\nIRCF <2:0>\nSystem Clock≠ 0 = 0\n≠ 0 = 0Start-up Time 2-cycle Sync Running\n2-cycle Sync RunningHFINTOSC LFINTOSC (FSCM and WDT disabled)\nHFINTOSC LFINTOSC (Either FSCM or WDT enabled)\nLFINTOSC\nHFINTOSC\nIRCF <2:0>\nSystem Clock= 0 ¼ 0Start-up Time 2-cycle Sync RunningLFINTOSC HFINTOSC\nLFINTOSC turns off unless WDT or FSCM is enabled\n© 2007 Microchip Technology Inc. DS41202F-page 27PIC16F684\n3.6 Clock Switching\nThe system clock source can be switched between\nexternal and internal clock sources via software usingthe System Clock Select (SCS) bit of the OSCCON\nregister.\n3.6.1 SYSTEM CLOCK SELECT (SCS) BIT\nThe System Clock Select (SCS) bit of the OSCCON\nregister selects the system clock source that is used for\nthe CPU and peripherals.\n\x81 When the SCS bit of the OSCCON register = 0, \nthe system clock source is determined by configuration of the FOSC<2:0> bits in the \nConfiguration Word register (CONFIG).\n\x81 When the SCS bit of the OSCCON register = 1, \nthe system clock source is chosen by the internal \noscillator frequency selected by the IRCF<2:0> bits of the OSCCON register. After a Reset, the \nSCS bit of the OSCCON register is always \ncleared.\n3.6.2 OSCILLATOR START-UP TIME-OUT \nSTATUS (OSTS) BIT\nThe Oscillator Start-up Time-out Status (OSTS) bit of\nthe OSCCON register indicates whether the systemclock is running from the external clock source, as\ndefined by the FOSC<2:0> bits in the Configuration\nWord register (CONFIG), or from the internal clocksource. In particular, OSTS indicates that the Oscillator\nStart-up Timer (OST) has timed out for LP, XT or HS\nmodes.\n3.7 Two-Speed Clock Start-up Mode\nTwo-Speed Start-up mode provides additional powersavings by minimizing the latency between external\noscillator start-up and code execution. In applications\nthat make heavy use of the Sleep mode, Two-SpeedStart-up will remove the external oscillator start-up\ntime from the time spent awake and can reduce the\noverall power consumption of the device.\nThis mode allows the application to wake-up from\nSleep, perform a few instructions using the INTOSC\nas the clock source and go back to Sleep without\nwaiting for the primary oscillator to become stable.When the Oscillator module is configured for LP, XT or\nHS modes, the Oscillator Start-up Timer (OST) is\nenabled (see Section 3.4.1 “Oscillator Start-up Timer\n(OST)” ). The OST will suspend program execution until\n1024 oscillations are counted. Two-Speed Start-up\nmode minimizes the delay in code execution by\noperating from the internal oscillator as the OST iscounting. When the OST count reaches 1024 and the\nOSTS bit of the OSCCON register is set, program\nexecution switches to the external oscillator.\n3.7.1 TWO-SPEED START-UP MODE \nCONFIGURATION\nTwo-Speed Start-up mode is configured by the\nfollowing settings:\n\x81 IESO (of the Configuration Word register) = 1; \nInternal/External Switchover bit (Two-Speed \nStart-up mode enabled).\n\x81 SCS (of the OSCCON register) = 0.\n\x81 FOSC<2:0> bits in the Configuration Word \nregister (CONFIG) configured for LP, XT or HS \nmode.\nTwo-Speed Start-up mode is entered after:\x81 Power-on Reset (POR) and, if enabled, after \nPower-up Timer (PWRT) has expired, or\n\x81 Wake-up from Sleep.\nIf the external clock oscillator is configured to be\nanything other than LP, XT or HS mode, then\nTwo-Speed Start-up is disabled. This is because the\nexternal clock oscillator does not require anystabilization time after POR or an exit from Sleep.\n3.7.2 TWO-SPEED START-UP \nSEQUENCE\n1. Wake-up from Power-on Reset or Sleep.\n2. Instructions begin execution by the internal\noscillator at the frequency set in the IRCF<2:0>\nbits of the OSCCON register.\n3. OST enabled to count 1024 clock cycles.\n4. OST timed out, wait for falling edge of the\ninternal oscillator.\n5. OSTS is set.6. System clock held low until the next falling edge\nof new clock (LP, XT or HS mode).\n7. System clock is switched to external clock\nsource.Note: Any automatic clock switch, which may\noccur from Two-Speed Start-up or Fail-Safe\nClock Monitor, does not update the SCS bit\nof the OSCCON register. The user canmonitor the OSTS bit of the OSCCON\nregister to determine the current system\nclock source.\nNote: Executing a SLEEP  instruction will abort\nthe oscillator start-up time and will cause\nthe OSTS bit of the OSCCON register toremain clear.\nPIC16F684\nDS41202F-page 28 © 2007 Microchip Technology Inc.3.7.3 CHECKING TWO-SPEED CLOCK \nSTATUS\nChecking the state of the OSTS bit of the OSCCON\nregister will confirm if the microcontroller is runningfrom the external clock source, as defined by the\nFOSC<2:0> bits in the Configuration Word register\n(CONFIG), or the internal oscillator.\nFIGURE 3-7: TWO-SPEED START-UP \n0 1 1022 1023\n                     PC + 1TOSTTHFINTOSC\nOSC1\nOSC2\nProgram Counter\nSystem ClockPC - N PC\n© 2007 Microchip Technology Inc. DS41202F-page 29PIC16F684\n3.8 Fail-Safe Clock Monitor\nThe Fail-Safe Clock Monitor (FSCM) allows the device\nto continue operating should the external oscillator fail.The FSCM can detect oscillator failure any time after\nthe Oscillator Start-up Timer (OST) has expired. The\nFSCM is enabled by setting the FCMEN bit in theConfiguration Word register (CONFIG). The FSCM is\napplicable to all external oscillator modes (LP, XT, HS,\nEC, RC and RCIO).\nFIGURE 3-8: FSCM BLOCK DIAGRAM \n3.8.1 FAIL-SAFE DETECTION\nThe FSCM module detects a failed oscillator by\ncomparing the external oscillator to the FSCM sampleclock. The sample clock is generated by dividing the\nLFINTOSC by 64. See Figure 3-8. Inside the fail\ndetector block is a latch. The external clock sets thelatch on each falling edge of the external clock. The\nsample clock clears the latch on each rising edge of the\nsample clock. A failure is detected when an entirehalf-cycle of the sample clock elapses before the\nprimary clock goes low.\n3.8.2 FAIL-SAFE OPERATION\nWhen the external clock fails, the FSCM switches the\ndevice clock to an internal clock source and sets the bitflag OSFIF of the PIR1 register. Setting this flag will\ngenerate an interrupt if the OSFIE bit of the PIE1\nregister is also set. The device firmware can then takesteps to mitigate the problems that may arise from a\nfailed clock. The system clock will continue to be\nsourced from the internal clock source until the devicefirmware successfully restarts the external oscillator\nand switches back to external operation.\nThe internal clock source chosen by the FSCM is\ndetermined by the IRCF<2:0> bits of the OSCCONregister. This allows the internal oscillator to be\nconfigured before a failure occurs.3.8.3 FAIL-SAFE CONDITION CLEARING\nThe Fail-Safe condition is cleared after a Reset,\nexecuting a SLEEP  instruction or toggling the SCS bit\nof the OSCCON register. When the SCS bit is toggled,\nthe OST is restarted. While the OST is running, the\ndevice continues to operate from the INTOSC selectedin OSCCON. When the OST times out, the Fail-Safe\ncondition is cleared and the device will be operating\nfrom the external clock source. The Fail-Safe conditionmust be cleared before the OSFIF flag can be cleared.\n3.8.4 RESET OR WAKE-UP FROM SLEEP\nThe FSCM is designed to detect an oscillator failure\nafter the Oscillator Start-up Timer (OST) has expired.\nThe OST is used after waking up from Sleep and afterany type of Reset. The OST is not used with the EC or\nRC Clock modes so that the FSCM will be active as\nsoon as the Reset or wake-up has completed. Whenthe FSCM is enabled, the Two-Speed Start-up is also\nenabled. Therefore, the device will always be executing\ncode while the OST is operating.External\nLFINTOSC÷ 64S\nRQ\n31 kHz\n(~32 μs)488 Hz\n(~2 ms)Clock Monitor\nLatch\nClock\nFailure\nDetectedOscillatorClock\nQ\nSample ClockNote: Due to the wide range of oscillator start-up\ntimes, the Fail-Safe circuit is not active\nduring oscillator start-up (i.e., after exitingReset or Sleep). After an appropriate\namount of time, the user should check the\nOSTS bit of the OSCCON register to verifythe oscillator start-up and that the system\nclock switchover has successfully\ncompleted.\nPIC16F684\nDS41202F-page 30 © 2007 Microchip Technology Inc.FIGURE 3-9: FSCM TIMING DIAGRAM \nTABLE 3-2: SUMMARY OF REGISTERS ASSOCIATED WITH CLOCK SOURCES     OSCFIFSystem\nClock\nOutputSample Clock\nFailure\nDetectedOscillator\nFailure\nNote: The system clock is normally at a much higher frequency than the sample clock. The relative frequencies in\nthis example have been chosen for clarity.(Q)\nTest Test TestClock Monitor Output\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets(1)\nCONFIG(2)CPD CP MCLRE PWRTE WDTE FOSC2 FOSC1 FOSC0 — —\nOSCCON — IRCF2 IRCF1 IRCF0 OSTS HTS LTS SCS -110 x000 -110 x000\nOSCTUNE — — — TUN4 TUN3 TUN2 TUN1 TUN0 ---0 0000 ---u uuuu\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nLegend: x = unknown, u = unchanged, – = unimplemented locations read as ‘ 0’. Shaded cells are not  used by oscillators.\nNote 1: Other (non Power-up) Resets include MCLR  Reset and Watchdog Timer Reset during normal operation.\n2: See Configuration Word register (Register 12-1) for operation of all register bits.\n© 2007 Microchip Technology Inc. DS41202F-page 31PIC16F684\n4.0 I/O PORTS\nThere are as many as twelve general purpose I/O pins\navailable. Depending on which peripherals are enabled,\nsome or all of the pins may not be available as generalpurpose I/O. In general, when a peripheral is enabled,\nthe associated pin may not be used as a general\npurpose I/O pin.\n4.1 PORTA and the TRISA Registers\nPORTA is a 6-bit wide, bidirectional port. Thecorresponding data direction register is TRISA\n(Register 4-2). Setting a TRISA bit (= 1) will make the\ncorresponding PORTA pin an input (i.e., disable theoutput driver). Clearing a TRISA bit (= 0) will make the\ncorresponding PORTA pin an output (i.e., enables output\ndriver and puts the contents of the output latch on theselected pin). The exception is RA3, which is input only\nand its TRIS bit will always read as ‘ 1’. Example 4-1\nshows how to initialize PORTA.\nReading the PORTA register (Register 4-1) reads the\nstatus of the pins, whereas writing to it will write to the\nPORT latch. All write operations are read-modify-write\noperations. Therefore, a write to a port implies that theport pins are read, this value is modified and then\nwritten to the PORT data latch. RA3 reads ‘ 0’ when\nMCLRE = 1.\nThe TRISA register controls the direction of the\nPORTA pins, even when they are being used as analoginputs. The user must ensure the bits in the TRISA\nregister are maintained set when using them as analog\ninputs. I/O pins configured as analog input always read‘0’.\nEXAMPLE 4-1: INITIALIZING PORTA\n \n Note: The ANSEL and CMCON0 registers must\nbe initialized to configure an analog\nchannel as a digital input. Pins configuredas analog inputs will read ‘ 0’.\n BCF STATUS,RP0 ;Bank 0\n CLRF PORTA ;Init PORTA\n MOVLW 07h ;Set RA<2:0> to \n MOVWF CMCON0 ;digital I/O BSF STATUS,RP0 ;Bank 1\n CLRF ANSEL ;digital I/O\n MOVLW 0Ch ;Set RA<3:2> as inputs MOVWF TRISA ;and set RA<5:4,1:0>\n;as outputs\n BCF STATUS,RP0 ;Bank 0\nREGISTER 4-1: PORTA: PORTA REGISTER\nU-0 U-0 R/W-x R/W-0 R-x R/W-0 R/W-0 R/W-0\n— — RA5 RA4 RA3 RA2 RA1 RA0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-0 RA<5:0> : PORTA I/O Pin bit\n1 = PORTA pin is > V\nIH\n0 = PORTA pin is < V IL\nREGISTER 4-2: TRISA: PORTA TRI-STATE REGISTER\nU-0 U-0 R/W-1 R/W-1 R-1 R/W-1 R/W-1 R/W-1\n— — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-0 TRISA<5:0>:  PORTA Tri-State Control bit\n1 = PORTA pin configured as an input (tri-stated)\n0 = PORTA pin configured as an output\nNote 1: TRISA<3> always reads ‘ 1’.\n2: TRISA<5:4> always reads ‘ 1’ in XT, HS and LP OSC modes.\nPIC16F684\nDS41202F-page 32 © 2007 Microchip Technology Inc.4.2 Additional Pin Functions\nEvery PORTA pin on the PIC16F684 has an\ninterrupt-on-change option and a weak pull-up option.RA0 has an Ultra Low-Power Wake-up option. The next\nthree sections describe these functions.\n4.2.1 ANSEL REGISTER\nThe ANSEL register is used to configure the Input\nmode of an I/O pin to analog. Setting the appropriateANSEL bit high will cause all digital reads on the pin to\nbe read as ‘ 0’ and allow analog functions on the pin to\noperate correctly.\nThe state of the ANSEL bits has no affect on digital\noutput functions. A pin with TRIS clear and ANSEL set\nwill still operate as a digital output, but the Input mode\nwill be analog. This can cause unexpected behaviorwhen executing read-modify-write instructions on the\naffected port.\n4.2.2 WEAK PULL-UPS\nEach of the PORTA pins, except RA3, has an\nindividually configurable internal weak pull-up. Controlbits WPUAx enable or disable each pull-up. Refer to\nRegister 4-4. Each weak pull-up is automatically turned\noff when the port pin is configured as an output. Thepull-ups are disabled on a Power-on Reset by the\nRAPU\n bit of the OPTION register). A weak pull-up is\nautomatically enabled for RA3 when configured asMCLR\n and disabled when RA3 is an I/O. There is no\nsoftware control of the MCLR  pull-up.4.2.3 INTERRUPT-ON-CHANGE\nEach of the PORTA pins is individually configurable as\nan interrupt-on-change pin. Control bits IOCAx enableor disable the interrupt function for each pin. Refer to\nRegister 4-5. The interrupt-on-change is disabled on a\nPower-on Reset.\nFor enabled interrupt-on-change pins, the values are\ncompared with the old value latched on the last read of\nPORTA. The ‘mismatch’ outputs of the last read are\nOR’d together to set the PORTA Change Interrupt Flagbit (RAIF) in the INTCON register (Register 2-3).\nThis interrupt can wake the device from Sleep. The\nuser, in the Interrupt Service Routine, clears the inter-\nrupt by:\na) Any read or write of PORTA. This will end the\nmismatch condition, then,\nb) Clear the flag bit RAIF.\nA mismatch condition will continue to set flag bit RAIF.\nReading PORTA will end the mismatch condition and\nallow flag bit RAIF to be cleared. The latch holding the\nlast read value is not affected by a MCLR\n nor\nBrown-out Reset. After these resets, the RAIF flag will\ncontinue to be set if a mismatch is present. \n Note: If a change on the I/O pin should occur\nwhen any PORTA operation is being\nexecuted, then the RAIF interrupt flag may\nnot get set.\nREGISTER 4-3: ANSEL: ANALOG SELECT REGISTER\nR/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1\nANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-0 ANS<7:0> : Analog Select bits\nAnalog select between analog or digital function on pins AN<7:0>, respectively.1 = Analog input. Pin is assigned as analog input\n(1).\n0 = Digital I/O. Pin is assigned to port or special function.\nNote 1: Setting a pin to an analog input automatically disables the digital input circuitry, weak pull-ups and \ninterrupt-on-change, if available. The corresponding TRIS bit must be set to Input mode in order to allow \nexternal control of the voltage on the pin.\n© 2007 Microchip Technology Inc. DS41202F-page 33PIC16F684\n             \n             REGISTER 4-4: WPUA: WEAK PULL-UP PORTA REGISTER\nU-0 U-0 R/W-1 R/W-1 U-0 R/W-1 R/W-1 R/W-1\n— — WPUA5 WPUA4 — WPUA2 WPUA1 WPUA0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-4 WPUA<5:4>:  Weak Pull-up Control bits\n1 = Pull-up enabled\n0 = Pull-up disabled\nbit 3 Unimplemented : Read as ‘ 0’\nbit 2-0 WPUA<2:0>:  Weak Pull-up Control bits\n1 = Pull-up enabled\n0 = Pull-up disabled\nNote 1: Global RAPU  must be enabled for individual pull-ups to be enabled.\n2:The weak pull-up device is automatically disabled if the pin is in Output mode (TRISA = 0).\n3:The RA3 pull-up is enabled when configured as MCLR  and disabled as an I/O in the Configuration Word.\n4:WPUA<5:4> always reads ‘ 1’ in XT, HS and LP OSC modes.\nREGISTER 4-5: IOCA: INTERRUPT-ON-CHANGE PORTA REGISTER\nU-0 U-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\n— — IOCA5 IOCA4 IOCA3 IOCA2 IOCA1 IOCA0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-0 IOCA<5:0>:  Interrupt-on-change PORTA Control bit\n1 = Interrupt-on-change enabled\n0 = Interrupt-on-change disabled\nNote 1: Global Interrupt Enable (GIE) must be enabled for individual interrupts to be recognized.\n2:IOCA<5:4> always reads ‘ 1’ in XT, HS and LP OSC modes.\nPIC16F684\nDS41202F-page 34 © 2007 Microchip Technology Inc.4.2.4 ULTRA LOW-POWER WAKE-UP\nThe Ultra Low-Power Wake-Up (ULPWU) on RA0\nallows a slow falling voltage to generate aninterrupt-on-change on RA0 without excess current\nconsumption. The mode is selected by setting the\nULPWUE bit of the PCON register. This enables a smallcurrent sink which can be used to discharge a capacitor\non RA0. \nTo use this feature, the RA0 pin is first configured to output\n‘1’ to charge the capacitor. Then interrupt-on-change for\nRA0 is enabled, and RA0 is configured as an input. The\nULPWUE bit is set to begin the discharge and a SLEEP\ninstruction is performed. When the voltage on RA0 dropsbelow V\nIL, the device will wake-up and execute the next\ninstruction. If the GIE bit of the INTCON register is set, the\ndevice will call the interrupt service routine (0004h). SeeSection 4.2.3 “Interrupt-on-Change”  and\nSection 12.4.3 “PORTA Interrupt-on-Change”  for\nmore information.\nThis feature provides a low-power technique for\nperiodically waking up the device from Sleep. The\ntime-out is dependent on the discharge time of the RC\ncircuit on RA0. See Example 4-2 for initializing the UltraLow-Power Wake-Up module.\nThe series resistor provides overcurrent protection for\nthe RA0 pin and can allow for software calibration of\nthe time-out (see Figure 4-1). A timer can be used tomeasure the charge time and discharge time of the\ncapacitor. The charge time can then be adjusted to\nprovide the desired interrupt delay. This technique willcompensate for the affects of temperature, voltage and\ncomponent accuracy. The Ultra Low-Power Wake-Up\nperipheral can also be configured as a simpleProgrammable Low Voltage Detect or temperature\nsensor.EXAMPLE 4-2: ULTRA LOW-POWER \nWAKE-UP INITIALIZATIONNote: For more information, refer to AN879,\n“Using the Microchip Ultra Low-Power\nWake-Up Module ” Application Note\n(DS00879).\nBANKSEL CMCON0 ;\nMOVLW H’7’ ;Turn off\nMOVWF CMCON0 ;comparators\nBANKSEL ANSEL ;\nBCF ANSEL,0 ;RA0 to digital I/OBCF TRISA,0 ;Output high to\nBANKSEL PORTA ;\nBSF PORTA,0 ;charge capacitorCALL CapDelay ;\nBANKSEL PCON ;\nBSF PCON,ULPWUE ;Enable ULP Wake-upBSF IOCA,0 ;Select RA0 IOC\nBSF TRISA,0 ;RA0 to input\nMOVLW B’10001000’ ;Enable interruptMOVWF INTCON ; and clear flag\nSLEEP ;Wait for IOC\n© 2007 Microchip Technology Inc. DS41202F-page 35PIC16F684\n4.2.5 PIN DESCRIPTIONS AND \nDIAGRAMS\nEach PORTA pin is multiplexed with other functions.\nThe pins and their combined functions are brieflydescribed here. For specific information about\nindividual functions such as the Comparator or the\nADC, refer to the appropriate section in this data sheet.\n4.2.5.1 RA0/AN0/C1IN+/ICSPDAT/ULPWU\nFigure 4-1 shows the diagram for this pin. The RA0 pinis configurable to function as one of the following:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\x81 an analog non-inverting input to the comparator\n\x81 In-Circuit Serial Programming data\n\x81 an analog input for the Ultra Low-Power Wake-Up4.2.5.2 RA1/AN1/C1IN-/V REF/ICSPCLK\nFigure 4-2 shows the diagram for this pin. The RA1 pin\nis configurable to function as one of the following:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 an analog inverting input to the comparator\n\x81 a voltage reference input for the ADC\x81 In-Circuit Serial Programming clock\nFIGURE 4-1: BLOCK DIAGRAM OF RA0\nVDD\nVSSD\nQCKQ\nD\nQCKQ\nD\nQCKQ\nD\nQCKQVDD\nD\nENQD\nENQWeak\nRD PORTARDWR\nWR\nRD\nWR\nIOCA\nRD\nIOCA\nInterrupt-on-\nTo ComparatorAnalog(1)\nInput Mode\nRAPU\nAnalog(1)\nInput Mode\nChangeQ3WR\nRD\n01IULPWPUAData Bus\nWPUA\nPORTA\nTRISA\nTRISA\nPORTA\nNote 1: Comparator mode and ANSEL determines Analog Input mode.-\n+ VT\nULPWUE\nTo A/D ConverterVSSI/O Pin\nPIC16F684\nDS41202F-page 36 © 2007 Microchip Technology Inc.FIGURE 4-2: BLOCK DIAGRAM OF RA1 4.2.5.3 RA2/AN2/T0CKI/INT/C1OUT\nFigure 4-3 shows the diagram for this pin. The RA2 pin\nis configurable to function as one of the following:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC \n\x81 the clock input for TMR0\n\x81 an external edge triggered interrupt\x81 a digital output from Comparator 1\nFIGURE 4-3: BLOCK DIAGRAM OF RA2 VDD\nVSSD\nQCKQ\nD\nQCKQ\nD\nQCKQ\nD\nQCKQVDD\nD\nENQD\nENQWeakData Bus\nWR\nWPUA\nRD\nWPUA\nRD PORTARD\nPORTAWR\nPORTA\nWR\nTRISA\nRD\nTRISA\nWR\nIOCA\nRD\nIOCA\nInterrupt-on-\nTo ComparatorAnalog(1)\nInput Mode\nRAPU\nAnalog(1)\nInput Mode\nChangeQ3\nNote 1: Comparator mode and ANSEL determines Analog\nInput mode.To A/D ConverterI/O Pin\nVDD\nVSSD\nQCKQ\nD\nQCKQ\nD\nQCKQ\nD\nQCKQVDD\nD\nENQD\nENQWeak\nAnalog(1)\nInput ModeData Bus\nWR\nWPUA\nRD\nWPUA\nRD\nPORTAWR\nPORTA\nWR\nTRISA\nRD\nTRISA\nWR\nIOCA\nRD\nIOCA\nTo A/D Converter01 C1OUTC1OUT\nEnable\nTo INTTo Timer0Analog(1)\nInput Mode\nRAPU\nRD PORTAInterrupt-on-\nChangeQ3\nNote 1: Analog Input mode is generated by ANSEL.I/O Pin\n© 2007 Microchip Technology Inc. DS41202F-page 37PIC16F684\n4.2.5.4 RA3/MCLR /VPP\nFigure 4-4 shows the diagram for this pin. The RA3 pin\nis configurable to function as one of the following:\n\x81 a general purpose input\n\x81 as Master Clear Reset with weak pull-up\nFIGURE 4-4: BLOCK DIAGRAM OF RA34.2.5.5 RA4/AN3/T1G /OSC2/CLKOUT\nFigure 4-5 shows the diagram for this pin. The RA4 pin\nis configurable to function as one of the following:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 a Timer1 gate (count enable)\n\x81 a crystal/resonator connection\x81 a clock output\nFIGURE 4-5: BLOCK DIAGRAM OF RA4\nVSS\nD\nQCKQ\nD\nENQData Bus\nRD PORTARD\nPORTA\nWR\nIOCA\nRD\nIOCAResetMCLRE\nRD\nTRISAVSS\nD\nENQMCLREVDD\nWeak MCLRE\nInterrupt-on-\nChangeQ3Input\nPin\nVDD\nVSSD\nQCKQ\nD\nQCKQ\nD\nQCKQ\nD\nQCKQVDD\nD\nENQD\nENQWeak\nAnalog\nInput ModeData Bus\nWR\nWPUA\nRD\nWPUA\nRD\nPORTAWR\nPORTA\nWR\nTRISA\nRD\nTRISA\nWR\nIOCA\nRD\nIOCAFOSC/4\nTo A/D ConverterOscillator\nCircuit\nOSC1\nCLKOUT01CLKOUT\nEnable\nEnableAnalog(3)\nInput Mode\nRAPU\nRD PORTA \nTo T1GINTOSC/\nRC/EC(2)CLK(1)\nModes\nCLKOUT\nEnable\nNote 1: CLK modes are XT, HS, LP, LPTMR1 and CLKOUT\nEnable.\n2:With CLKOUT option.\n3:Analog Input mode comes from ANSEL.Interrupt-on-\nChangeQ3I/O Pin\nPIC16F684\nDS41202F-page 38 © 2007 Microchip Technology Inc.4.2.5.6 RA5/T1CKI/OSC1/CLKIN\nFigure 4-6 shows the diagram for this pin. The RA5 pin\nis configurable to function as one of the following:\n\x81 a general purpose I/O\n\x81 a Timer1 clock input\n\x81 a crystal/resonator connection\n\x81 a clock input\nFIGURE 4-6: BLOCK DIAGRAM OF RA5\nVDD\nVSSD\nQCKQ\nD\nQCKQ\nD\nQCKQ\nD\nQCKQVDD\nD\nENQD\nENQWeakData Bus\nWR\nWPUA\nRD\nWPUA\nRD\nPORTAWR\nPORTA\nWR\nTRISA\nRD\nTRISA\nWR\nIOCA\nRD\nIOCA\nTo Timer1 INTOSC\nMode\nRD PORTA INTOSC\nMode\nRAPU\nOSC2\nNote 1: Timer1 LP Oscillator enabled.TMR1LPEN(1)\nInterrupt-on-\nChangeOscillator\nCircuit\nQ3I/O Pin\n© 2007 Microchip Technology Inc. DS41202F-page 39PIC16F684\nTABLE 4-1: SUMMARY OF REGISTERS ASSOCIATED WITH PORTA    \nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nANSEL ANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS0 1111 1111 1111 1111\nCMCON0 C2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0 0000 0000 0000 0000\nPCON — —U L P W U E SBOREN — — POR BOR --01 --qq --0u --uu\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 0000 0000\nIOCA — — IOCA5 IOCA4 IOCA3 IOCA2 IOCA1 IOCA0 --00 0000 --00 0000\nOPTION_REG RAPU INTEDG T0CS T0SE PSA PS2 PS1 PS01111 1111 1111 1111\nPORTA — — RA5 RA4 RA3 RA2 RA1 RA0 --x0 x000 --uu uu00\nTRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0 --11 1111 --11 1111\nWPUA — —W P U A 5 W P U A 4 — WPUA2 WPUA1 WPUA0 --11 -111 --11 -111\nLegend: x = unknown, u = unchanged, – = unimplemented locations read as ‘ 0’. Shaded cells are not used by PORTA.\nPIC16F684\nDS41202F-page 40 © 2007 Microchip Technology Inc.4.3 PORTC\nPORTC is a general purpose I/O port consisting of 6\nbidirectional pins. The pins can be configured for eitherdigital I/O or analog input to A/D Converter (ADC) or\nComparator. For specific information about individual\nfunctions such as the Enhanced CCP or the ADC, referto the appropriate section in this data sheet.EXAMPLE 4-3: INITIALIZING PORTC\n             \n             Note: The ANSEL and CMCON0 registers must\nbe initialized to configure an analog chan-nel as a digital input. Pins configured as\nanalog inputs will read ‘ 0’.BANKSEL PORTC ;\nCLRF PORTC ;Init PORTCMOVLW 07h ;Set RC<4,1:0> to \nMOVWF CMCON0 ;digital I/O\nBANKSEL ANSEL ;CLRF ANSEL ;digital I/O\nMOVLW 0Ch ;Set RC<3:2> as inputs\nMOVWF TRISC ;and set RC<5:4,1:0>\n;as outputs\nBCF STATUS,RP0 ;Bank 0\nREGISTER 4-6: PORTC: PORTC REGISTER\nU-0 U-0 R/W-x R/W-x R/W-0 R/W-0 R/W-0 R/W-0\n— — RC5 RC4 RC3 RC2 RC1 RC0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-0 RC<5:0> : PORTC I/O Pin bit\n1 = PORTC pin is > V IH\n0 = PORTC pin is < V IL\nREGISTER 4-7: TRISC: PORTC TRI-STATE REGISTER\nU-0 U-0 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1\n— — TRISC5 TRISC4 TRISC3 TRISC2 TRISC1 TRISC0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 Unimplemented : Read as ‘ 0’\nbit 5-0 TRISC<5:0>:  PORTC Tri-State Control bit\n1 = PORTC pin configured as an input (tri-stated)\n0 = PORTC pin configured as an output\n© 2007 Microchip Technology Inc. DS41202F-page 41PIC16F684\n4.3.1 RC0/AN4/C2IN+\nThe RC0 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 an analog non-inverting input to the comparator\n4.3.2  RC1/AN5/C2IN-\nThe RC1 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 an analog inverting input to the comparator\nFIGURE 4-7: BLOCK DIAGRAM OF RC0 \nAND RC14.3.3 RC2/AN6/P1D\nThe RC2 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 a digital output from the Enhanced CCP\n4.3.4 RC3/AN7/P1C\nThe RC3 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 an analog input for the ADC\n\x81 a digital output from the Enhanced CCP\nFIGURE 4-8: BLOCK DIAGRAM OF RC2 \nAND RC3\nI/O Pi nVDD\nVSSD\nQCKQ\nD\nQCKQData Bus\nWR\nPORTC\nWR\nTRISC\nRD\nTRISC\nTo A/D ConverterRD\nPORTCAnalog Input\nMode(1)\nTo Comparators\nNote 1: Analog Input mode comes from ANSEL or\nComparator mode.I/O PinVDD\nVSSD\nQCKQ\nD\nQCKQData Bus\nWR\nPORTC\nWR\nTRISC\nRD\nTRISC\nTo A/D ConverterRD\nPORTCAnalog Input\nMode(1)01 CCPOUTCCPOUT\nEnable\nNote 1: Analog Input mode comes from ANSEL.\nPIC16F684\nDS41202F-page 42 © 2007 Microchip Technology Inc.4.3.5 RC4/C2OUT/P1B \nThe RC4 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 a digital output from the comparator\n\x81 a digital output from the Enhanced CCP\nFIGURE 4-9: BLOCK DIAGRAM OF RC44.3.6 RC5/CCP1/P1A \nThe RC5 is configurable to function as one of the\nfollowing:\n\x81 a general purpose I/O\n\x81 a digital input/output for the Enhanced CCP\nFIGURE 4-10: BLOCK DIAGRAM OF RC5 \nPIN\nTABLE 4-2: SUMMARY OF REGISTERS ASSOCIATED WITH PORTC    Note: Enabling both C2OUT and P1B will cause\na conflict on RC4 and create unpredictable\nresults. Therefore, if C2OUT is enabled,the ECCP can not be used in Half-Bridge\nor Full-Bridge mode and vice-versa.\nI/O PinVDD\nVSSD\nQCKQ\nD\nQCKQData Bus\nWR\nPORTC\nWR\nTRISC\nRD\nTRISC\nRD\nPORTC01\nNote 1: Port/Peripheral Select signals selects between \nport data and peripheral output.C2OUT EN\nCCPOUT EN\nC2OUT EN\nC2OUT\nCCPOUT EN\nCCPOUTI/O PinVDD\nVSSD\nQCKQ\nD\nQCKQData bus\nWR\nPORTC\nWR\nTRISC\nRD\nTRISC\nTo Enhanced CCPRD\nPORTC01 CCP1OUTCCP1OUT\nEnable\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nANSEL ANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS01111 1111 1111 1111\nCMCON0 C2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0 0000 0000 0000 0000\nPORTC — — RC5 RC4 RC3 RC2 RC1 RC0 --xx 0000 --uu uu00\nTRISC — — TRISC5 TRISC4 TRISC3 TRISC2 TRISC1 TRISC0 --11 1111 --11 1111\nLegend: x = unknown, u = unchanged, – = unimplemented locations read as ‘ 0’. Shaded cells are not used by PORTC.\n© 2007 Microchip Technology Inc. DS41202F-page 43PIC16F684\n5.0 TIMER0 MODULE\nThe Timer0 module is an 8-bit timer/counter with the\nfollowing features:\n\x81 8-bit timer/counter register (TMR0)\n\x81 8-bit prescaler (shared with Watchdog Timer)\n\x81 Programmable internal or external clock source\x81 Programmable external clock edge selection\n\x81 Interrupt on overflow\nFigure 5-1 is a block diagram of the Timer0 module.5.1 Timer0 Operation\nWhen used as a timer, the Timer0 module can be used\nas either an 8-bit timer or an 8-bit counter.\n5.1.1 8-BIT TIMER MODE\nWhen used as a timer, the Timer0 module willincrement every instruction cycle (without prescaler).\nTimer mode is selected by clearing the T0CS bit of the\nOPTION register to ‘ 0’.\nWhen TMR0 is written, the increment is inhibited for\ntwo instruction cycles immediately following the write. \n5.1.2 8-BIT COUNTER MODE\nWhen used as a counter, the Timer0 module will\nincrement on every rising or falling edge of the T0CKI\npin. The incrementing edge is determined by the T0SEbit of the OPTION register. Counter mode is selected by\nsetting the T0CS bit of the OPTION register to ‘ 1’. \nFIGURE 5-1: BLOCK DIAGRAM OF THE TIMER0/WDT PRESCALER   Note: The value written to the TMR0 register can\nbe adjusted, in order to account for the twoinstruction cycle delay when TMR0 is\nwritten.\nT0CKI\nT0SEpinTMR0 \nWatchdog\nTimerWDT\nTime-outPS<2:0>WDTEData Bus\nSet Flag bit T0IF\non OverflowT0CS\nNote 1: T0SE, T0CS, PSA, PS<2:0> are bits in the OPTION register.\n2:SWDTEN and WDTPS<3:0> are bits in the WDTCON register.\n3:WDTE bit is in the Configuration Word register.0\n1\n01\n0\n1Sync 2\ncycles8\n88-bit\nPrescaler\n01FOSC/4\nPSA\nPSA\nPSA16-bit\nPrescaler16\nWDTPS<3:0>31 kHz\nINTOSCSWDTEN3\nPIC16F684\nDS41202F-page 44 © 2007 Microchip Technology Inc.5.1.3 SOFTWARE PROGRAMMABLE \nPRESCALER\nA single software programmable prescaler is available\nfor use with either Timer0 or the Watchdog Timer(WDT), but not both simultaneously. The prescaler\nassignment is controlled by the PSA bit of the OPTION\nregister. To assign the prescaler to Timer0, the PSA bitmust be cleared to a ‘ 0’.\nThere are 8 prescaler options for the Timer0 module\nranging from 1:2 to 1:256. The prescale values are\nselectable via the PS<2:0> bits of the OPTION register.In order to have a 1:1 prescaler value for the Timer0\nmodule, the prescaler must be assigned to the WDT\nmodule.\nThe prescaler is not readable or writable. When\nassigned to the Timer0 module, all instructions writing to\nthe TMR0 register will clear the prescaler.\nWhen the prescaler is assigned to WDT, a CLRWDT\ninstruction will clear the prescaler along with the WDT.\n5.1.3.1 Switching Prescaler Between \nTimer0 and WDT Modules\nAs a result of having the prescaler assigned to either\nTimer0 or the WDT, it is possible to generate an\nunintended device Reset when switching prescaler\nvalues. When changing the prescaler assignment fromTimer0 to the WDT module, the instruction sequence\nshown in Example 5-1 must be executed.\nEXAMPLE 5-1: CHANGING PRESCALER \n(TIMER0 →WDT)When changing the prescaler assignment from the\nWDT to the Timer0 module, the following instruction\nsequence must be executed (see Example 5-2).\nEXAMPLE 5-2: CHANGING PRESCALER \n(WDT →TIMER0)\n5.1.4 TIMER0 INTERRUPT\nTimer0 will generate an interrupt when the TMR0\nregister overflows from FFh to 00h. The T0IF interruptflag bit of the INTCON register is set every time the\nTMR0 register overflows, regardless of whether or not\nthe Timer0 interrupt is enabled. The T0IF bit must becleared in software. The Timer0 interrupt enable is the\nT0IE bit of the INTCON register.\n5.1.5 USING TIMER0 WITH AN \nEXTERNAL CLOCK\nWhen Timer0 is in Counter mode, the synchronization\nof the T0CKI input and the Timer0 register is accom-\nplished by sampling the prescaler output on the Q2 andQ4 cycles of the internal phase clocks. Therefore, the\nhigh and low periods of the external clock source must\nmeet the timing requirements as shown inSection 15.0 “Electrical Specifications” .BANKSEL TMR0 ;\nCLRWDT ;Clear WDT\nCLRF TMR0 ;Clear TMR0 and\n; prescaler\nBANKSEL OPTION_REG ;\nBSF OPTION_REG,PSA ;Select WDTCLRWDT ;\n;\nMOVLW b’11111000’ ;Mask prescalerANDWF OPTION_REG,W ; bits\nIORLW b’00000101’ ;Set WDT prescaler\nMOVWF OPTION_REG ; to 1:32Note: The Timer0 interrupt cannot wake the\nprocessor from Sleep since the timer is\nfrozen during Sleep.CLRWDT ;Clear WDT and\n;prescaler\nBANKSEL OPTION_REG ;\nMOVLW b’11110000’ ;Mask TMR0 select andANDWF OPTION_REG,W ; prescaler bits \nIORLW b’00000011’ ;Set prescale to 1:16 \nMOVWF OPTION_REG ;\n© 2007 Microchip Technology Inc. DS41202F-page 45PIC16F684\n \nTABLE 5-1: SUMMARY OF REGISTERS ASSOCIATED WITH TIMER0REGISTER 5-1: OPTION_REG: OPTION REGISTER\nR/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1 R/W-1\nRAPU INTEDG T0CS T0SE PSA PS2 PS1 PS0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 RAPU : PORTA Pull-up Enable bit\n1 = PORTA pull-ups are disabled\n0 = PORTA pull-ups are enabled by individual PORT latch values\nbit 6 INTEDG:  Interrupt Edge Select bit\n1 = Interrupt on rising edge of INT pin\n0 = Interrupt on falling edge of INT pin\nbit 5 T0CS:  TMR0 Clock Source Select bit\n1 = Transition on T0CKI pin\n0 = Internal instruction cycle clock (F OSC/4)\nbit 4 T0SE:  TMR0 Source Edge Select bit\n1 = Increment on high-to-low transition on T0CKI pin\n0 = Increment on low-to-high transition on T0CKI pin\nbit 3 PSA:  Prescaler Assignment bit\n1 = Prescaler is assigned to the WDT\n0 = Prescaler is assigned to the Timer0 module\nbit 2-0 PS<2:0>:  Prescaler Rate Select bits\nNote 1: A dedicated 16-bit WDT postscaler is available. See Section 12.6 “Watchdog Timer (WDT)”  for more \ninformation.000\n001010011\n100\n1011101111 : 2\n1 : 41 : 81 : 161 : 321 : 64\n1 : 128\n1 : 2561 : 1\n1 : 21 : 41 : 8\n1 : 16\n1 : 321 : 641 : 128BIT VALUE TMR0 RATE WDT RATE\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on\nall other\nResets\nTMR0 Timer0 Module Register xxxx xxxx uuuu uuuu\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF0000 0000 0000 0000\nOPTION_REG RAPUINTEDG T0CS T0SE PSA PS2 PS1 PS0 1111 1111 1111 1111\nTRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0--11 1111 --11 1111\nLegend: – = Unimplemented locations, read as ‘0’, u = unchanged, x = unknown. Shaded cells are not used by the \nTimer0 module.\nPIC16F684\nDS41202F-page 46 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 47PIC16F684\n6.0 TIMER1 MODULE WITH GATE \nCONTROL\nThe Timer1 module is a 16-bit timer/counter with the\nfollowing features:\n\x81 16-bit timer/counter register pair (TMR1H:TMR1L)\n\x81 Programmable internal or external clock source\n\x81 3-bit prescaler\n\x81 Optional LP oscillator\x81 Synchronous or asynchronous operation\n\x81 Timer1 gate (count enable) via comparator or \nT1G\n pin\n\x81 Interrupt on overflow\n\x81 Wake-up on overflow (external clock, \nAsynchronous mode only)\n\x81 Time base for the Capture/Compare function\x81 Special Event Trigger (with ECCP)\n\x81 Comparator output synchronization to Timer1 \nclock\nFigure 6-1 is a block diagram of the Timer1 module.6.1 Timer1 Operation\nThe Timer1 module is a 16-bit incrementing counter\nwhich is accessed through the TMR1H:TMR1L registerpair. Writes to TMR1H or TMR1L directly update the\ncounter.\nWhen used with an internal clock source, the module is\na timer. When used with an external clock source, themodule can be used as either a timer or counter.\n6.2 Clock Source Selection\nThe TMR1CS bit of the T1CON register is used to select\nthe clock source. When TMR1CS = 0, the clock source\nis F OSC/4. When TMR1CS = 1, the clock source is\nsupplied externally.\nFIGURE 6-1: TIMER1 BLOCK DIAGRAM   Clock Source TMR1CS\nFOSC/4 0\nT1CKI pin 1\nTMR1H TMR1L\nOscillatorT1SYNC\nT1CKPS<1:0>Prescaler\n1, 2, 4, 8Synchronize\ndet(2)1\n00\n1Synchronized\nclock input\n2Set flag bit\nTMR1IF onOverflow\nTMR1(1)TMR1GE\nTMR1ON\nT1OSCEN1\n0 C2OUT\nT1GSST1GINV\nTo C2 Comparator Module\nTimer1 Clock\nTMR1CSOSC2/T1GOSC1/T1CKI\n* ST Buffer is low power type when using LP osc, or high speed type when using T1CKI.\nNote 1: Timer1 register increments on rising edge.\n2: Synchronize does not operate while in Sleep.*EN\nFOSC/4\nInternal\nClock\nFOSC = 100\nFOSC = 000\nSleep\nPIC16F684\nDS41202F-page 48 © 2007 Microchip Technology Inc.6.2.1 INTERNAL CLOCK SOURCE\nWhen the internal clock source is selected, the\nTMR1H:TMR1L register pair will increment on multiplesof F\nOSC as determined by the Timer1 prescaler.\n6.2.2 EXTERNAL CLOCK SOURCE\nWhen the external clock source is selected, the Timer1\nmodule may work as a timer or a counter.\nWhen counting, Timer1 is incremented on the rising\nedge of the external clock input T1CKI. In addition, theCounter mode clock can be synchronized to the\nmicrocontroller system clock or run asynchronously.\nIf an external clock oscillator is needed (and the\nmicrocontroller is using the INTOSC without CLKOUT),Timer1 can use the LP oscillator as a clock source. \n6.3 Timer1 Prescaler\nTimer1 has four prescaler options allowing 1, 2, 4 or 8divisions of the clock input. The T1CKPS bits of the\nT1CON register control the prescale counter. The\nprescale counter is not directly readable or writable;however, the prescaler counter is cleared upon a write to\nTMR1H or TMR1L.\n6.4 Timer1 Oscillator\nA low-power 32.768 kHz crystal oscillator is built-in\nbetween pins OSC1 (input) and OSC2 (amplifieroutput). The oscillator is enabled by setting the\nT1OSCEN control bit of the T1CON register. The\noscillator will continue to run during Sleep.\nThe Timer1 oscillator is shared with the system LP\noscillator. Thus, Timer1 can use this mode only when\nthe primary system clock is derived from the internal\noscillator or when the oscillator is in the LP mode. Theuser must provide a software time delay to ensure\nproper oscillator start-up.TRISA5 and TRISA4 bits are set when the Timer1\noscillator is enabled. RA5 and RA4 bits read as ‘ 0’ and\nTRISA5 and TRISA4 bits read as ‘ 1’.\n6.5 Timer1 Operation in \nAsynchronous Counter Mode\nIf control bit T1SYNC  of the T1CON register is set, the\nexternal clock input is not synchronized. The timer\nincrements asynchronously to the internal phaseclocks. If external clock source is selected then the\ntimer will continue to run during Sleep and can\ngenerate an interrupt on overflow, which will wake-upthe processor. However, special precautions in\nsoftware are needed to read/write the timer (see\nSection 6.5.1 “Reading and Writing Timer1 inAsynchronous Counter Mode” ).\n6.5.1 READING AND WRITING TIMER1 IN \nASYNCHRONOUS COUNTER MODE\nReading TMR1H or TMR1L while the timer is running\nfrom an external asynchronous clock will ensure a valid\nread (taken care of in hardware). However, the user\nshould keep in mind that reading the 16-bit timer in two8-bit values itself, poses certain problems, since the\ntimer may overflow or carry out of TMR1L to TMR1H\nbetween the reads.\nFor writes, it is recommended that the user simply stop\nthe timer and write the desired values. A write\ncontention may occur by writing to the timer registers,\nwhile the register is incrementing. This may produce anunpredictable value in the TMR1H:TMR1L register pair.Note: In Counter mode, a falling edge must be\nregistered by the counter prior to the firstincrementing rising edge after any one or\nmore of the following conditions:\n\x81 Timer1 enabled after POR reset\n\x81 Write to TMR1H or TMR1L\n\x81 Timer1 is disabled\x81 Timer1 is disabled (TMR1ON 0) when \nT1CKI is high then Timer1 is enabled (TMR1ON= 1) when T1CKI is low.\nSee Figure 6-2Note: The oscillator requires a start-up and\nstabilization time before use. Thus,\nT1OSCEN should be set and a suitable\ndelay observed prior to enabling Timer1.\nNote: When switching from synchronous to\nasynchronous operation, it is possible toskip an increment. When switching from\nasynchronous to synchronous operation,\nit is possible to produce an additionalincrement.\n© 2007 Microchip Technology Inc. DS41202F-page 49PIC16F684\n6.6 Timer1 Gate\nTimer1 gate source is software configurable to be the\nT1G pin or the output of Comparator 2. This allows the\ndevice to directly time external events using T1G  or\nanalog events using Comparator 2. See the CMCON1\nregister (Register 8-2) for selecting the Timer1 gatesource. This feature can simplify the software for a\nDelta-Sigma A/D converter  and many other applications.\nFor more information on Delta-Sigma A/D converters,see the Microchip web site (www.microchip.com). \nTimer1 gate can be inverted using the T1GINV bit of\nthe T1CON register, whether it originates from the T1G\npin or Comparator 2 output. This configures Timer1 to\nmeasure either the active-high or active-low time\nbetween events.\n6.7 Timer1 Interrupt\nThe Timer1 register pair (TMR1H:TMR1L) incrementsto FFFFh and rolls over to 0000h. When Timer1 rolls\nover, the Timer1 interrupt flag bit of the PIR1 register is\nset. To enable the interrupt on rollover, you must setthese bits:\n\x81 TMR1ON bit or the T1CON register\n\x81 TMR1IE bit of the PIE1 register\x81 PEIE bit of the INTCON register\n\x81 GIE bit of the INTCON register\nThe interrupt is cleared by clearing the TMR1IF bit in\nthe Interrupt Service Routine.\n6.8 Timer1 Operation During Sleep\nTimer1 can only operate during Sleep when setup inAsynchronous Counter mode. In this mode, an external\ncrystal or clock source can be used to increment thecounter. To set up the timer to wake the device:\n\x81 TMR1ON bit of the T1CON register must be set\n\x81 TMR1IE bit of the PIE1 register must be set\x81 PEIE bit of the INTCON register must be set\n\x81 T1SYNC\n bit of the T1CON register\n\x81 TMR1CS bit of the T1CON register\x81 T1OSCEN bit of the T1CON register (can be set)\nThe device will wake-up on an overflow and execute\nthe next instruction. If the GIE bit of the INTCONregister is set, the device will call the Interrupt Service\nRoutine (0004h).6.9 ECCP Capture/Compare Time Base\nThe ECCP module uses the TMR1H:TMR1L register\npair as the time base when operating in Capture orCompare mode.\nIn Capture mode, the value in the TMR1H:TMR1L\nregister pair is copied into the CCPR1H:CCPR1L\nregister pair on a configured event. \nIn Compare mode, an event is triggered when the value\nCCPR1H:CCPR1L register pair matches the value in\nthe TMR1H:TMR1L register pair. This event can be a\nSpecial Event Trigger.\nFor more information, see Section 11.0 “Enhanced\nCapture/Compare/PWM (With Auto-Shutdown and\nDead Band) Module” .\n6.10 ECCP Special Event Trigger\nWhen the ECCP is configured to trigger a special\nevent, the trigger will clear the TMR1H:TMR1L registerpair. This special event does not cause a Timer1\ninterrupt. The ECCP module may still be configured to\ngenerate a ECCP interrupt.\nIn this mode of operation, the CCPR1H:CCPR1L\nregister pair effectively becomes the period register for\nTimer1.\nTimer1 should be synchronized to the F\nOSC to utilize\nthe Special Event Trigger. Asynchronous operation ofTimer1 can cause a Special Event Trigger to be\nmissed.\nIn the event that a write to TMR1H or TMR1L coincides\nwith a Special Event Trigger from the ECCP, the writewill take precedence.\nFor more information, see Section 11.2.4 “Special\nEvent Trigger” .\n6.11 Comparator Synchronization\nThe same clock used to increment Timer1 can also be\nused to synchronize the comparator output. Thisfeature is enabled in the Comparator module.\nWhen using the comparator for Timer1 gate, the\ncomparator output should be synchronized to Timer1.\nThis ensures Timer1 does not miss an increment if thecomparator changes.\nFor more information, see Section 8.9 “Synchronizing\nComparator C2 Output to Timer1” .Note: TMR1GE bit of the T1CON register must\nbe set to use either T1G  or C2OUT as the\nTimer1 gate source. See the CMCON1\nregister (Register 8-2) for more informa-\ntion on selecting the Timer1 gate source.\nNote: The TMR1H:TTMR1L register pair and the\nTMR1IF bit should be cleared before\nenabling interrupts.\nPIC16F684\nDS41202F-page 50 © 2007 Microchip Technology Inc.FIGURE 6-2: TIMER1 INCREMENTING EDGE    \n6.12 Timer1 Control Register\nThe Timer1 Control register (T1CON), shown in\nRegister 6-1, is used to control Timer1 and select the\nvarious features of the Timer1 module.\n T1CKI = 1\nwhen TMR1\nEnabled\nT1CKI = 0\nwhen TMR1\nEnabled\nNote 1: Arrows indicate counter increments.\n2:In Counter mode, a falling edge must be registered by the count er prior to the first incrementing rising edge of the clock .\nREGISTER 6-1: T1CON: TI MER 1 CONTROL REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nT1GINV(1)TMR1GE(2)T1CKPS1 T1CKPS0 T1OSCEN T1SYNC TMR1CS TMR1ON\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 T1GINV: Timer1 Gate Invert bit(1)\n1 = Timer1 gate is active high (Timer1 counts when gate is high)\n0 = Timer1 gate is active low (Timer1 counts when gate is low)\nbit 6 TMR1GE: Timer1 Gate Enable bit(2)\nIf TMR1ON = 0:\nThis bit is ignored\nIf TMR1ON = 1:\n1 = Timer1 is on if Timer1 gate is not active\n0 = Timer1 is on\nbit 5-4 T1CKPS<1:0>:  Timer1 Input Clock Prescale Select bits\n11 = 1:8 Prescale Value\n10 = 1:4 Prescale Value\n01 = 1:2 Prescale Value\n00 = 1:1 Prescale Value\nbit 3 T1OSCEN: LP Oscillator Enable Control bit\nIf INTOSC without CLKOUT oscillator is active:\n1 = LP oscillator is enabled for Timer1 clock\n0 = LP oscillator is off\nElse:\nThis bit is ignored\n© 2007 Microchip Technology Inc. DS41202F-page 51PIC16F684\nTABLE 6-1: SUMMARY OF REGISTERS ASSOCIATED WITH TIMER1     bit 2 T1SYNC : Timer1 External Clock Input Synchronization Control bit\nTMR1CS = 1:\n1 = Do not synchronize external clock input\n0 = Synchronize external clock input\nTMR1CS = 0:\nThis bit is ignored. Timer1 uses the internal clock\nbit 1 TMR1CS: Timer1 Clock Source Select bit\n1 = External clock from T1CKI pin (on the rising edge)\n0 = Internal clock (F OSC/4)\nbit 0 TMR1ON: Timer1 On bit\n1 = Enables Timer1\n0 = Stops Timer1\nNote 1: T1GINV bit inverts the Timer1 gate logic, regardless of source.\n2:TMR1GE bit must be set to use either T1G  pin or C2OUT, as selected by the T1GSS bit of the CMCON1 \nregister, as a Timer1 gate source.\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nCMCON1 — — — — — — T1GSS C2SYNC ---- --10 ---- --10\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nTMR1H Holding Register for the Most Significant Byte of the 16-bit TMR1 Register xxxx xxxx uuuu uuuu\nTMR1L Holding Register for the Least Significant Byte of the 16-bit TMR1 Register xxxx xxxx uuuu uuuu\nT1CON T1GINV TMR1GE T1CKPS1 T1CKPS0 T1OSCEN T1SYNC TMR1CS TMR1ON 0000 0000 uuuu uuuu\nLegend: x = unknown, u = unchanged, — = unimplemented, read as ‘ 0’. Shaded cells are not used by the Timer1 module.REGISTER 6-1: T1CON: TIMER 1 CONTROL REGISTER (CONTINUED)\nPIC16F684\nDS41202F-page 52 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 53PIC16F684\n7.0 TIMER2 MODULE\nThe Timer2 module is an eight-bit timer with the\nfollowing features: \n\x81 8-bit timer register (TMR2)\n\x81 8-bit period register (PR2)\n\x81 Interrupt on TMR2 match with PR2\x81 Software programmable prescaler (1:1, 1:4, 1:16)\n\x81 Software programmable postscaler (1:1 to 1:16)\nSee Figure 7-1 for a block diagram of Timer2.\n7.1 Timer2 Operation\nThe clock input to the Timer2 module is the system\ninstruction clock (F OSC/4). The clock is fed into the\nTimer2 prescaler, which has prescale options of 1:1,1:4 or 1:16. The output of the prescaler is then used to\nincrement the TMR2 register.\nThe values of TMR2 and PR2 are constantly compared\nto determine when they match. TMR2 will incrementfrom 00h until it matches the value in PR2. When a\nmatch occurs, two things happen:\n\x81 TMR2 is reset to 00h on the next increment cycle.\n\x81 The Timer2 postscaler is incremented\nThe match output of the Timer2/PR2 comparator is fed\ninto the Timer2 postscaler. The postscaler has\npostscale options of 1:1 to 1:16 inclusive. The output ofthe Timer2 postscaler is used to set the TMR2IF\ninterrupt flag bit in the PIR1 register.The TMR2 and PR2 registers are both fully readable\nand writable. On any Reset, the TMR2 register is set to\n00h and the PR2 register is set to FFh.\nTimer2 is turned on by setting the TMR2ON bit in the\nT2CON register to a ‘ 1’. Timer2 is turned off by clearing\nthe TMR2ON bit to a ‘ 0’.\nThe Timer2 prescaler is controlled by the T2CKPS bits\nin the T2CON register. The Timer2 postscaler is\ncontrolled by the TOUTPS bits in the T2CON register.The prescaler and postscaler counters are cleared\nwhen:\n\x81 A write to TMR2 occurs.\n\x81 A write to T2CON occurs.\n\x81 Any device Reset occurs (Power-on Reset, MCLR\n \nReset, Watchdog Timer Reset, or Brown-out \nReset).\nFIGURE 7-1: TIMER2 BLOCK DIAGRAM       Note: TMR2 is not cleared when T2CON is\nwritten.\nComparatorTMR2Sets Flag\nTMR2Output\nReset\nPostscalerPrescaler\nPR22FOSC/4\n1:1 to 1:161:1, 1:4, 1:16\nEQ\n4bit TMR2IF\nTOUTPS<3:0>T2CKPS<1:0>\nPIC16F684\nDS41202F-page 54 © 2007 Microchip Technology Inc.  \nTABLE 7-1: SUMMARY OF ASSOCIATED TIMER2 REGISTERS     REGISTER 7-1: T2CON: TI MER 2 CONTROL REGISTER\nU-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\n— TOUTPS3 TOUTPS2 TOUTPS1 TOUTPS0 TMR2ON T2CKPS1 T2CKPS0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 Unimplemented:  Read as ‘ 0’\nbit 6-3 TOUTPS<3:0>:  Timer2 Output Postscaler Select bits\n0000  = 1:1 Postscaler\n0001  = 1:2 Postscaler\n0010  = 1:3 Postscaler\n0011  = 1:4 Postscaler\n0100  = 1:5 Postscaler\n0101  = 1:6 Postscaler\n0110  = 1:7 Postscaler\n0111  = 1:8 Postscaler\n1000  = 1:9 Postscaler\n1001  = 1:10 Postscaler\n1010  = 1:11 Postscaler\n1011  = 1:12 Postscaler\n1100  = 1:13 Postscaler\n1101  = 1:14 Postscaler\n1110  = 1:15 Postscaler\n1111  = 1:16 Postscaler\nbit 2 TMR2ON:  Timer2 On bit\n1 = Timer2 is on\n0 = Timer2 is off\nbit 1-0 T2CKPS<1:0>:  Timer2 Clock Prescale Select bits\n00 =P r e s c a l e r  i s  1\n01 =P r e s c a l e r  i s  4\n1x = Prescaler is 16\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPR2 Timer2 Module Period Register 1111 1111 1111 1111\nTMR2 Holding Register for the 8-bit TMR2 Register 0000 0000 0000 0000\nT2CON — TOUTPS3 TOUTPS2 TOUTPS1 TOUTPS0 TMR2ON T2CKPS1 T2CKPS0 -000 0000 -000 0000\nLegend: x = unknown, u = unchanged, — = unimplemented read as ‘ 0’. Shaded cells are not used for Timer2 module.\n© 2007 Microchip Technology Inc. DS41202F-page 55PIC16F684\n8.0 COMPARATOR MODULE\nComparators are used to interface analog circuits to a\ndigital circuit by comparing two analog voltages and\nproviding a digital indication of their relative magnitudes.The comparators are very useful mixed signal building\nblocks because they provide analog functionality\nindependent of the device program execution. Theanalog Comparator module includes the following\nfeatures:\n\x81 Dual comparators\n\x81 Multiple comparator configurations\n\x81 Comparator outputs are available internally/\nexternally\n\x81 Programmable output polarity\x81 Interrupt-on-change\n\x81 Wake-up from Sleep\n\x81 Timer1 gate (count enable)\x81 Output synchronization to Timer1 clock input\n\x81 Programmable voltage reference8.1  Comparator Overview\nA comparator is shown in Figure 8-1 along with the\nrelationship between the analog input levels and thedigital output. When the analog voltage at V\nIN+ is less\nthan the analog voltage at V IN-, the output of the\ncomparator is a digital low level. When the analogvoltage at V\nIN+ is greater than the analog voltage at\nVIN-, the output of the comparator is a digital high level.\nFIGURE 8-1: SINGLE COMPARATOR      \nThis device contains two comparators as shown in\nFigure 8-2 and Figure 8-3. The comparators are notindependently configurable.Note: Only Comparator C2 can be linked to\nTimer1.–+ VIN+\nVIN-Output\nOutputVIN+VIN-\nNote: The black areas of the output of the\ncomparator represents the uncertainty\ndue to input offsets and response time.\nPIC16F684\nDS41202F-page 56 © 2007 Microchip Technology Inc.FIGURE 8-2: COMPARATOR C1 OUTPUT BLOCK DIAGRAM    \nFIGURE 8-3: COMPARATOR C2 OUTPUT BLOCK DIAGRAM   DQ\nENTo C1OUT pin\nRD CMCON0\nSet C1IF bit\nMULTIPLEX\nPort Pins\nQ3*RD CMCON0\nResetTo Data BusC1INV\nDQ\nEN\nCLQ1\nNote 1: Q1 and Q3 are phases of the four-phase system clock (F OSC).\n2:Q1 is held high during Sleep mode.C1\nC2SYNC\nDQ\nENTo C2OUT pin\nRD CMCON0\nSet C2IF bit\nMULTIPLEX\nPort Pins\nQ3*RD CMCON0\nResetTo Data BusC2INV\nTimer1\nclock source(1)0\n1To Timer1 Gate\nDQ\nDQ\nEN\nCLQ1\nNote 1: Comparator output is latched on fa lling edge of Timer1 clock source.\n2:Q1 and Q3 are phases of the four-phase system clock (F OSC).\n3:Q1 is held high during Sleep mode.C2\n© 2007 Microchip Technology Inc. DS41202F-page 57PIC16F684\n8.1.1 ANALOG INPUT CONNECTION \nCONSIDERATIONS\nA simplified circuit for an analog input is shown in\nFigure 8-4. Since the analog input pins share their con-nection with a digital input, they have reverse biased\nESD protection diodes to V\nDD and V SS. The analog\ninput, therefore, must be between V SS and V DD. If the\ninput voltage deviates from this range by more than\n0.6V in either direction, one of the diodes is forward\nbiased and a latch-up may occur.\nA maximum source impedance of 10 k Ω is recommended\nfor the analog sources. Also, any external component\nconnected to an analog input pin, such as a capacitor or\na Zener diode, should have very little leakage current tominimize inaccuracies introduced.\nFIGURE 8-4: ANALOG INPUT MODEL Note 1: When reading a PORT register, all pins\nconfigured as analog inputs will read as a‘0’. Pins configured as digital inputs will\nconvert as an analog input, according to\nthe input specification.\n2:Analog levels on any pin defined as a\ndigital input, may cause the input buffer to\nconsume more current than is specified.\nVARs < 10K\nCPIN\n5 pFVDD\nVT ≈ 0.6V\nVT ≈ 0.6VRIC\nILEAKAGE\n±500 nA\nVssAIN\nLegend: CPIN = Input Capacitance\nILEAKAGE = Leakage Current at the pin due to various junctions\nRIC = Interconnect Resistance\nRS = Source Impedance\nVA = Analog Voltage\nVT = Threshold VoltageTo ADC Input\nPIC16F684\nDS41202F-page 58 © 2007 Microchip Technology Inc.8.2 Comparator Configuration\nThere are eight modes of operation for the comparator.\nThe CM<2:0> bits of the CMCON0 register are used toselect these modes as shown in Figure 8-5. I/O lines\nchange as a function of the mode and are designated\nas follows:\n\x81 Analog function (A): digital input buffer is disabled\n\x81 Digital function (D): comparator digital output, \noverrides port function\n\x81 Normal port function (I/O): independent of \ncomparatorThe port pins denoted as “A” will read as a ‘ 0’\nregardless of the state of the I/O pin or the I/O control\nTRIS bit. Pins used as analog inputs should also have\nthe corresponding TRIS bit set to ‘ 1’ to disable the\ndigital output driver. Pins denoted as “D” should have\nthe corresponding TRIS bit set to ‘ 0’ to enable the\ndigital output driver.\nFIGURE 8-5: COMPARATOR I/O OPERATING MODESNote: Comparator interrupts should be disabled\nduring a Comparator mode change toprevent unintended interrupts.\nC1C1IN-VIN-\nVIN+C1IN+Off(1)Comparators Reset   (POR Default Value)\nA\nACM<2:0> = 000\nC2C2IN-VIN-\nVIN+C2IN+Off(1)A\nAC1C1IN-VIN-\nVIN+C1IN+C1OUTTwo Independent Comparators\nA\nACM<2:0> = 100\nC2C2IN-VIN-\nVIN+C2IN+C2OUTA\nA\nC1C1IN-VIN-\nVIN+C1IN+C1OUTTwo Common Reference Comparators\nA\nI/OCM<2:0> = 011\nC2C2IN-VIN-\nVIN+C2IN+C2OUTA\nAC1C1IN-VIN-\nVIN+C1IN+Off(1)One Independent Comparator\nI/O\nI/OCM<2:0> = 101\nC2C2IN-VIN-\nVIN+C2IN+C2OUTA\nA\nC1C1IN-VIN-\nVIN+C1IN+Off(1)Comparators Off   (Lowest Power)\nI/O\nI/OCM<2:0> = 111\nC2C2IN-VIN-\nVIN+C2IN+Off(1)I/O\nI/OC1C1IN-VIN-\nVIN+C1IN+ C1OUTFour Inputs Multiplexed to Two Comparators\nA\nACM<2:0> = 010\nC2C2IN-VIN-\nVIN+C2IN+ C2OUTA\nA\nFrom CVREF ModuleCIS = 0\nCIS = 1\nCIS = 0\nCIS = 1C1C1IN-VIN-\nVIN+\nC1OUT(pin)C1OUTTwo Common Reference Comparators with Outputs\nA\nDCM<2:0> = 110\nC2C2IN-VIN-\nVIN+C2IN+C2OUTA\nA\nC2OUT(pin)C1C1IN-VIN-\nVIN+C1IN+ C1OUTThree Inputs Multiplexed to Two Comparators\nA\nACM<2:0> = 001\nC2C2IN-VIN-\nVIN+C2IN+C2OUTA\nACIS = 0\nCIS = 1\nD\nLegend: A = Analog Input, ports always reads ‘ 0’ CIS = Comparator Input Switch (CMCON0<3>)\nI/O = Normal port I/O D = Comparator Digital Output\nNote 1: Reads as ‘ 0’, unless CxINV = 1.\n© 2007 Microchip Technology Inc. DS41202F-page 59PIC16F684\n8.3  Comparator Control\nThe CMCON0 register (Register 8-1) provides access\nto the following comparator features:\n\x81 Mode selection\n\x81 Output state\n\x81 Output polarity\n\x81 Input switch\n8.3.1 COMPARATOR OUTPUT STATE\nEach comparator state can always be read internally\nvia the associated CxOUT bit of the CMCON0 register.\nThe comparator outputs are directed to the CxOUT\npins when CM<2:0> = 110. When this mode is\nselected, the TRIS bits for the associated CxOUT pins\nmust be cleared to enable the output drivers.\n8.3.2 COMPARATOR OUTPUT POLARITY\nInverting the output of a comparator is functionally\nequivalent to swapping the comparator inputs. Thepolarity of a comparator output can be inverted by set-\nting the CxINV bits of the CMCON0 register. Clearing\nCxINV results in a non-inverted output. A completetable showing the output state versus input conditions\nand the polarity bit is shown in Table 8-1.\nTABLE 8-1: OUTPUT STATE VS. INPUT \nCONDITIONS\n8.3.3 COMPARATOR INPUT SWITCH\nThe inverting input of the comparators may be switched\nbetween two analog pins in the following modes:\n\x81 CM<2:0> = 001 (Comparator C1 only)\n\x81 CM<2:0> = 010 (Comparators C1 and C2)\nIn the above modes, both pins remain in Analog mode\nregardless of which pin is selected as the input. The CIS\nbit of the CMCON0 register controls the comparatorinput switch.8.4 Comparator Response Time\nThe comparator output is indeterminate for a period oftime after the change of an input source or the selectionof a new reference voltage. This period is referred to as\nthe response time. The response time of the\ncomparator differs from the settling time of the voltagereference. Therefore, both of these times must be\nconsidered when determining the total response time\nto a comparator input change. See Comparator andVoltage Reference specifications of Section 15.0\n“Electrical Specifications”  for more details.\n8.5  Comparator Interrupt Operation\nThe comparator interrupt flag is set whenever there is\na change in the output value of the comparator.Changes are recognized by means of a mismatch\ncircuit which consists of two latches and an exclusive-\nor gate (see Figure 8-2 and Figure 8-3). One latch isupdated with the comparator output level when the\nCMCON0 register is read. This latch retains the value\nuntil the next read of the CMCON0 register or theoccurrence of a reset. The other latch of the mismatch\ncircuit is updated on every Q1 system clock. A\nmismatch condition will occur when a comparatoroutput change is clocked through the second latch on\nthe Q1 clock cycle. The mismatch condition will persist,\nholding the CxIF bit of the PIR1 register true, until eitherthe CMCON0 register is read or the comparator output\nreturns to the previous state.\nSoftware will need to maintain information about the\nstatus of the comparator output to determine the actual\nchange that has occurred.\nThe CxIF bit of the PIR1 register is the comparator\ninterrupt flag. This bit must be reset in software by\nclearing it to ‘ 0’. Since it is also possible to write a ‘ 1’ to\nthis register, a simulated interrupt may be initiated.\nThe CxIE bit of the PIE1 register and the PEIE and GIE\nbits of the INTCON register must all be set to enable\ncomparator interrupts. If any of these bits are cleared,\nthe interrupt is not enabled, although the CxIF bit of thePIR1 register will still be set if an interrupt condition\noccurs.\nThe user, in the Interrupt Service Routine, can clear the\ninterrupt in the following manner:\na) Any read or write of CMCON0. This will end the\nmismatch condition.\nb) Clear the CxIF interrupt flag.Input Conditions CxINV CxOUT\nV\nIN- > V IN+ 00\nVIN- < V IN+ 01\nVIN- > V IN+ 11\nVIN- < V IN+ 10\nNote: CxOUT refers to both the register bit and\noutput pin.Note: A write operation to the CMCON0 register\nwill also clear the mismatch condition\nbecause all writes include a readoperation at the beginning of the write\ncycle.\nPIC16F684\nDS41202F-page 60 © 2007 Microchip Technology Inc.A persistent mismatch condition will preclude clearing\nthe CxIF interrupt flag. Reading CMCON0 will end the\nmismatch condition and allow the CxIF bit to be\ncleared.\nFIGURE 8-6: COMPARATOR \nINTERRUPT TIMING W/O CMCON0 READ \nFIGURE 8-7: COMPARATOR \nINTERRUPT TIMING WITH CMCON0 READ 8.6 Operation During Sleep\nThe comparator, if enabled before entering Sleep mode,\nremains active during Sleep. The additional currentconsumed by the comparator is shown separately in\nSection 15.0 “Electrical Specifications” . If the\ncomparator is not used to wake the device, powerconsumption can be minimized while in Sleep mode by\nturning off the comparator. The comparator is turned off\nby selecting mode CM<2:0> = 000 or CM<2:0> = 111\nof the CMCON0 register.\nA change to the comparator output can wake-up the\ndevice from Sleep. To enable the comparator to wake\nthe device from Sleep, the CxIE bit of the PIE1 registerand the PEIE bit of the INTCON register must be set.\nThe instruction following the Sleep instruction always\nexecutes following a wake from Sleep. If the GIE bit ofthe INTCON register is also set, the device will then\nexecute the interrupt service routine.\n8.7  Effects of a Reset\nA device Reset forces the CMCON0 and CMCON1\nregisters to their Reset states. This forces the Compar-ator module to be in the Comparator Reset mode\n(CM<2:0> = 000) . Thus, all comparator inputs are\nanalog inputs with the comparator disabled to consumethe smallest current possible.\nNote 1: If a change in the CM1CON0 register\n(CxOUT) should occur when a read oper-\nation is being executed (start of the Q2\ncycle), then the CxIF Interrupt Flag bit ofthe PIR1 register may not get set.\n2:When either comparator is first enabled,\nbias circuitry in the Comparator module\nmay cause an invalid output from thecomparator until the bias circuitry is stable.\nAllow about 1 μs for bias settling then clear\nthe mismatch condition and interrupt flagsbefore enabling comparator interrupts.Q1\nQ3\nCxIN+CxOUTSet CMIF (level)\nCMIFTRT\nreset by software\nQ1\nQ3\nCxIN+\nCxOUTSet CMIF (level)\nCMIFTRT\nreset by software cleared by CMCON0 read\n© 2007 Microchip Technology Inc. DS41202F-page 61PIC16F684\n  \nREGISTER 8-1: CMCON0: COMPARATOR CONFIGURATION REGISTER\nR-0 R-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nC2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 C2OUT:  Comparator 2 Output bit\nWhen C2INV = 0:\n1 = C2 V IN+ > C2 V IN-\n0 = C2 V IN+ < C2 V IN-\nWhen C2INV = 1:\n1 = C2 V IN+ < C2 V IN-\n0 = C2 V IN+ > C2 V IN-\nbit 6 C1OUT:  Comparator 1 Output bit\nWhen C1INV = 0:\n1 = C1 V IN+ > C1 V IN-\n0 = C1 V IN+ < C1 V IN-\nWhen C1INV = 1:\n1 = C1 V IN+ < C1 V IN-\n0 = C1 V IN+ > C1 V IN-\nbit 5 C2INV:  Comparator 2 Output Inversion bit\n1 = C2 output inverted\n0 = C2 output not inverted\nbit 4 C1INV:  Comparator 1 Output Inversion bit\n1 = C1 Output inverted\n0 = C1 Output not inverted\nbit 3 CIS: Comparator Input Switch bit\nWhen CM<2:0> = 010:\n1 = C1IN+ connects to C1 V IN-\n       C2IN+ connects to C2 V IN-\n0 = C1IN- connects to C1 V IN-\n       C2IN- connects to C2 V IN-\nWhen CM<2:0> = 001:\n1 = C1IN+ connects to C1 V IN-\n0 = C1IN- connects to C1 V IN-\nbit 2-0 CM<2:0>:  Comparator Mode bits (See Figure 8-5)\n000 = Comparators off. CxIN pins are configured as analog\n001 = Three inputs multiplexed to two comparators\n010 = Four inputs multiplexed to two comparators\n011 = Two common reference comparators\n100 = Two independent comparators\n101 = One independent comparator\n110 = Two common reference comparators with outputs\n111 = Comparators off. CxIN pins are configured as digital I/O\nPIC16F684\nDS41202F-page 62 © 2007 Microchip Technology Inc.8.8 Comparator C2 Gating Timer1\nThis feature can be used to time the duration or interval\nof analog events. Clearing the T1GSS bit of theCMCON1 register will enable Timer1 to increment\nbased on the output of Comparator C2. This requires\nthat Timer1 is on and gating is enabled. SeeSection 6.0 “Timer1 Module with Gate Control”  for\ndetails.\nIt is recommended to synchronize Comparator C2 with\nTimer1 by setting the C2SYNC bit when the comparatoris used as the Timer1 gate source. This ensures Timer1\ndoes not miss an increment if the comparator changes\nduring an increment.8.9 Synchronizing Comparator C2 \nOutput to Timer1\nThe output of Comparator C2 can be synchronized with\nTimer1 by setting the C2SYNC bit of the CMCON1\nregister. When enabled, the comparator output islatched on the falling edge of the Timer1 clock source.\nIf a prescaler is used with Timer1, the comparator\noutput is latched after the prescaling function. Toprevent a race condition, the comparator output is\nlatched on the falling edge of the Timer1 clock source\nand Timer1 increments on the rising edge of its clocksource. Reference the comparator block diagrams\n(Figure 8-2 and Figure 8-3) and the Timer1 Block\nDiagram (Figure 6-1) for more information.\n  \nREGISTER 8-2: CMCON1: COMPARATOR CONFIGURATION REGISTER\nU-0 U-0 U-0 U-0 U-0 U-0 R/W-1 R/W-0\n— — — — — — T1GSS C2SYNC\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-2 Unimplemented:  Read as ‘ 0’\nbit 1 T1GSS:  Timer1 Gate Source Select bit(1)\n1 = Timer1 gate source is T1G  pin (pin should be configured as digital input)\n0 = Timer1 gate source is Comparator C2 output\nbit 0 C2SYNC:  Comparator C2 Output Synchronization bit(2)\n1 = Output is synchronized with falling edge of Timer1 clock\n0 = Output is asynchronous\nNote 1: Refer to Section 6.6 “Timer1 Gate” .\n2:Refer to Figure 8-3.\n© 2007 Microchip Technology Inc. DS41202F-page 63PIC16F684\n8.10 Comparator Voltage Reference\nThe comparator voltage reference module provides an\ninternally generated voltage reference for the compara-tors. The following features are available:\n\x81 Independent from Comparator operation\n\x81 Two 16-level voltage ranges\x81 Output clamped to V\nSS\n\x81 Ratiometric with V DD\nThe VRCON register (Register ) controls the voltage\nreference module shown in Figure 8-8.\n8.10.1 INDEPENDENT OPERATION\nThe comparator voltage reference is independent of\nthe comparator configuration. Setting the VREN bit ofthe VRCON register will enable the voltage reference.\n8.10.2 OUTPUT VOLTAGE SELECTION\nThe CVREF voltage reference has 2 ranges with 16\nvoltage levels in each range. Range selection is\ncontrolled by the VRR bit of the VRCON register. The16 levels are set with the VR<3:0> bits of the VRCON\nregister.\nThe CV REF output voltage is determined by the following\nequations:EQUATION 8-1: CV REF OUTPUT VOLTAGE\nThe full range of V SS to V DD cannot be realized due to\nthe construction of the module. See Figure 8-8.\n8.10.3 OUTPUT CLAMPED TO V SS\nThe CV REF output voltage can be set to Vss with no\npower consumption by configuring VRCON as follows:\n\x81V R E N = 0\n\x81V R R =1\n\x81V R < 3 : 0 > = 0000\nThis allows the comparator to detect a zero-crossing\nwhile not consuming additional CV REF module current.\n8.10.4 OUTPUT RATIOMETRIC TO VDD\nThe comparator voltage reference is V DD derived and\ntherefore, the CV REF output changes with fluctuations in\nVDD. The tested absolute accuracy of the Comparator\nVoltage Reference can be found in Section 15.0\n“Electrical Specifications” .\n  VRR 1 (low range):=\nVRR 0 (high range):=\nCVREF (VDD/4) +  =CVREF (VR<3:0>/24) V DD× =\n(VR<3:0> V DD/32) ×\nVRCON: VOLTAGE REFERENCE CONTROL REGISTER\nR/W-0 U-0 R/W-0 U-0 R/W-0 R/W-0 R/W-0 R/W-0\nVREN —V R R — VR3 VR2 VR1 VR0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 VREN:  CV\nREF Enable bit\n1 = CV REF circuit powered on\n0 = CV REF circuit powered down, no I DD drain and CV REF = V SS.\nbit 6 Unimplemented: Read as ‘0’\nbit 5 VRR:  CVREF Range Selection bit\n1 = Low range\n0 = High range\nbit 4 Unimplemented: Read as ‘0’\nbit 3-0 VR<3:0>:  CVREF Value Selection bits (0 ≤ VR<3:0> ≤ 15)\nWhen V RR = 1: CV REF = (VR<3:0>/24) * V DD\nWhen V RR = 0: CV REF = V DD/4 + (VR<3:0>/32) * V DD\nPIC16F684\nDS41202F-page 64 © 2007 Microchip Technology Inc.FIGURE 8-8: COMPARATOR VOLTAGE REFERENCE BLOCK DIAGRAM\nTABLE 8-2: SUMMARY OF REGISTERS ASSOCIATED WITH THE COMPARATOR AND VOLTAGE \nREFERENCE MODULES\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on\nall other\nResets\nANSEL ANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS0 1111 1111 1111 1111\nCMCON0 C2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0 0000 0000 0000 0000\nCMCON1 — — — — — — T1GSS C2SYNC ---- --10 ---- --10\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPORTA — — RA5 RA4 RA3 RA2 RA1 RA0 --x0 x000 --uu uu00\nPORTC — — RC5 RC4 RC3 RC2 RC1 RC0 --xx 0000 --uu uu00\nTRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0 --11 1111 --11 1111\nTRISC — — TRISC5 TRISC4 TRISC3 TRISC2 TRISC1 TRISC0 --11 1111 --11 1111\nVRCON VREN —V R R — VR3 VR2 VR1 VR0 0-0- 0000 0-0- 0000\nLegend: x = unknown, u = unchanged, - = unimplemented, read as ‘ 0’. Shaded cells are not used for comparator.VRR 8R\nVR<3:0>(1)16-1 Analog8R R R R R\nCVREF to16 Stages\nComparator\nInputVRENVDD\nMUX\nVR<3:0> = 0000VREN\nVRR0121415\nNote 1: Care should be taken to ensure V REF remains\nwithin the comparator common mode input range.\nSee Section 15.0 “Electrical Specifications”  for\nmore detail. \n© 2007 Microchip Technology Inc. DS41202F-page 65PIC16F684\n9.0 ANALOG-TO-DIGITAL \nCONVERTER (ADC) MODULE\nThe Analog-to-Digital Converter (ADC) allows\nconversion of an analog input signal to a 10-bit binaryrepresentation of that signal. This device uses analog\ninputs, which are multiplexed into a single sample and\nhold circuit. The output of the sample and hold isconnected to the input of the converter. The converter\ngenerates a 10-bit binary result via successive\napproximation and stores the conversion result into theADC result registers (ADRESL and ADRESH).\nThe ADC voltage reference is software selectable to\neither V\nDD or a voltage applied to the external reference\npins.\nThe ADC can generate an interrupt upon completion of\na conversion. This interrupt can be used to wake-up the\ndevice from Sleep.\nFigure 9-1 shows the block diagram of the ADC.\nFIGURE 9-1: ADC BLOCK DIAGRAM   \nRA0/AN0\nA/DRA1/AN1/V REF\nRA2/AN2\nRC0/AN4VDD\nVREF\nADONGO/DONEVCFG = 1VCFG = 0\nCHS <3:0>VSSRC1/AN5\nRC2/AN6\nRC3/AN7RA4/AN3\nADRESH ADRESL10\n10ADFM0 = Left Justify\n1 = Right Justify\n4\nPIC16F684\nDS41202F-page 66 © 2007 Microchip Technology Inc.9.1 ADC Configuration \nWhen configuring and using the ADC the following\nfunctions must be considered:\n\x81 Port configuration\n\x81 Channel selection\n\x81 ADC voltage reference selection\n\x81 ADC conversion clock source\x81 Interrupt control\n\x81 Results formatting\n9.1.1 PORT CONFIGURATION\nThe ADC can be used to convert both analog and digital\nsignals. When converting analog signals, the I/O pin\nshould be configured for analog by setting the associatedTRIS and ANSEL bits. See the corresponding port\nsection for more information.\n9.1.2 CHANNEL SELECTION\nThe CHS bits of the ADCON0 register determine whichchannel is connected to the sample and hold circuit.\nWhen changing channels, a delay is required before\nstarting the next conversion. Refer to Section 9.2\n“ADC Operation”  for more information.\n9.1.3 ADC V OLTAGE REFERENCE\nThe VCFG bit of the ADCON0 register provides control\nof the positive voltage reference. The positive voltage\nreference can be either V DD or an external voltage\nsource. The negative voltage reference is always\nconnected to the ground reference.9.1.4  CONVERSION CLOCK\nThe source of the conversion clock is software select-\nable via the ADCS bits of the ADCON1 register. Thereare seven possible clock options:\n\x81F\nOSC/2\n\x81FOSC/4\n\x81FOSC/8\n\x81FOSC/16\n\x81FOSC/32\n\x81FOSC/64\n\x81FRC (dedicated internal oscillator)\nThe time to complete one bit conversion is defined as\nTAD. One full 10-bit conversion requires 11 T AD periods\nas shown in Figure 9-3.\nFor correct conversion, the appropriate T AD specification\nmust be met. See A/D conversion requirements in\nSection 15.0 “Electrical Specifications”  for more\ninformation. Table 9-1 gives examples of appropriateADC clock selections.\nTABLE 9-1: ADC CLOCK PERIOD (T AD) VS. DEVICE OPERATING FREQUENCIES (V DD > 3.0V)  Note: Analog voltages on any pin that is defined\nas a digital input may cause the input\nbuffer to conduct excess current.\nNote: Unless using the F RC, any changes in the\nsystem clock frequency will change theADC clock frequency, which may\nadversely affect the ADC result.\nADC Clock Period (T AD) Device Frequency (F OSC)\nADC Clock Source ADCS<2:0> 20 MHz 8 MHz 4 MHz 1 MHz\nFOSC/2 000 100 ns(2)250 ns(2)500 ns(2)2.0 μs\nFOSC/4 100 200 ns(2)500 ns(2)1.0 μs(2)4.0 μs\nFOSC/8 001 400 ns(2)1.0 μs(2)2.0 μs 8.0 μs(3)\nFOSC/16 101 800 ns(2)2.0 μs4 . 0  μs 16.0 μs(3)\nFOSC/32 010 1.6 μs4 . 0  μs 8.0 μs(3)32.0 μs(3)\nFOSC/64 110 3.2 μs 8.0 μs(3)16.0 μs(3)64.0 μs(3)\nFRC x11 2-6 μs(1,4)2-6 μs(1,4)2-6 μs(1,4)2-6 μs(1,4)\nLegend: Shaded cells are outside of recommended range.\nNote 1: The F RC source has a typical T AD time of 4 μs for V DD > 3.0V.\n2:These values violate the minimum required T AD time.\n3:For faster conversion times, the selection of another clock source is recommended.\n4:When the device frequency is greater than 1 MHz, the F RC clock source is only recommended if the \nconversion will be performed during Sleep.\n© 2007 Microchip Technology Inc. DS41202F-page 67PIC16F684\nFIGURE 9-2: ANALOG-TO-DIGITAL CONVERSION T AD CYCLES \n9.1.5 INTERRUPTS\nThe ADC module allows for the ability to generate an\ninterrupt upon completion of an analog-to-digital\nconversion. The ADC interrupt flag is the ADIF bit in the\nPIR1 register. The ADC interrupt enable is the ADIE bitin the PIE1 register. The ADIF bit must be cleared in\nsoftware.\nThis interrupt can be generated while the device is\noperating or while in Sleep. If the device is in Sleep, the\ninterrupt will wake-up the device. Upon waking fromSleep, the next instruction following the SLEEP\ninstruction is always executed. If the user is attempting\nto wake-up from Sleep and resume in-line codeexecution, the global interrupt must be disabled. If the\nglobal interrupt is enabled, execution will switch to the\ninterrupt service routine.\nPlease see Section 9.1.5 “Interrupts”  for more\ninformation.9.1.6 RESULT FORMATTING\nThe 10-bit A/D conversion result can be supplied in twoformats, left justified or right justified. The ADFM bit of\nthe ADCON0 register controls the output format.\nFigure 9-4 shows the two output formats.\nFIGURE 9-3: 10-BIT A/D CONVERSION RESULT FORMAT TAD1TAD2TAD3TAD4TAD5TAD6TAD7TAD8TAD9\nSet GO/DONE  bit Holding Capacitor is Disconnected from Analog Input (typically 100 ns) b9 b8 b7 b6 b5 b4 b3 b2TAD10TAD11\nb1 b0TCY to T AD\nConversion Starts \nADRESH and ADRESL registers are loaded,\nGO bit is cleared,\nADIF bit is set,\nHolding capacitor is connected to analog input\nNote: The ADIF bit is set at the completion of\nevery conversion, regardless of whether\nor not the ADC interrupt is enabled.\nADRESH ADRESL\n(ADFM = 0)M S B L S B\nbit 7 bit 0 bit 7 bit 0\n10-bit A/D Result Unimplemented: Read as ‘ 0’\n(ADFM = 1) MSB LSB\nbit 7 bit 0 bit 7 bit 0\nUnimplemented: Read as ‘ 0’ 10-bit A/D Result\nPIC16F684\nDS41202F-page 68 © 2007 Microchip Technology Inc.9.2 ADC Operation\n9.2.1 STARTING A CONVERSION\nTo enable the ADC module, the ADON bit of the\nADCON0 register must be set to a ‘ 1’. Setting the\nGO/DONE  bit of the ADCON0 register to a ‘ 1’ will start\nthe analog-to-digital conversion.\n9.2.2 COMPLETION OF A CONVERSION\nWhen the conversion is complete, the ADC module will:\n\x81 Clear the GO/DONE  bit \n\x81 Set the ADIF flag bit\x81 Update the ADRESH:ADRESL registers with new \nconversion result\n9.2.3 TERMINATING A CONVERSION\nIf a conversion must be terminated before completion,the GO/DONE\n bit can be cleared in software. The\nADRESH:ADRESL registers will not be updated with\nthe partially complete analog-to-digital conversionsample. Instead, the ADRESH:ADRESL register pair\nwill retain the value of the previous conversion. Addi-\ntionally, a 2 T\nAD delay is required before another acqui-\nsition can be initiated. Following this delay, an input\nacquisition is automatically started on the selected\nchannel.\n9.2.4 ADC OPERATION DURING SLEEP\nThe ADC module can operate during Sleep. Thisrequires the ADC clock source to be set to the F\nRC\noption. When the F RC clock source is selected, the\nADC waits one additional instruction before starting theconversion. This allows the SLEEP  instruction to be\nexecuted, which can reduce system noise during the\nconversion. If the ADC interrupt is enabled, the devicewill wake-up from Sleep when the conversion\ncompletes. If the ADC interrupt is disabled, the ADC\nmodule is turned off after the conversion completes,although the ADON bit remains set.\nWhen the ADC clock source is something other than\nF\nRC, a SLEEP  instruction causes the present conver-\nsion to be aborted and the ADC module is turned off,although the ADON bit remains set.9.2.5 SPECIAL EVENT TRIGGER\nThe ECCP Special Event Trigger allows periodic ADCmeasurements without software intervention. Whenthis trigger occurs, the GO/DONE\n bit is set by hardware\nand the Timer1 counter resets to zero.\nUsing the Special Event Trigger does not ensure\nproper ADC timing. It is the user’s responsibility toensure that the ADC timing requirements are met.\nSee Section 11.0 “Enhanced Capture/Com-\npare/PWM (With Auto-Shutdown and Dead Band)\nModule”  for more information.\n9.2.6 A/D CONVERSION PROCEDURE\nThis is an example procedure for using the ADC to\nperform an Analog-to-Digital conversion:\n1. Configure Port:\n\x81 Disable pin output driver (See TRIS register)\x81 Configure pin as analog\n2. Configure the ADC module:\n\x81 Select ADC conversion clock\x81 Configure voltage reference\n\x81 Select ADC input channel\n\x81 Select result format\x81 Turn on ADC module\n3. Configure ADC interrupt (optional):\n\x81 Clear ADC interrupt flag \x81 Enable ADC interrupt\n\x81 Enable peripheral interrupt\n\x81 Enable global interrupt\n(1)\n4. Wait the required acquisition time(2).\n5. Start conversion by setting the GO/DONE  bit.\n6. Wait for ADC conversion to complete by one of\nthe following:\n\x81 Polling the GO/DONE  bit\n\x81 Waiting for the ADC interrupt (interrupts \nenabled)\n7. Read ADC Result\n8. Clear the ADC interrupt flag (required if interrupt\nis enabled).Note: The GO/DONE  bit should not be set in the\nsame instruction that turns on the ADC.Refer to Section 9.2.6 “A/D Conversion\nProcedure” .\nNote: A device Reset forces all registers to their\nReset state. Thus, the ADC module is\nturned off and any pending conversion isterminated.\nNote 1: The global interrupt can be disabled if the\nuser is attempting to wake-up from Sleep\nand resume in-line code execution.\n2:See Section 9.3 “A/D Acquisition\nRequirements” .\n© 2007 Microchip Technology Inc. DS41202F-page 69PIC16F684\nEXAMPLE 9-1: A/D CONVERSION\n;This code block configures the ADC\n;for polling, Vdd reference, Frc clock\n;and AN0 input.\n;;Conversion start & polling for completion \n; are included.\n;BANKSEL ADCON1 ;\nMOVLW B’01110000’ ;ADC Frc clock\nMOVWF ADCON1 ;BANKSEL TRISA ;\nBSF TRISA,0 ;Set RA0 to input\nBANKSEL ANSEL ;BSF ANSEL,0 ;Set RA0 to analog\nBANKSEL ADCON0 ;\nMOVLW B’10000001’ ;Right justify,MOVWF ADCON0 ; Vdd Vref, AN0, On\nCALL SampleTime ;Acquisiton delay\nBSF ADCON0,GO ;Start conversionBTFSC ADCON0,GO ;Is conversion done?\nGOTO $-1 ;No, test again\nBANKSEL ADRESH ;MOVF ADRESH,W ;Read upper 2 bits\nMOVWF RESULTHI ;store in GPR space\nBANKSEL ADRESL ;MOVF ADRESL,W ;Read lower 8 bits\nMOVWF RESULTLO ;Store in GPR space\nPIC16F684\nDS41202F-page 70 © 2007 Microchip Technology Inc.9.2.7 ADC REGISTER DEFINITIONS\nThe following registers are used to control the operation of the ADC.\n \n REGISTER 9-1: ADCON0: A/D CONTROL REGISTER 0\nR/W-0 R/W-0 U-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nADFM VCFG — CHS2 CHS1 CHS0 GO/DONE ADON\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 ADFM: A/D Conversion Result Format Select bit\n1 = Right justified\n0 = Left justified\nbit 6 VCFG:  Voltage Reference bit\n1 = V REF pin\n0 = V DD\nbit 5 Unimplemented: Read as ‘0’\nbit 4-2 CHS<2:0>: Analog Channel Select bits\n000 = AN0\n001 = AN1\n010 = AN2\n011 = AN3\n100 = AN4\n101 = AN5\n110 = AN6\n111 = AN7\nbit 1 GO/DONE : A/D Conversion Status bit\n1 = A/D conversion cycle in progress. Setti ng this bit starts an A/D conversion cycle. \n      This bit is automatically cleared by  hardware when the A/D conversion has completed.\n0 = A/D conversion completed/not in progress\nbit 0 ADON:  ADC Enable bit\n1 = ADC is enabled\n0 = ADC is disabled and consumes no operating current\nREGISTER 9-2: ADCON1: A/D CONTROL REGISTER 1\nU-0 R/W-0 R/W-0 R/W-0 U-0 U-0 U-0 U-0\n— ADCS2 ADCS1 ADCS0 — — — —\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 Unimplemented: Read as ‘0’\nbit 6-4 ADCS<2:0>:  A/D Conversion Clock Select bits\n000 = F\nOSC/2\n001 = F OSC/8\n010 = F OSC/32\nx11 = F RC (clock derived from a dedicated internal oscillator = 500 kHz max)\n100 = F OSC/4\n101 = F OSC/16\n110 = F OSC/64\nbit 3-0 Unimplemented: Read as ‘0’\n© 2007 Microchip Technology Inc. DS41202F-page 71PIC16F684\n \n \n REGISTER 9-3: ADRESH: ADC RESULT REGISTER HIGH (ADRESH) ADFM = 0 \nR/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x\nADRES9 ADRES8 ADRES7 ADRES6 ADRES5 ADRES4 ADRES3 ADRES2\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-0 ADRES<9:2> : ADC Result Register bits\nUpper 8 bits of 10-bit conversion result\nREGISTER 9-4: ADRESL: ADC RESULT REGISTER LOW (ADRESL) ADFM = 0  \nR/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x\nADRES1 ADRES0 — — — — — —\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 ADRES<1:0> : ADC Result Register bits\nLower 2 bits of 10-bit conversion result\nbit 5-0 Reserved : Do not use.\nREGISTER 9-5: ADRESH: ADC RESULT REGISTER HIGH (ADRESH) ADFM = 1 \nR/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x\n— — — — — — ADRES9 ADRES8\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-2 Reserved : Do not use.\nbit 1-0 ADRES<9:8> : ADC Result Register bits\nUpper 2 bits of 10-bit conversion result\nREGISTER 9-6: ADRESL: ADC RESULT REGISTER LOW (ADRESL) ADFM = 1  \nR/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x R/W-x\nADRES7 ADRES6 ADRES5 ADRES4 ADRES3 ADRES2 ADRES1 ADRES0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-0 ADRES<7:0> : ADC Result Register bits\nLower 8 bits of 10-bit conversion result\nPIC16F684\nDS41202F-page 72 © 2007 Microchip Technology Inc.9.3 A/D Acquisition Requirements\nFor the ADC to meet its specified accuracy, the charge\nholding capacitor (C HOLD ) must be allowed to fully\ncharge to the input channel voltage level. The Analog\nInput model is shown in Figure 9-4. The source\nimpedance (R S) and the internal sampling switch (R SS)\nimpedance directly affect the time required to charge the\ncapacitor C HOLD . The sampling switch (R SS) impedance\nvaries over the device voltage (V DD), see Figure 9-4.\nThe maximum recommended impedance for analog\nsources is 10 k Ω. As the source impedance is\ndecreased, the acquisition time may be decreased.After the analog input channel is selected (or changed),\nan A/D acquisition must be done before the conversion\ncan be started. To calculate the minimum acquisitiontime, Equation 9-1 may be used. This equation\nassumes that 1/2 LSb error is used (1024 steps for the\nADC). The 1/2 LSb error is the maximum error allowedfor the ADC to meet its specified resolution.\nEQUATION 9-1: ACQUISITION TIME EXAMPLE     \n    TACQ Amplifier Settling Time Hold Capacitor Charging Time Temperature Coefficient ++ =\n  T AMP TCTCOFF ++ =\n  5µs T C Temperature - 25°C() 0.05µs/°C() [] ++ =\nTC CHOLD RIC RSS RS ++ ()  ln(1/2047) –=\n  10pF 1k Ω 7kΩ 10kΩ ++ () –  ln(0.0004885) =\n1.37= µs\nTACQ 5µS1.37µ S 50°C- 25°C() 0.05µ S/°C () [] ++ =\n  7.67µ S =VAPPLIED 1eTc–\nRC---------\n–\n⎝⎠⎜⎟⎛⎞VAPPLIED 11\n2047------------ –⎝⎠⎛⎞=VAPPLIED 11\n2047------------ –⎝⎠⎛⎞VCHOLD=\nVAPPLIED 1eTC–\nRC----------\n–\n⎝⎠⎜⎟⎛⎞VCHOLD=;[1] V CHOLD  charged to within 1/2 lsb\n;[2] V CHOLD  charge response to V APPLIED\n;combining [1] and [2]The value for T C can be approximated with the following equations:\nSolving for T C:\nTherefore:Temperature  50°C and external impedance of 10k Ω 5.0V V DD = Assumptions:\nNote 1: The reference voltage (V REF) has no effect on the equation, since it cancels itself out.\n2:The charge holding capacitor (C HOLD ) is not discharged after each conversion.\n3:The maximum recommended impedance for analog sources is 10 k Ω. This is required to meet the pin \nleakage specification.\n© 2007 Microchip Technology Inc. DS41202F-page 73PIC16F684\nFIGURE 9-4: ANALOG INPUT MODEL        \nFIGURE 9-5: ADC TRANSFER FUNCTIONCPIN VARsANx\n5 pF\nVDDVT = 0.6V\nVT = 0.6VI LEAKAGERIC ≤ 1kSampling\nSwitch\nSS Rss\nCHOLD  = 10 pF\nVSS/VREF-\n6V\nSampling Switch5V\n4V\n3V\n2V\n56789 1 0 1 1\n(kΩ)VDD\n± 500 nA\nLegend: CPIN\nVT\nI LEAKAGE\nRIC\nSS\nCHOLD= Input Capacitance\n= Threshold Voltage\n= Leakage current at the pin due to\n= Interconnect Resistance\n= Sampling Switch\n= Sample/Hold Capacitancevarious junctionsRSS\n3FFh\n3FEhADC Output Code3FDh\n3FCh\n004h\n003h\n002h\n001h\n000hFull-Scale3FBh\n1 LSB ideal\nVSS/VREF-Zero-Scale\nTransitionVDD/VREF+Transition1 LSB idealFull-Scale Range\nAnalog Input Voltage\nPIC16F684\nDS41202F-page 74 © 2007 Microchip Technology Inc.TABLE 9-2: SUMMARY OF ASSOCIATED ADC REGISTERS     \nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nADCON0 ADFM VCFG — CHS2 CHS1 CHS0 GO/DONE ADON0000 0000 0000 0000\nADCON1 — ADCS2 ADCS1 ADCS0 — — — —-000 ---- -000 ----\nANSEL ANS7 ANS6 ANS5 ANS4 ANS3 ANS2 ANS1 ANS0 1111 1111 1111 1111\nADRESH A/D Result Register High Byte xxxx xxxx uuuu uuuu\nADRESL A/D Result Register Low Byte xxxx xxxx uuuu uuuu\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF0000 0000 0000 0000\nPIE1 EEIE ADIE CCPIE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCPIF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPORTA — — RA5 RA4 RA3 RA2 RA1 RA0 --x0 x000 --uu uuuu\nPORTC — — RC5 RC4 RC3 RC2 RC1 RC0 --xx 0000 --uu uuuu\nTRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0 --11 1111 --11 1111\nTRISC — — TRISC5 TRISC4 TRISC3 TRISC2 TRISC1 TRISC0 --11 1111 --11 1111\nLegend: x = unknown, u = unchanged, — = unimplemented read as ‘ 0’. Shaded cells are not used for ADC module.\n© 2007 Microchip Technology Inc. DS41202F-page 75PIC16F684\n10.0 DATA EEPROM MEMORY\nThe EEPROM data memory is readable and writable\nduring normal operation (full V DD range). This memory\nis not directly mapped in the register file space.Instead, it is indirectly addressed through the Special\nFunction Registers. There are four SFRs used to read\nand write this memory:\n\x81 EECON1\n\x81 EECON2 (not a physically implemented register)\n\x81 EEDAT\n\x81 EEADR\nEEDAT holds the 8-bit data for read/write, and EEADR\nholds the address of the EEPROM location being\naccessed. PIC16F684 has 256 bytes of data EEPROM\nwith an address range from 0h to FFh.The EEPROM data memory allows byte read and write.\nA byte write automatically erases the location and\nwrites the new data (erase before write). The EEPROM\ndata memory is rated for high erase/write cycles. Thewrite time is controlled by an on-chip timer. The write\ntime will vary with voltage and temperature as well as\nfrom chip-to-chip. Please refer to AC Specifications inSection 15.0 “Electrical Specifications”  for exact\nlimits.\nWhen the data memory is code-protected, the CPU\nmay continue to read and write the data EEPROMmemory. The device programmer can no longer access\nthe data EEPROM data and will read zeroes.\n              \n              REGISTER 10-1: EEDAT: EEPROM DATA REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nEEDAT7 EEDAT6 EEDAT5 EEDAT4 EEDAT3 EEDAT2 EEDAT1 EEDAT0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-0 EEDATn : Byte Value to Write To or Read From Data EEPROM bits\nREGISTER 10-2: EEADR: EEPROM ADDRESS REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nEEADR7 EEADR6 EEADR5 EEADR4 EEADR3 EEADR2 EEADR1 EEADR0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-0 EEADR : Specifies One of 256 Locations fo r EEPROM Read/Write Operation bits\nPIC16F684\nDS41202F-page 76 © 2007 Microchip Technology Inc.10.1 EECON1 and EECON2 Registers\nEECON1 is the control register with four low-order bits\nphysically implemented. The upper four bits arenon-implemented and read as ‘ 0’s.\nControl bits RD and WR initiate read and write,\nrespectively. These bits cannot be cleared, only set in\nsoftware. They are cleared in hardware at completionof the read or write operation. The inability to clear the\nWR bit in software prevents the accidental, premature\ntermination of a write operation.\nThe WREN bit, when set, will allow a write operation.\nOn power-up, the WREN bit is clear. The WRERR bit is\nset when a write operation is interrupted by a MCLR\nReset, or a WDT Time-out Reset during normaloperation. In these situations, following Reset, the user\ncan check the WRERR bit, clear it and rewrite the\nlocation. The data and address will be cleared.\nTherefore, the EEDAT and EEADR registers will needto be re-initialized.\nInterrupt flag, EEIF bit of the PIR1 register, is set when\nwrite is complete. This bit must be cleared in software.\nEECON2 is not a physical register. Reading EECON2\nwill read all ‘ 0’s. The EECON2 register is used\nexclusively in the data EEPROM write sequence.\n              Note: The EECON1, EEDAT and EEADR\nregisters should not be modified during a\ndata EEPROM write (WR bit = 1).\nREGISTER 10-3: EECON1: EEPROM CONTROL REGISTER\nU-0 U-0 U-0 U-0 R/W-x R/W-0 R/S-0 R/S-0\n— — — — WRERR WREN WR RD\nbit 7 bit 0\nLegend:\nS = Bit can only be set\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-4 Unimplemented: Read as ‘0’\nbit 3 WRERR:  EEPROM Error Flag bit\n1 = A write operation is prematurely terminated (any MCLR  Reset, any WDT Reset during \nnormal operation or BOR Reset)\n0 = The write operation completed\nbit 2 WREN:  EEPROM Write Enable bit\n1 = Allows write cycles\n0 = Inhibits write to the data EEPROM\nbit 1 WR: Write Control bit\n1 = Initiates a write cycle (The bit is cleared by hardware once write is complete. The WR bit can only\nbe set, not cleared, in software.)\n0 = Write cycle to the data EEPROM is complete\nbit 0 RD: Read Control bit\n1 = Initiates an EEPROM read (Read takes one cycle. RD is cleared in hardware. The RD bit can only\nbe set, not cleared, in software.)\n0 = Does not initiate an EEPROM read\n© 2007 Microchip Technology Inc. DS41202F-page 77PIC16F684\n10.2 Reading the EEPROM Data \nMemory\nTo read a data memory location, the user must write the\naddress to the EEADR register and then set control bit\nRD of the EECON1 register, as shown in Example 10-1.The data is available, at the very next cycle, in the\nEEDAT register. Therefore, it can be read in the next\ninstruction. EEDAT holds this value until another read, oruntil it is written to by the user (during a write operation).\nEXAMPLE 10-1: DATA EEPROM READ\n10.3 Writing to the EEPROM Data \nMemory\nTo write an EEPROM data location, the user must first\nwrite the address to the EEADR register and the data\nto the EEDAT register. Then the user must follow aspecific sequence to initiate the write for each byte, as\nshown in Example 10-2.\nEXAMPLE 10-2: DATA EEPROM WRITE\nThe write will not initiate if the above sequence is not\nexactly followed (write 55h to EECON2, write AAh to\nEECON2, then set WR bit) for each byte. We strongly\nrecommend that interrupts be disabled during thiscode segment. A cycle count is executed during the\nrequired sequence. Any number that is not equal to the\nrequired cycles to execute the required sequence willprevent the data from being written into the EEPROM.\nAdditionally, the WREN bit in EECON1 must be set to\nenable write. This mechanism prevents accidental\nwrites to data EEPROM due to errant (unexpected)code execution (i.e., lost programs). The user should\nkeep the WREN bit clear at all times, except when\nupdating EEPROM. The WREN bit is not clearedby hardware.After a write sequence has been initiated, clearing the\nWREN bit will not affect this write cycle. The WR bit will\nbe inhibited from being set unless the WREN bit is set.\nAt the completion of the write cycle, the WR bit is\ncleared in hardware and the EE Write CompleteInterrupt Flag bit (EEIF) is set. The user can either\nenable this interrupt or poll this bit. The EEIF bit of the\nPIR1 register must be cleared by software.\n10.4 Write Verify\nDepending on the application, good programmingpractice may dictate that the value written to the data\nEEPROM should be verified (see Example 10-3) to the\ndesired value to be written.\nEXAMPLE 10-3: WRITE VERIFY\n10.4.1 USING THE DATA EEPROM\nThe data EEPROM is a high-endurance, byte\naddressable array that has been optimized for thestorage of frequently changing information (e.g.,\nprogram variables or other data that are updated often).\nWhen variables in one section change frequently, whilevariables in another section do not change, it is possible\nto exceed the total number of write cycles to the\nEEPROM (specification D124) without exceeding thetotal number of write cycles to a single byte\n(specifications D120 and D120A). If this is the case,\nthen a refresh of the array must be performed. For thisreason, variables that change infrequently (such as\nconstants, IDs, calibration, etc.) should be stored in\nFlash program memory.BANKSEL EEADR ;\nMOVLW CONFIG_ADDR;\nMOVWF EEADR ;Address to readBSF EECON1,RD ;EE Read\nMOVF EEDAT,W ;Move data to W\nBANKSEL EECON1 ;\nBSF EECON1,WREN ;Enable writeBCF INTCON,GIE ;Disable INTs\nBTFSC INTCON,GIE ;See AN576\nGOTO $-2 ;MOVLW 55h ;Unlock write\nMOVWF EECON2 ;\nMOVLW AAh ;MOVWF EECON2 ;\nBSF EECON1,WR ;Start the write\nBSF INTCON,GIE ;Enable INTSRequired\nSequenceBANKSELEEDAT ;\nMOVF EEDAT,W ;EEDAT not changed \n;from previous write\nBSF EECON1,RD ;YES, Read the \n;value written\nXORWF EEDAT,W\nBTFSS STATUS,Z ;Is data the sameGOTO WRITE_ERR ;No, handle error\n: ;Yes, continue\nPIC16F684\nDS41202F-page 78 © 2007 Microchip Technology Inc.10.5 Protection Against Spurious Write\nThere are conditions when the user may not want to\nwrite to the data EEPROM memory. To protect againstspurious EEPROM writes, various mechanisms have\nbeen built in. On power-up, WREN is cleared. Also, the\nPower-up Timer (64 ms duration) preventsEEPROM write.\nThe write initiate sequence and the WREN bit together\nhelp prevent an accidental write during:\n\x81 Brown-out\n\x81P o w e r  G l i t c h\n\x81 Software Malfunction10.6 Data EEPROM Operation During \nCode-Protect\nData memory can be code-protected by programming\nthe CPD  bit in the Configuration Word register\n(Register 12-1) to ‘ 0’.\nWhen the data memory is code-protected, the CPU is\nable to read and write data to the data EEPROM. It is\nrecommended to code-protect the program memory\nwhen code-protecting data memory. This preventsanyone from programming zeroes over the existing\ncode (which will execute as NOPs) to reach an added\nroutine, programmed in unused program memory,which outputs the contents of data memory.\nProgramming unused locations in program memory to\n‘0’ will also help prevent data memory code protection\nfrom becoming breached.\nTABLE 10-1: SUMMARY OF ASSOCIATED DATA EEPROM REGISTERS \nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nEEDAT EEDAT7 EEDAT6 EEDAT5 EEDAT4 EEDAT3 EEDAT2 EEDAT1 EEDAT0 0000 0000 0000 0000\nEEADR EEADR7 EEADR6 EEADR5 EEADR4 EEADR3 EEADR2 EEADR1 EEADR0 0000 0000 0000 0000\nEECON1 — — — — WRERR WREN WR RD ---- x000 ---- q000\nEECON2(1)EEPROM Control Register 2 ---- ---- ---- ----\nLegend: x = unknown, u = unchanged, – = unimplemented read as ‘ 0’, q = value depends upon condition. Shaded cells are not used by the Data \nEEPROM module.\nNote 1: EECON2 is not a physical register.\n© 2007 Microchip Technology Inc. DS41202F-page 79PIC16F684\n11.0 ENHANCED \nCAPTURE/COMPARE/PWM \n(WITH AUTO-SHUTDOWN AND DEAD BAND) MODULE\nThe Enhanced Capture/Compare/PWM module is a\nperipheral which allows the user to time and control\ndifferent events. In Capture mode, the peripheralallows the timing of the duration of an event. The\nCompare mode allows the user to trigger an external\nevent when a predetermined amount of time hasexpired. The PWM mode can generate a Pulse-Width\nModulated signal of varying frequency and duty cycle.Table 11-1 shows the timer resources required by the\nECCP module.\nTABLE 11-1: ECCP MODE – TIMER \nRESOURCES REQUIRED\n  ECCP Mode Timer Resource\nCapture Timer1\nCompare Timer1\nPWM Timer2\nREGISTER 11-1: CCP1CON: ENHANCED CCP1 CONTROL REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nP1M1 P1M0 DC1B1 DC1B0 CCP1M3 CCP1M2 CCP1M1 CCP1M0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-6 P1M<1:0>: PWM Output Configuration bits\nIf CCP 1M<3:2> = 00, 01, 10 :\nxx = P1A assigned as Capture/Compare input; P1B, P1C, P1D assigned as port pins\nIf CCP 1M<3:2> = 11:\n00 = Single output; P1A modulated; P1B, P1C, P1D assigned as port pins\n01 = Full-bridge output forward; P1D modulated; P1A active; P1B, P1C inactive\n10 = Half-bridge output; P1A, P1B modulated with dead-band control; P1C, P1D assigned as port pins\n11 = Full-bridge output reverse; P1B modulated; P1C active; P1A, P1D inactive\nbit 5-4 DC1B<1:0>:  PWM Duty Cycle Least Significant bits\nCapture mode:\nUnused.\nCompare mode:\nUnused.\nPWM mode:\nThese bits are the two LSbs of the PWM duty cycle. The eight MSbs are found in CCPR1L.\nbit 3-0 CCP1M<3:0>:  ECCP Mode Select bits\n0000  = Capture/Compare/PWM off (resets ECCP module)\n0001  = Unused (reserved)\n0010  = Compare mode, toggle output on match (CCP1IF bit is set)\n0011  = Unused (reserved)\n0100  = Capture mode, every falling edge\n0101  = Capture mode, every rising edge\n0110  = Capture mode, every 4th rising edge\n0111  = Capture mode, every 16th rising edge\n1000  = Compare mode, set output on match (CCP1IF bit is set)\n1001  = Compare mode, clear output on match (CCP1IF bit is set)\n1010  = Compare mode, generate software interrupt on match (CCP1IF bit is set, CCP1 pin is\nunaffected)\n1011  = Compare mode, trigger special event (CCP1IF bit is set; CCP1 resets TMR1 or TMR2, and starts\nan A/D conversion, if the ADC module is enabled)\n1100  = PWM mode; P1A, P1C active-high; P1B, P1D active-high\n1101  = PWM mode; P1A, P1C active-high; P1B, P1D active-low\n1110  = PWM mode; P1A, P1C active-low; P1B, P1D active-high\n1111  = PWM mode; P1A, P1C active-low; P1B, P1D active-low\nPIC16F684\nDS41202F-page 80 © 2007 Microchip Technology Inc.11.1 Capture Mode\nIn Capture mode, CCPR1H:CCPR1L captures the\n16-bit value of the TMR1 register when an event occurson pin CCP1. An event is defined as one of the\nfollowing and is configured by the CCP1M<3:0> bits of\nthe CCP1CON register:\n\x81 Every falling edge\n\x81 Every rising edge\n\x81 Every 4th rising edge\n\x81 Every 16th rising edge\nWhen a capture is made, the Interrupt Request Flag bit\nCCP1IF of the PIR1 register is set. The interrupt flag\nmust be cleared in software. If another capture occurs\nbefore the value in the CCPR1H, CCPR1L register pairis read, the old captured value is overwritten by the new\ncaptured value (see Figure 11-1).\n11.1.1 CCP1 PIN CONFIGURATION\nIn Capture mode, the CCP1 pin should be configured\nas an input by setting the associated TRIS control bit.\nFIGURE 11-1: CAPTURE MODE \nOPERATION BLOCK DIAGRAM11.1.2 TIMER1 MODE SELECTION\nTimer1 must be running in Timer mode or Synchronized\nCounter mode for the CCP module to use the capturefeature. In Asynchronous Counter mode, the capture\noperation may not work. \n11.1.3 SOFTWARE INTERRUPT\nWhen the Capture mode is changed, a false capture\ninterrupt may be generated. The user should keep theCCP1IE interrupt enable bit of the PIE1 register clear to\navoid false interrupts. Additionally, the user should\nclear the CCP1IF interrupt flag bit of the PIR1 registerfollowing any change in operating mode.\n11.1.4 CCP PRESCALER\nThere are four prescaler settings specified by the\nCCP1M<3:0> bits of the CCP1CON register.\nWhenever the CCP module is turned off, or the CCPmodule is not in Capture mode, the prescaler counter\nis cleared. Any Reset will clear the prescaler counter.\nSwitching from one capture prescaler to another does not\nclear the prescaler and may generate a false interrupt. Toavoid this unexpected operation, turn the module off by\nclearing the CCP1CON register before changing the\nprescaler (see Example 11-1).\nEXAMPLE 11-1: CHANGING BETWEEN \nCAPTURE PRESCALERSNote: If the CCP1 pin is configured as an output,\na write to the port can cause a capture\ncondition. \nCCPR 1H CCPR 1L\nTMR1H TMR1LSet Flag bit CCP1IF\n(PIR1 register)\nCapture\nEnable\nCCP1CON<3:0>Prescaler\n÷ 1, 4, 16\nand\nEdge DetectpinCCP1\nSystem Clock (F OSC)BANKSEL CCP1CON ;Set Bank bits to point\n;to CCP1CON\nCLRF CCP1CON ;Turn CCP module offMOVLW NEW_CAPT_PS;Load the W reg with\n; the new prescaler\n; move value and CCP ON\nMOVWF CCP1CON ;Load CCP1CON with this\n; value\n© 2007 Microchip Technology Inc. DS41202F-page 81PIC16F684\n11.2 Compare Mode\nIn Compare mode, the 16-bit CCPR1 register value is\nconstantly compared against the TMR1 register pairvalue. When a match occurs, the CCP module may:\n\x81 Toggle the CCP1 output\n\x81 Set the CCP1 output\x81 Clear the CCP1 output\n\x81 Generate a Special Event Trigger\n\x81 Generate a Software Interrupt\nThe action on the pin is based on the value of the\nCCP1M<3:0> control bits of the CCP1CON register.\nAll Compare modes can generate an interrupt.\nFIGURE 11-2: COMPARE MODE \nOPERATION BLOCK DIAGRAM\n11.2.1 CCP1 PIN CONFIGURATION\nThe user must configure the CCP1 pin as an output by\nclearing the associated TRIS bit.11.2.2 TIMER1 MODE SELECTION\nIn Compare mode, Timer1 must be running in eitherTimer mode or Synchronized Counter mode. Thecompare operation may not work in Asynchronous\nCounter mode.\n11.2.3 SOFTWARE INTERRUPT MODE \nWhen Generate Software Interrupt mode is chosen\n(CCP1M<3:0> = 1010 ), the CCP module does not\nassert control of the CCP1 pin (see the CCP1CON\nregister).\n11.2.4 SPECIAL EVENT TRIGGER\nWhen Special Event Trigger mode is chosen\n(CCP1M<3:0> = 1011 ), the CCP module does the\nfollowing:\n\x81 Resets Timer1\n\x81 Starts an ADC conversion if ADC is enabled\nThe CCP module does not assert control of the CCP1\npin in this mode (see the CCP1CON register).\nThe Special Event Trigger output of the CCP occurs\nimmediately upon a match between the TMR1H,\nTMR1L register pair and the CCPR1H, CCPR1Lregister pair. The TMR1H, TMR1L register pair is not\nreset until the next rising edge of the Timer1 clock. This\nallows the CCPR1H, CCPR1L register pair toeffectively provide a 16-bit programmable period\nregister for Timer1.\nNote: Clearing the CCP1CON register will force\nthe CCP1 compare output latch to the\ndefault low level. This is not the port I/Odata latch.CCPR1H CCPR1L\nTMR1H TMR1LComparatorQS\nROutput\nLogic\nSpecial Event TriggerSet CCP1IF Interrupt Flag\n(PIR1)\nMatch\nTRISCCP1CON<3:0>\nMode Select\nOutput EnablePin\nSpecial Event Trigger will:\n\x81 Clear TMR1H and TMR1L registers.\n\x81 NOT set interrupt flag bit TMR1IF of the PIR1 register.\x81 Set the GO/DONE\n bit to start the ADC conversion.CCP1 4\nNote 1: The Special Event Trigger from the CCP\nmodule does not set interrupt flag bit\nTMR1IF of the PIR1 register.\n2:Removing the match condition by\nchanging the contents of the CCPR1Hand CCPR1L register pair, between the\nclock edge that generates the Special\nEvent Trigger and the clock edge thatgenerates the Timer1 Reset, will preclude\nthe Reset from occurring.\nPIC16F684\nDS41202F-page 82 © 2007 Microchip Technology Inc.11.3 PWM Mode\nThe PWM mode generates a Pulse-Width Modulated\nsignal on the CCP1 pin. The duty cycle, period andresolution are determined by the following registers:\n\x81P R 2\n\x81T 2 C O N\x81 CCPR1L\n\x81 CCP1CON\nIn Pulse-Width Modulation (PWM) mode, the CCP\nmodule produces up to a 10-bit resolution PWM output\non the CCP1 pin. Since the CCP1 pin is multiplexedwith the PORT data latch, the TRIS for that pin must be\ncleared to enable the CCP1 pin output driver. \nFigure 11-3 shows a simplified block diagram of PWM\noperation. \nFigure 11-4 shows a typical waveform of the PWM\nsignal.\nFor a step by step procedure on how to set up the CCP\nmodule for PWM operation, see Section 11.3.7\n“Setup for PWM Operation” .\nFIGURE 11-3: SIMPLIFIED PWM BLOCK \nDIAGRAM     The PWM output (Figure 11-4) has a time base\n(period) and a time that the output stays high (duty\ncycle).\nFIGURE 11-4: CCP PWM OUTPUT\nNote: Clearing the CCP1CON register will\nrelinquish CCP1 control of the CCP1 pin.\nCCPR1L\nCCPR1H(2) (Slave)\nComparator\nTMR2\nPR2(1)RQ\nSDuty Cycle RegistersCCP1CON<5:4>\nClear Timer2,\ntoggle CCP1 pin and \nlatch duty cycle\nNote 1: The 8-bit timer TMR2 register is concatenated  \nwith the 2-bit internal system clock (F OSC), or \n2 bits of the prescaler, to create the 10-bit time  \nbase.\n2: In PWM mode, CCPR1H is a read-only register .TRISCCP1\nComparatorPeriod\nPulse Width\nTMR2 = 0TMR2 = CCPR1L:CCP1CON<5:4>TMR2 = PR2\n© 2007 Microchip Technology Inc. DS41202F-page 83PIC16F684\n11.3.1 PWM PERIOD\nThe PWM period is specified by the PR2 register of\nTimer2. The PWM period can be calculated using theformula of Equation 11-1.\nEQUATION 11-1: PWM PERIOD\nWhen TMR2 is equal to PR2, the following three eventsoccur on the next increment cycle:\n\x81 TMR2 is cleared\n\x81 The CCP1 pin is set. (Exception: If the PWM duty \ncycle = 0%, the pin will not be set.)\n\x81 The PWM duty cycle is latched from CCPR1L into \nCCPR1H.\n11.3.2 PWM DUTY CYCLE\nThe PWM duty cycle is specified by writing a 10-bitvalue to multiple registers: CCPR1L register and\nCCP1<1:0> bits of the CCP1CON register. The\nCCPR1L contains the eight MSbs and the CCP1<1:0>bits of the CCP1CON register contain the two LSbs.\nCCPR1L and CCP1<1:0> bits of the CCP1CON\nregister can be written to at any time. The duty cyclevalue is not latched into CCPR1H until after the period\ncompletes (i.e., a match between PR2 and TMR2\nregisters occurs). While using the PWM, the CCPR1Hregister is read-only.\nEquation 11-2 is used to calculate the PWM pulse\nwidth.\nEquation 11-3 is used to calculate the PWM duty cycle\nratio.EQUATION 11-2: PULSE WIDTH\nEQUATION 11-3: DUTY CYCLE RATIO\nThe CCPR1H register and a 2-bit internal latch are\nused to double buffer the PWM duty cycle. This double\nbuffering is essential for glitchless PWM operation.\nThe 8-bit timer TMR2 register is concatenated with\neither the 2-bit internal system clock (F OSC), or 2 bits of\nthe prescaler, to create the 10-bit time base. The system\nclock is used if the Timer2 prescaler is set to 1:1.\nWhen the 10-bit time base matches the CCPR1H and\n2-bit latch, then the CCP1 pin is cleared (seeFigure 11-3).\n11.3.3 PWM RESOLUTION\nThe resolution determines the number of available duty\ncycles for a given period. For example, a 10-bit resolution\nwill result in 1024 discrete duty cycles, whereas an 8-bitresolution will result in 256 discrete duty cycles.\nThe maximum PWM resolution is 10 bits when PR2 is\n255. The resolution is a function of the PR2 register\nvalue as shown by Equation 11-4.\nEQUATION 11-4: PWM RESOLUTION\nTABLE 11-2: EXAMPLE PWM FREQUENCIES AND RESOLUTIONS (F OSC = 20 MHz)\nTABLE 11-3: EXAMPLE PWM FREQUENCIES AND RESOLUTIONS (F OSC = 8 MHz)Note: The Timer2 postscaler (see Section 7.1\n“Timer2 Operation” ) is not used in the\ndetermination of the PWM frequency.PWM Period PR2 () 1+ [] 4T OSC  • •• =\n(TMR2 Prescale Value)\nNote: If the pulse width value is greater than the\nperiod the assigned PWM pin(s) will\nremain unchanged.Pulse Width CCPR1L:CCP1CON<5:4> ()   • =\nTOSC    •(TMR2 Prescale Value)\nDuty Cycle RatioCCPR1L:CCP1CON<5:4>()\n4P R 2 1 + ()-----------------------------------------------------------------------=\nResolution4P R 2 1 + ()[]log\n2()log----------------------------------------- -  bits =\nPWM Frequency 1.22 kHz 4.88 kHz 19.53 kHz 78.12 kHz 156.3 kHz 208.3 kHz\nTimer Prescale (1, 4, 16) 16 4 1 1 1 1\nPR2 Value 0xFF 0xFF 0xFF 0x3F 0x1F 0x17Maximum Resolution (bits) 10 10 10 8 7 6.6\nPWM Frequency 1.22 kHz 4.90 kHz 19.61 kHz 76.92 kHz 153.85 kHz 200.0 kHz\nTimer Prescale (1, 4, 16) 16 4 1 1 1 1\nPR2 Value 0x65 0x65 0x65 0x19 0x0C 0x09\nMaximum Resolution (bits) 8 8 8 6 5 5\nPIC16F684\nDS41202F-page 84 © 2007 Microchip Technology Inc.11.3.4 OPERATION IN SLEEP MODE\nIn Sleep mode, the TMR2 register will not increment\nand the state of the module will not change. If the CCP1pin is driving a value, it will continue to drive that value.\nWhen the device wakes up, TMR2 will continue from its\nprevious state.\n11.3.5 CHANGES IN SYSTEM CLOCK \nFREQUENCY\nThe PWM frequency is derived from the system clock\nfrequency. Any changes in the system clock frequency\nwill result in changes to the PWM frequency. See\nSection 3.0 “Oscillator Module (With Fail-SafeClock Monitor)”  for additional details.\n11.3.6 EFFECTS OF RESET\nAny Reset will force all ports to Input mode and the\nCCP registers to their Reset states.11.3.7 SETUP FOR PWM OPERATION\nThe following steps should be taken when configuring\nthe CCP module for PWM operation:\n1. Disable the PWM pin (CCP1) output driver by\nsetting the associated TRIS bit.\n2. Set the PWM period by loading the PR2 register.3. Configure the CCP module for the PWM mode\nby loading the CCP1CON register with theappropriate values.\n4. Set the PWM duty cycle by loading the CCPR1L\nregister and CCP1 bits of the CCP1CON register.\n5. Configure and start Timer2:\n\x81 Clear the TMR2IF interrupt flag bit of the \nPIR1 register.\n\x81 Set the Timer2 prescale value by loading the \nT2CKPS bits of the T2CON register.\n\x81 Enable Timer2 by setting the TMR2ON bit of \nthe T2CON register.\n6. Enable PWM output after a new PWM cycle has\nstarted:\n\x81 Wait until Timer2 overflows (TMR2IF bit of \nthe PIR1 register is set).\n\x81 Enable the CCP1 pin output driver by clearing \nthe associated TRIS bit.\n© 2007 Microchip Technology Inc. DS41202F-page 85PIC16F684\n11.4 PWM (Enhanced Mode)\nThe Enhanced PWM Mode can generate a PWM signal\non up to four different output pins with up to 10-bits ofresolution. It can do this through four different PWM\noutput modes:\n\x81 Single PWM\n\x81 Half-Bridge PWM\n\x81 Full-Bridge PWM, Forward mode\x81 Full-Bridge PWM, Reverse mode\nTo select an Enhanced PWM mode, the P1M bits of the\nCCP1CON register must be set appropriately.The PWM outputs are multiplexed with I/O pins and are\ndesignated P1A, P1B, P1C and P1D. The polarity of the\nPWM pins is configurable and is selected by setting the\nCCP1M bits in the CCP1CON register appropriately.\nTable 11-4 shows the pin assignments for each\nEnhanced PWM mode.\nFigure 11-5 shows an example of a simplified block\ndiagram of the Enhanced PWM module.\nFIGURE 11-5: EXAMPLE SIMPLIFIED BLOCK DIAGRAM OF THE ENHANCED PWM MODE   \nTABLE 11-4: EXAMPLE PIN ASSIGNMENTS FOR VARIOUS PWM ENHANCED MODES  Note: To prevent the generation of an\nincomplete waveform when the PWM is\nfirst enabled, the ECCP module waits until\nthe start of a new PWM period beforegenerating a PWM signal.\nCCPR1L\nCCPR1H (Slave)\nComparator\nTMR2\nComparator\nPR2(1)RQ\nSDuty Cycle RegistersCCP1<1:0>\nClear Timer2,\ntoggle PWM pin and latch duty cycle\nNote 1: The 8-bit timer TMR2 register is concatenated with the 2-bit internal Q clock, or 2 bits of the prescaler to create the 10-bit\ntime base.TRISCCP1/P1A\nTRISP1B\nTRISP1C\nTRISP1DOutput\nControllerP1M<1:0>\n2CCP1M<3:0>\n4\nPWM1CONCCP1/P1A\nP1B\nP1C\nP1D\nNote 1: The TRIS register value for each PWM output must be configured appropriately.\n2:Clearing the CCP1CON register will relinquish ECCP control of all PWM output pins.\n3:Any pin not used by an Enhanced PWM mode is available for alternate pin functions\nECCP Mode P1M CCP1/P1A P1B P1C P1D\nSingle 00 Yes No No No\nHalf-Bridge 10 Yes Yes No No\nFull-Bridge, Forward 01 Yes Yes Yes Yes\nFull-Bridge, Reverse 11 Yes Yes Yes Yes\nPIC16F684\nDS41202F-page 86 © 2007 Microchip Technology Inc.FIGURE 11-6: EXAMPLE PWM (ENHANCED MODE) OUTPUT RELATIONSHIPS (ACTIVE-HIGH \nSTATE)\n0\nPeriod\n00\n10\n01\n11SignalPR2+1\nP1M<1:0>\nP1A Modulated\nP1A Modulated\nP1B Modulated\nP1A Active\nP1B Inactive\nP1C InactiveP1D Modulated\nP1A Inactive\nP1B ModulatedP1C Active\nP1D InactivePulse\nWidth\n(Single Output)\n(Half-Bridge)\n(Full-Bridge,\nForward)\n(Full-Bridge,\nReverse)Delay(1)Delay(1)\nRelationships:\n\x81 Period = 4 * T OSC * (PR2 + 1) * (TMR2 Prescale Value)\n\x81 Pulse Width = T OSC * (CCPR1L<7:0>:CCP1CON<5:4>) * (TMR2 Prescale Value)\n\x81 Delay = 4 * T OSC * (PWM1CON<6:0>)\nNote 1: Dead-band delay is programmed using the PWM1CON register ( Section 11.4.6 “Programmable Dead-Band Delay\nmode” ).\n© 2007 Microchip Technology Inc. DS41202F-page 87PIC16F684\nFIGURE 11-7: EXAMPLE ENHANCED PWM OUTPUT RELATIONSHIPS (ACTIVE-LOW STATE)\n0\nPeriod\n00\n10\n01\n11SignalPR2+1\nP1M<1:0>\nP1A Modulated\nP1A Modulated\nP1B Modulated\nP1A ActiveP1B Inactive\nP1C Inactive\nP1D ModulatedP1A Inactive\nP1B Modulated\nP1C ActiveP1D InactivePulse\nWidth\n(Single Output)\n(Half-Bridge)\n(Full-Bridge,\nForward)\n(Full-Bridge,\nReverse)Delay(1) Delay(1)\nRelationships:\n\x81 Period = 4 * T OSC * (PR2 + 1) * (TMR2 Prescale Value)\n\x81 Pulse Width = T OSC * (CCPR1L<7:0>:CCP1CON<5:4>) * (TMR2 Prescale Value)\n\x81 Delay = 4 * T OSC * (PWM1CON<6:0>)\nNote 1: Dead-band delay is programmed using the PWM1CON register ( Section 11.4.6 “Programmable Dead-Band Delay\nmode” ).\nPIC16F684\nDS41202F-page 88 © 2007 Microchip Technology Inc.11.4.1 HALF-BRIDGE MODE\nIn Half-Bridge mode, two pins are used as outputs to\ndrive push-pull loads. The PWM output signal is outputon the CCP1/P1A pin, while the complementary PWM\noutput signal is output on the P1B pin (see\nFigure 11-16). This mode can be used for half-bridgeapplications, as shown in Figure 11-17, or for\nfull-bridge applications, where four power switches are\nbeing modulated with two PWM signals.\nIn Half-Bridge mode, the programmable dead-band delay\ncan be used to prevent shoot-through current in\nhalf-bridge power devices. The value of the PDC<6:0>\nbits of the PWM1CON register sets the number ofinstruction cycles before the output is driven active. If the\nvalue is greater than the duty cycle, the corresponding\noutput remains inactive during the entire cycle. SeeSection 11.4.6 “Programmable Dead-Band Delay\nmode”  for more details of the dead-band delay\noperations.Since the P1A and P1B outputs are multiplexed with\nthe PORT data latches, the associated TRIS bits must\nbe cleared to configure P1A and P1B as outputs.\nFIGURE 11-8: EXAMPLE OF \nHALF-BRIDGE PWM OUTPUT\nFIGURE 11-9: EXAMPLE OF HALF-BRIDGE APPLICATIONSPeriod\nPulse Width\ntd\ntd\n(1)P1A(2)\nP1B(2)\ntd = Dead-Band DelayPeriod\n(1) (1)\nNote 1: At this time, the TMR2 register is equal to the\nPR2 register.\n2:Output signals are shown as active-high.\nP1A\nP1BFET\nDriver\nFET\nDriverLoad\n+\n-+\n-\nFET\nDriver\nFET\nDriverV+\nLoadFET\nDriver\nFETDriverP1A\nP1BStandard Half-Bridge Circuit (“Push-Pull”)\nHalf-Bridge Output Driving a Full-Bridge Circuit\n© 2007 Microchip Technology Inc. DS41202F-page 89PIC16F684\n11.4.2 FULL-BRIDGE MODE\nIn Full-Bridge mode, all four pins are used as outputs.\nAn example of full-bridge application is shown inFigure 11-10.\nIn the Forward mode, pin CCP1/P1A is driven to its active\nstate, pin P1D is modulated, while P1B and P1C will be\ndriven to their inactive state as shown in Figure 11-11. \nIn the Reverse mode, P1C is driven to its active state,\npin P1B is modulated, while P1A and P1D will be driven\nto their inactive state as shown Figure 11-11.\nP1A, P1B, P1C and P1D outputs are multiplexed with\nthe PORT data latches. The associated TRIS bits mustbe cleared to configure the P1A, P1B, P1C and P1D\npins as outputs.\nFIGURE 11-10: EXAMPLE OF FULL-BRIDGE APPLICATION\nP1A\nP1CFET\nDriver\nFET\nDriverV+\nV-LoadFET\nDriver\nFET\nDriverP1B\nP1DQA\nQB QDQC\nPIC16F684\nDS41202F-page 90 © 2007 Microchip Technology Inc.FIGURE 11-11: EXAMPLE OF FULL-BRIDGE PWM OUTPUT\nPeriod\nPulse WidthP1A(2)\nP1B(2)\nP1C(2)\nP1D(2)Forward Mode\n(1)\nPeriod\nPulse Width\nP1A(2)\nP1C(2)\nP1D(2)P1B(2)Reverse Mode(1)\n(1) (1)\nNote 1: At this time, the TMR2 register is equal to the PR2 register.\n2:Output signal is shown as active-high.\n© 2007 Microchip Technology Inc. DS41202F-page 91PIC16F684\n11.4.2.1 Direction Change in Full-Bridge \nMode\nIn the Full-Bridge mode, the P1M1 bit in the CCP1CON\nregister allows users to control the forward/reversedirection. When the application firmware changes this\ndirection control bit, the module will change to the new\ndirection on the next PWM cycle.\nA direction change is initiated in software by changing\nthe P1M1 bit of the CCP1CON register. The following\nsequence occurs four Timer2 cycles prior to the end of\nthe current PWM period:\n\x81 The modulated outputs (P1B and P1D) are placed \nin their inactive state.\n\x81 The associated unmodulated outputs (P1A and \nP1C) are switched to drive in the opposite \ndirection.\n\x81 PWM modulation resumes at the beginning of the \nnext period.\nSee Figure 11-12 for an illustration of this sequence.The Full-Bridge mode does not provide dead-band\ndelay. As one output is modulated at a time, dead-band\ndelay is generally not required. There is a situation\nwhere dead-band delay is required. This situationoccurs when both of the following conditions are true:\n1. The direction of the PWM output changes when\nthe duty cycle of the output is at or near 100%.\n2. The turn off time of the power switch, including\nthe power device and driver circuit, is greater\nthan the turn on time.\nFigure 11-13 shows an example of the PWM direction\nchanging from forward to reverse, at a near 100% duty\ncycle. In this example, at time t1, the output P1A and\nP1D become inactive, while output P1C becomesactive. Since the turn off time of the power devices is\nlonger than the turn on time, a shoot-through current\nwill flow through power devices QC and QD (seeFigure 11-10) for the duration of ‘t’. The same\nphenomenon will occur to power devices QA and QB\nfor PWM direction change from reverse to forward.\nIf changing PWM direction at high duty cycle is required\nfor an application, two possible solutions for eliminating\nthe shoot-through current are:\n1. Reduce PWM duty cycle for one PWM period\nbefore changing directions.\n2. Use switch drivers that can drive the switches off\nfaster than they can drive them on.\nOther options to prevent shoot-through current may\nexist.\nFIGURE 11-12: EXAMPLE OF PWM DIRECTION CHANGE\nPulse WidthPeriod(1)\nSignal\nNote 1: The direction bit P1M1 of the CCP1CON register is written any time during the PWM cycle.\n2:When changing directions, the P1A and P1C signals switch before the end of the current PWM cycle. The\nmodulated P1B and P1D signals are inactive at this time. The length of this time is four Timer2 counts.Period\n(2)P1A (Active-High)\nP1B (Active-High)\nP1C (Active-High)\nP1D (Active-High)Pulse Width\nPIC16F684\nDS41202F-page 92 © 2007 Microchip Technology Inc.FIGURE 11-13: EXAMPLE OF PWM DIRECTION CHANGE AT NEAR 100% DUTY CYCLE\n11.4.3 START-UP CONSIDERATIONS\nWhen any PWM mode is used, the application\nhardware must use the proper external pull-up and/or\npull-down resistors on the PWM output pins. \nThe CCP1M<1:0> bits of the CCP1CON register allow\nthe user to choose whether the PWM output signals areactive-high or active-low for each pair of PWM output pins\n(P1A/P1C and P1B/P1D). The PWM output polarities\nmust be selected before the PWM pin output drivers areenabled. Changing the polarity configuration while the\nPWM pin output drivers are enabled is not recommended\nsince it may result in damage to the application circuits.\nThe P1A, P1B, P1C and P1D output latches may not be\nin the proper states when the PWM module is\ninitialized. Enabling the PWM pin output drivers at the\nsame time as the Enhanced PWM modes may causedamage to the application circuit. The Enhanced PWM\nmodes must be enabled in the proper Output mode and\ncomplete a full PWM cycle before enabling the PWMpin output drivers. The completion of a full PWM cycle\nis indicated by the TMR2IF bit of the PIR1 register\nbeing set as the second PWM period begins.Forward Period Reverse Period\nP1A\nTON\nTOFF\nT = T OFF – TONP1B\nP1C\nP1D\nExternal Switch D\nPotential\nShoot-Through Current\nNote 1: All signals are shown as active-high.\n2:TON is the turn on delay of power switch QC and its driver.\n3:TOFF is the turn off delay of pow er switch QD and its driver.External Switch Ct1\nDC\nPW\nNote: When the microcontroller is released from\nReset, all of the I/O pins are in the\nhigh-impedance state. The external cir-cuits must keep the power switch devices\nin the OFF state until the microcontroller\ndrives the I/O pins with the proper signallevels or activates the PWM output(s).\n© 2007 Microchip Technology Inc. DS41202F-page 93PIC16F684\n11.4.4 ENHANCED PWM \nAUTO-SHUTDOWN MODE\nThe PWM mode supports an Auto-Shutdown mode that\nwill disable the PWM outputs when an externalshutdown event occurs. Auto-Shutdown mode places\nthe PWM output pins into a predetermined state. This\nmode is used to help prevent the PWM from damagingthe application.\nThe auto-shutdown sources are selected using the\nECCPASx bits of the ECCPAS register. A shutdown\nevent may be generated by:\n\x81A  l o g i c  ‘0’ on the INT pin\n\x81 Comparator 1\n\x81 Comparator 2\n\x81 Setting the ECCPASE bit in firmwareA shutdown condition is indicated by the ECCPASE\n(Auto-Shutdown Event Status) bit of the ECCPAS\nregister. If the bit is a ‘ 0’, the PWM pins are operating\nnormally. If the bit is a ‘ 1’, the PWM outputs are in the\nshutdown state.\nWhen a shutdown event occurs, two things happen:The ECCPASE bit is set to ‘ 1’. The ECCPASE will\nremain set until cleared in firmware or an auto-restart\noccurs (see Section 11.4.5 “Auto-Restart Mode” ).\nThe enabled PWM pins are asynchronously placed in\ntheir shutdown states. The PWM output pins are\ngrouped into pairs [P1A/P1C ] and [P1B/P1D]. The state\nof each pin pair is determined by the PSSAC andPSSBD bits of the ECCPAS register. Each pin pair may\nbe placed into one of three states:\n\x81 Drive logic ‘ 1’\n\x81 Drive logic ‘ 0’\n\x81 Tri-state (high-impedance)\n  \nREGISTER 11-2: ECCPAS: ENHANCED CAPTURE/COMPARE/PWM AUTO-SHUTDOWN \nCONTROL REGISTER\nU-0 U-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nECCPASE ECCPAS2 ECCPAS1 ECCPAS0 PSSAC1 PSSAC0 PSSBD1 PSSBD0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 ECCPASE: ECCP Auto-Shutdown Event Status bit \n1 = A shutdown event has occurred; ECCP outputs are in shutdown state\n0 = ECCP outputs are operating\nbit 6-4 ECCPAS<2:0>:  ECCP Auto-shutdown Source Select bits\n000 = Auto-Shutdown is disabled\n001 = Comparator 1 output change\n010 = Comparator 2 output change\n011 = Either Comparator 1 or 2 change\n100 =V IL on INT pin\n101 =V IL on INT pin or Comparator 1 change\n110 =V IL on INT pin or Comparator 2 change\n111 =V IL on INT pin or Comparator 1 or 2 change\nbit 3-2 PSSACn:  Pins P1A and P1C Shutdown State Control bits\n00 = Drive pins P1A and P1C to ‘ 0’\n01 = Drive pins P1A and P1C to ‘ 1’\n1x = Pins P1A and P1C tri-state\nbit 1-0 PSSBDn:  Pins P1B and P1D Shutdown State Control bits\n00 = Drive pins P1B and P1D to ‘ 0’\n01 = Drive pins P1B and P1D to ‘ 1’\n1x = Pins P1B and P1D tri-state\nPIC16F684\nDS41202F-page 94 © 2007 Microchip Technology Inc.FIGURE 11-14: PWM AUTO-SHUTDOWN WITH FIRMWARE RESTART (PRSEN = 0) \n11.4.5 AUTO-RESTART MODE\nThe Enhanced PWM can be configured to automati-\ncally restart the PWM signal once the auto-shutdowncondition has been removed. Auto-restart is enabled by\nsetting the PRSEN bit in the PWM1CON register.\nIf auto-restart is enabled, the ECCPASE bit will remain\nset as long as the auto-shutdown condition is active.When the auto-shutdown condition is removed, the\nECCPASE bit will be cleared via hardware and normal\noperation will resume.\nFIGURE 11-15: PWM AUTO-SHUTDOWN WITH AUTO-RESTART ENABLED (PRSEN = 1) Note 1: The auto-shutdown condition is a\nlevel-based signal, not an edge-based\nsignal. As long as the level is present, theauto-shutdown will persist.\n2:Writing to the ECCPASE bit is disabled\nwhile an auto-shutdown condition\npersists.\n3:Once the auto-shutdown condition has\nbeen removed and the PWM restarted\n(either through firmware or auto-restart)\nthe PWM signal will always restart at thebeginning of the next PWM period.\nShutdown\nPWMECCPASE bit\nActivityEvent\nShutdown\nEvent OccursShutdown\nEvent ClearsPWM\nResumesNormal PWM\nStart of\nPWM PeriodECCPASE\nCleared by\nFirmwarePWM Period\nShutdown\nPWMECCPASE bit\nActivityEvent\nShutdown\nEvent OccursShutdown\nEvent ClearsPWM\nResumesNormal PWM\nStart of\nPWM PeriodPWM Period\n© 2007 Microchip Technology Inc. DS41202F-page 95PIC16F684\n11.4.6 PROGRAMMABLE DEAD-BAND \nDELAY MODE\nIn half-bridge applications where all power switches are\nmodulated at the PWM frequency, the power switchesnormally require more time to turn off than to turn on. If\nboth the upper and lower power switches are switched\nat the same time (one turned on, and the other turnedoff), both switches may be on for a short period of time\nuntil one switch completely turns off. During this brief\ninterval, a very high current ( shoot-through current ) will\nflow through both power switches, shorting the bridge\nsupply. To avoid this potentially destructive\nshoot-through current from flowing during switching,turning on either of the power switches is normally\ndelayed to allow the other switch to completely turn off.\nIn Half-Bridge mode, a digitally programmable\ndead-band delay is available to avoid shoot-throughcurrent from destroying the bridge power switches. The\ndelay occurs at the signal transition from the non-active\nstate to the active state. See Section FIGURE 11-17:\n“Example of Half-Bridge Applications”  for\nillustration. The lower seven bits of the associated\nPWM1CON register (Register 11-3) sets the delayperiod in terms of microcontroller instruction cycles\n(T\nCY or 4 T OSC).FIGURE 11-16: EXAMPLE OF \nHALF-BRIDGE PWM OUTPUT\nFIGURE 11-17: EXAMPLE OF HALF-BRIDGE APPLICATIONSPeriod\nPulse Width\ntd\ntd\n(1)P1A(2)\nP1B(2)\ntd = Dead-Band DelayPeriod\n(1) (1)\nNote 1: At this time, the TMR2 register is equal to the\nPR2 register.\n2:Output signals are shown as active-high.\nP1A\nP1BFET\nDriver\nFET\nDriverV+\nV-Load\n+\nV\n-+\nV\n-Standard Half-Bridge Circuit (“Push-Pull”)\nPIC16F684\nDS41202F-page 96 © 2007 Microchip Technology Inc.  \nTABLE 11-5: SUMMARY OF REGISTERS ASSOCIATED WITH CAPTURE, COMPARE AND PWM     REGISTER 11-3: PWM1CON: ENHANCED PWM CONTROL REGISTER\nR/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0 R/W-0\nPRSEN PDC6 PDC5 PDC4 PDC3 PDC2 PDC1 PDC0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7 PRSEN: PWM Restart Enable bit\n1 = Upon auto-shutdown, the ECCPASE bit clears automatically once the shutdown event goes\naway; the PWM restarts automatically\n0 = Upon auto-shutdown, ECCPASE must be cleared in software to restart the PWM\nbit 6-0 PDC<6:0>: PWM Delay Count bits\nPDCn = Number of F\nOSC/4 (4 * T OSC) cycles between the scheduled time when a PWM signal\nshould  transition active and the actual  time it transitions active\nNote 1: Bit resets to ‘ 0’ with Two-Speed Start-up and LP, XT or HS selected as the Oscillator mode or Fail-Safe \nmode is enabled.\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on:\nPOR, BORValue on\nall other\nResets\nCCPR1L Capture/Compare/PWM Register 1 Low Byte xxxx xxxx uuuu uuuu\nCCPR1H Capture/Compare/PWM Register 1 High Byte xxxx xxxx uuuu uuuu\nCCP1CON P1M1 P1M0 DC1B1 DC1B0 CCP1M3 CCP1M2 CCP1M1 CCP1M0 0000 0000 0000 0000\nCMCON0 C2OUT C1OUT C2INV C1INV CIS CM2 CM1 CM0 0000 0000 0000 0000\nCMCON1 — — — — — — T1GSS C2SYNC ---- --10 ---- --10\nECCPAS ECCPASE ECCPAS2 ECCPAS1 ECCPAS0 PSSAC1 PSSAC0 PSSBD1 PSSBD0 0000 0000 0000 0000\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPR2 Timer2 Module Period Register 1111 1111 1111 1111\nPWM1CON PRSEN PDC6 PDC5 PDC4 PDC3 PDC2 PDC1 PDC0 0000 0000 0000 0000\nT1CON T1GINV TMR1GE T1CKPS1 T1CKPS0 T1OSCEN T1SYNC TMR1CS TMR1ON 0000 0000 uuuu uuuu\nT2CON — TOUTPS3 TOUTPS2 TOUTPS1 TOUTPS0 TMR2ON T2CKPS1 T2CKPS0 -000 0000 -000 0000\nTMR1L Holding Register for the Least Significant Byte of the 16-bit TMR1 Register xxxx xxxx uuuu uuuu\nTMR1H Holding Register for the Most Significant Byte of the 16-bit TMR1 Register xxxx xxxx uuuu uuuu\nTMR2 Timer2 Module Register 0000 0000 0000 0000\nTRISA — — TRISA5 TRISA4 TRISA3 TRISA2 TRISA1 TRISA0 --11 1111 --11 1111\nTRISC — — TRISC5 TRISC4 TRISC3 TRISC2 TRISC1 TRISC0 --11 1111 --11 1111\nLegend:  - = Unimplemented locations, read as ‘ 0’, u = unchanged, x = unknown. Shaded cells are not used by the Capture, \nCompare and PWM.\n© 2007 Microchip Technology Inc. DS41202F-page 97PIC16F684\n12.0 SPECIAL FEATURES OF THE \nCPU\nThe PIC16F684 has a host of features intended to\nmaximize system reliability, minimize cost throughelimination of external components, provide power\nsaving features and offer code protection.\nThese features are:\x81 Reset\n- Power-on Reset (POR)\n- Power-up Timer (PWRT)- Oscillator Start-up Timer (OST)\n- Brown-out Reset (BOR)\n\x81 Interrupts\x81 Watchdog Timer (WDT)\n\x81 Oscillator selection\n\x81 Sleep\x81 Code protection\n\x81 ID Locations\n\x81 In-Circuit Serial Programming\nThe PIC16F684 has two timers that offer necessary\ndelays on power-up. One is the Oscillator Start-up\nTimer (OST), intended to keep the chip in Reset until\nthe crystal oscillator is stable. The other is thePower-up Timer (PWRT), which provides a fixed delay\nof 64 ms (nominal) on power-up only, designed to keep\nthe part in Reset while the power supply stabilizes.There is also circuitry to reset the device if a brown-out\noccurs, which can use the Power-up Timer to provide\nat least a 64 ms Reset. With these threefunctions-on-chip, most applications need no external\nReset circuitry.\nThe Sleep mode is designed to offer a very low-current\nPower-Down mode. The user can wake-up from Sleepthrough:\n\x81 External Reset\n\x81 Watchdog Timer Wake-up\x81 An interrupt\nSeveral oscillator options are also made available to\nallow the part to fit the application. The INTOSC optionsaves system cost while the LP crystal option saves\npower. A set of configuration bits are used to select\nvarious options (see Register 12-1).12.1 Configuration Bits\nThe Configuration bits can be programmed (read as‘0’), or left unprogrammed (read as ‘ 1’) to select various\ndevice configurations as shown in Register 12-1.\nThese bits are mapped in program memory location\n2007h.\nNote: Address 2007h is beyond the user program\nmemory space. It belongs to the special\nconfiguration memory space(2000h-3FFFh), which can be accessed\nonly during programming. See\n“PIC12F6XX/16F6XX  Memory Program-\nming Specification”  (DS41204) for more\ninformation.\nPIC16F684\nDS41202F-page 98 © 2007 Microchip Technology Inc.              \nREGISTER 12-1: CONFIG: CO NFIGURATION WORD REGISTER\n— — — — FCMEN IESO BOREN1 BOREN0\nbit 15 bit 8\nCPD CP MCLRE PWRTE WDTE FOSC2 FOSC1 FOSC0\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit P = Progra mmable’ U = Unimplemented bit, read as ‘0’\n-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 15-12 Unimplemented : Read as ‘ 1’\nbit 11 FCMEN: Fail-Safe Clock Monitor Enabled bit\n1 = Fail-Safe Clock Monitor is enabled\n0 = Fail-Safe Clock Monitor is disabled\nbit 10 IESO: Internal External Switchover bit\n1 = Internal External Switchover mode is enabled\n0 = Internal External Switchover mode is disabled\nbit 9-8 BOREN<1:0>:  Brown-out Reset Selection bits(1)\n11 = BOR enabled\n10 = BOR enabled during operation and disabled in Sleep\n01 = BOR controlled by SBOREN bit of the PCON register\n00 = BOR disabled\nbit 7 CPD : Data Code Protection bit(2)\n1 = Data memory code pr otection is disabled\n0 = Data memory code protection is enabled\nbit 6 CP: Code Protection bit(3)\n1 = Program memory code protection is disabled\n0 = Program memory code protection is enabled\nbit 5 MCLRE:  RA3/MCLR  pin function select bit(4)\n1 = RA3/MCLR  pin function is MCLR\n0 = RA3/MCLR  pin function is digital input, MCLR  internally tied to V DD\nbit 4 PWRTE : Power-up Timer Enable bit\n1 = PWRT disabled\n0 = PWRT enabled\nbit 3 WDTE:  Watchdog Timer Enable bit\n1 = WDT enabled\n0 = WDT disabled and can be enabled by SWDTEN bit of the WDTCON register\nbit 2-0 FOSC<2:0>:  Oscillator Selection bits\n111 = RC oscillator: CLKOUT function on RA4/OSC2/CLKOUT pin, RC on RA5/OSC1/CLKIN\n110 = RCIO oscillator: I/O function on RA4/OSC2/CLKOUT pin, RC on RA5/OSC1/CLKIN\n101 = INTOSC oscillator: CLKOUT function on RA4/OSC2/CLKOUT pin, I/O function on RA5/OSC1/CLKIN\n100 = INTOSCIO oscillator: I/O function on RA4/OSC2/CLKOUT pin, I/O function on RA5/OSC1/CLKIN\n011 = EC: I/O function on RA4/OSC2/CLKOUT pin, CLKIN on RA5/OSC1/CLKIN\n010 = HS oscillator: High-speed crystal/resonat or on RA4/OSC2/CLKOUT and RA5/OSC1/CLKIN\n001 = XT oscillator: Crystal/resonator on RA4/OSC2/CLKOUT and RA5/OSC1/CLKIN\n000 = LP oscillator: Low-power crysta l on RA4/OSC2/CLKOUT and RA5/OSC1/CLKIN\nNote 1: Enabling Brown-out Reset does not automatically enable Power-up Timer.\n2: The entire data EEPROM will be erased w hen the code protection is turned off.\n3: The entire program memory will be erased when the code protec tion is turned off.\n4: When MCLR  is asserted in INTOSC or RC mode, the internal clock oscillator is disabled.\n© 2007 Microchip Technology Inc. DS41202F-page 99PIC16F684\n12.2 Calibration Bits\nBrown-out Reset (BOR), Power-on Reset (POR) and\n8 MHz internal oscillator (HFINTOSC) are factory cali-brated. These calibration values are stored in fuses\nlocated in the Calibration Word (2009h). The Calibra-\ntion Word is not erased when using the specified bulkerase sequence in the “ PIC12F6XX/16F6XX Memory\nProgramming Specification”  (DS41244) and thus, does\nnot require reprogramming.\n12.3 Reset\nThe PIC16F684 differentiates between various kinds ofReset: \na) Power-on Reset (POR) \nb) WDT Reset during normal operationc) WDT Reset during Sleep \nd) MCLR\n Reset during normal operation\ne) MCLR  Reset during Sleep\nf) Brown-out Reset (BOR)Some registers are not affected in any Reset condition;\ntheir status is unknown on POR and unchanged in any\nother Reset. Most other registers are reset to a “Reset\nstate” on:\n\x81 Power-on Reset\n\x81M C L R  Reset\n\x81M C L R  Reset during Sleep\n\x81 WDT Reset\x81 Brown-out Reset (BOR)\nWDT wake-up does not cause register resets in the\nsame manner as a WDT Reset since wake-up isviewed as the resumption of normal operation. TO\n and\nPD bits are set or cleared differently in different Reset\nsituations, as indicated in Table 12-2. Software can usethese bits to determine the nature of the Reset. See\nTable 12-4 for a full description of Reset states of all\nregisters.\nA simplified block diagram of the On-Chip Reset Circuit\nis shown in Figure 12-1.\nThe MCLR\n Reset path has a noise filter to detect and\nignore small pulses. See Section 15.0 “Electrical\nSpecifications”  for pulse-width specifications.\nFIGURE 12-1: SIMPLIFIED BLOCK DIAGRAM OF ON-CHIP RESET CIRCUIT \nS\nRQExternal\nReset\nMCLR /VPP pin\nVDD\nOSC1/WDT\nModule\nVDD Rise\nDetect\nOST/PWRT\nLFINTOSCWDT\nTime-out\nPower-on Reset\nOST\n10-bit Ripple Counter\nPWRTChip_Reset\n11-bit Ripple CounterReset\nEnable OSTEnable PWRTSLEEP\nBrown-out(1)\nReset\nSBORENBOREN\nCLKI pin\nNote 1: Refer to the Configuration Word register (Register 12-1).\nPIC16F684\nDS41202F-page 100 © 2007 Microchip Technology Inc.12.3.1 POWER-ON RESET (POR)\nThe on-chip POR circuit holds the chip in Reset until\nVDD has reached a high enough level for proper\noperation. To take advantage of the POR, simply\nconnect the MCLR  pin through a resistor to V DD. This\nwill eliminate external RC components usually neededto create Power-on Reset. A maximum rise time for\nV\nDD is required. See Section 15.0 “Electrical\nSpecifications”  for details. If the BOR is enabled, the\nmaximum rise time specification does not apply. The\nBOR circuitry will keep the device in Reset until V DD\nreaches V BOR (see Section 12.3.4 “Brown-Out Reset\n(BOR)” ).\nWhen the device starts normal operation (exits the\nReset condition), device operating parameters (i.e.,voltage, frequency, temperature, etc.) must be met to\nensure proper operation. If these conditions are not\nmet, the device must be held in Reset until theoperating conditions are met.\nFor additional information, refer to Application Note\nAN607, “Power-up Trouble Shooting”  (DS00607).\n12.3.2 MCLR\nPIC16F684 has a noise filter in the MCLR  Reset path.\nThe filter will detect and ignore small pulses.\nIt should be noted that a WDT Reset does not drive\nMCLR  pin low.\nVoltages applied to the MCLR  pin that exceed its\nspecification can result in both MCLR  Resets and\nexcessive current beyond the device specificationduring the ESD event. For this reason, Microchip\nrecommends that the MCLR\n pin no longer be tied\ndirectly to V DD. The use of an RC network, as shown in\nFigure 12-2, is suggested.\nAn internal MCLR  option is enabled by clearing the\nMCLRE bit in the Configuration Word register. When\nMCLRE  = 0, the Reset signal to the chip is generated\ninternally. When the MCLRE  = 1, the RA3/MCLR  pin\nbecomes an external Reset input. In this mode, the\nRA3/MCLR  pin has a weak pull-up to V DD.FIGURE 12-2: RECOMMENDED MCLR  \nCIRCUIT\n12.3.3 POWER-UP TIMER (PWRT)\nThe Power-up Timer provides a fixed 64 ms (nominal)\ntime-out on power-up only, from POR or Brown-out\nReset. The Power-up Timer operates from the 31 kHz\nLFINTOSC oscillator. For more information, seeSection 3.5 “Internal Clock Modes” . The chip is kept\nin Reset as long as PWRT is active. The PWRT delay\nallows the V\nDD to rise to an acceptable level. A\nConfiguration bit, PWRTE , can disable (if set) or enable\n(if cleared or programmed) the Power-up Timer. The\nPower-up Timer should be enabled when Brown-outReset is enabled, although it is not required.\nThe Power-up Timer delay will varies from chip-to-chip\ndue to:\n\x81V\nDD variation\n\x81 Temperature variation\x81 Process variation\nSee DC parameters for details ( Section 15.0\n“Electrical Specifications” ).Note: The POR circuit does not produce an\ninternal Reset when V DD declines. To\nre-enable the POR, V DD must reach Vss\nfor a minimum of 100 μs.\nNote: Voltage spikes below V SS at the MCLR\npin, inducing currents greater than 80 mA,\nmay cause latch-up. Thus, a series resis-tor of 50-100 \nΩ should be used when\napplying a “low” level to the MCLR  pin,\nrather than pulling this pin directly to V SS.VDD \nPIC®\nMCLRR1\n1kΩ (or greater)\nC1\n0.1 μF\n(optional, not critical)R2\n100 Ω\n(needed with capacitor) SW1\n(optional)MCU\n© 2007 Microchip Technology Inc. DS41202F-page 101PIC16F684\n12.3.4 BROWN-OUT RESET (BOR)\nThe BOREN0 and BOREN1 bits in the Configuration\nWord register select one of four BOR modes. Twomodes have been added to allow software or hardware\ncontrol of the BOR enable. When BOREN<1:0> = 01,\nthe SBOREN bit of the PCON register enables/disablesthe BOR, allowing it to be controlled in software. By\nselecting BOREN<1:0> = 10, the BOR is automatically\ndisabled in Sleep to conserve power and enabled onwake-up. In this mode, the SBOREN bit is disabled.\nSee Register 12-1 for the Configuration Word\ndefinition.\nA brown-out occurs when V\nDD falls below V BOR for\ngreater than parameter T BOR (see Section 15.0\n“Electrical Specifications” ). The brown-out condition\nwill reset the device. This will occur regardless of V DD\nslew rate. A Brown-out Reset may not occur if V DD falls\nbelow V BOR for less than parameter T BOR. \nOn any Reset (Power-on, Brown-out Reset, Watchdog\nTimer, etc.), the chip will remain in Reset until V DD rises\nabove V BOR (see Figure 12-3). If enabled, the\nPower-up Timer will be invoked by the Reset and keep\nthe chip in Reset an additional 64 ms. If VDD drops below V BOR while the Power-up Timer is\nrunning, the chip will go back into a Brown-out Reset\nand the Power-up Timer will be re-initialized. Once V DD\nrises above V BOR, the Power-up Timer will execute a\n64 ms Reset.\n12.3.5 BOR CALIBRATION\nThe PIC16F684 stores the BOR calibration values in\nfuses located in the Calibration Word register (2008h).\nThe Calibration Word register is not erased when usingthe specified bulk erase sequence in the\n“PIC12F6XX/16F6XX  Memory Programming Specifi-\ncation ” (DS41204) and thus, does not require\nreprogramming. \n \nFIGURE 12-3:  BROWN-OUT SITUATIONS Note: The Power-up Timer is enabled by the\nPWRTE  bit in the Configuration Word\nregister.Note: Address 2008h is  beyond the user pro-\ngram memory space. It belongs to thespecial configuration memory space\n(2000h-3FFFh), which can be accessed\nonly during programming. See“PIC12F6XX/16F6XX  Memory Program-\nming Specification”  (DS41204) for more\ninformation.\n64 ms(1)VBOR VDD\nInternal\nReset\nVBOR VDD\nInternal\nReset 64 ms(1)< 64 ms\n64 ms(1)VBOR VDD\nInternal\nReset\nNote 1: 64 ms delay only if PWRTE  bit is programmed to ‘ 0’.\nPIC16F684\nDS41202F-page 102 © 2007 Microchip Technology Inc.12.3.6 TIME-OUT SEQUENCE\nOn power-up, the time-out sequence is as follows: \n\x81 PWRT time-out is invoked after POR has expired.\n\x81 OST is activated after the PWRT time-out has \nexpired.\nThe total time-out will vary based on oscillator\nconfiguration and PWRTE  bit status. For example, in EC\nmode with PWRTE  bit erased (PWRT disabled), there\nwill be no time-out at all.  Figure 12-4, Figure 12-5 and\nFigure 12-6 depict time-out sequences. The device canexecute code from the INTOSC while OST is active by\nenabling Two-Speed Start-up or Fail-Safe Monitor (see\nSection 3.7.2 “Two-speed Start-up Sequence”  and\nSection 3.8 “Fail-Safe Clock Monitor” ).\nSince the time-outs occur from the POR pulse, if MCLR\nis kept low long enough, the time-outs will expire. Then,\nbringing MCLR  high will begin execution immediately\n(see Figure 12-5). This is useful for testing purposes or\nto synchronize more than one PIC16F684 device\noperating in parallel.\nTable 12-5 shows the Reset conditions for some\nspecial registers, while Table 12-4 shows the Reset\nconditions for all the registers. 12.3.7 POWER CONTROL (PCON) \nREGISTER \nThe Power Control register PCON (address 8Eh) has\ntwo Status bits to indicate what type of Reset occurredlast.\nBit 0 is BOR\n (Brown-out). BOR  is unknown on\nPower-on Reset. It must then be set by the user and\nchecked on subsequent Resets to see if BOR  = 0,\nindicating that a Brown-out has occurred. The BOR\nStatus bit is a “don’t care” and is not necessarilypredictable if the brown-out circuit is disabled(BOREN<1:0>  = 00 in the Configuration Word\nregister).\nBit 1 is POR\n (Power-on Reset). It is a ‘ 0’ on Power-on\nReset and unaffected otherwise. The user must write a‘1’ to this bit following a Power-on Reset. On a subse-\nquent Reset, if POR\n is ‘0’, it will indicate that a\nPower-on Reset has occurred (i.e., V DD may have\ngone too low).\nFor more information, see Section 4.2.4 “Ultra\nLow-Power Wake-up”  and Section 12.3.4\n“Brown-Out Reset (BOR)” .\nTABLE 12-1: TIME-OUT IN VARIOUS SITUATIONS\nTABLE 12-2: STATUS/PCON BITS AND THEIR SIGNIFICANCE\nTABLE 12-3: SUMMARY OF REGISTERS ASSOCIATED WITH BROWN-OUT RESET   Oscillator ConfigurationPower-up Brown-out ResetWake-up from \nSleepPWRTE  = 0 PWRTE  = 1 PWRTE  = 0 PWRTE  = 1\nXT, HS, LP T PWRT  + 1024 \x81 \nTOSC1024 \x81 T OSC TPWRT  + 1024 \x81 \nTOSC1024 \x81 T OSC 1024 \x81 T OSC\nRC, EC, INTOSC T PWRT —T PWRT ——\nPOR BOR TO PD Condition\n0x11 Power-on Reset\nu011 Brown-out Reset\nuu0u WDT Reset\nuu00 WDT Wake-up\nuuuu MCLR  Reset during normal operation\nuu10 MCLR  Reset during Sleep\nLegend: u = unchanged, x = unknown\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on \nall other \nResets(1)\nPCON — — ULPWUE SBOREN — —P O R BOR--01 --qq --0u --uu\nSTATUS IRP RP1 RP0 TO PD Z DC C0001 1xxx 000q quuu\nLegend: u = unchanged, x = unknown, – = unimplemented bit, reads as ‘ 0’, q = value depends on condition. \nShaded cells are not used by BOR.\nNote 1: Other (non Power-up) Resets include MCLR  Reset and Watchdog Timer Reset during normal operation.\n© 2007 Microchip Technology Inc. DS41202F-page 103PIC16F684\nFIGURE 12-4: TIME-OUT SEQUENCE ON POWER-UP (DELAYED MCLR ): CASE 1\nFIGURE 12-5: TIME-OUT SEQUENCE ON POWER-UP (DELAYED MCLR ): CASE 2\nFIGURE 12-6: TIME-OUT SEQUENCE ON POWER-UP (MCLR  WITH V DD)TPWRT  \nTOST VDD\nMCLR\nInternal POR\nPWRT Time-out\nOST Time-out\nInternal Reset\nVDD\nMCLR\nInternal POR\nPWRT Time-out\nOST Time-out\nInternal ResetTPWRT  \nTOST \nTOSTVDD\nMCLR\nInternal POR\nPWRT Time-out\nOST Time-out\nInternal ResetTPWRT  \nPIC16F684\nDS41202F-page 104 © 2007 Microchip Technology Inc. \nTABLE 12-4: INITIALIZATION CONDITION FOR REGISTERS\nRegister AddressPower-on \nResetMCLR  Reset\nWDT Reset\nBrown-out Reset(1)Wake-up from Sleep through \nInterrupt\nWake-up from Sleep through \nWDT Time-out\nW— xxxx xxxx uuuu uuuu uuuu uuuu\nINDF 00h/80h xxxx xxxx xxxx xxxx uuuu uuuu\nTMR0 01h xxxx xxxx uuuu uuuu uuuu uuuu\nPCL 02h/82h 0000 0000 0000 0000 PC + 1(3)\nSTATUS 03h/83h 0001 1xxx 000q quuu(4)uuuq quuu(4)\nFSR 04h/84h xxxx xxxx uuuu uuuu uuuu uuuu\nPORTA(6)05h --x0 x000 --u0 u000 --uu uuuu\nPORTC(6)07h --xx 0000 --uu 0000 --uu uuuu\nPCLATH 0Ah/8Ah ---0 0000 ---0 0000 ---u uuuu\nINTCON 0Bh/8Bh 0000 0000 0000 0000 uuuu uuuu(2)\nPIR1 0Ch 0000 0000 0000 0000 uuuu uuuu(2)\nTMR1L 0Eh xxxx xxxx uuuu uuuu uuuu uuuu\nTMR1H 0Fh xxxx xxxx uuuu uuuu uuuu uuuu\nT1CON 10h 0000 0000 uuuu uuuu -uuu uuuu\nTMR2 11h 0000 0000 0000 0000 uuuu uuuu\nT2CON 12h -000 0000 -000 0000 -uuu uuuu\nCCPR1L 13h xxxx xxxx uuuu uuuu uuuu uuuu\nCCPR1H 14h xxxx xxxx uuuu uuuu uuuu uuuu\nCCP1CON 15h 0000 0000 0000 0000 uuuu uuuu\nPWM1CON 16h 0000 0000 0000 0000 uuuu uuuu\nECCPAS 17h 0000 0000 0000 0000 uuuu uuuu\nWDTCON 18h ---0 1000 ---0 1000 ---u uuuu\nCMCON0 19h 0000 0000 0000 0000 uuuu uuuu\nCMCON1 1Ah ---- --10 ---- --10 ---- --uu\nADRESH 1Eh xxxx xxxx uuuu uuuu uuuu uuuu\nADCON0 1Fh 00-0 0000 00-0 0000 uu-u uuuu\nOPTION_REG 81h 1111 1111 1111 1111 uuuu uuuu\nTRISA 85h --11 1111 --11 1111 --uu uuuu\nTRISC 87h --11 1111 --11 1111 --uu uuuu\nPIE1 8Ch 0000 0000 0000 0000 uuuu uuuu\nPCON 8Eh --01 --0x --0u --uq(1, 5)--uu --uu\nOSCCON 8Fh -110 x000 -110 q000 -uuu uuuu\nLegend: u = unchanged, x = unknown, – = unimplemented bit, reads as ‘ 0’, q = value depends on condition.\nNote 1: If VDD goes too low, Power-on Reset will be activated and registers will be affected differently.\n2:One or more bits in INTCON and/or PIR1 will be affected (to cause wake-up).\n3:When the wake-up is due to an interrupt and the GIE bit is set, the PC is loaded with the interrupt \nvector (0004h).\n4:See Table 12-5 for Reset value for specific condition.\n5:If Reset was due to brown-out, then bit 0 = 0. All other Resets will cause bit 0 = u.\n6:Port pins with analog functions controlled by the ANSEL register will read ‘ 0’ immediately after a Reset \neven though the data latches are either undefined (POR) or unchanged (other Resets).\n© 2007 Microchip Technology Inc. DS41202F-page 105PIC16F684\nTABLE 12-5: INITIALIZATION CONDITION FOR SPECIAL REGISTERSOSCTUNE 90h ---0 0000 ---u uuuu ---u uuuu\nANSEL 91h 1111 1111 1111 1111 uuuu uuuu\nPR2 92h 1111 1111 1111 1111 1111 1111\nWPUA 95h --11 -111 --11 -111 uuuu uuuu\nIOCA 96h --00 0000 --00 0000 --uu uuuu\nVRCON 99h 0-0- 0000 0-0- 0000 u-u- uuuu\nEEDAT 9Ah 0000 0000 0000 0000 uuuu uuuu\nEEADR 9Bh 0000 0000 0000 0000 uuuu uuuu\nEECON1 9Ch ---- x000 ---- q000 ---- uuuu\nEECON2 9Dh ---- ---- ---- ---- ---- ----\nADRESL 9Eh xxxx xxxx uuuu uuuu uuuu uuuu\nADCON1 9Fh -000 ---- -000 ---- -uuu ----\nConditionProgram\nCounterStatus\nRegisterPCON\nRegister\nPower-on Reset 000h 0001 1xxx --01 --0x\nMCLR  Reset during normal operation 000h 000u uuuu --0u --uu\nMCLR  Reset during Sleep 000h 0001 0uuu --0u --uu\nWDT Reset 000h 0000 uuuu --0u --uu\nWDT Wake-up PC + 1 uuu0 0uuu --uu --uu\nBrown-out Reset 000h 0001 1uuu --01 --u0\nInterrupt Wake-up from Sleep PC + 1(1)uuu1 0uuu --uu --uu\nLegend: u = unchanged,   x = unknown, – = unimplemented bit, reads as ‘ 0’.\nNote 1: When the wake-up is due to an interrupt and Global Interrupt Enable bit, GIE, is set, the PC is loaded with \nthe interrupt vector (0004h) after execution of PC + 1.TABLE 12-4: INITIALIZATION CONDITION FOR REGISTERS (CONTINUED)\nRegister AddressPower-on \nResetMCLR  Reset\nWDT Reset (Continued)\nBrown-out Reset(1)Wake-up from Sleep through \nInterrupt\nWake-up from Sleep through \nWDT Time-out (Continued)\nLegend: u = unchanged, x = unknown, – = unimplemented bit, reads as ‘ 0’, q = value depends on condition.\nNote 1: If VDD goes too low, Power-on Reset will be activated and registers will be affected differently.\n2:One or more bits in INTCON and/or PIR1 will be affected (to cause wake-up).\n3:When the wake-up is due to an interrupt and the GIE bit is set, the PC is loaded with the interrupt \nvector (0004h).\n4:See Table 12-5 for Reset value for specific condition.\n5:If Reset was due to brown-out, then bit 0 = 0. All other Resets will cause bit 0 = u.\n6:Port pins with analog functions controlled by the ANSEL register will read ‘ 0’ immediately after a Reset \neven though the data latches are either undefined (POR) or unchanged (other Resets).\nPIC16F684\nDS41202F-page 106 © 2007 Microchip Technology Inc.12.4 Interrupts\nThe PIC16F684 has 11 sources of interrupt:\n\x81 External Interrupt RA2/INT\n\x81 Timer0 Overflow Interrupt\n\x81 PORTA Change Interrupts\x81 2 Comparator Interrupts\n\x81 A/D Interrupt\n\x81 Timer1 Overflow Interrupt\x81 Timer2 Match Interrupt\n\x81 EEPROM Data Write Interrupt\n\x81 Fail-Safe Clock Monitor Interrupt\x81 Enhanced CCP Interrupt\nThe Interrupt Control register (INTCON) and Peripheral\nInterrupt Request Register 1 (PIR1) record individualinterrupt requests in flag bits. The INTCON register\nalso has individual and global interrupt enable bits. \nThe Global Interrupt Enable bit, GIE of the INTCON\nregister, enables (if set) all unmasked interrupts, ordisables (if cleared) all interrupts. Individual interrupts\ncan be disabled through their corresponding enable\nbits in the INTCON register and PIE1 register. GIE iscleared on Reset.\nWhen an interrupt is serviced, the following actions\noccur automatically:\n\x81 The GIE is cleared to disable any further interrupt.\n\x81 The return address is pushed onto the stack.\n\x81 The PC is loaded with 0004h.\nThe Return from Interrupt instruction, RETFIE , exits\nthe interrupt routine, as well as sets the GIE bit, which\nre-enables unmasked interrupts.\nThe following interrupt flags are contained in the\nINTCON register:\n\x81 INT Pin Interrupt\n\x81 PORTA Change Interrupt\n\x81 Timer0 Overflow Interrupt\nThe peripheral interrupt flags are contained in the PIR1\nregister. The corresponding interrupt enable bit is\ncontained in the PIE1 register.\nThe following interrupt flags are contained in the PIR1\nregister:\n\x81 EEPROM Data Write Interrupt\n\x81 A/D Interrupt\x81 2 Comparator Interrupts\n\x81 Timer1 Overflow Interrupt\n\x81 Timer2 Match Interrupt\x81 Fail-Safe Clock Monitor Interrupt\n\x81 Enhanced CCP InterruptFor external interrupt events, such as the INT pin or\nPORTA change interrupt, the interrupt latency will be\nthree or four instruction cycles. The exact latency\ndepends upon when the interrupt event occurs (seeFigure 12-8). The latency is the same for one or\ntwo-cycle instructions. Once in the Interrupt Service\nRoutine, the source(s) of the interrupt can bedetermined by polling the interrupt flag bits. The\ninterrupt flag bit(s) must be cleared in software before\nre-enabling interrupts to avoid multiple interruptrequests. \nFor additional information on Timer1, Timer2,\ncomparators, ADC, data EEPROM or Enhanced CCPmodules, refer to the respective peripheral section.\n12.4.1 RA2/INT INTERRUPT\nThe external interrupt on the RA2/INT pin is\nedge-triggered; either on the rising edge if the INTEDG\nbit of the OPTION register is set, or the falling edge, ifthe INTEDG bit is clear. When a valid edge appears on\nthe RA2/INT pin, the INTF bit of the INTCON register is\nset. This interrupt can be disabled by clearing the INTEcontrol bit of the INTCON register. The INTF bit must\nbe cleared by software in the Interrupt Service Routine\nbefore re-enabling this interrupt. The RA2/INT interruptcan wake-up the processor from Sleep, if the INTE bit\nwas set prior to going into Sleep. See Section 12.7\n“Power-Down Mode (Sleep)”  for details on Sleep and\nFigure 12-10 for timing of wake-up from Sleep through\nRA2/INT interrupt.Note 1: Individual interrupt flag bits are set,\nregardless of the status of their\ncorresponding mask bit or the GIE bit.\n2:When an instruction that clears the GIE\nbit is executed, any interrupts that werepending for execution in the next cycle\nare ignored. The interrupts, which were\nignored, are still pending to be servicedwhen the GIE bit is set again.\nNote: The ANSEL and CMCON0 registers must\nbe initialized to configure an analog\nchannel as a digital input. Pins configured\nas analog inputs will read ‘ 0’ and cannot\ngenerate an interrupt.\n© 2007 Microchip Technology Inc. DS41202F-page 107PIC16F684\n12.4.2 TIMER0 INTERRUPT\nAn overflow (FFh → 00h) in the TMR0 register will set\nthe T0IF bit of the INTCON register. The interrupt canbe enabled/disabled by setting/clearing T0IE bit of the\nINTCON register. See Section 5.0 “Timer0 Module”\nfor operation of the Timer0 module.12.4.3 PORTA INTERRUPT-ON-CHANGE\nAn input change on PORTA sets the RAIF bit of theINTCON register. The interrupt can beenabled/disabled by setting/clearing the RAIE bit of the\nINTCON register. Plus, individual pins can be\nconfigured through the IOCA register. \nFIGURE 12-7: INTERRUPT LOGIC Note: If a change on the I/O pin should occur\nwhen any PORTA operation is beingexecuted, then the RAIF interrupt flag may\nnot get set.\nTMR1IF\nTMR1IE\nC1IF\nC1IET0IF\nT0IE\nINTF\nINTE\nRAIF\nRAIE\nGIEPEIEWake-up (If in Sleep mode)(1)\nInterrupt to CPU\nEEIEEEIFADIF\nADIEIOC-RA0\nIOCA0\nIOC-RA1\nIOCA1\nIOC-RA2\nIOCA2\nIOC-RA3\nIOCA3\nIOC-RA4\nIOCA4\nIOC-RA5\nIOCA5\nTMR2IF\nTMR2IE\nCCP1IF\nCCP1IEOSFIFOSFIEC2IFC2IE\nNote 1: Some peripherals depend upon the system clock for\noperation. Since the system clock is suspended during Sleep, only \nthose peripherals which do not depend upon the system clock will wake\n \nthe part from Sleep. See Section 12.7.1 “Wake-up from Sleep” .\nPIC16F684\nDS41202F-page 108 © 2007 Microchip Technology Inc.FIGURE 12-8: INT PIN INTERRUPT TIMING\nTABLE 12-6: SUMMARY OF REGISTERS ASSOCIATED WITH INTERRUPTS\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on\nall other\nResets\nINTCON GIE PEIE T0IE INTE RAIE T0IF INTF RAIF 0000 0000 0000 0000\nIOCA — — IOCA5 IOCA4 IOCA3 IOCA2 IOCA1 IOCA0 --00 0000 --00 0000\nPIR1 EEIF ADIF CCP1IF C2IF C1IF OSFIF TMR2IF TMR1IF 0000 0000 0000 0000\nPIE1 EEIE ADIE CCP1IE C2IE C1IE OSFIE TMR2IE TMR1IE 0000 0000 0000 0000\nLegend: x = unknown, u = unchanged, – = unimplemented read as ‘ 0’, q = value depends upon condition. \nShaded cells are not used by the interrupt module.Q2 Q1 Q3 Q4 Q2 Q1 Q3 Q4 Q2 Q1 Q3 Q4 Q2 Q1 Q3 Q4 Q2 Q1 Q3 Q4\nOSC1\nCLKOUT\nINT pin\nINTF flag\n(INTCON reg.)\nGIE bit\n(INTCON reg.)\nINSTRUCTION FLOW\nPC\nInstruction\nFetched\nInstruction\nExecutedInterrupt Latency\nPC PC + 1 PC + 1 0004h 0005h\nInst (0004h) Inst (0005h)\nDummy CycleInst (PC) Inst (PC + 1)\nInst (PC – 1)Inst (0004h) Dummy Cycle Inst (PC)—\nNote 1: INTF flag is sampled here (every Q1).\n2:Asynchronous interrupt latency = 3-4 T CY. Synchronous latency = 3 T CY, where T CY = instruction cycle time. Latency\nis the same whether Inst (PC) is a single cycle or a 2-cycle instruction.\n3:CLKOUT is available only in INTOSC and RC Oscillator modes.\n4:For minimum width of INT pulse, refer to AC specifications in Section 15.0 “Electrical Specifications” .\n5:INTF is enabled to be set any time during the Q4-Q1 cycles.(1)\n(2)(3)\n(4)\n(5)(1)\n© 2007 Microchip Technology Inc. DS41202F-page 109PIC16F684\n12.5 Context Saving During Interrupts\nDuring an interrupt, only the return PC value is saved\non the stack. Typically, users may wish to save keyregisters during an interrupt (e.g., W and STATUS\nregisters). This must be implemented in software.\nTemporary holding registers W_TEMP and\nSTATUS_TEMP should be placed in the last 16 bytesof GPR (see Figure 2-2). These 16 locations are\ncommon to all banks and do not require banking. This\nmakes context save and restore operations simpler.The code shown in Example 12-1 can be used to:\n\x81 Store the W register\n\x81 Store the STATUS register\x81 Execute the ISR code\n\x81 Restore the Status (and Bank Select Bit register)\n\x81 Restore the W register\nEXAMPLE 12-1:  SAVING STATUS AND W REGISTERS IN RAM Note: The PIC16F684 does not require saving\nthe PCLATH. However, if computed\nGOTO s are used in both the ISR and the\nmain code, the PCLATH must be savedand restored in the ISR.\nMOVWF W_TEMP ;Copy W to TEMP register\nSWAPF STATUS,W ;Swap status to be saved into W \n;Swaps are used because they do not affect the status bits\nMOVWF STATUS_TEMP ;Save status to bank zero STATUS_TEMP register:\n:(ISR) ;Insert user code here\n:SWAPF STATUS_TEMP,W ;Swap STATUS_TEMP register into W \n;(sets bank to original state)\nMOVWF STATUS ;Move W into STATUS registerSWAPF W_TEMP,F ;Swap W_TEMP\nSWAPF W_TEMP,W ;Swap W_TEMP into W\nPIC16F684\nDS41202F-page 110 © 2007 Microchip Technology Inc.12.6 Watchdog Timer (WDT)\nThe WDT has the following features:\n\x81 Operates from the LFINTOSC (31 kHz)\n\x81 Contains a 16-bit prescaler\n\x81 Shares an 8-bit prescaler with Timer0\x81 Time-out period is from 1 ms to 268 seconds\n\x81 Configuration bit and software controlled\nWDT is cleared under certain conditions described in\nTable 12-7.\n12.6.1 WDT OSCILLATOR\nThe WDT derives its time base from the 31 kHz\nLFINTOSC. The LTS bit of the OSCCON register doesnot reflect that the LFINTOSC is enabled.\nThe value of WDTCON is ‘ ---0 1000 ’ on all Resets.\nThis gives a nominal time base of 17 ms.12.6.2 WDT CONTROL\nThe WDTE bit is located in the Configuration Word\nregister. When set, the WDT runs continuously.\nWhen the WDTE bit in the Configuration Word register\nis set, the SWDTEN bit of the WDTCON register has no\neffect. If WDTE is clear, then the SWDTEN bit can be\nused to enable and disable the WDT. Setting the bit willenable it and clearing the bit will disable it.\nThe PSA and PS<2:0> bits of the OPTION register\nhave the same function as in previous versions of the\nPIC16F684 Family of microcontrollers. SeeSection 5.0 “Timer0 Module”  for more information.\nFIGURE 12-9: WATCHDOG TIMER BLOCK DIAGRAMNote: When the Oscillator Start-up Timer (OST)\nis invoked, the WDT is held in Reset,\nbecause the WDT Ripple Counter is used\nby the OST to perform the oscillator delaycount. When the OST count has expired,\nthe WDT will begin counting (if enabled).\nTABLE 12-7: WDT STATUS\nConditions WDT\nWDTE = 0\nClearedCLRWDT  Command\nOscillator Fail DetectedExit Sleep + System Clock = T1OSC, EXTRC, INTRC, EXTCLK\nExit Sleep + System Clock = XT, HS, LP Cleared until the end of OST31 kHzPSA16-bit WDT PrescalerFrom Timer0 Clock Source\nPrescaler(1)\n8\nPS<2:0>\nPSA\nWDT Time-outTo Timer0 WDTPS<3:0>\nWDTE from the Configuration Word Register1\n1 00\nSWDTEN from WDTCONLFINTOSC Clock\nNote 1: This is the shared Timer0/WDT prescaler. See Section 5.0 “Timer0 Module”  for more information.\n© 2007 Microchip Technology Inc. DS41202F-page 111PIC16F684\n              \nTABLE 12-8: SUMMARY OF REGISTERS ASSOCIATED WITH WATCHDOG TIMERREGISTER 12-2: WDTCON: WATCHDOG TIMER CONTROL REGISTER\nU-0 U-0 U-0 R/W-0 R/W-1 R/W-0 R/W-0 R/W-0\n— — — WDTPS3 WDTPS2 WDTPS1 WDTPS0 SWDTEN\nbit 7 bit 0\nLegend:\nR = Readable bit W = Writable bit U = Unimplemented bit, read as ‘0’-n = Value at POR ‘1’ = Bit is set ‘0’ = Bit is cleared x = Bit is unknown\nbit 7-5 Unimplemented: Read as ‘0’\nbit 4-1 WDTPS<3:0>:  Watchdog Timer Period Select bits\nBit Value = Prescale Rate0000   = 1:32\n0001   = 1:64\n0010   = 1:128\n0011   = 1:256\n0100   = 1:512 (Reset value)\n0101   = 1:1024\n0110   = 1:2048\n0111   = 1:4096\n1000   = 1:8192\n1001   = 1:16384\n1010   = 1:32768\n1011   = 1:65536\n1100   = Reserved\n1101   = Reserved\n1110   = Reserved\n1111   = Reserved\nbit 0 SWDTEN:  Software Enable or Disable the Watchdog Timer\n(1)\n1 = WDT is turned on\n0 = WDT is turned off (Reset value)\nNote 1: If WDTE Configuration bit = 1, then WDT is always enabled, irrespective of this control bit. If WDTE \nConfiguration bit = 0, then it is possible to turn WDT on/off with this control bit.\nName Bit 7 Bit 6 Bit 5 Bit 4 Bit 3 Bit 2 Bit 1 Bit 0Value on: \nPOR, BORValue on\nall other\nResets\nWDTCON — — — WDTPS3 WDTPS2 WSTPS1 WDTPS0 SWDTEN ---0 1000 ---0 1000\nOPTION_REG RAPU INTEDG T0CS T0SE PSA PS2 PS1 PS0 1111 1111 1111 1111\nCONFIG CPD CP MCLRE PWRTE WDTE FOSC2 FOSC1 FOSC0 — —\nLegend: Shaded cells are not used by the Watchdog Timer.\nNote 1: See Register 12-1 for operation of all Configuration Word register bits.\nPIC16F684\nDS41202F-page 112 © 2007 Microchip Technology Inc.12.7 Power-Down Mode (Sleep)\nThe Power-down mode is entered by executing a\nSLEEP  instruction.\nIf the Watchdog Timer is enabled:\x81 WDT will be cleared but keeps running.\n\x81P D\n bit in the STATUS register is cleared.\n\x81T O  bit is set.\n\x81 Oscillator driver is turned off.\x81 I/O ports maintain the status they had before SLEEP  \nwas executed (driving high, low or high-impedance).\nFor lowest current consumption in this mode, all I/O pins\nshould be either at V\nDD or V SS, with no external circuitry\ndrawing current from the I/O pin and the comparators\nand CV REF should be disabled. I/O pins that are\nhigh-impedance inputs should be pulled high or low\nexternally to avoid switching currents caused by floating\ninputs. The T0CKI input should also be at V DD or V SS for\nlowest current consumption. The contribution from\non-chip pull-ups on PORTA should be considered.\nThe MCLR  pin must be at a logic high level.      \n12.7.1 WAKE-UP FROM SLEEP\nThe device can wake-up from Sleep through one of the\nfollowing events:\n1. External Reset input on MCLR  pin.\n2. Watchdog Timer wake-up (if WDT was\nenabled).\n3. Interrupt from RA2/INT pin, PORTA change or a\nperipheral interrupt.\nThe first event will cause a device Reset. The two latter\nevents are considered a continuation of programexecution. The TO\n and PD  bits in the STATUS register\ncan be used to determine the cause of a device Reset.\nThe PD  bit, which is set on power-up, is cleared when\nSleep is invoked. TO  bit is cleared if WDT wake-up\noccurred.\nThe following peripheral interrupts can wake the device\nfrom Sleep:\n1. Timer1 interrupt. Timer1 must be operating as\nan asynchronous counter.\n2. ECCP Capture mode interrupt.3. A/D conversion (when A/D clock source is FRC).\n4. EEPROM write operation completion.\n5. Comparator output changes state.6. Interrupt-on-change.\n7. External Interrupt from INT pin.\nOther peripherals cannot generate interrupts since\nduring Sleep, no on-chip clocks are present.When the SLEEP  instruction is being executed, the next\ninstruction (PC + 1) is prefetched. For the device to\nwake-up through an interrupt event, the corresponding\ninterrupt enable bit must be set (enabled). Wake-upoccurs regardless of the state of the GIE bit. If the GIE\nbit is clear (disabled), the device continues execution at\nthe instruction after the SLEEP  instruction. If the GIE bit\nis set (enabled), the device executes the instruction\nafter the SLEEP  instruction, then branches to the inter-\nrupt address (0004h). In cases where the execution ofthe instruction following SLEEP is not desirable, the\nuser should have a NOP after the SLEEP  instruction.\nThe WDT is cleared when the device wakes up from\nSleep, regardless of the source of wake-up.\n12.7.2 WAKE-UP USING INTERRUPTS\nWhen global interrupts are disabled (GIE cleared) and\nany interrupt source has both its interrupt enable bit\nand interrupt flag bit set, one of the following will occur:\n\x81 If the interrupt occurs before  the execution of a \nSLEEP  instruction, the SLEEP  instruction will \ncomplete as a NOP. Therefore, the WDT and WDT \nprescaler and postscaler (if enabled) will not be cleared, the TO\n bit will not be set and the PD  bit \nwill not be cleared.\n\x81 If the interrupt occurs during or after  the \nexecution of a SLEEP  instruction, the device will \nImmediately wake-up from Sleep. The SLEEP  \ninstruction is executed. Therefore, the WDT and \nWDT prescaler and postscaler (if enabled) will be \ncleared, the TO  bit will be set and the PD  bit will \nbe cleared.\nEven if the flag bits were checked before executing a\nSLEEP  instruction, it may be possible for flag bits to\nbecome set before the SLEEP  instruction completes. To\ndetermine whether a SLEEP  instruction executed, test\nthe PD  bit. If the PD  bit is set, the SLEEP  instruction\nwas executed as a NOP.\nTo ensure that the WDT is cleared, a CLRWDT  instruction\nshould be executed before a SLEEP  instruction. See\nFigure 12-10 for more details.Note: It should be noted that a Reset generated\nby a WDT time-out does not drive MCLR\npin low.Note: If the global interrupts are disabled (GIE is\ncleared) and any interrupt source has both\nits interrupt enable bit and the correspond-ing interrupt flag bits set, the device will\nimmediately wake-up from Sleep.\n© 2007 Microchip Technology Inc. DS41202F-page 113PIC16F684\nFIGURE 12-10: WAKE-UP FROM SLEEP THROUGH INTERRUPT\n12.8 Code Protection\nIf the code protection bit(s) have not been\nprogrammed, the on-chip program memory can beread out using ICSP\n™ for verification purposes.\n12.9 ID Locations\nFour memory locations (2000h-2003h) are designatedas ID locations where the user can store checksum or\nother code identification numbers. These locations are\nnot accessible during normal execution but arereadable and writable during Program/Verify mode.\nOnly the Least Significant 7 bits of the ID locations are\nused.Q1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1 Q1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1 Q2 Q3 Q4 Q1 Q2 Q3 Q4\nOSC1\nCLKOUT(4)\nINT pin\nINTF flag\n(INTCON reg.)\nGIE bit\n(INTCON reg.)\nInstruction Flow\nPC\nInstruction\nFetched\nInstruction\nExecutedPC PC + 1 PC + 2\nInst(PC) = Sleep\nInst(PC – 1)Inst(PC + 1)\nSleepProcessor in\nSleepInterrupt Latency(3)\nInst(PC + 2)\nInst(PC + 1)Inst(0004h) Inst(0005h)\nInst(0004h) Dummy CyclePC + 2 0004h 0005h\nDummy CycleTOST(2)\nPC + 2\nNote 1: XT, HS or LP Oscillator mode assumed.\n2: TOST = 1024 T OSC (drawing not to scale). This delay does not apply to EC, INTOSC and RC Oscillator modes.\n3: GIE = ‘1’ assumed. In this case after wake-up, the processor jumps to 0004h. If GIE = ‘ 0’, execution will continue in-line.\n4: CLKOUT is not available in XT, HS, LP or EC Oscillator modes, but shown here for timing reference.\nNote: The entire data EEPROM and Flash pro-\ngram memory will be erased when the\ncode protection is turned off. See the\n“PIC12F6XX/16F6XX  Memory\nProgramming Specification”  (DS41204)\nfor more information.\nPIC16F684\nDS41202F-page 114 © 2007 Microchip Technology Inc.12.10 In-Circuit Serial Programming\nThe PIC16F684 microcontrollers can be serially\nprogrammed while in the end application circuit. This issimply done with five connections for:\n\x81c l o c k\n\x81d a t a\x81 power\n\x81 ground\n\x81 programming voltage\nThis allows customers to manufacture boards with\nunprogrammed devices and then program the micro-\ncontroller just before shipping the product. This also\nallows the most recent firmware or a custom firmwareto be programmed.\nThe device is placed into a Program/Verify mode by\nholding the RA0 and RA1 pins low, while raising the\nMCLR\n (V PP) pin from V IL to V IHH. See the\n“PIC12F6XX/16F6XX  Memory Programming\nSpecification”  (DS41204) for more information. RA0\nbecomes the programming data and RA1 becomes theprogramming clock. Both RA0 and RA1 are Schmitt\nTrigger inputs in Program/Verify mode.\nA typical In-Circuit Serial Programming connection is\nshown in Figure 12-11.\nFIGURE 12-11: TYPICAL IN-CIRCUIT \nSERIAL PROGRAMMING CONNECTION12.11 In-Circuit Debugger\nSince in-circuit debugging requires access to three\npins, MPLAB® ICD 2 development with a 14-pin device\nis not practical. A special 20-pin PIC16F684 ICD device\nis used with MPLAB ICD 2 to provide separate clock,\ndata and MCLR  pins and frees all normally available\npins to the user.\nA special debugging adapter allows the ICD device to\nbe used in place of a PIC16F684 device. The\ndebugging adapter is the only source of the ICD device.\nWhen the ICD  pin on the PIC16F684 ICD device is held\nlow, the In-Circuit Debugger functionality is enabled.\nThis function allows simple debugging functions when\nused with MPLAB ICD 2. When the microcontroller hasthis feature enabled, some of the resources are not\navailable for general use. Table 12-9 shows which\nfeatures are consumed by the background debugger.\nTABLE 12-9: DEBUGGER RESOURCES\nFor more information, see “ MPLAB® ICD 2 In-Circuit\nDebugger User’s Guide”  (DS51331), available on\nMicrochip’s web site (www.microchip.com).\nFIGURE 12-12: 20-PIN ICD PINOUT    \nExternal\nConnector\nSignalsTo Normal\nConnections\nTo Normal\nConnectionsPIC16F684\nVDD\nVSS\nMCLR /VPP/RA3\nRA1\nRA0+5V\n0V\nVPP\nCLK\nData I/O\n* * **\n* Isolation devices (as required)Resource Description\nI/O pins ICDCLK, ICDDATA\nStack 1 level\nProgram Memory Address 0h must be NOP\n700h-7FFh\n20-Pin PDIP\nPIC16F684-ICDIn-Circuit Debug Device\nNC\nICDMCLR /VPP\nVDD\nRA5\nRA4\nRA3ICDCLK\nICDDATA\nVss\nRA0\nICD NCRA1\nRA2\nRC5\nRC4\nRC3RC0\nRC1\nRC21\n2\n3\n4\n5\n6\n7\n8\n9\n1020\n19\n18\n17\n16\n15\n14\n13\n12\n11\n© 2007 Microchip Technology Inc. DS41202F-page 115PIC16F684\n13.0 INSTRUCTION SET SUMMARY\nThe PIC16F684 instruction set is highly orthogonal and\nis comprised of three basic categories:\n\x81Byte-oriented operations\n\x81Bit-oriented operations\n\x81Literal and control operations\nEach PIC16 instruction is a 14-bit word divided into an\nopcode,  which specifies the instruction type and one or\nmore operands,  which further specify the operation of\nthe instruction. The formats for each of the categoriesis presented in Figure 13-1, while the various opcode\nfields are summarized in Table 13-1.\nTable 13-2 lists the instructions recognized by the\nMPASM\nTM assembler.\nFor byte-oriented instructions, ‘f’ represents a file\nregister designator and ‘d’ represents a destination\ndesignator. The file register designator specifies which\nfile register is to be used by the instruction.\nThe destination designator specifies where the result of\nthe operation is to be placed. If ‘d’ is zero, the result is\nplaced in the W register. If ‘d’ is one, the result is placed\nin the file register specified in the instruction.\nFor bit-oriented instructions, ‘b’ represents a bit field\ndesignator, which selects the bit affected by the\noperation, while ‘f’ represents the address of the file in\nwhich the bit is located.\nFor literal and control operations, ‘k’ represents an\n8-bit or 11-bit constant, or literal value.\nOne instruction cycle consists of four oscillator periods;\nfor an oscillator frequency of 4 MHz, this gives a\nnominal instruction execution time of 1 μs. All\ninstructions are executed within a single instruction\ncycle, unless a conditional test is true, or the program\ncounter is changed as a result of an instruction. Whenthis occurs, the execution takes two instruction cycles,\nwith the second cycle executed as a NOP.\nAll instruction examples use the format ‘ 0xhh ’ to\nrepresent a hexadecimal number, where ‘ h’ signifies a\nhexadecimal digit.\n13.1 Read-Modify-Write Operations\nAny instruction that specifies a file register as part of\nthe instruction performs a Read-Modify-Write (R-M-W)\noperation. The register is read, the data is modified,and the result is stored according to either the instruc-\ntion, or the destination designator ‘d’. A read operation\nis performed on a register even if the instruction writesto that register.\nFor example, a CLRF PORTA  instruction will read\nPORTA, clear all the data bits, then write the result back\nto PORTA. This example would have the unintendedconsequence of clearing the condition that set the RAIF\nflag.TABLE 13-1: OPCODE FIELD \nDESCRIPTIONS  \nFIGURE 13-1: GENERAL FORMAT FOR \nINSTRUCTIONS    Field Description\nfRegister file address (0x00 to 0x7F)\nW Working register (accumulator)\nb Bit address within an 8-bit file register\nkLiteral field, constant data or label\nxDon’t care location (= 0 or 1). \nThe assembler will generate code with x = 0. \nIt is the recommended form of use for compatibility with all Microchip software tools.\nd Destination select; d = 0: store result in W,\nd = 1: store result in file register f. \nDefault is d = 1.\nPC Program Counter\nTO Time-out bit\nC Carry bit\nDC Digit carry bit\nZ Zero bit\nPD Power-down bit\nByte-oriented file register operations\n13                          8     7    6                              0\nd = 0 for destination WOPCODE                 d              f (FILE #)\nd = 1 for destination f\nf = 7-bit file register address\nBit-oriented file register operations\n13                         10  9        7   6                       0\nOPCODE          b (BIT #)        f (FILE #)\nb = 3-bit bit address\nf = 7-bit file register address\nLiteral and control operations\n13                                  8    7                             0\nOPCODE                              k (literal)\nk = 8-bit immediate value\n13                 11    10                                          0\nOPCODE                        k (literal)\nk = 11-bit immediate valueGeneral\nCALL  and GOTO  instructions only\nPIC16F684\nDS41202F-page 116 © 2007 Microchip Technology Inc.TABLE 13-2: PIC16F684 INSTRUCTION SET   \nMnemonic,\nOperandsDescription Cycles14-Bit OpcodeStatus\nAffectedNotes\nMSb LSb\nBYTE-ORIENTED FILE REGISTER OPERATIONS\nADDWF\nANDWF\nCLRFCLRW\nCOMF\nDECFDECFSZ\nINCF\nINCFSZIORWF\nMOVF\nMOVWFNOP\nRLF\nRRFSUBWF\nSWAPF\nXORWFf, d\nf, d\nf\n–\nf, d\nf, df, d\nf, d\nf, df, d\nf, d\nf\n–\nf, d\nf, df, d\nf, d\nf, dAdd W and f\nAND W with f\nClear fClear W\nComplement f\nDecrement fDecrement f, Skip if 0\nIncrement f\nIncrement f, Skip if 0Inclusive OR W with f\nMove f\nMove W to fNo Operation\nRotate Left f through Carry\nRotate Right f through CarrySubtract W from f\nSwap nibbles in f\nExclusive OR W with f1\n1\n11\n1\n1\n1(2)\n1\n1(2)\n1\n1\n11\n1\n11\n1\n100\n00\n0000\n00\n0000\n00\n0000\n00\n0000\n00\n0000\n00\n000111\n0101\n00010001\n1001\n00111011\n1010\n11110100\n1000\n00000000\n1101\n11000010\n1110\n0110dfff\ndfff\nlfff0xxx\ndfff\ndfffdfff\ndfff\ndfffdfff\ndfff\nlfff\n0xx0\ndfff\ndfffdfff\ndfff\ndfffffff\nffff\nffffxxxx\nffff\nffffffff\nffff\nffffffff\nffff\nffff0000\nffff\nffffffff\nffff\nffffC, DC, Z\nZ\nZZ\nZ\nZ\nZ\nZ\nZ\nC\nC\nC, DC, Z\nZ1, 2\n1, 2\n2\n1, 2\n1, 2\n1, 2, 3\n1, 2\n1, 2, 3\n1, 2\n1, 2\n1, 2\n1, 21, 2\n1, 2\n1, 2\nBIT-ORIENTED FILE REGISTER OPERATIONS\nBCF\nBSF\nBTFSC\nBTFSSf, b\nf, b\nf, b\nf, bBit Clear f\nBit Set f\nBit Test f, Skip if Clear\nBit Test f, Skip if Set1\n1\n1 (2)\n1 (2)01\n01\n01\n0100bb\n01bb\n10bb\n11bbbfff\nbfff\nbfff\nbfffffff\nffff\nffff\nffff1, 2\n1, 2\n3\n3\nLITERAL AND CONTROL OPERATIONS\nADDLW\nANDLWCALL\nCLRWDT\nGOTOIORLW\nMOVLW\nRETFIERETLW\nRETURN\nSLEEPSUBLW\nXORLWk\nkk\n–\nkk\nk\n–\nk\n––\nk\nkAdd literal and W\nAND literal with WCall Subroutine\nClear Watchdog Timer\nGo to addressInclusive OR literal with W\nMove literal to W\nReturn from interruptReturn with literal in W\nReturn from Subroutine\nGo into Standby modeSubtract W from literal\nExclusive OR literal with W1\n12\n1\n21\n1\n22\n2\n11\n111\n1110\n00\n1011\n11\n0011\n00\n0011\n11111x\n10010kkk\n0000\n1kkk1000\n00xx\n000001xx\n0000\n0000110x\n1010kkkk\nkkkkkkkk\n0110\nkkkkkkkk\nkkkk\n0000kkkk\n0000\n0110kkkk\nkkkkkkkk\nkkkkkkkk\n0100\nkkkkkkkk\nkkkk\n1001kkkk\n1000\n0011kkkk\nkkkkC, DC, Z\nZ\nTO\n, PD\nZ\nTO, PD\nC, DC, Z\nZ\nNote 1: When an I/O register is modified as a function of itself (e.g., MOVF GPIO, 1 ), the value used will be that value present \non the pins themselves. For example, if the data latch is ‘ 1’ for a pin configured as input and is driven low by an external \ndevice, the data will be written back with a ‘ 0’.\n2: If this instruction is executed on the TM R0 register (and where applicable, d = 1), the prescaler will be cleared if \nassigned to the Timer0 module.\n3: If the Program Counter (PC) is modified, or a conditional te st is true, the instruction requires two cycles. The second \ncycle is executed as a NOP.\n© 2007 Microchip Technology Inc. DS41202F-page 117PIC16F684\n13.2 Instruction Descriptions \nADDLW Add literal and W\nSyntax: [ label ]  ADDLW     k\nOperands: 0 ≤ k ≤ 255\nOperation: (W) + k → (W)\nStatus Affected: C, DC, ZDescription: The contents of the W register \nare added to the eight-bit literal ‘k’ and the result is placed in the \nW register.\nADDWF Add W and f\nSyntax: [ label ]  ADDWF     f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (W) + (f) → (destination)\nStatus Affected: C, DC, ZDescription: Add the contents of the W register \nwith register ‘f’. If ‘d’ is ‘ 0’, the \nresult is stored in the W register. If \n‘d’ is ‘1’, the result is stored back \nin register ‘f’.\nANDLW AND literal with W\nSyntax: [  label ]  ANDLW     k\nOperands: 0 ≤ k ≤ 255\nOperation: (W) .AND. (k) → (W)\nStatus Affected: ZDescription: The contents of W register are \nAND’ed with the eight-bit literal \n‘k’. The result is placed in the W register.\nANDWF AND W with f\nSyntax: [  label ]  ANDWF     f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (W) .AND. (f) → (destination)\nStatus Affected: ZDescription: AND the W register with register \n‘f’. If ‘d’ is ‘0’, the result is stored in \nthe W register. If ‘d’ is ‘ 1’, the \nresult is stored back in register ‘f’.BCF Bit Clear f\nSyntax: [ label ] BCF     f,b\nOperands: 0 ≤ f ≤ 127\n0 ≤ b ≤ 7\nOperation: 0 → (f<b>)\nStatus Affected: NoneDescription: Bit ‘b’ in register ‘f’ is cleared.\nBSF Bit Set f\nSyntax: [ label ] BSF    f,b\nOperands: 0 ≤ f ≤ 127\n0 ≤ b ≤ 7\nOperation: 1 → (f<b>)\nStatus Affected: NoneDescription: Bit ‘b’ in register ‘f’ is set.\nBTFSC Bit Test, Skip if Clear\nSyntax: [ label ] BTFSC   f,b\nOperands: 0 ≤ f ≤ 127\n0 ≤ b ≤ 7\nOperation: skip if (f<b>) = 0\nStatus Affected: NoneDescription: If bit ‘b’ in register ‘f’ is ‘ 1’, the next \ninstruction is executed.\nIf bit ‘b’, in register ‘f’, is ‘ 0’, the \nnext instruction is discarded, and a NOP is executed instead, making \nthis a 2-cycle instruction.\nPIC16F684\nDS41202F-page 118 © 2007 Microchip Technology Inc.BTFSS Bit Test f, Skip if Set\nSyntax: [ label ] BTFSS   f,b\nOperands: 0 ≤ f ≤ 127\n0 ≤ b < 7\nOperation: skip if (f<b>) = 1\nStatus Affected: NoneDescription: If bit ‘b’ in register ‘f’ is ‘ 0’, the next \ninstruction is executed.\nIf bit ‘b’ is ‘ 1’, then the next\ninstruction is discarded and a NOP \nis executed instead, making this a \n2-cycle instruction.\nCALL Call Subroutine\nSyntax: [ label ]   CALL   k\nOperands: 0 ≤ k ≤ 2047\nOperation: (PC)+ 1 → TOS,\nk → PC<10:0>,\n(PCLATH<4:3>) → PC<12:11>\nStatus Affected: NoneDescription: Call Subroutine. First, return \naddress (PC + 1) is pushed onto \nthe stack. The eleven-bit \nimmediate address is loaded into PC bits <10:0>. The upper bits of \nthe PC are loaded from PCLATH. \nCALL  is a two-cycle instruction.\nCLRF Clear f\nSyntax: [  label ]  CLRF    f\nOperands: 0 ≤ f ≤ 127\nOperation: 00h → (f)\n1 → Z\nStatus Affected: ZDescription: The contents of register ‘f’ are \ncleared and the Z bit is set.\nCLRW Clear W\nSyntax: [ label ]   CLRW\nOperands: NoneOperation: 00h → (W)\n1 → Z\nStatus Affected: ZDescription: W register is cleared. Zero bit (Z) \nis set.CLRWDT Clear Watchdog Timer\nSyntax: [ label ]   CLRWDT\nOperands: NoneOperation: 00h → WDT\n0 → WDT prescaler,\n1 → TO\n1 → PD\nStatus Affected: TO , PD\nDescription: CLRWDT  instruction resets the \nWatchdog Timer. It also resets the \nprescaler of the WDT. \nStatus bits TO  and PD  are set.\nCOMF Complement f\nSyntax: [ label ]   COMF    f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f ) → (destination)\nStatus Affected: ZDescription: The contents of register ‘f’ are \ncomplemented. If ‘d’ is ‘ 0’, the \nresult is stored in W. If ‘d’ is ‘ 1’, \nthe result is stored back in\nregister ‘f’.\nDECF Decrement f\nSyntax: [ label ]   DECF f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) - 1 → (destination)\nStatus Affected: ZDescription: Decrement register ‘f’. If ‘d’ is ‘ 0’, \nthe result is stored in the W \nregister. If ‘d’ is ‘ 1’, the result is \nstored back in register ‘f’.\n© 2007 Microchip Technology Inc. DS41202F-page 119PIC16F684\nDECFSZ Decrement f, Skip if 0\nSyntax: [ label ]   DECFSZ   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) - 1 → (destination);     \nskip if result = 0\nStatus Affected: NoneDescription: The contents of register ‘f’ are \ndecremented. If ‘d’ is ‘ 0’, the result \nis placed in the W register. If ‘d’ is \n‘1’, the result is placed back in \nregister ‘f’. If the result is ‘ 1’, the next \ninstruction is executed. If the \nresult is ‘0’, then a NOP is \nexecuted instead, making it a \n2-cycle instruction.\nGOTO Unconditional Branch\nSyntax: [ label ]    GOTO   k\nOperands: 0 ≤ k ≤ 2047\nOperation: k → PC<10:0>\nPCLATH<4:3> → PC<12:11>\nStatus Affected: NoneDescription: GOTO  is an unconditional branch. \nThe eleven-bit immediate value is \nloaded into PC bits <10:0>. The upper bits of PC are loaded from \nPCLATH<4:3>. GOTO  is a \ntwo-cycle instruction.\nINCF Increment f\nSyntax: [ label ]    INCF   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) + 1 → (destination)\nStatus Affected: ZDescription: The contents of register ‘f’ are \nincremented. If ‘d’ is ‘ 0’, the result \nis placed in the W register. If ‘d’ is \n‘1’, the result is placed back in \nregister ‘f’.INCFSZ Increment f, Skip if 0\nSyntax: [ label ]    INCFSZ   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) + 1 → (destination),\n skip if result = 0\nStatus Affected: NoneDescription: The contents of register ‘f’ are \nincremented. If ‘d’ is ‘ 0’, the result \nis placed in the W register. If ‘d’ is \n‘1’, the result is placed back in \nregister ‘f’.If the result is ‘ 1’, the next \ninstruction is executed. If the \nresult is ‘0’, a NOP is executed \ninstead, making it a  2-cycle \ninstruction.\nIORLW Inclusive OR literal with W\nSyntax: [ label ]    IORLW   k\nOperands: 0 ≤ k ≤ 255\nOperation: (W) .OR. k → (W)\nStatus Affected: ZDescription: The contents of the W register are \nOR’ed with the eight-bit literal ‘k’. \nThe result is placed in the \nW register.\nIORWF Inclusive OR W with f\nSyntax: [ label ]    IORWF    f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (W) .OR. (f) → (destination)\nStatus Affected: ZDescription: Inclusive OR the W register with \nregister ‘f’. If ‘d’ is ‘ 0’, the result is \nplaced in the W register. If ‘d’ is \n‘1’, the result is placed back in \nregister ‘f’.\nPIC16F684\nDS41202F-page 120 © 2007 Microchip Technology Inc.MOVF Move f\nSyntax: [ label ]    MOVF   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) → (dest)\nStatus Affected: ZDescription: The contents of register f is \nmoved to a destination dependent \nupon the status of d. If d = 0,\ndestination is W register. If d = 1, \nthe destination is file register f \nitself. d = 1 is useful to test a file \nregister since status flag Z is \naffected.\nWords: 1Cycles: 1Example:\nMOVF FSR, 0\nAfter Instruction\nW=  v a l u e  i n  F S R  register\nZ=  1\nMOVLW Move literal to W\nSyntax: [ label ]    MOVLW   k\nOperands: 0 ≤ k ≤ 255\nOperation: k → (W)\nStatus Affected: NoneDescription: The eight-bit literal ‘k’ is loaded into \nW register. The “don’t cares” will \nassemble as ‘ 0’s.\nWords: 1Cycles: 1Example:\nMOVLW 0x5A\nAfter Instruction\nW= 0 x 5 AMOVWF Move W to f\nSyntax: [ label ]    MOVWF     f\nOperands: 0 ≤ f ≤ 127\nOperation: (W) → (f)\nStatus Affected: NoneDescription: Move data from W register to\nregister ‘f’.\nWords: 1Cycles: 1Example:\nMOVW\nFOPTION\nBefore Instruction\nOPTION = 0xFF\nW = 0x4F\nAfter Instruction\nOPTION = 0x4F\nW = 0x4F\nNOP No Operation\nSyntax: [ label ]    NOP\nOperands: NoneOperation: No operationStatus Affected: NoneDescription: No operation.Words: 1Cycles: 1Example:\nNOP\n© 2007 Microchip Technology Inc. DS41202F-page 121PIC16F684\nRETFIE Return from Interrupt\nSyntax: [ label ]    RETFIE\nOperands: NoneOperation: TOS → PC,\n1 → GIE\nStatus Affected: NoneDescription: Return from Interrupt. Stack is \nPOPed and Top-of-Stack (TOS) is \nloaded in the PC. Interrupts are enabled by setting Global\nInterrupt Enable bit, GIE \n(INTCON<7>). This is a two-cycle instruction.\nWords: 1Cycles: 2Example:\nRETFIE\nAfter Interrupt\nPC = TOS\nGIE =1RETLW Return with literal in W\nSyntax: [ label ]    RETLW   k\nOperands: 0 ≤ k ≤ 255\nOperation: k → (W); \nTOS → PC\nStatus Affected: NoneDescription: The W register is loaded with the \neight bit literal ‘k’. The program \ncounter is loaded from the top of the stack (the return address). \nThis is a two-cycle instruction.\nWords: 1Cycles: 2Example:\nTABLECALL TABLE;W contains \ntable\n;offset value\n\x81 ;W now has table value\n\x81\x81\nADDWF PC ;W = offset\nRETLW k1 ;Begin tableRETLW k2 ;\n\x81\n\x81\x81\nRETLW kn ; End of table\nBefore Instruction\nW = 0x07\nAfter Instruction\nW = value of k8\nRETURN Return from Subroutine\nSyntax: [ label ]    RETURN\nOperands: NoneOperation: TOS → PC\nStatus Affected: NoneDescription: Return from subroutine. The stack \nis POPed and the top of the stack (TOS) is loaded into the program \ncounter. This is a two-cycle \ninstruction.\nPIC16F684\nDS41202F-page 122 © 2007 Microchip Technology Inc.RLF Rotate Left f through Carry\nSyntax: [ label ] RLF    f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: See description belowStatus Affected: CDescription: The contents of register ‘f’ are \nrotated one bit to the left through the Carry flag. If ‘d’ is ‘ 0’, the \nresult is placed in the W register. \nIf ‘d’ is ‘1’, the result is stored \nback in register ‘f’.\nWords: 1\nCycles: 1Example:\nRLF REG1,0\nBefore Instruction\nREG1 = 1110 0110\nC= 0\nAfter Instruction\nREG1 = 1110 0110\nW = 1100 1100C= 1\nRRF Rotate Right f through Carry\nSyntax: [ label ]    RRF   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: See description belowStatus Affected: CDescription: The contents of register ‘f’ are \nrotated one bit to the right through \nthe Carry flag. If ‘d’ is ‘ 0’, the \nresult is placed in the W register. If ‘d’ is ‘1’, the result is placed \nback in register ‘f’.Register f C\nRegister f CSLEEP Enter Sleep mode\nSyntax: [ label  ] SLEEP\nOperands: NoneOperation: 00h → WDT,\n0 → WDT prescaler,\n1 → TO\n,\n0 → PD\nStatus Affected: TO , PD\nDescription: The power-down Status bit, PD  is \ncleared. Time-out Status bit, TO  \nis set. Watchdog Timer and its prescaler are cleared.\nThe processor is put into Sleep \nmode with the oscillator stopped. \nSUBLW Subtract W from literal\nSyntax: [ label ] SUBLW   k\nOperands: 0 ≤ k ≤ 255\nOperation: k - (W) → (W)\nStatus Affected: C, DC, ZDescription: The W register is subtracted (2’s \ncomplement method) from the \neight-bit literal ‘k’. The result is \nplaced in the W register.\nC = 0 W > k\nC = 1 W ≤ k\nDC = 0 W<3:0> > k<3:0>\nDC = 1 W<3:0> ≤ k<3:0>\n© 2007 Microchip Technology Inc. DS41202F-page 123PIC16F684\nSUBWF Subtract W from f\nSyntax: [ label ] SUBWF   f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f) - (W) → (destination)\nStatus Affected: C, DC, ZDescription: Subtract (2’s complement method) \nW register from register ‘f’. If ‘d’ is \n‘0’, the result is stored in the W \nregister. If ‘d’ is ‘ 1’, the result is \nstored back in register ‘f.\nSWAPF Swap Nibbles in f\nSyntax: [ label ] SWAPF f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (f<3:0>) → (destination<7:4>),\n(f<7:4>) → (destination<3:0>)\nStatus Affected: NoneDescription: The upper and lower nibbles of \nregister ‘f’ are exchanged. If ‘d’ is \n‘0’, the result is placed in the W \nregister. If ‘d’ is ‘ 1’, the result is \nplaced in register ‘f’.C = 0 W > f\nC = 1 W ≤ f\nDC = 0 W<3:0> > f<3:0>\nDC = 1 W<3:0> ≤ f<3:0>XORLW Exclusive OR literal with W\nSyntax: [ label ] XORLW   k\nOperands: 0 ≤ k ≤ 255\nOperation: (W) .XOR. k → (W)\nStatus Affected: ZDescription: The contents of the W register \nare XOR’ed with the eight-bitliteral ‘k’. The result is placed in \nthe W register.\nXORWF Exclusive OR W with f\nSyntax: [ label ] XORWF    f,d\nOperands: 0 ≤ f ≤ 127\nd ∈ [0,1]\nOperation: (W) .XOR. (f) → (destination)\nStatus Affected: ZDescription: Exclusive OR the contents of the \nW register with register ‘f’. If ‘d’ is ‘0’, the result is stored in the W \nregister. If ‘d’ is ‘ 1’, the result is \nstored back in register ‘f’.\nPIC16F684\nDS41202F-page 124 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 125PIC16F684\n14.0 DEVELOPMENT SUPPORT\nThe PIC® microcontrollers are supported with a full\nrange of hardware and software development tools:\n\x81 Integrated Development Environment\n- MPLAB® IDE Software\n\x81 Assemblers/Compilers/Linkers\n- MPASMTM Assembler\n- MPLAB C18 and MPLAB C30 C Compilers\n-M P L I N KTM Object Linker/\nMPLIBTM Object Librarian\n- MPLAB ASM30 Assembler/Linker/Library\n\x81 Simulators\n- MPLAB SIM Software Simulator\n\x81E m u l a t o r s\n- MPLAB ICE 2000 In-Circuit Emulator\n- MPLAB REAL ICE™ In-Circuit Emulator\n\x81 In-Circuit Debugger\n- MPLAB ICD 2\n\x81 Device Programmers\n- PICSTART® Plus Development Programmer\n- MPLAB PM3 Device Programmer\n- PICkit™ 2 Development Programmer\n\x81 Low-Cost Demonstration and Development \nBoards and Evaluation Kits14.1 MPLAB Integrated Development \nEnvironment Software\nThe MPLAB IDE software brings an ease of software\ndevelopment previously unseen in the 8/16-bit micro-\ncontroller market. The MPLAB IDE is a Windows®\noperating system-based application that contains:\n\x81 A single graphical interface to all debugging tools\n- Simulator- Programmer (sold separately)\n- Emulator (sold separately)\n- In-Circuit Debugger (sold separately)\n\x81 A full-featured editor with color-coded context\n\x81 A multiple project manager\n\x81 Customizable data windows with direct edit of \ncontents\n\x81 High-level source code debugging\x81 Visual device initializer for easy register \ninitialization\n\x81 Mouse over variable inspection\n\x81 Drag and drop variables from source to watch \nwindows\n\x81 Extensive on-line help\n\x81 Integration of select third party tools, such as \nHI-TECH Software C Compilers and IAR \nC Compilers\nThe MPLAB IDE allows you to:\x81 Edit your source files (either assembly or C)\n\x81 One touch assemble (or compile) and download \nto PIC MCU emulator and simulator tools \n(automatically updates all project information)\n\x81 Debug using:\n- Source files (assembly or C)\n- Mixed assembly and C- Machine code\nMPLAB IDE supports multiple debugging tools in a\nsingle development paradigm, from the cost-effectivesimulators, through low-cost in-circuit debuggers, to\nfull-featured emulators. This eliminates the learning\ncurve when upgrading to tools with increased flexibilityand power.\nPIC16F684\nDS41202F-page 126 © 2007 Microchip Technology Inc.14.2 MPASM Assembler\nThe MPASM Assembler is a full-featured, universal\nmacro assembler for all PIC MCUs. \nThe MPASM Assembler generates relocatable object\nfiles for the MPLINK Object Linker, Intel® standard HEX\nfiles, MAP files to detail memory usage and symbol\nreference, absolute LST files that contain source linesand generated machine code and COFF files for\ndebugging.\nThe MPASM Assembler features include:\x81 Integration into MPLAB IDE projects\n\x81 User-defined macros to streamline \nassembly code\n\x81 Conditional assembly for multi-purpose \nsource files\n\x81 Directives that allow complete control over the \nassembly process\n14.3 MPLAB C18 and MPLAB C30 \nC Compilers\nThe MPLAB C18 and MPLAB C30 Code Development\nSystems are complete ANSI C compilers for\nMicrochip’s PIC18 and PIC24 families of microcontrol-lers and the dsPIC30 and dsPIC33 family of digital sig-\nnal controllers. These compilers provide powerful\nintegration capabilities, superior code optimization andease of use not found with other compilers. \nFor easy source level debugging, the compilers provide\nsymbol information that is optimized to the MPLAB IDE\ndebugger.\n14.4 MPLINK Object Linker/\nMPLIB Object Librarian\nThe MPLINK Object Linker combines relocatable\nobjects created by the MPASM Assembler and theMPLAB C18 C Compiler. It can link relocatable objects\nfrom precompiled libraries, using directives from a\nlinker script. \nThe MPLIB Object Librarian manages the creation and\nmodification of library files of precompiled code. When\na routine from a library is called from a source file, only\nthe modules that contain that routine will be linked inwith the application. This allows large libraries to be\nused efficiently in many different applications. \nThe object linker/library features include:\x81 Efficient linking of single libraries instead of many \nsmaller files\n\x81 Enhanced code maintainability by grouping \nrelated modules together\n\x81 Flexible creation of libraries with easy module \nlisting, replacement, deletion and extraction14.5 MPLAB ASM30 Assembler, Linker \nand Librarian\nMPLAB ASM30 Assembler produces relocatable\nmachine code from symbolic assembly language for\ndsPIC30F devices. MPLAB C30 C Compiler uses theassembler to produce its object file. The assembler\ngenerates relocatable object files that can then be\narchived or linked with other relocatable object files andarchives to create an executable file. Notable features\nof the assembler include:\n\x81 Support for the entire dsPIC30F instruction set\n\x81 Support for fixed-point and floating-point data\n\x81 Command line interface\x81 Rich directive set\n\x81 Flexible macro language\n\x81 MPLAB IDE compatibility\n14.6 MPLAB SIM Software Simulator\nThe MPLAB SIM Software Simulator allows code\ndevelopment in a PC-hosted environment by simulat-\ning the PIC MCUs and dsPIC® DSCs on an instruction\nlevel. On any given instruction, the data areas can beexamined or modified and stimuli can be applied from\na comprehensive stimulus controller. Registers can be\nlogged to files for further run-time analysis. The tracebuffer and logic analyzer display extend the power of\nthe simulator to record and track program execution,\nactions on I/O, most peripherals and internal registers. \nThe MPLAB SIM Software Simulator fully supports\nsymbolic debugging using the MPLAB C18 and\nMPLAB C30 C Compilers, and the MPASM and\nMPLAB ASM30 Assemblers. The software simulatoroffers the flexibility to develop and debug code outside\nof the hardware laboratory environment, making it an\nexcellent, economical software development tool. \n© 2007 Microchip Technology Inc. DS41202F-page 127PIC16F684\n14.7 MPLAB ICE 2000 \nHigh-Performance \nIn-Circuit Emulator\nThe MPLAB ICE 2000 In-Circuit Emulator is intended\nto provide the product development engineer with a\ncomplete microcontroller design tool set for PIC\nmicrocontrollers. Software control of the MPLAB ICE2000 In-Circuit Emulator is advanced by the MPLAB\nIntegrated Development Environment, which allows\nediting, building, downloading and source debuggingfrom a single environment.\nThe MPLAB ICE 2000 is a full-featured emulator\nsystem with enhanced trace, trigger and data monitor-\ning features. Interchangeable processor modules allowthe system to be easily reconfigured for emulation of\ndifferent processors. The architecture of the MPLAB\nICE 2000 In-Circuit Emulator allows expansion tosupport new PIC microcontrollers.\nThe MPLAB ICE 2000 In-Circuit Emulator system has\nbeen designed as a real-time emulation system with\nadvanced features that are typically found on moreexpensive development tools. The PC platform and\nMicrosoft\n® Windows® 32-bit operating system were\nchosen to best make these features available in asimple, unified application.\n14.8 MPLAB REAL ICE In-Circuit \nEmulator System\nMPLAB REAL ICE In-Circuit Emulator System is\nMicrochip’s next generation high-speed emulator for\nMicrochip Flash DSC® and MCU devices. It debugs and\nprograms PIC® and dsPIC® Flash microcontrollers with\nthe easy-to-use, powerful graphical user interface of the\nMPLAB Integrated Development Environment (IDE),\nincluded with each kit. \nThe MPLAB REAL ICE probe is connected to the design\nengineer’s PC using a high-speed USB 2.0 interface and\nis connected to the target with either a connector\ncompatible with the popular MPLAB ICD 2 system\n(RJ11) or with the new high speed, noise tolerant, low-\nvoltage differential signal (LVDS) interconnection\n(CAT5). \nMPLAB REAL ICE is field upgradeable through future\nfirmware downloads in MPLAB IDE. In upcoming\nreleases of MPLAB IDE, new devices will be supported,\nand new features will be added, such as software break-points and assembly code trace. MPLAB REAL ICE\noffers significant advantages over competitive emulators\nincluding low-cost, full-speed emulation, real-time\nvariable watches, trace analysis, complex breakpoints, a\nruggedized probe interface and long (up to three meters)\ninterconnection cables.14.9 MPLAB ICD 2 In-Circuit Debugger\nMicrochip’s In-Circuit Debugger, MPLAB ICD 2, is apowerful, low-cost, run-time development tool,\nconnecting to the host PC via an RS-232 or high-speed\nUSB interface. This tool is based on the Flash PIC\nMCUs and can be used to develop for these and otherPIC MCUs and dsPIC DSCs. The MPLAB ICD 2 utilizes\nthe in-circuit debugging capability built into the Flash\ndevices. This feature, along with Microchip’s In-CircuitSerial Programming\nTM (ICSPTM) protocol, offers cost-\neffective, in-circuit Flash debugging from the graphical\nuser interface of the MPLAB Integrated DevelopmentEnvironment. This enables a designer to develop and\ndebug source code by setting breakpoints, single step-\nping and watching variables, and CPU status andperipheral registers. Running at full speed enables\ntesting hardware and applications in real time. MPLAB\nICD 2 also serves as a development programmer forselected PIC devices.\n14.10 MPLAB PM3 Device Programmer\nThe MPLAB PM3 Device Programmer is a universal,\nCE compliant device programmer with programmable\nvoltage verification at V DDMIN  and V DDMAX  for\nmaximum reliability. It features a large LCD display\n(128 x 64) for menus and error messages and a modu-\nlar, detachable socket assembly to support variouspackage types. The ICSP™ cable assembly is included\nas a standard item. In Stand-Alone mode, the MPLAB\nPM3 Device Programmer can read, verify and programPIC devices without a PC connection. It can also set\ncode protection in this mode. The MPLAB PM3\nconnects to the host PC via an RS-232 or USB cable.The MPLAB PM3 has high-speed communications and\noptimized algorithms for quick programming of large\nmemory devices and incorporates an SD/MMC card forfile storage and secure data applications.\nPIC16F684\nDS41202F-page 128 © 2007 Microchip Technology Inc.14.11 PICSTART Plus Development \nProgrammer\nThe PICSTART Plus Development Programmer is an\neasy-to-use, low-cost, prototype programmer. It\nconnects to the PC via a COM (RS-232) port. MPLABIntegrated Development Environment software makes\nusing the programmer simple and efficient. The\nPICSTART Plus Development Programmer supportsmost PIC devices in DIP packages up to 40 pins.\nLarger pin count devices, such as the PIC16C92X and\nPIC17C76X, may be supported with an adapter socket.The PICSTART Plus Development Programmer is CE\ncompliant.\n14.12 PICkit 2 Development Programmer\nThe PICkit™ 2 Development Programmer is a low-cost\nprogrammer and selected Flash device debugger withan easy-to-use interface for programming many of\nMicrochip’s baseline, mid-range and PIC18F families of\nFlash memory microcontrollers. The PICkit 2 Starter Kitincludes a prototyping development board, twelve\nsequential lessons, software and HI-TECH’s PICC™\nLite C compiler, and is designed to help get up to speedquickly using PIC\n® microcontrollers. The kit provides\neverything needed to program, evaluate and develop\napplications using Microchip’s powerful, mid-rangeFlash memory family of microcontrollers.14.13 Demonstration, Development and \nEvaluation Boards\nA wide variety of demonstration, development and\nevaluation boards for various PIC MCUs and dsPIC\nDSCs allows quick application development on fully func-tional systems. Most boards include prototyping areas for\nadding custom circuitry and provide application firmware\nand source code for examination and modification.\nThe boards support a variety of features, including LEDs,\ntemperature sensors, switches, speakers, RS-232\ninterfaces, LCD displays, potentiometers and additional\nEEPROM memory.\nThe demonstration and development boards can be\nused in teaching environments, for prototyping custom\ncircuits and for learning about various microcontroller\napplications.\nIn addition to the PICDEM™ and dsPICDEM™ demon-\nstration/development board series of circuits, Microchip\nhas a line of evaluation kits and demonstration software\nfor analog filter design, K\nEELOQ® security ICs, CAN,\nIrDA®, PowerSmart® battery management, SEEVAL®\nevaluation system, Sigma-Delta ADC, flow ratesensing, plus many more.\nCheck the Microchip web page (www.microchip.com)\nand the latest “Product Selector Guide”  (DS00148) for\nthe complete list of demonstration, development and\nevaluation kits.\n© 2007 Microchip Technology Inc. DS41202F-page 129PIC16F684\n15.0 ELECTRICAL SPECIFICATIONS\nAbsolute Maximum Ratings(†)\nAmbient temperature under bias................................................................................................. .........-40° to +125°C\nStorage temperature ............................................................................................................ ............  -65°C to +150°C\nVoltage on V DD with respect to V SS ...................................................................................................  -0.3V to +6.5V\nVoltage on MCLR  with respect to Vss ............................................................................................... -0.3V to +1 3.5V\nVoltage on all other pins with respect to V SS ........................................................................... -0.3V to (V DD + 0.3V)\nTotal power dissipation(1)............................................................................................................................... 800 mW\nMaximum current out of V SS pin ......................................................................................................................  95 m A\nMaximum current into V DD pin .........................................................................................................................  9 5 mA\nInput clamp current, I IK (VI < 0 or V I > V DD)...............................................................................................................± 20 mA\nOutput clamp current, I OK (Vo < 0 or Vo >V DD).........................................................................................................± 20 mA\nMaximum output current sunk by any I/O pin..................................................................................... ............... 25 mA\nMaximum output current sourced by any I/O pin .................................................................................. ............ 25 mA\nMaximum current sunk by PORTA and PORTC (combined) ...........................................................................  9 0 mA\nMaximum current sourced PORTA and PORTC (combined)...........................................................................  9 0 mA\nNote 1: Power dissipation is calculated as follows: P DIS = V DD x {IDD – ∑ IOH} + ∑ {(VDD – VOH) x IOH} + ∑(VOl x IOL).\n† NOTICE: Stresses above those listed under “Absolute Maximum Ratings” may cause permanent damage to the \ndevice. This is a stress rating only and functional operation of the device at those or any other conditions above those \nindicated in the operation listings of this specification is not implied. Exposure above maximum rating conditions for extended periods may affect device reliability.\nPIC16F684\nDS41202F-page 130 © 2007 Microchip Technology Inc.FIGURE 15-1: PIC16F684 VOLTAGE-FREQUENCY GRAPH, \n-40°C ≤ TA ≤ +125°C\nFIGURE 15-2: HFINTOSC FREQUENCY ACCURACY OVER DEVICE V DD AND TEMPERATURE 5.5\n2.03.5\n2.5\n03.04.04.55.0\nFrequency (MHz)VDD (V)\nNote 1: The shaded region indicates the permissible combinations of voltage and frequency.82 0 10\n125\n25\n2.006085\nVDD (V)4.0 5.0 4.5Temperature ( °C)\n2.5 3.0 3.5 5.5± 1%± 2%± 5%\n© 2007 Microchip Technology Inc. DS41202F-page 131PIC16F684\n15.1 DC Characteristics: PIC16F684-I (Industrial)\n PIC16F684-E (Extended)  \nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C ≤ TA ≤ +85°C for industrial\n-40°C ≤ TA ≤ +125°C for extended\nParam \nNo.Sym Characteristic Min Typ† MaxUnit\nsConditions\nD001\nD001C\nD001DVDD Supply Voltage 2.0\n2.0\n3.0\n4.5—\n—\n—\n—5.5\n5.5\n5.5\n5.5V\nV\nV\nVFOSC < = 8 MHz: HFINTOSC, EC\nFOSC < = 4 MHz\nFOSC < = 10 MHz\nFOSC < = 20 MHz\nD002* V DR RAM Data Retention \nVoltage(1)1.5 — — V Device in Sleep mode\nD003 V POR VDD Start Voltage  to \nensure internal Power-on \nReset signal—V SS —V S e e  Section 12.3.1 “Power-On Reset \n(POR)”  for details.\nD004* S VDD VDD Rise Rate  to ensure \ninternal Power-on Reset \nsignal0.05 — — V/ms See Section 12.3.1 “Power-On Reset \n(POR)”  for details.\n* These parameters are characterized but not tested.\n† Data in “Typ” column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: This is the limit to which V DD can be lowered in Sleep mode without losing RAM data.\nPIC16F684\nDS41202F-page 132 © 2007 Microchip Technology Inc.15.2 DC Characteristics: PIC16F684-I (Industrial)\nPIC16F684-E (Extended)\nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +85°C for industrial\n-40°C  ≤ TA ≤ +125°C for extended\nParam\nNo.Device Characteristics Min Typ† Max UnitsConditions\nVDD Note\nD010 Supply Current (I DD)(1, 2)—1 11 6 μA2 . 0 F OSC = 32 kHz\nLP Oscillator mode—1 82 8 μA3 . 0\n—3 55 4 μA5 . 0\nD011* — 140 240 μA2 . 0 F OSC = 1 MHz\nXT Oscillator mode— 220 380 μA3 . 0\n— 380 550 μA5 . 0\nD012 — 260 360 μA2 . 0 F OSC = 4 MHz\nXT Oscillator mode— 420 650 μA3 . 0\n—0 . 81 . 1m A5 . 0\nD013* — 130 220 μA2 . 0 F OSC = 1 MHz\nEC Oscillator mode— 215 360 μA3 . 0\n— 360 520 μA5 . 0\nD014 — 220 340 μA2 . 0 F OSC = 4 MHz\nEC Oscillator mode— 375 550 μA3 . 0\n— 0.65 1.0 mA 5.0\nD015 — 8 20 μA2 . 0 F OSC = 31 kHz\nLFINTOSC mode—1 64 0 μA3 . 0\n—3 16 5 μA5 . 0\nD016* — 340 450 μA2 . 0 F OSC = 4 MHz\nHFINTOSC mode— 500 700 μA3 . 0\n—0 . 81 . 2m A5 . 0\nD017 — 410 650 μA2 . 0 F OSC = 8 MHz\nHFINTOSC mode— 700 950 μA3 . 0\n— 1.30 1.65 mA 5.0\nD018 — 230 400 μA2 . 0 F OSC = 4 MHz\nEXTRC mode(3)— 400 680 μA3 . 0\n— 0.63 1.1 mA 5.0\nD019 — 2.6 3.25 mA 4.5 F OSC = 20 MHz\nHS Oscillator mode— 2.8 3.35 mA 5.0\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: The test conditions for all I DD measurements in active operation mode are: OSC1 = external square wave, \nfrom rail-to-rail; all I/O pins tri-stated, pulled to V DD; MCLR  = V DD; WDT disabled.\n2:The supply current is mainly a function of the operating voltage and frequency. Other factors, such as I/O \npin loading and switching rate, oscillator type, internal code execution pattern and temperature, also have an impact on the current consumption.\n3:For RC oscillator configurations, current through R\nEXT is not included. The current through the resistor can \nbe extended by the formula I R = V DD/2REXT (mA) with R EXT in kΩ.\n© 2007 Microchip Technology Inc. DS41202F-page 133PIC16F684\n15.3 DC Characteristics: PIC16F684-I (Industrial)\nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +85°C for industrial\nParam\nNo.Device Characteristics Min Typ† Max UnitsConditions\nVDD Note\nD020 Power-down Base \nCurrent(I PD)(2) — 0.05 1.2 μA 2.0 WDT, BOR, Comparators, V REF and\nT1OSC disabled— 0.15 1.5 μA3 . 0\n— 0.35 1.8 μA5 . 0\n— 150 500 nA 3.0 -40°C  ≤ TA ≤ +25°C\nD021 — 1.0 2.2 μA 2.0 WDT Current(1)\n—2 . 04 . 0 μA3 . 0\n—3 . 07 . 0 μA5 . 0\nD022 — 42 60 μA 3.0 BOR Current(1)\n— 85 122 μA5 . 0\nD023 — 32 45 μA 2.0 Comparator Current(1), both \ncomparators enabled—6 07 8 μA3 . 0\n— 120 160 μA5 . 0\nD024 — 30 36 μA2 . 0 C V REF Current(1) (high range)\n—4 55 5 μA3 . 0\n—7 59 5 μA5 . 0\nD025* — 39 47 μA2 . 0 C V REF Current(1) (low range)\n—5 97 2 μA3 . 0\n— 98 124 μA5 . 0\nD026 — 4.5 7.0 μA 2.0 T1OSC Current(1), 32.768 kHz\n—5 . 08 . 0 μA3 . 0\n—6 . 01 2 μA5 . 0\nD027 — 0.30 1.6 μA 3.0 A/D Current(1), no conversion in \nprogress— 0.36 1.9 μA5 . 0\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: The peripheral current is the sum of the base I DD or I PD and the additional current consumed when this \nperipheral is enabled. The peripheral Δ current can be determined by subtracting the base I DD or I PD \ncurrent from this limit. Max values should be used when calculating total current consumption.\n2:The power-down current in Sleep mode does not depend on the oscillator type. Power-down current is \nmeasured with the part in Sleep mode, with all I/O pins in high-impedance state and tied to V DD.\nPIC16F684\nDS41202F-page 134 © 2007 Microchip Technology Inc.15.4 DC Characteristics: PIC16F684 -E (Extended)\nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C ≤ TA ≤ +125°C for extended \nParam\nNo.Device Characteristics Min Typ† Max UnitsConditions\nVDD Note\nD020E Power-down Base \nCurrent (I PD)(2)—0 . 0 5 9 μA 2.0 WDT, BOR, Comparators, V REF and \nT1OSC disabled—0 . 1 5 1 1 μA3 . 0\n—0 . 3 51 5 μA5 . 0\nD021E — 1 17.5 μA 2.0 WDT Current(1)\n—21 9 μA3 . 0\n—32 2 μA5 . 0\nD022E — 42 65 μA 3.0 BOR Current(1)\n—8 5 1 2 7 μA5 . 0\nD023E — 32 45 μA 2.0 Comparator Current(1), both \ncomparators enabled—6 07 8 μA3 . 0\n—1 2 0 1 6 0 μA5 . 0\nD024E — 30 70 μA2 . 0 C V REF Current(1) (high range)\n—4 59 0 μA3 . 0\n—7 5 1 2 0 μA5 . 0\nD025E* — 39 91 μA2 . 0 C V REF Current(1) (low range)\n—5 91 1 7 μA3 . 0\n—9 8 1 5 6 μA5 . 0\nD026E — 4.5 25 μA 2.0 T1OSC Current(1), 32.768 kHz\n—53 0 μA3 . 0\n—64 0 μA5 . 0\nD027E — 0.30 12 μA 3.0 A/D Current(1), no conversion in \nprogress—0 . 3 61 6 μA5 . 0\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: The peripheral current is the sum of the base I DD or I PD and the additional current consumed when this \nperipheral is enabled. The peripheral Δ current can be determined by subtracting the base I DD or I PD \ncurrent from this limit. Max values should be used when calculating total current consumption.\n2:The power-down current in Sleep mode does not depend on the oscillator type. Power-down current is \nmeasured with the part in Sleep mode, with all I/O pins in high-impedance state and tied to V DD.\n© 2007 Microchip Technology Inc. DS41202F-page 135PIC16F684\n \n15.5 DC Characteristics: PIC16F684-I (Industrial)\n PIC16F684-E (Extended)\nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +85°C for industrial\n-40°C  ≤ TA ≤ +125°C for extended\nParam\nNo.Sym Characteristic Min Typ† Max Units Conditions\nVIL Input Low Voltage\nI/O Port:\nD030 with TTL buffer Vss — 0.8 V 4.5V ≤ VDD ≤ 5.5V\nD030A Vss — 0.15 V DD V2 . 0 V  ≤ VDD ≤ 4.5V\nD031 with Schmitt Trigger buffer Vss — 0.2 V DD V2 . 0 V  ≤ VDD ≤ 5.5V\nD032 MCLR , OSC1 (RC mode)(1)VSS —0 . 2  V DD V\nD033 OSC1 (XT and LP modes) V SS —0 . 3V\nD033A OSC1 (HS mode) V SS —0 . 3  V DD V\nVIH Input High VoltageI/O ports: —\nD040 with TTL buffer 2.0 — V\nDD V4 . 5 V  ≤ VDD ≤ 5.5V\nD040A 0.25 V DD + 0.8 — V DD V2 . 0 V  ≤ VDD ≤ 4.5V\nD041 with Schmitt Trigger buffer 0.8 V DD —V DD V2 . 0 V  ≤ VDD ≤ 5.5V\nD042 MCLR 0.8 V DD —V DD V\nD043 OSC1 (XT and LP modes) 1.6 — V DD V\nD043A OSC1 (HS mode) 0.7 V DD —V DD V\nD043B OSC1 (RC mode) 0.9 V DD —V DD V( N o t e  1 )\nIIL Input Leakage Current(2)\nD060 I/O ports — ± 0.1 ± 1 μAV SS ≤ VPIN ≤ VDD, \nPin at high-impedance\nD061 MCLR(3)— ± 0.1 ± 5 μAV SS ≤ VPIN ≤ VDD\nD063 OSC1 — ± 0.1 ± 5 μAV SS ≤ VPIN ≤ VDD, XT, HS and \nLP oscillator configuration\nD070* I PUR PORTA Weak Pull-up Current 50 250 400 μAV DD = 5.0V, V PIN = V SS\nVOL Output Low Voltage(5)\nD080 I/O ports — — 0.6 V I OL = 8.5 mA, V DD = 4.5V (Ind.)\nVOH Output High Voltage(5)\nD090 I/O ports V DD – 0.7 — — V I OH = -3.0 mA, V DD = 4.5V (Ind.)\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise st ated. These parameters are for design guidance only and are \nnot tested.\nNote 1: In RC oscillator configuration, the OSC1 /CLKIN pin is a Schmitt Trigger input. It  is not recommended to use an external \nclock in RC mode.\n2: Negative current is defined as current sourced by the pin.\n3: The leakage current on the MCLR  pin is strongly dependent on the applied voltage level. The specified levels represent \nnormal operating conditions. Higher leakage current  may be measured at different input voltages.\n4: See Section 10.4.1 “Using the Data EEPROM”  for additional information.\n5: Including OSC2 in CLKOUT mode.\nPIC16F684\nDS41202F-page 136 © 2007 Microchip Technology Inc.D100 I ULP Ultra Low-Power Wake-Up \nCurrent— 200 — nA See Application Note AN879, \n“Using the Microchip Ultra\nLow-Power Wake-up Module ” \n(DS00879)\nCapacitive Loading Specs on \nOutput Pins\nD101* COSC2 OSC2 pin — — 15 pF In XT, HS and LP modes when \nexternal clock is used to drive OSC1\nD101A* C\nIO All I/O pins — — 50 pF\nData EEPROM Memory\nD120 E D Byte Endurance 100K 1M — E/W -40°C ≤ TA ≤ +85°C\nD120A E D Byte Endurance 10K 100K — E/W +85°C ≤ TA ≤ +125°C\nD121 V DRW VDD for Read/Write V MIN — 5.5 V Using EECON1 to read/write\nVMIN = Minimum operating \nvoltage\nD122 T DEW Erase/Write Cycle Time — 5 6 ms\nD123 T RETD Characteristic Retention 40 — — Year Provided no other specifications \nare violated\nD124 T REF Number of Total Erase/Write \nCycles before Refresh(4)1M 10M — E/W -40°C ≤ TA ≤ +85°C\nProgram Flash Memory\nD130 E P Cell Endurance 10K 100K — E/W -40°C ≤ TA ≤ +85°C\nD130A E D Cell Endurance 1K 10K — E/W +85°C ≤ TA ≤ +125°C\nD131 V PR VDD for Read V MIN —5 . 5V V MIN = Minimum operating \nvoltage\nD132 V PEW VDD for Erase/Write 4.5 — 5.5 V\nD133 T PEW Erase/Write cycle time — 2 2.5 ms\nD134 T RETD Characteristic Retention 40 — — Year Provided no other specifications \nare violated15.5 DC Characteristics: PIC16F684-I (Industrial)\n PIC16F684-E (Extended) (Continued)\nDC CHARACTERISTICSStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +85°C for industrial\n-40°C  ≤ TA ≤ +125°C for extended\nParam\nNo.Sym Characteristic Min Typ† Max Units Conditions\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise st ated. These parameters are for design guidance only and are \nnot tested.\nNote 1: In RC oscillator configuration, the OSC1 /CLKIN pin is a Schmitt Trigger input. It  is not recommended to use an external \nclock in RC mode.\n2: Negative current is defined as current sourced by the pin.\n3: The leakage current on the MCLR  pin is strongly dependent on the applied voltage level. The specified levels represent \nnormal operating conditions. Higher leakage current  may be measured at different input voltages.\n4: See Section 10.4.1 “Using the Data EEPROM”  for additional information.\n5: Including OSC2 in CLKOUT mode.\n© 2007 Microchip Technology Inc. DS41202F-page 137PIC16F684\n15.6 Thermal Considerations\nStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +125°C\nParam\nNo.Sym Characteristic Typ Units Conditions\nTH01 θJA Thermal Resistance \nJunction to Ambient69.8 C/W 14-pin PDIP package\n85.0 C/W 14-pin SOIC package\n100.4 C/W 14-pin TSSOP package\n46.3 C/W 16-pin QFN 4x0.9mm package\nTH02 θJC Thermal Resistance \nJunction to Case32.5 C/W 14-pin PDIP package\n31.0 C/W 14-pin SOIC package31.7 C/W 14-pin TSSOP package\n2.6 C/W 16-pin QFN 4x0.9mm package\nTH03 T\nJ Junction Temperature 150 C For derated power calculations\nTH04 PD Power Dissipation — W PD = P INTERNAL  + P I/O\nTH05 P INTERNAL Internal Power Dissipation — W P INTERNAL  = IDD x V DD\n(NOTE 1)\nTH06 P I/O I/O Power Dissipation — W P I/O = Σ (IOL * VOL) + Σ (IOH * (V DD - VOH))\nTH07 P DER Derated Power — W P DER = (T J - TA)/θJA\n(NOTE 2, 3)\nNote 1: IDD is current to run the chip alone without driving any load on the output pins.\n2:TA = Ambient Temperature.\n3:Maximum allowable power dissipation is the lower value of either the absolute maximum total power \ndissipation or derated power (P DER).\nPIC16F684\nDS41202F-page 138 © 2007 Microchip Technology Inc.15.7  Timing Parameter Symbology\nThe timing parameter symbols have been created with\none of the following formats:\nFIGURE 15-3: LOAD CONDITIONS1. TppS2ppS\n2. TppS\nT\nF Frequency T Time\nLowercase letters (pp) and their meanings:\npp\ncc CCP1 osc OSC1\nck CLKOUT rd RD\ncs CS rw RD  or WR\ndi SDI sc SCKdo SDO ss SS\ndt Data in t0 T0CKI\nio I/O PORT t1 T1CKI\nmc MCLR wr WR\nUppercase letters and their meanings:\nS\nFF a l l PP e r i o d\nHH i g h RR i s eI Invalid (High-impedance) V Valid\nL Low Z High-impedance\nVSSCL\nLegend: CL= 50 pF for all pins\n15 pF for OSC2 outputLoad Condition\nPin\n© 2007 Microchip Technology Inc. DS41202F-page 139PIC16F684\n15.8 AC Characteristics: PIC16F684 (Industrial, Extended)\nFIGURE 15-4: CLOCK TIMING\nTABLE 15-1: CLOCK OSCILLATOR TIMING REQUIREMENTS\nStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +125°C\nParam\nNo.Sym Characteristic Min Typ† Max Units Conditions\nOS01 F OSC External CLKIN Frequency(1) DC — 37 kHz LP Oscillator mode \nDC — 4 MHz XT Oscillator modeDC — 20 MHz HS Oscillator modeDC — 20 MHz EC Oscillator mode\nOscillator Frequency\n(1) — 32.768 — kHz LP Oscillator mode\n0.1 — 4 MHz XT Oscillator mode\n1 — 20 MHz HS Oscillator mode\nDC — 4 MHz RC Oscillator mode \nOS02 T OSC External CLKIN Period(1)27 — \x81 μs LP Oscillator mode\n250 — \x81 ns XT Oscillator mode\n50 — \x81 ns HS Oscillator mode\n50 — \x81 ns EC Oscillator mode\nOscillator Period(1)—3 0 . 5— μs LP Oscillator mode\n250 — 10,000 ns XT Oscillator mode\n50 — 1,000 ns HS Oscillator mode\n250 — — ns RC Oscillator mode\nOS03 T CY Instruction Cycle Time(1) 200 T CY DC ns T CY = 4/F OSC\nOS04* TosH,\nTosLExternal CLKIN High,\nExternal CLKIN Low2—— μs LP oscillator\n100 — — ns XT oscillator\n20 — — ns HS oscillator\nOS05* TosR,\nTosFExternal CLKIN Rise,\nExternal CLKIN Fall0 — \x81 ns LP oscillator\n0 — \x81 ns XT oscillator\n0 — \x81 ns HS oscillator\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stated. These parameters are for design guidance only and \nare not tested.\nNote 1: Instruction cycle period (T CY) equals four times the input oscillator time base period. All specified values are \nbased on characterization data for that particular oscillator type under standard operating conditions with the \ndevice executing code. Exceeding these specified limits may result in an unstable oscillator operation and/or \nhigher than expected current consumption. All devices are tested to operate at ‘min’ values with an external clock \napplied to OSC1 pin. When an external clock input is used, the ‘max’ cycle time limit is ‘DC’ (no clock) for all \ndevices.OSC1/CLKIN\nOSC2/CLKOUTQ4 Q1 Q2 Q3 Q4 Q1\nOS02\nOS03OS04 OS04\nOSC2/CLKOUT\n(LP ,XT,HS Modes)\n(CLKOUT Mode)\nPIC16F684\nDS41202F-page 140 © 2007 Microchip Technology Inc.TABLE 15-2: OSCILLATOR PARAMETERS \nStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym CharacteristicFreq\nToleranceMin Typ† Max Units Conditions\nOS06 T WARM Internal Oscillator Switch \nwhen running(3)—— — 2 T OSC Slowest clock\nOS07 T SC Fail-Safe Sample Clock \nPeriod(1)— —2 1—m s L F I N T O S C / 6 4\nOS08 HF OSC Internal Calibrated\nHFINTOSC Frequency(2)±1% 7.92 8.0 8.08 MHz V DD = 3.5V, 25°C\n±2% 7.84 8.0 8.16 MHz 2.5V ≤ VDD ≤ 5.5V,\n0°C ≤ TA ≤ +85°C\n±5% 7.60 8.0 8.40 MHz 2.0V ≤ VDD ≤ 5.5V,\n-40°C ≤ TA ≤ +85°C (Ind.),\n-40°C ≤ TA ≤ +125°C (Ext.)\nOS09* LF OSC Internal Uncalibrated\nLFINTOSC Frequency— 1 53 14 5 k H z\nOS10* T IOSC \nSTHFINTOSC Oscillator \nWake-up from Sleep\nStart-up Time— 5.5 12 24 μsV DD = 2.0V, -40°C to +85°C\n—3 . 5 7 1 4 μsV DD = 3.0V, -40°C to +85°C\n—3 6 1 1 μsV DD = 5.0V, -40°C to +85°C\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance only \nand are not tested.\nNote 1: Instruction cycle period (T CY) equals four times the input oscillator time base period. All specified values are \nbased on characterization data for that particular oscillator type under standard operating conditions with the \ndevice executing code. Exceeding these specified limits may result in an unstable oscillator operation and/or \nhigher than expected current consumption. All devices are tested to operate at ‘min’ values with an external \nclock applied to the OSC1 pin. When an external clock input is used, the ‘max’ cycle time limit is ‘DC’ (no clock) \nfor all devices.\n2: To ensure these oscillator frequency tolerances, V DD and V SS must be capacitively decoupled as close to the \ndevice as possible. 0.1 μF and 0.01 μF values in parallel are recommended.\n3: By design.\n© 2007 Microchip Technology Inc. DS41202F-page 141PIC16F684\nFIGURE 15-5: CLKOUT AND I/O TIMING     \n    Fosc\nCLKOUT\nI/O pin\n(Input)\nI/O pin\n(Output)Q4 Q1 Q2 Q3\nOS11\nOS19\nOS13\nOS15\nOS18, OS19OS20\nOS21\nOS17OS16\nOS14OS12\nOS18\nOld Value New ValueWrite Fetch Read Execute Cycle\nTABLE 15-3: CLKOUT AND I/O TIMING PARAMETERS\nStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristic Min Typ† Max Units Conditions\nOS11 T OSH2CKLF OSC↑ to CLKOUT ↓ (1)— — 70 ns V DD = 5.0V\nOS12 T OSH2CKHF OSC↑ to CLKOUT ↑ (1)— — 72 ns V DD = 5.0V\nOS13 T CKL2IOVC L K O U T ↓ to Port out valid(1) — — 20 ns\nOS14 T IOV2CKH Port input valid before CLKOUT ↑(1) T OSC + 200 ns — — ns \nOS15 T OSH2IOVF OSC↑ (Q1 cycle) to Port out valid — 50 70* ns V DD = 5.0V\nOS16 T OSH2IOIF OSC↑ (Q2 cycle) to Port input invalid \n(I/O in hold time)50 — — ns V DD = 5.0V\nOS17 T IOV2OSH Port input valid to F OSC↑ (Q2 cycle)\n(I/O in setup time)20 — — ns\nOS18 T IOR Port output rise time(2)—\n—15\n4072\n32ns V DD = 2.0V\nVDD = 5.0V\nOS19 T IOF Port output fall time(2)—\n—28\n1555\n30ns V DD = 2.0V\nVDD = 5.0V\nOS20* T INP INT pin input high or low time 25 — — ns\nOS21* T RAP PORTA interrupt-on-change new input \nlevel timeTCY ——n s\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25 °C unless otherwise stated.\nNote 1: Measurements are taken in RC mode where CLKOUT output is 4 x T OSC.\n2:Includes OSC2 in CLKOUT mode.\nPIC16F684\nDS41202F-page 142 © 2007 Microchip Technology Inc.FIGURE 15-6: RESET, WATCHDOG TIMER, OSCILLATOR START-UP TIMER AND \nPOWER-UP TIMER TIMING\nFIGURE 15-7: BROWN-OUT RESE T TIMING AND CHARACTERISTICSVDD\nMCLR\nInternal\nPOR\nPWRT\nTime-out\nOSC\nStart-Up Time\nInternal Reset(1)\nWatchdog Timer33\n3230\n31\n34\nI/O pins34\nNote 1: Asserted low.Reset(1)\nVBORVDD\n(Device in Brown-out Reset) (Device not in Brown-out Reset)\n33*37\n* 64 ms delay only if PWRTE  bit in the Configuration Word register is programmed to ‘ 0’.Reset\n(due to BOR)VBOR + V HYST\n© 2007 Microchip Technology Inc. DS41202F-page 143PIC16F684\nTABLE 15-4: RESET, WATCHDOG TIMER, OSCILLATOR START-UP TIMER, POWER-UP TIMER \nAND BROWN-OUT RESET PARAMETERS\nStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristic Min Typ† Max Units Conditions\n30 T MCLM C L R  Pulse Width (low) 2 \n5—\n——\n—μs\nμsVDD = 5V, -40°C to +85°C\nVDD = 5V\n31 T WDT Watchdog Timer Time-out \nPeriod (No Prescaler)10\n1016\n1629\n31ms\nmsVDD = 5V, -40°C to +85°C\nVDD = 5V\n32 T OST Oscillation Start-up Timer \nPeriod(1, 2)— 1024 — T OSC (NOTE 3)\n33* T PWRT Power-up Timer Period 40 65 140 ms\n34* T IOZ I/O High-impedance from \nMCLR  Low or Watchdog Timer \nReset—— 2 . 0 μs\n35 V BOR Brown-out Reset Voltage 2.0 — 2.2 V (NOTE 4)\n36* V HYST Brown-out Reset Hysteresis — 50 — mV\n37* T BOR Brown-out Reset Minimum \nDetection Period100 — — μsV DD ≤ VBOR\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: Instruction cycle period (T CY) equals four times the input oscillator time base period. All specified values \nare based on characterization data for that particular oscillator type under standard operating conditions with the device executing code. Exceeding these specified limits may result in an unstable oscillator oper-\nation and/or higher than expected current consumption. All devices are tested to operate at ‘min’ values \nwith an external clock applied to the OSC1 pin. When an external clock input is used, the ‘max’ cycle time limit is ‘DC’ (no clock) for all devices.\n2:By design.\n3:Period of the slower clock.\n4:To ensure these voltage tolerances, V\nDD and V SS must be capacitively decoupled as close to the device as \npossible. 0.1 μF and 0.01 μF values in parallel are recommended.\nPIC16F684\nDS41202F-page 144 © 2007 Microchip Technology Inc.FIGURE 15-8: TIMER0 AND TIMER1 EXTERNAL CLOCK TIMINGS\nTABLE 15-5: TIMER0 AND TIMER1 EXTERNAL CLOCK REQUIREMENTS\nStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristic Min Typ† Max Units Conditions\n40* T T0H T0CKI High Pulse Width No Prescaler 0.5 T CY + 20 — — ns\nWith Prescaler 10 — — ns  \n41* T T0L T0CKI Low Pulse Width No Prescaler 0.5 T CY + 20 — — ns  \nWith Prescaler 10 — — ns  \n42* T T0P T0CKI Period Greater of:\n20 or T CY + 40\n         N— — ns N = prescale value \n(2, 4, ..., 256)\n45* T T1H T1CKI High \nTimeSynchronous, No Prescaler 0.5 T CY + 20 — — ns  \nSynchronous, \nwith Prescaler15 — — ns  \nAsynchronous 30 — — ns  \n46* T T1L T1CKI Low \nTimeSynchronous, No Prescaler 0.5 T CY + 20 — — ns  \nSynchronous, \nwith Prescaler15 — — ns  \nAsynchronous 30 — — ns  \n47* T T1P T1CKI Input \nPeriod Synchronous Greater of:\n30 or T CY + 40\n          N— — ns N = prescale value \n(1, 2, 4, 8)\nAsynchronous 60 — — ns  \n48 F T1 Timer1 Oscillator Input Frequency Range \n(oscillator enabled by setting bit T1OSCEN)— 32.768 — kHz\n49* TCKEZ TMR1 Delay from External Clock Edge to Timer \nIncrement2 TOSC —7  T OSC — Timers in Sync \nmode\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stat ed. These parameters are for design guidance only and are not \ntested.T0CKI\nT1CKI40 41\n42\n45 46\n47 49\nTMR0 or\nTMR1\n© 2007 Microchip Technology Inc. DS41202F-page 145PIC16F684\nFIGURE 15-9: CAPTURE/COMPARE/PWM TIMINGS (ECCP)\nTABLE 15-6: CAPTURE/COMPARE/PWM REQUIREMENTS (ECCP)\nStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristic Min Typ† Max Units Conditions\nCC01* TccL CCP1 Input Low Time No Prescaler 0.5T CY + 20 — — ns\nWith Prescaler 20 — — ns\nCC02* TccH CCP1 Input High Time No Prescaler 0.5T CY + 20 — — ns\nWith Prescaler 20 — — ns\nCC03* TccP CCP1 Input Period 3T CY + 40\nN— — ns N = prescale \nvalue (1, 4 or \n16)\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.Note: Refer to Figure 15-3 for load conditions.(Capture mode)\nCC01 CC02\nCC03CCP1\nPIC16F684\nDS41202F-page 146 © 2007 Microchip Technology Inc.TABLE 15-7: COMPARATOR SPECIFICATIONS\nTABLE 15-8: COMPARATOR VOLTAGE REFERENCE (CV REF) SPECIFICATIONSStandard Operating Conditions (unless otherwise stated)\nOperating Temperature -40°C ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristics Min Typ† Max Units Comments\nCM01 V OS Input Offset Voltage — ± 5.0 ± 10 mV (V DD - 1.5)/2\nCM02 V CM Input Common Mode Voltage 0 — V DD – 1.5 V\nCM03* C MRR Common Mode Rejection Ratio +55 — — dB\nCM04* T RT Response Time Falling — 150 600 ns (NOTE 1)\nRising — 200 1000 ns\nCM05* T MC2COV Comparator Mode Change to \nOutput Valid—— 1 0 μs\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: Response time is measured with one comparator input at (V DD- 1.5)/2 - 100 mV to (V DD-1 . 5 ) / 2+2 0m V .\nStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristics Min Typ† Max Units Comments\nCV01* C LSB Step Size(2)—\n—VDD/24\nVDD/32—\n—V\nVLow Range (VRR = 1)\nHigh Range (VRR = 0)\nCV02* C ACC Absolute Accuracy —\n——\n—± 1/2\n± 1/2LSb\nLSbLow Range (VRR = 1)\nHigh Range (VRR = 0)\nCV03* C R Unit Resistor Value (R) — 2k — Ω\nCV04* C ST Settling Time(1)——1 0 μs\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5V, 25°C unless otherwise stated. These parameters are for design \nguidance only and are not tested.\nNote 1: Settling time measured while VRR = 1 and VR<3:0> transitions from ‘ 0000 ’ to ‘1111 ’.\n2:See Section 8.10 “Comparator Voltage Reference”  for more information.\n© 2007 Microchip Technology Inc. DS41202F-page 147PIC16F684\nTABLE 15-9: PIC16F684 A/D CONVERTER (ADC) CHARACTERISTICS\nStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +125°C\nParam \nNo.Sym Characteristic Min Typ† Max Units Conditions\nAD01 N R Resolution — — 10 bits bit\nAD02 E IL Integral Error — — ±1L S b V REF = 5.12V\nAD03 E DL Differential Error — — ±1 LSb No missing codes to 10 bits\nVREF = 5.12V\nAD04 E OFF Offset Error — — ±1L S b V REF = 5.12V\nAD07 E GN Gain Error — — ±1L S b V REF = 5.12V\nAD06\nAD06AVREF Reference Voltage(3)2.2\n2.7——\nVDDV\nAbsolute minimum to ensure 1 LSb \naccuracy\nAD07 V AIN Full-Scale Range V SS —V REF V\nAD08 Z AIN Recommended \nImpedance of Analog Voltage Source—— 1 0 k Ω\nAD09* I\nREF VREF Input Current(3) 10 — 1000 μAD u r i n g  V AIN acquisition. \nBased on differential of V HOLD  to V AIN.\n—— 5 0 μA During A/D conversion cycle.\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: Total Absolute Error includes integral, differential, offset and gain errors.\n2:The A/D conversion result never decreases with an increase in the input voltage and has no missing \ncodes.\n3:ADC V REF is from external V REF or V DD pin, whichever is selected as reference input.\n4:When ADC is off, it will not consume any current other than leakage current. The power-down current \nspecification includes any such leakage from the ADC module.\nPIC16F684\nDS41202F-page 148 © 2007 Microchip Technology Inc.TABLE 15-10: PIC16F684 A/D CONVERSION REQUIREMENTS\nStandard Operating Conditions (unless otherwise stated)\nOperating temperature -40°C  ≤ TA ≤ +125°C\nParam\nNo.Sym Characteristic Min Typ† Max Units Conditions\nAD130* T AD A/D Clock Period 1.6 — 9.0 μsT OSC-based, V REF ≥ 3.0V\n3.0 — 9.0 μsT OSC-based, V REF full range\nA/D Internal RC \nOscillator Period 3.0 6.0 9.0 μsADCS<1:0> = 11 (ADRC mode)\nAt V DD = 2.5V\n1.6 4.0 6.0 μsA t  V DD = 5.0V\nAD131 T CNV Conversion Time\n(not including \nAcquisition Time)(1)—1 1— T AD Set GO/DONE  bit to new data in A/D \nResult register\nAD132* T ACQ Acquisition Time 11.5 — μs\nAD133* T AMP Amplifier Settling Time — — 5 μs\nAD134 T GO Q4 to A/D Clock Start —\n—TOSC/2\nTOSC/2 + T CY———\n— If the A/D clock source is selected as \nRC, a time of T\nCY is added before the \nA/D clock starts. This allows the SLEEP  \ninstruction to be executed.\n* These parameters are characterized but not tested.\n† Data in ‘Typ’ column is at 5.0V, 25°C unless otherwise stated. These parameters are for design guidance \nonly and are not tested.\nNote 1: ADRESH and ADRESL registers may be read on the following T CY cycle.\n2:See Section 9.3 “A/D Acquisition Requirements”  for minimum conditions.\n© 2007 Microchip Technology Inc. DS41202F-page 149PIC16F684\nFIGURE 15-10: PIC16F684 A/D CONVERSION TIMING (NORMAL MODE)\nFIGURE 15-11: PIC16F684 A/D CONVERSION TIMING (SLEEP MODE)AD131\nAD130BSF ADCON0, GO\nQ4\nA/D CLK\nA/D Data\nADRES\nADIF\nGO\nSampleOLD_DATA\nSampling StoppedDONENEW_DATA98 7 321 0\nNote 1: If the A/D clock source is selected as RC, a time of T CY is added before the A/D clock starts. This allows the\nSLEEP  instruction to be executed.1 TCY\n6AD134 (TOSC/2(1))\n1 TCY\nAD132\nAD132AD131\nAD130BSF ADCON0, GO\nQ4\nA/D CLK\nA/D Data\nADRES\nADIF\nGO\nSampleOLD_DATA\nSampling StoppedDONENEW_DATA9 7 3210\nNote 1: If the A/D clock source is selected as RC, a time of T CY is added before the A/D clock starts. This allows the\nSLEEP  instruction to be executed. AD134\n6 81 TCY (TOSC/2 + T CY(1))\n1 TCY\nPIC16F684\nDS41202F-page 150 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 151PIC16F684\n16.0 DC AND AC CHARACTERISTICS GRAPHS AND TABLES\nThe graphs and tables provided in this section are for design guidance  and are not tested .\nIn some graphs or tables, the data presented are outside specified operating range  (i.e., outside specified V DD\nrange). This is for information only  and devices are ensured to operate properly only within the specified range.\n“Typical” represents the mean of the distribution at 25 °C. “Maximum” or “minimum” represents\n(mean + 3 σ) or (mean - 3 σ) respectively, where σ is a standard deviation, over each temperature range.\nFIGURE 16-1: TYPICAL I DD vs. F OSC OVER V DD (EC MODE)Note: The graphs and tables provided following this note are a statistical summary based on a limited number of\nsamples and are provided for informational purposes only. The performance characteristics listed herein arenot tested or guaranteed. In some graphs or tables, the data presented may be outside the specified\noperating range (e.g., outside specified power supply range) and therefore, outside the warranted range.\n3.0V4.0V5.0V5.5V\n2.0V\n0.00.51.01.52.02.53.03.5\n1 MHz 2 MHz 4 MHz 6 MHz 8 MHz 10 MHz 12 MHz 14 MHz 16 MHz 18 MHz 20 MHz\nFOSCIDD (mA)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 152 © 2007 Microchip Technology Inc.FIGURE 16-2: MAXIMUM I DD vs. F OSC OVER V DD (EC MODE)\nFIGURE 16-3: TYPICAL I DD vs. F OSC OVER V DD (HS MODE)EC Mode\n3.0V4.0V5.0V\n2.0V\n0.00.51.01.52.02.53.03.54.0\n1 MHz 2 MHz 4 MHz 6 MHz 8 MHz 10 MHz 12 MHz 14 MHz 16 MHz 18 MHz 20 MHz\nFOSCIDD (mA) 5.5VTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nTypical IDD vs FOSC Over Vdd\nHS Mode\n3.0V3.5V4.0V4.5V5.0V5.5V\n0.00.51.01.52.02.53.03.54.0\n4 MHz 10 MHz 16 MHz 20 MHz\nFOSCIDD (mA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 153PIC16F684\nFIGURE 16-4: MAXIMUM I DD vs. F OSC OVER V DD (HS MODE)\nFIGURE 16-5: TYPICAL I DD vs. V DD OVER F OSC (XT MODE)Maximum IDD vs FOSC Over Vdd\nHS Mode\n3.5V4.0V4.5V5.0V\n0.00.51.01.52.02.53.03.54.04.55.0\n4 MHz 10 MHz 16 MHz 20 MHz\nFOSCIDD (mA)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n3.0V5.5V\nXT Mode\n0100200300400500600700800900\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n4 MHz\n1 MHz\nPIC16F684\nDS41202F-page 154 © 2007 Microchip Technology Inc.FIGURE 16-6: MAXIMUM I DD vs. V DD OVER F OSC (XT MODE)\nFIGURE 16-7: TYPICAL I DD vs. V DD OVER F OSC (EXTRC MODE)XT Mode\n02004006008001,0001,2001,400\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n4 MHz\n1 MHz\nEXTRC Mode\n0100200300400500600700800\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IDD (μA)\n1 MHzTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n4 MHz\n© 2007 Microchip Technology Inc. DS41202F-page 155PIC16F684\nFIGURE 16-8: MAXIMUM I DD vs. V DD OVER F OSC (EXTRC MODE)\nFIGURE 16-9: I DD vs. V DD OVER F OSC (LFINTOSC MODE, 31 kHz)EXTRC Mode\n02004006008001,0001,2001,400\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n4 MHz\n1 MHz\nLFINTOSC Mode, 31KHZ\nTypicalMaximum\n01020304050607080\nVDD (V)IDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nPIC16F684\nDS41202F-page 156 © 2007 Microchip Technology Inc.FIGURE 16-10: I DD vs. V DD OVER F OSC (LP MODE)\nFIGURE 16-11: TYPICAL I DD vs. F OSC OVER V DD (HFINTOSC MODE)LP Mode\n010203040506070\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n32 kHz Maximum\n32 kHz Typical\nHFINTOSC\n2.0V3.0V4.0V5.0V5.5V\n02004006008001,0001,2001,4001,600\n125 kHz 250 kHz 500 kHz 1 MHz 2 MHz 4 MHz 8 MHz\nFOSCIDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 157PIC16F684\nFIGURE 16-12: MAXIMUM I DD vs. F OSC OVER V DD (HFINTOSC MODE)\nFIGURE 16-13:  TYPICAL I PD vs. V DD (SLEEP MODE, ALL PERIPHERALS DISABLED)HFINTOSC\n2.0V3.0V4.0V5.0V5.5V\n02004006008001,0001,2001,4001,6001,8002,000\n125 kHz 250 kHz 500 kHz 1 MHz 2 MHz 4 MHz 8 MHz\nFOSCIDD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nTypical\n(Sleep Mode all Peripherals Disabled)\n0.00.050.100.150.200.250.300.350.400.45\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 158 © 2007 Microchip Technology Inc.FIGURE 16-14: MAXIMUM I PD vs. V DD (SLEEP MODE, ALL PERIPHERALS DISABLED)\nFIGURE 16-15: COMPARATOR I PD vs. V DD (BOTH COMPARATORS ENABLED)Maximum\n(Sleep Mode all Peripherals Disabled)\nMax. 125°C\nMax. 85°C\n0.02.04.06.08.010.012.014.016.018.0\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Maximum: Mean + 3 σTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n020406080100120140160180\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Maximum\nTypicalTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 159PIC16F684\nFIGURE 16-16: BOR I PD vs. V DD OVER TEMPERATURE\nFIGURE 16-17: TYPICAL WDT I PD vs. V DD OVER TEMPERATURE020406080100120140160\n2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA) Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nMaximum\nTypical\nTypical \n0.00.51.01.52.02.53.0\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Typical: Statistical Mean @25°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 160 © 2007 Microchip Technology Inc.FIGURE 16-18: MAXIMUM WDT I PD vs. V DD OVER TEMPERATURE\nFIGURE 16-19: WDT PERIOD vs. V DD OVER TEMPERATUREMaximum \nMax. 125°C\nMax. 85°C\n0.05.010.015.020.025.0\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nMinimumTypical\n1012141618202224262830\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Time (ms)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nMax. (125°C)\nMax. (85°C)\n© 2007 Microchip Technology Inc. DS41202F-page 161PIC16F684\nFIGURE 16-20: WDT PERIOD vs. TEMPERATURE OVER V DD (5.0V)\nFIGURE 16-21: CV REF IPD vs. V DD OVER TEMPERATURE (HIGH RANGE)Vdd = 5V\n1012141618202224262830\n -40°C  25°C  85°C  125°C\nTemperature ( °C)Time (ms)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nMaximum\nTypical\nMinimum\nHigh Range\nTypicalMax. 85°C\n020406080100120140\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Max. 125°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 162 © 2007 Microchip Technology Inc.FIGURE 16-22: CV REF IPD vs. V DD OVER TEMPERATURE (LOW RANGE)\nFIGURE 16-23: V OL vs. I OL OVER TEMPERATURE (V DD = 3.0V)TypicalMax. 85°C\n020406080100120140160180\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (μA)Max. 125°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n(VDD = 3V, -40×C TO 125×C)\n0.00.10.20.30.40.50.60.70.8\n5.0 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 10.0\nIOL (mA)VOL (V)Max. 85°CMax. 125°C\nTypical 25°C\nMin. -40°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 163PIC16F684\nFIGURE 16-24: V OL vs. I OL OVER TEMPERATURE (V DD = 5.0V)\nFIGURE 16-25: V OH vs. I OH OVER TEMPERATURE (V DD = 3.0V)0.000.050.100.150.200.250.300.350.400.45\n5.0 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 10.0\nIOL (mA)VOL (V)Typical: Statistical Mean @25×C\nMaximum: Meas + 3  (-40×C to 125×C)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nMax. 85°C\nTyp. 25°C\nMin. -40°CMax. 125°C\n0.00.51.01.52.02.53.03.5\n-4.0 -3.5 -3.0 -2.5 -2.0 -1.5 -1.0 -0.5 0.0\nIOH (mA)VOH (V)Typ. 25°CMax. -40°C\nMin. 125°C\nTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 164 © 2007 Microchip Technology Inc.FIGURE 16-26: V OH vs. I OH OVER TEMPERATURE (V DD = 5.0V)\nFIGURE 16-27: TTL INPUT THRESHOLD V IN vs. V DD OVER TEMPERATURE(VDD = 5V, -40×C TO 125×C)\n3.03.54.04.55.05.5\n-5.0 -4.5 -4.0 -3.5 -3.0 -2.5 -2.0 -1.5 -1.0 -0.5 0.0\nIOH (mA)VOH (V)Max. -40°C\nTyp. 25°C\nMin. 125°C\nTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n(TTL Input, -40×C TO 125×C)\n0.50.70.91.11.31.51.7\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)VIN (V)Typ. 25°CMax. -40°C\nMin. 125°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 165PIC16F684\nFIGURE 16-28:  SCHMITT TRIGGER INPUT THRESHOLD V IN vs. V DD OVER TEMPERATURE\nFIGURE 16-29: T1OSC I PD vs. V DD OVER TEMPERATURE (32 kHz)(ST Input, -40×C TO 125×C)\n0.51.01.52.02.53.03.54.0\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)VIN (V)VIH Max. 125°C\nVIH Min. -40°C\nVIL Min. 125°CVIL Max. -40°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nTyp. 25°CMax. 85°CMax. 125°C\n0.05.010.015.020.025.030.035.040.045.0\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)IPD (mA)Maximum: Mean + 3  (-40×C to 125×C)Typical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 166 © 2007 Microchip Technology Inc.FIGURE 16-30: COMPARATOR RESPONSE TIME (RISING EDGE)\nFIGURE 16-31: COMPARATOR RESPONSE TIME (FALLING EDGE)531 806\n01002003004005006007008009001000\n2.0 2.5 4.0 5.5\nVDD (V)Response Time (nS)Max. 85°C\nTyp. 25°C\nMin. -40°CMax. 125°C\nNote:         \nV- input = Transition from V CM + 100 MV to V CM - 20 MV V+ input = V CMVCM = V DD - 1.5V)/2\n01002003004005006007008009001000\n2.0 2.5 4.0 5.5\nVDD (V)Response Time (nS)Max. 85°C\nTyp. 25°C\nMin. -40°CMax. 125°C\nNote:         \nV- input = Transition from V CM - 100 MV to V CM + 20 MV V+ input = V CMVCM = V DD - 1.5V)/2\n© 2007 Microchip Technology Inc. DS41202F-page 167PIC16F684\nFIGURE 16-32: LFINTOSC FREQUENCY vs. V DD OVER TEMPERATURE (31 kHz)\nFIGURE 16-33: ADC CLOCK PERIOD vs. V DD OVER TEMPERATURELFINTOSC 31Khz\n05,00010,00015,00020,00025,00030,00035,00040,00045,000\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Frequency (Hz)Max. -40°C\nTyp. 25°C\nMin. 85°C\nMin. 125°C\nTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n02468\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Time ( μs)25°C85°C125°C\n-40°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\nPIC16F684\nDS41202F-page 168 © 2007 Microchip Technology Inc.FIGURE 16-34: TYPICAL HFINTOSC START-UP TIMES vs. V DD OVER TEMPERATURE\nFIGURE 16-35: MAXIMUM HFINTOSC START-UP TIMES vs. V DD OVER TEMPERATURE0246810121416\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Time ( μs)85°C\n25°C\n-40°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n-40C to +85C\n0510152025\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Time ( μs)\n-40°C85°C\n25°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n© 2007 Microchip Technology Inc. DS41202F-page 169PIC16F684\nFIGURE 16-36: MINIMUM HFINTOSC START-UP TIMES vs. V DD OVER TEMPERATURE\nFIGURE 16-37: TYPICAL HFINTOSC FREQUENCY CHANGE vs. V DD (25°C)-40C to +85C\n012345678910\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Time ( μs)\n-40°C25°C85°CTypical: Statistical Mean @25°C\nMaximum: Mean (Worst Case Temp) + 3 σ\n(-40°C to 125°C)\n-5-4-3-2-1012345\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Change from Calibration (%)\nPIC16F684\nDS41202F-page 170 © 2007 Microchip Technology Inc.FIGURE 16-38: TYPICAL HFINTOSC FREQUENCY CHANGE OVER DEVICE V DD (85°C)\nFIGURE 16-39: TYPICAL HFINTOSC FREQUENCY CHANGE vs. V DD (125°C)-5-4-3-2-1012345\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V)Change from Calibration (%)\n-5-4-3-2-1012345\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V) Change from Calibration (%)\n© 2007 Microchip Technology Inc. DS41202F-page 171PIC16F684\nFIGURE 16-40: TYPICAL HFINTOSC FREQUENCY CHANGE vs. V DD (-40°C)\n-5-4-3-2-1012345\n2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\nVDD (V) Change from Calibration (%)\nPIC16F684\nDS41202F-page 172 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 173PIC16F684\n17.0 PACKAGING INFORMATION\n17.1 Package Marking Information          \n*Standard PIC device marking consists of Microchip part number, year code, week code, and traceability\ncode. For PIC device marking beyond this, certain price adders apply. Please check with your MicrochipSales Office. For QTP devices, any special marking adders are included in QTP price.XXXXXX16-Lead QFN\nXXXXXX\nYWWNNN16F684-IExample\n/ML51001714-Lead PDIP\nXXXXXXXXXXXXXX\nXXXXXXXXXXXXXX\nYYWWNNNExample\nPIC16F684\n0510017\n14-Lead SOIC (.150”)\nXXXXXXXXXXX\nXXXXXXXXXXX\nYYWWNNNExample\nPIC16F684-E\n0510017\n14-Lead TSSOP\nXXXXXXXX\nYYWW\nNNNExample\nXXXX/ST\n0510\n017\nLegend: XX...X Customer-specific information\nY Year code (last digit of calendar year)\nYY Year code (last 2 digits of calendar year)WW Week code (week of January 1 is week ‘01’)\nNNN Alphanumeric traceability code\n  Pb-free JEDEC designator for Matte Tin (Sn)* This package is Pb-free. The Pb-free JEDEC designator (     )\ncan be found on the outer packaging for this package.\nNote : In the event the full Microchip part number cannot be marked on one line, it will\nbe carried over to the next line, thus limiting the number of available\ncharacters for customer-specific information.3e\n3e3e\n3e\n3e-I/P\nPIC16F684\nDS41202F-page 174 © 2007 Microchip Technology Inc.17.2 Package Details\nThe following sections give the technical details of the packages.\n14-Lead Plastic Dual In-Line (P or PD) – 300 mil Body [PDIP]\nNotes:\n1. Pin 1 visual index feature may vary, but must be located with the hatched area.\n2. § Significant Characteristic.\n3. Dimensions D and E1 do not include mold flash or protrusions. Mold flash or protrusions shall not exceed .010" per side.4. Dimensioning and tolerancing per ASME Y14.5M.\nBSC: Basic Dimension. Theoretically exact value shown without tolerances.Note: For the most current package drawings, please see the Microchip Packaging Specification located at \nhttp://www.microchip.com/packaging\nUnits INCHES\nDimension Limits MIN NOM MAX\nNumber of Pins N 14Pitch e .100 BSCTop to Seating Plane A – – .210Molded Package Thickness A2 .115 .130 .195Base to Seating Plane A1 .015 – –Shoulder to Shoulder Width E .290 .310 .325Molded Package Width E1 .240 .250 .280Overall Length D .735 .750 .775Tip to Seating Plane L .115 .130 .150Lead Thickness c .008 .010 .015Upper Lead Width b1 .045 .060 .070Lower Lead Width b .014 .018 .022Overall Row Spacing  § eB – – .430N\nE1\nDNOTE 1\n12 3\nE\nc\neBA2\nLA\nA1\nb1\nb e\nMicrochip Technology Drawing C04-005 B\n© 2007 Microchip Technology Inc. DS41202F-page 175PIC16F684\n14-Lead Plastic Small Outline (SL or OD) – Narrow, 3.90 mm Body [SOIC]\nNotes:\n1. Pin 1 visual index feature may vary, but must be located within the hatched area.\n2. § Significant Characteristic.\n3. Dimensions D and E1 do not include mold flash or protrusions. Mold flash or protrusions shall not exceed 0.15 mm per side.\n4. Dimensioning and tolerancing per ASME Y14.5M.\nBSC: Basic Dimension. Theoretically exact value shown without tolerances.\nREF: Reference Dimension, usually without tolerance, for information purposes only.Note: For the most current package drawings, please see the Microchip Packaging Specification located at \nhttp://www.microchip.com/packaging\nUnits MILLIMETERS\nDimension Limits MIN NOM MAX\nNumber of Pins N 14Pitch e 1.27 BSCOverall Height A – – 1.75Molded Package Thickness A2 1.25 – –Standoff  § A1 0.10 – 0.25Overall Width E 6.00 BSCMolded Package Width E1 3.90 BSCOverall Length D 8.65 BSCChamfer (optional) h 0.25 – 0.50Foot Length L 0.40 – 1.27Footprint L1 1.04 REFFoot Angle φ 0° – 8°\nLead Thickness c 0.17 – 0.25Lead Width b 0.31 – 0.51Mold Draft Angle Top α 5° – 15°\nMold Draft Angle Bottom β 5° – 15°NOTE 1ND\nE\nE1\n1 2 3\nbe\nA\nA1A2\nL\nL1ch\nhα\nβφ\nMicrochip Technology Drawing C04-065 B\nPIC16F684\nDS41202F-page 176 © 2007 Microchip Technology Inc.14-Lead Plastic Thin Shrink Small Outline (ST) – 4.4 mm Body [TSSOP]\nNotes:\n1. Pin 1 visual index feature may vary, but must be located within the hatched area.2. Dimensions D and E1 do not include mold flash or protrusions. Mold flash or protrusions shall not exceed 0.15 mm per side.\n3. Dimensioning and tolerancing per ASME Y14.5M.\nBSC: Basic Dimension. Theoretically exact value shown without tolerances.\nREF: Reference Dimension, usually without tolerance, for information purposes only.Note: For the most current package drawings, please see the Microchip Packaging Specification located at \nhttp://www.microchip.com/packaging\nUnits MILLIMETERS\nDimension Limits MIN NOM MAX\nNumber of Pins N 14Pitch e 0.65 BSCOverall Height A – – 1.20Molded Package Thickness A2 0.80 1.00 1.05Standoff A1 0.05 – 0.15Overall Width E 6.40 BSCMolded Package Width E1 4.30 4.40 4.50Molded Package Length D 4.90 5.00 5.10Foot Length L 0.45 0.60 0.75Footprint L1 1.00 REFFoot Angle φ 0° – 8°\nLead Thickness c 0.09 – 0.20Lead Width b 0.19 – 0.30NOTE 1D\nN\nE\nE1\n12\ne\nb\nc\nA\nA1A2\nL1 Lφ\nMicrochip Technology Drawing C04-087 B\n© 2007 Microchip Technology Inc. DS41202F-page 177PIC16F684\n16-Lead Plastic Quad Flat, No Lead Package (ML) – 4x4x0.9 mm Body [QFN]\nNotes:\n1. Pin 1 visual index feature may vary, but must be located within the hatched area.\n2. Package is saw singulated.\n3. Dimensioning and tolerancing per ASME Y14.5M.\nBSC: Basic Dimension. Theoretically exact value shown without tolerances.\nREF: Reference Dimension, usually without tolerance, for information purposes only.Note: For the most current package drawings, please see the Microchip Packaging Specification located at \nhttp://www.microchip.com/packaging\nUnits MILLIMETERS\nDimension Limits MIN NOM MAX\nNumber of Pins N 16Pitch e 0.65 BSCOverall Height A 0.80 0.90 1.00Standoff A1 0.00 0.02 0.05Contact Thickness A3 0.20 REFOverall Width E 4.00 BSCExposed Pad Width E2 2.50 2.65 2.80Overall Length D 4.00 BSCExposed Pad Length D2 2.50 2.65 2.80Contact Width b 0.25 0.30 0.35Contact Length L 0.30 0.40 0.50Contact-to-Exposed Pad K 0.20 – –D\nE\nN2\n1EXPOSED\nPADD2\nE2\n2\n1e\nb\nK\nN\nNOTE 1\nA3\nA1ALTOP VIEW BOTTOM VIEW\nMicrochip Technology Drawing C04-127 B\nPIC16F684\nDS41202F-page 178 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 179PIC16F684\nAPPENDIX A: DATA SHEET \nREVISION HISTORY\nRevision A\nThis is a new data sheet.\nRevision B\nRewrites of the Oscillator and Special Features of the\nCPU Sections. General corrections to Figures and\nformatting.\nRevision C\nRevision D\nAdded Characterization Data. Updated Electrical\nSpecifications. Incorporated Golden Chapter Sectionsfor the following:\n\x81Section 3.0 “Oscillator Module (With Fail-Safe \nClock Monitor)”\n\x81Section 5.0 “Timer0 Module”\n\x81Section 6.0 “Timer1 Module with Gate Control”\n\x81Section 7.0 “Timer2 Module”\n\x81Section 8.0 “Comparator Module”\n\x81Section 9.0 “Analog-to-Digital Converter (ADC) \nModule”\n\x81Section 11.0 “Enhanced Capture/Compare/PWM \n(With Auto-Shutdown and Dead Band) Module”\nRevision E\nUpdated Package Drawings; Replace PICmicro with\nPIC.\nRevision F (03/2007)\nReplaced Package Drawings (Rev. AM); Replaced\nDevelopment Support Section.APPENDIX B: MIGRATING FROM \nOTHER PIC® \nDEVICES\nThis discusses some of the issues in migrating from\nother PIC devices to the PIC16F6XX Family of devices.\nB.1 PIC16F676 to PIC16F684\nTABLE B-1: FEATURE COMPARISON\nFeature PIC16F676 PIC16F684\nMax Operating \nSpeed20 MHz 20 MHz\nMax Program \nMemory (Words)1024 2048\nSRAM (bytes) 64 128\nA/D Resolution 10-bit 10-bit\nData EEPROM \n(Bytes)128 256\nTimers (8/16-bit) 1/1 2/1\nOscillator Modes 8 8\nBrown-out Reset Y YInternal Pull-ups RA0/1/2/4/5 RA0/1/2/4/5, \nMCLR\nInterrupt-on-change RA0/1/2/3/4/5 RA0/1/2/3/4/5\nComparator 1 2\nECCP N Y\nUltra Low-Power \nWake-UpNY\nExtended WDT N Y\nSoftware Control \nOption of WDT/BORNY\nINTOSC \nFrequencies4M H z 3 2k H z -\n8M H z\nClock Switching N Y\nNote: This device has been designed to perform\nto the parameters of its data sheet. It has\nbeen tested to an electrical specification\ndesigned to determine its conformancewith these parameters. Due to process\ndifferences in the manufacture of this\ndevice, this device may have differentperformance characteristics than its earlier\nversion. These differences may cause this\ndevice to perform differently in yourapplication than the earlier version of this\ndevice.\nPIC16F684\nDS41202F-page 180 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc.    DS41202F-page 181PIC16F684\nINDEX\nA\nA/D\nSpecifications.................................................... 147, 148\nAbsolute Maximum Ratings .............................................. 129\nAC Characteristics\nIndustrial and Extended ............................................ 139Load Conditions........................................................ 138\nADC .................................................................................... 65\nAcquisition Requirements ........................................... 72Associated registers.................................................... 74\nBlock Diagram............................................................. 65\nCalculating Acquisition Time....................................... 72Channel Selection....................................................... 66\nConfiguration............................................................... 66\nConfiguring Interrupt ................................................... 68Conversion Clock........................................................ 66\nConversion Procedure ................................................ 68\nInternal Sampling Switch (R\nSS) Impedance................ 72\nInterrupts..................................................................... 67\nOperation .................................................................... 68\nOperation During Sleep .............................................. 68Port Configuration....................................................... 66\nReference Voltage (V\nREF)........................................... 66\nResult Formatting........................................................ 67Source Impedance...................................................... 72\nSpecial Event Trigger.................................................. 68\nStarting an A/D Conversion ........................................ 67\nADCON0 Register............................................................... 70\nADCON1 Register............................................................... 70\nADRESH Register (ADFM = 0)........................................... 71ADRESH Register (ADFM = 1)........................................... 71\nADRESL Register (ADFM = 0)............................................ 71\nADRESL Register (ADFM = 1)............................................ 71Analog Input Connection Considerations............................ 57\nAnalog-to-Digital Converter. See ADC\nANSEL Register.................................................................. 32Assembler\nMPASM Assembler................................................... 126\nB\nBlock Diagrams\n(CCP) Capture Mode Operation ................................. 80\nADC ............................................................................ 65ADC Transfer Function ............................................... 73\nAnalog Input Model............................................... 57, 73\nCCP PWM................................................................... 82Clock Source............................................................... 19\nComparator 1.............................................................. 56\nComparator 2.............................................................. 56Comparator Modes ..................................................... 58\nCompare ..................................................................... 81\nCrystal Operation........................................................ 22\nExternal RC Mode....................................................... 23\nFail-Safe Clock Monitor (FSCM)................................. 29In-Circuit Serial Programming Connections.............. 114\nInterrupt Logic ........................................................... 107\nMCLR\n Circuit............................................................. 100\nOn-Chip Reset Circuit................................................. 99\nPIC16F684.................................................................... 5\nPWM (Enhanced)........................................................ 85RA0 Pins..................................................................... 35\nRA1 Pins..................................................................... 36\nRA2 Pin....................................................................... 36RA3 Pin....................................................................... 37RA4 Pin ...................................................................... 37\nRA5 Pin ...................................................................... 38\nRC0 and RC1 Pins ..................................................... 41\nRC2 and RC3 Pins ..................................................... 41RC4 Pin ...................................................................... 42\nRC5 Pin ...................................................................... 42\nResonator Operation .................................................. 22Timer1 ........................................................................ 47\nTimer2 ........................................................................ 53\nTMR0/WDT Prescaler ................................................ 43Watchdog Timer (WDT)............................................ 110\nBrown-out Reset (BOR).................................................... 101\nAssociated................................................................ 102Calibration ................................................................ 101\nSpecifications ........................................................... 143\nTiming and Characteristics ....................................... 142\nC\nC Compilers\nMPLAB C18.............................................................. 126MPLAB C30.............................................................. 126\nCalibration Bits.................................................................... 99\nCapture Module. See Enhanced Capture/\nCompare/PWM (ECCP)\nCapture/Compare/PWM (CCP)\nAssociated registers w/ Capture/Compare/PWM ....... 96Capture Mode............................................................. 80\nCCP1 Pin Configuration ............................................. 80\nCompare Mode........................................................... 81\nCCP1 Pin Configuration ..................................... 81\nSoftware Interrupt Mode............................... 80, 81\nSpecial Event Trigger ......................................... 81Timer1 Mode Selection................................. 80, 81\nPrescaler .................................................................... 80\nPWM Mode................................................................. 82\nDuty Cycle .......................................................... 83\nEffects of Reset .................................................. 84\nExample PWM Frequencies and \nResolutions, 20 MHZ.................................. 83\nExample PWM Frequencies and \nResolutions, 8 MHz .................................... 83\nOperation in Sleep Mode.................................... 84\nSetup for Operation ............................................ 84\nSystem Clock Frequency Changes .................... 84\nPWM Period ............................................................... 83\nSetup for PWM Operation .......................................... 84\nCCP1CON (Enhanced) Register ........................................ 79Clock Sources\nExternal Modes........................................................... 21\nEC ...................................................................... 21HS ...................................................................... 22\nLP ....................................................................... 22\nOST .................................................................... 21\nRC ...................................................................... 23\nXT....................................................................... 22\nInternal Modes............................................................ 23\nFrequency Selection........................................... 25\nHFINTOSC ......................................................... 23HFINTOSC/LFINTOSC Switch Timing............... 25\nINTOSC.............................................................. 23\nINTOSCIO .......................................................... 23LFINTOSC.......................................................... 25\nClock Switching .................................................................. 27\nCMCON0 Register.............................................................. 61\nPIC16F684\nDS41202F-page 182 © 2007 Microchip Technology Inc.CMCON1 Register ..............................................................62\nCode Examples\nA/D Conversion...........................................................69Assigning Prescaler to Timer0 ....................................44\nAssigning Prescaler to WDT .......................................44\nChanging Between Capture Prescalers...................... 80Data EEPROM Read ..................................................77\nData EEPROM Write ..................................................77\nIndirect Addressing .....................................................19Initializing PORTA.......................................................31\nInitializing PORTC.......................................................40\nSaving Status and W Registers in RAM ................... 109Ultra Low-Power Wake-Up Initialization...................... 34\nWrite Verify .................................................................77\nCode Protection ................................................................ 113Comparator .........................................................................55\nC2OUT as T1 Gate .....................................................62\nConfigurations.............................................................58Interrupts.....................................................................59\nOperation ....................................................................59\nOperation During Sleep ..............................................60Overview .....................................................................55\nResponse Time........................................................... 59\nSynchronizing COUT w/Timer1 ..................................62\nComparator Module\nAssociated Registers ..................................................64\nComparator Voltage Reference (CV\nREF)\nResponse Time........................................................... 59\nComparator Voltage Reference (CV REF) ............................63\nEffects of a Reset........................................................60Specifications............................................................146\nComparators\nC2OUT as T1 Gate .....................................................49Effects of a Reset........................................................60\nSpecifications............................................................146\nCompare Module. See Enhanced Capture/\nCompare/PWM (ECCP)\nCONFIG Register................................................................98\nConfiguration Bits................................................................97CPU Features .....................................................................97\nCustomer Change Notification Service ............................. 187\nCustomer Notification Service...........................................187Customer Support............................................................. 187\nD\nData EEPROM Memory\nAssociated Registers ..................................................78\nCode Protection .................................................... 75, 78\nData Memory.........................................................................7DC and AC Characteristics\nGraphs and Tables ...................................................151\nDC Characteristics\nExtended and Industrial ............................................ 135\nIndustrial and Extended ............................................ 131\nDevelopment Support ....................................................... 125\nDevice Overview ...................................................................5\nE\nECCP. See Enhanced Capture/Compare/PWM\nECCPAS Register...............................................................93\nEEADR Register .................................................................75EECON1 Register...............................................................76\nEECON2 Register...............................................................76\nEEDAT Register..................................................................75EEPROM Data Memory\nAvoiding Spurious Write..............................................78Reading ...................................................................... 77\nWrite Verify ................................................................. 77\nWriting ........................................................................ 77\nEffects of Reset\nPWM mode................................................................. 84\nElectrical Specifications .................................................... 129Enhanced Capture/Compare/PWM .................................... 79\nEnhanced Capture/Compare/PWM (ECCP)\nEnhanced PWM Mode................................................ 85\nAuto-Restart ....................................................... 94\nAuto-shutdown.................................................... 93\nDirection Change in Full-Bridge Output Mode.... 91Full-Bridge Application........................................ 89\nFull-Bridge Mode ................................................ 89\nHalf-Bridge Application ....................................... 88Half-Bridge Application Examples ...................... 95\nHalf-Bridge Mode................................................ 88\nOutput Relationships (Active-High and\n Active-Low)................................................ 86\nOutput Relationships Diagram............................ 87\nProgrammable Dead-Band Delay....................... 95Shoot-through Current........................................ 95\nStart-up Considerations...................................... 92\nSpecifications ........................................................... 145Timer Resources ........................................................ 79\nErrata .................................................................................... 4\nF\nFail-Safe Clock Monitor ...................................................... 29\nFail-Safe Condition Clearing....................................... 29\nFail-Safe Detection ..................................................... 29Fail-Safe Operation..................................................... 29\nReset or Wake-up from Sleep .................................... 29\nFirmware Instructions ....................................................... 115Fuses. See Configuration Bits\nG\nGeneral Purpose Register File ............................................. 8\nI\nID Locations...................................................................... 113\nIn-Circuit Debugger........................................................... 114In-Circuit Serial Programming (ICSP)............................... 114\nIndirect Addressing, INDF and FSR registers..................... 19\nInstruction Format............................................................. 115Instruction Set................................................................... 115\nADDLW..................................................................... 117\nADDWF..................................................................... 117ANDLW..................................................................... 117\nANDWF..................................................................... 117\nBCF .......................................................................... 117BSF........................................................................... 117\nBTFSC...................................................................... 117\nBTFSS ...................................................................... 118\nCALL......................................................................... 118\nCLRF ........................................................................ 118CLRW ....................................................................... 118\nCLRWDT .................................................................. 118\nCOMF ....................................................................... 118DECF........................................................................ 118\nDECFSZ ................................................................... 119\nGOTO ....................................................................... 119INCF ......................................................................... 119\nINCFSZ..................................................................... 119\nIORLW...................................................................... 119IORWF...................................................................... 119\n© 2007 Microchip Technology Inc.    DS41202F-page 183PIC16F684\nMOVF........................................................................ 120\nMOVLW .................................................................... 120\nMOVWF .................................................................... 120NOP .......................................................................... 120\nRETFIE ..................................................................... 121\nRETLW ..................................................................... 121RETURN................................................................... 121\nRLF ........................................................................... 122\nRRF........................................................................... 122SLEEP ...................................................................... 122\nSUBLW ..................................................................... 122\nSUBWF..................................................................... 123SWAPF ..................................................................... 123\nXORLW..................................................................... 123\nXORWF..................................................................... 123Summary Table......................................................... 116\nINTCON Register................................................................ 15\nInternal Oscillator Block\nINTOSC\nSpecifications............................................ 140, 141\nInternal Sampling Switch (R\nSS) Impedance........................ 72\nInternet Address................................................................ 187\nInterrupts........................................................................... 106\nADC ............................................................................ 68Associated Registers ................................................ 108\nComparator................................................................. 59\nContext Saving.......................................................... 109Data EEPROM Memory Write .................................... 76\nInterrupt-on-Change.................................................... 32\nPORTA Interrupt-on-Change .................................... 107RA2/INT .................................................................... 106\nTimer0....................................................................... 107\nTMR1 .......................................................................... 49\nINTOSC Specifications ............................................. 140, 141\nIOCA Register..................................................................... 33\nL\nLoad Conditions ................................................................ 138\nM\nMCLR ................................................................................ 100\nInternal...................................................................... 100\nMemory Organization............................................................ 7\nData .............................................................................. 7Data EEPROM Memory.............................................. 75\nProgram ........................................................................ 7\nMicrochip Internet Web Site.............................................. 187Migrating from other PICmicro Devices ............................ 179\nMPLAB ASM30 Assembler, Linker, Librarian ................... 126\nMPLAB ICD 2 In-Circuit Debugger ................................... 127MPLAB ICE 2000 High-Performance Universal \nIn-Circuit Emulator .................................................... 127\nMPLAB Integrated Development Environment Software .. 125MPLAB PM3 Device Programmer .................................... 127\nMPLAB REAL ICE In-Circuit Emulator System................. 127\nMPLINK Object Linker/MPLIB Object Librarian ................ 126\nO\nOPCODE Field Descriptions............................................. 115OPTION Register.......................................................... 14, 45\nOSCCON Register.............................................................. 20\nOscillator\nAssociated registers.............................................. 30, 51\nOscillator Module ................................................................ 19\nEC............................................................................... 19HFINTOSC.................................................................. 19HS............................................................................... 19\nINTOSC ...................................................................... 19\nINTOSCIO .................................................................. 19LFINTOSC.................................................................. 19\nLP ............................................................................... 19\nRC .............................................................................. 19RCIO........................................................................... 19\nXT............................................................................... 19\nOscillator Parameters ....................................................... 140Oscillator Specifications.................................................... 139\nOscillator Start-up Timer (OST)\nSpecifications ........................................................... 143\nOscillator Switching\nFail-Safe Clock Monitor .............................................. 29\nTwo-Speed Clock Start-up ......................................... 27\nOSCTUNE Register............................................................ 24\nP\nP1A/P1B/P1C/P1D. See Enhanced Capture/\nCompare/PWM (ECCP).............................................. 85\nPackaging......................................................................... 173\nMarking..................................................................... 173PDIP Details ............................................................. 174\nPCL and PCLATH............................................................... 19\nStack........................................................................... 19\nPCON Register........................................................... 18, 102\nPICSTART Plus Development Programmer..................... 128\nPIE1 Register ..................................................................... 16Pin Diagram\nPDIP, SOIC, TSSOP .................................................... 2\nQFN .............................................................................. 3\nPinout Descriptions\nPIC16F684 ................................................................... 6\nPIR1 Register ..................................................................... 17PORTA ............................................................................... 31\nAdditional Pin Functions ............................................. 32\nANSEL Register ................................................. 32Interrupt-on-Change ........................................... 32\nUltra Low-Power Wake-Up........................... 32, 34\nWeak Pull-up ...................................................... 32\nAssociated registers ................................................... 39\nPin Descriptions and Diagrams .................................. 35\nRA0............................................................................. 35RA1............................................................................. 35\nRA2............................................................................. 36\nRA3............................................................................. 37RA4............................................................................. 37\nRA5............................................................................. 38\nSpecifications ........................................................... 141\nPORTA Register................................................................. 31\nPORTC ............................................................................... 40\nAssociated registers ................................................... 42P1A/P1B/P1C/P1D. See Enhanced Capture/\nCompare/PWM (ECCP)...................................... 40\nSpecifications ........................................................... 141\nPORTC Register................................................................. 40\nPower-Down Mode (Sleep)............................................... 112Power-on Reset (POR)..................................................... 100\nPower-up Timer (PWRT) .................................................. 100\nSpecifications ........................................................... 143\nPrecision Internal Oscillator Parameters .......................... 141\nPrescaler\nShared WDT/Timer0................................................... 44Switching Prescaler Assignment ................................ 44\nProgram Memory.................................................................. 7\nMap and Stack.............................................................. 7\nPIC16F684\nDS41202F-page 184 © 2007 Microchip Technology Inc.Programming, Device Instructions ....................................115\nPWM Mode. See Enhanced Capture/Compare/PWM ........ 85\nPWM1CON Register...........................................................96\nR\nReader Response ............................................................. 188Read-Modify-Write Operations.......................................... 115Registers\nADCON0 (ADC Control 0) ..........................................70\nADCON1 (ADC Control 1) ..........................................70ADRESH (ADC Result High) with ADFM = 0).............71\nADRESH (ADC Result High) with ADFM = 1).............71\nADRESL (ADC Result Low) with ADFM = 0) ..............71ADRESL (ADC Result Low) with ADFM = 1) ..............71\nANSEL (Analog Select)...............................................32\nCCP1CON (Enhanced CCP1 Control)........................ 79CMCON0 (Comparator Control 0) ..............................61\nCMCON1 (Comparator Control 1) ..............................62\nCONFIG (Configuration Word)....................................98Data Memory Map ........................................................8\nECCPAS (Enhanced CCP Auto-shutdown Control) ... 93\nEEADR (EEPROM Address) ......................................75EECON1 (EEPROM Control 1)...................................76\nEECON2 (EEPROM Control 2)...................................76\nEEDAT (EEPROM Data) ............................................75INTCON (Interrupt Control).........................................15\nIOCA (Interrupt-on-Change PORTA) .......................... 33\nOPTION_REG (OPTION) ..................................... 14, 45OSCCON (Oscillator Control) .....................................20\nOSCTUNE (Oscillator Tuning) ....................................24\nPCON (Power Control Register) .................................18PCON (Power Control) .............................................102\nPIE1 (Peripheral Interrupt Enable 1)........................... 16\nPIR1 (Peripheral Interrupt Register 1) ........................ 17PORTA........................................................................31\nPORTC .......................................................................40\nPWM1CON (Enhanced PWM Control) ....................... 96Reset Values.............................................................104\nReset Values (Special Registers) .............................105\nSpecial Function Registers ...........................................8Special Register Summary .........................................11\nSTATUS......................................................................13\nT1CON........................................................................50T2CON........................................................................54\nTRISA (Tri-State PORTA)...........................................31\nTRISC (Tri-State PORTC) ..........................................40VRCON (Voltage Reference Control) ......................... 63\nWDTCON (Watchdog Timer Control)........................ 111\nWPUA (Weak Pull-Up PORTA) ..................................33\nReset...................................................................................99\nRevision History ................................................................179\nS\nShoot-through Current ........................................................ 95Sleep\nPower-Down Mode ...................................................112\nWake-up....................................................................112\nWake-up Using Interrupts .........................................112\nSoftware Simulator (MPLAB SIM).....................................126\nSpecial Event Trigger..........................................................68\nSpecial Function Registers ...................................................8STATUS Register................................................................13\nT\nT1CON Register..................................................................50T2CON Register..................................................................54Thermal Considerations.................................................... 137\nTime-out Sequence .......................................................... 102\nTimer0................................................................................. 43\nAssociated Registers.................................................. 45\nExternal Clock............................................................. 44\nInterrupt ...................................................................... 45Operation.............................................................. 43, 47\nSpecifications ........................................................... 144\nT0CKI ......................................................................... 44\nTimer1................................................................................. 47\nAssociated registers ................................................... 51\nAsynchronous Counter Mode ..................................... 48\nReading and Writing ........................................... 48\nInterrupt ...................................................................... 49\nModes of Operation .................................................... 47Operation During Sleep .............................................. 49\nOscillator..................................................................... 48\nPrescaler .................................................................... 48Specifications ........................................................... 144\nTimer1 Gate\nInverting Gate ..................................................... 49Selecting Source .......................................... 49, 62\nSynchronizing COUT w/Timer1 .......................... 62\nTMR1H Register......................................................... 47TMR1L Register.......................................................... 47\nTimer2\nAssociated registers ................................................... 54\nTimers\nTimer1\nT1CON ............................................................... 50\nTimer2\nT2CON ............................................................... 54\nTiming Diagrams\nA/D Conversion......................................................... 149\nA/D Conversion (Sleep Mode).................................. 149\nBrown-out Reset (BOR)............................................ 142Brown-out Reset Situations ...................................... 101\nCLKOUT and I/O ...................................................... 141\nClock Timing............................................................. 139Comparator Output..................................................... 55\nEnhanced Capture/Compare/PWM (ECCP)............. 145\nFail-Safe Clock Monitor (FSCM)................................. 30Full-Bridge PWM Output............................................. 90\nHalf-Bridge PWM Output ...................................... 88, 95\nINT Pin Interrupt ....................................................... 108Internal Oscillator Switch Timing ................................ 26\nPWM Auto-shutdown\nAuto-restart Enabled........................................... 94Firmware Restart................................................ 94\nPWM Direction Change .............................................. 91\nPWM Direction Change at Near 100% Duty Cycle..... 92PWM Output (Active-High) ......................................... 86\nPWM Output (Active-Low) .......................................... 87\nReset, WDT, OST and Power-up Timer ................... 142\nTime-out Sequence\nCase 1 .............................................................. 103Case 2 .............................................................. 103\nCase 3 .............................................................. 103\nTimer0 and Timer1 External Clock ........................... 144Two Speed Start-up.................................................... 28\nWake-up from Interrupt............................................. 113\nTiming Parameter Symbology .......................................... 138TRISA Register................................................................... 31\nTRISC Register................................................................... 40\nTwo-Speed Clock Start-up Mode........................................ 27\n© 2007 Microchip Technology Inc.    DS41202F-page 185PIC16F684\nU\nUltra Low-Power Wake-Up ....................................... 6, 32, 34\nV\nVoltage Reference. See Comparator Voltage Reference\n(CV REF)\nVoltage References\nAssociated Registers .................................................. 64\nVREF. SEE ADC Reference Voltage\nW\nWake-up Using Interrupts ................................................. 112\nWatchdog Timer (WDT) .................................................... 110\nAssociated Registers ................................................ 111\nClock Source............................................................. 110\nModes ....................................................................... 110Period........................................................................ 110\nSpecifications............................................................ 143\nWDTCON Register ........................................................... 111WPUA Register................................................................... 33\nWWW Address.................................................................. 187\nWWW, On-Line Support ....................................................... 4\nPIC16F684\nDS41202F-page 186 © 2007 Microchip Technology Inc.NOTES:\n© 2007 Microchip Technology Inc. DS41202F-page 187PIC16F684\nTHE MICROCHIP WEB SITE\nMicrochip provides online support via our WWW site at\nwww.microchip.com. This web site is used as a means\nto make files and information easily available tocustomers. Accessible by using your favorite Internet\nbrowser, the web site contains the following\ninformation:\n\x81Product Support  – Data sheets and errata, \napplication notes and sample programs, design \nresources, user’s guides and hardware support \ndocuments, latest software releases and archived software\n\x81General Technical Support  – Frequently Asked \nQuestions (FAQ), technical support requests, \nonline discussion groups, Microchip consultant \nprogram member listing\n\x81Business of Microchip  – Product selector and \nordering guides, latest Microchip press releases, listing of seminars and events, listings of \nMicrochip sales offices, distributors and factory \nrepresentatives\nCUSTOMER CHANGE NOTIFICATION \nSERVICE\nMicrochip’s customer notification service helps keep\ncustomers current on Microchip products. Subscribers\nwill receive e-mail notification whenever there arechanges, updates, revisions or errata related to a\nspecified product family or development tool of interest.\nTo register, access the Microchip web site at\nwww.microchip.com, click on Customer ChangeNotification and follow the registration instructions.CUSTOMER SUPPORT\nUsers of Microchip products can receive assistance\nthrough several channels:\n\x81 Distributor or Representative\n\x81 Local Sales Office\n\x81 Field Application Engineer (FAE)\x81 Technical Support\n\x81 Development Systems Information Line\nCustomers should contact their distributor,\nrepresentative or field application engineer (FAE) for\nsupport. Local sales offices are also available to helpcustomers. A listing of sales offices and locations is\nincluded in the back of this document.\nTechnical support is available through the web site\nat: http://support.microchip.com\nPIC16F684\nDS41202F-page 188 © 2007 Microchip Technology Inc.READER RESPONSE\nIt is our intention to provide you with the best documentation possible to ensure successful use of your Microchip prod-\nuct.  If you wish to provide your comments on organization, clarity, subject matter, and ways in which our documentation\ncan better serve you, please FAX your comments to the Technical Publications Manager at (480) 792-4150.\nPlease list the following information, and use this outline to provide us with your comments about this document.\nTo: Technical Publications Manager\nRE: Reader ResponseTotal Pages Sent ________\nFrom: Name\nCompany\nAddress\nCity / State / ZIP / Country\nTelephone: (_______) _________ - _________\nApplication (optional):\nWould you like a reply?       Y         N\nDevice: Literature Number: \nQuestions:FAX: (______) _________ - _________\nDS41202F PIC16F684\n1. What are the best features of this document?\n2. How does this document meet your hardware and software development needs?3. Do you find the organization of this document easy to follow? If not, why?4. What additions to the document do you think would enhance the structure and subject?5. What deletions from the document could be made without affecting the overall usefulness?6. Is there any incorrect or misleading information (what and where)?7. How would you improve this document?\n© 2007 Microchip Technology Inc. DS41202F-page 189PIC16F684\nPRODUCT IDENTIFICATION SYSTEM\nTo order or obtain information, e. g., on pricing or delivery, refer to the factory or the listed sales office .\nPART NO. X /XX XXX\nPattern Package Temperature\nRangeDevice\n   \nDevice: PIC16F684, PIC16F684T(1)\n    V DD range 2.0V to 5.5V\nTemperature \nRange:I=  - 4 0 °C to +85 °C (Industrial)\nE=  - 4 0 °C to +125 °C (Extended)\nPackage: ML = Quad Flat No Leads (QFN)\nP = Plastic DIP\nSL = 14-lead Small Outline (3.90 mm)\nST = Thin Shrink Small Outline (4.4 mm)\nPattern: QTP, SQTPSM or ROM Code; Special Requirements \n(blank otherwise)Examples:\na) PIC16F684-E/P 301 = Extended Temp., PDIP\npackage, 20 MHz, QTP pattern #301\nb) PIC16F684-I/SO = Industrial Temp., SOIC\npackage, 20 MHz\nNote 1: T = in tape and reel TSSOP, SOIC and\nQFN packages only.\nDS41202F-page 190 © 2007 Microchip Technology Inc.AMERICAS\nCorporate Office\n2355 West Chandler Blvd.\nChandler, AZ  85224-6199\nTel:  480-792-7200  Fax:  480-792-7277\nTechnical Support: \nhttp://support.microchip.comWeb Address: \nwww.microchip.com\nAtlanta\nDuluth, GA \nTel: 678-957-9614 \nFax: 678-957-1455\nBoston\nWestborough, MA  \nTel: 774-760-0087 \nFax: 774-760-0088\nChicago\nItasca, IL  \nTel: 630-285-0071 \nFax: 630-285-0075\nDallas\nAddison, TX \nTel: 972-818-7423  \nFax: 972-818-2924\nDetroit\nFarmington Hills, MI \nTel: 248-538-2250\nFax: 248-538-2260\nKokomo\nKokomo, IN \nTel: 765-864-8360\nFax: 765-864-8387\nLos Angeles\nMission Viejo, CA \nTel: 949-462-9523  Fax: 949-462-9608\nSanta Clara\nSanta Clara, CA Tel: 408-961-6444\nFax: 408-961-6445\nToronto\nMississauga, Ontario, \nCanada\nTel: 905-673-0699  \nFax:  905-673-6509ASIA/PACIFIC\nAsia Pacific OfficeSuites 3707-14, 37th Floor\nTower 6, The Gateway\nHabour City, KowloonHong Kong\nTel: 852-2401-1200\nFax: 852-2401-3431\nAustralia - Sydney\nTel: 61-2-9868-6733\nFax: 61-2-9868-6755\nChina - Beijing\nTel: 86-10-8528-2100 \nFax: 86-10-8528-2104\nChina - Chengdu\nTel: 86-28-8665-5511\nFax: 86-28-8665-7889\nChina - Fuzhou\nTel: 86-591-8750-3506  \nFax: 86-591-8750-3521\nChina - Hong Kong SAR\nTel: 852-2401-1200  \nFax: 852-2401-3431\nChina - Qingdao\nTel: 86-532-8502-7355\nFax: 86-532-8502-7205\nChina - Shanghai\nTel: 86-21-5407-5533  \nFax: 86-21-5407-5066\nChina - Shenyang\nTel: 86-24-2334-2829Fax: 86-24-2334-2393\nChina - Shenzhen\nTel: 86-755-8203-2660 Fax: 86-755-8203-1760\nChina - Shunde\nTel: 86-757-2839-5507 Fax: 86-757-2839-5571\nChina - Wuhan\nTel: 86-27-5980-5300Fax: 86-27-5980-5118\nChina - Xian\nTel: 86-29-8833-7250Fax: 86-29-8833-7256ASIA/PACIFIC\nIndia - Bangalore\nTel: 91-80-4182-8400 \nFax: 91-80-4182-8422\nIndia - New Delhi\nTel: 91-11-4160-8631Fax: 91-11-4160-8632\nIndia - Pune\nTel: 91-20-2566-1512Fax: 91-20-2566-1513\nJapan - Yokohama\nTel: 81-45-471- 6166  Fax: 81-45-471-6122\nKorea - Gumi\nTel: 82-54-473-4301\nFax: 82-54-473-4302\nKorea - Seoul\nTel: 82-2-554-7200\nFax: 82-2-558-5932 or 82-2-558-5934\nMalaysia - Penang\nTel: 60-4-646-8870Fax: 60-4-646-5086\nPhilippines - Manila\nTel: 63-2-634-9065Fax: 63-2-634-9069\nSingapore\nTel:  65-6334-8870\nFax: 65-6334-8850\nTaiwan - Hsin Chu\nTel: 886-3-572-9526\nFax: 886-3-572-6459\nTaiwan - Kaohsiung\nTel: 886-7-536-4818\nFax: 886-7-536-4803\nTaiwan - Taipei\nTel: 886-2-2500-6610  \nFax: 886-2-2508-0102\nThailand - Bangkok\nTel: 66-2-694-1351Fax: 66-2-694-1350EUROPE\nAustria - WelsTel: 43-7242-2244-39\nFax: 43-7242-2244-393\nDenmark - Copenhagen\nTel: 45-4450-2828 \nFax: 45-4485-2829\nFrance - Paris\nTel: 33-1-69-53-63-20  \nFax: 33-1-69-30-90-79\nGermany - Munich\nTel: 49-89-627-144-0 \nFax: 49-89-627-144-44\nItaly - Milan \nTel: 39-0331-742611  \nFax: 39-0331-466781\nNetherlands - Drunen\nTel: 31-416-690399 \nFax: 31-416-690340\nSpain - Madrid\nTel: 34-91-708-08-90\nFax: 34-91-708-08-91\nUK - Wokingham\nTel: 44-118-921-5869\nFax: 44-118-921-5820WORLDWIDE  SALES  AND SERVICE\n12/08/06\n'}]
!==============================================================================!
### Technical Summary of the PIC16F684-I/SL Microcontroller

**Component Overview:**
The PIC16F684-I/SL is a 14-pin, Flash-based 8-bit CMOS microcontroller from Microchip Technology, designed for low-power applications with nanoWatt technology. It features a high-performance RISC CPU, multiple I/O options, and integrated peripherals, making it suitable for a variety of embedded applications.

**Key Specifications:**

- **Voltage Ratings:**
  - Operating Voltage (VDD): 2.0V to 5.5V
  - Brown-out Reset Voltage (VBOR): 2.0V to 2.2V

- **Current Ratings:**
  - Supply Current (IDD): 
    - 1 μA (typical) at 32 kHz in LP mode
    - 82 μA (typical) at 1 MHz in XT mode
    - 260 μA (typical) at 4 MHz in HS mode
    - 1.2 mA (maximum) at 20 MHz in HS mode

- **Power Consumption:**
  - Power-down Base Current (IPD): 
    - 0.05 μA (typical) in Sleep mode with all peripherals disabled
    - 0.15 μA (typical) in Sleep mode with WDT and BOR enabled

- **Operating Temperature Range:**
  - Industrial: -40°C to +85°C
  - Extended: -40°C to +125°C

- **Package Type:**
  - Available in 14-pin PDIP, SOIC, TSSOP, and 16-pin QFN packages.

- **Special Features:**
  - Integrated 10-bit ADC with 8 channels.
  - Dual comparators with programmable voltage reference.
  - Enhanced Capture/Compare/PWM (ECCP) module.
  - Watchdog Timer (WDT) with programmable prescaler.
  - Power-on Reset (POR) and Brown-out Reset (BOR) features.
  - In-Circuit Serial Programming (ICSP) capability.
  - Ultra Low-Power Wake-Up feature.

- **Moisture Sensitive Level (MSL):**
  - MSL Level: 1 (JEDEC J-STD-020E)

**Description:**
The PIC16F684 is an 8-bit microcontroller that utilizes a RISC architecture, allowing for efficient instruction execution. It includes a variety of integrated peripherals such as timers, an analog-to-digital converter (ADC), and comparators, making it versatile for applications in automation, control systems, and sensor interfacing.

**Typical Applications:**
- **Power Management:** The low-power features and sleep modes make it ideal for battery-operated devices.
- **Signal Processing:** The integrated ADC and comparators allow for effective signal conditioning and processing.
- **Data Acquisition:** Suitable for applications requiring data logging and sensor interfacing.
- **Embedded Control Systems:** Its GPIO capabilities and PWM outputs make it suitable for motor control and other actuating applications.

This microcontroller is designed for applications that require a balance of performance and power efficiency, making it a popular choice in the embedded systems market.